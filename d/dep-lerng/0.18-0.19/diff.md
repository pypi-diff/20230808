# Comparing `tmp/dep_lerng-0.18.tar.gz` & `tmp/dep_lerng-0.19.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dep_lerng-0.18.tar", last modified: Sat Aug  5 00:13:43 2023, max compression
+gzip compressed data, was "dep_lerng-0.19.tar", last modified: Mon Aug  7 23:25:29 2023, max compression
```

## Comparing `dep_lerng-0.18.tar` & `dep_lerng-0.19.tar`

### file list

```diff
@@ -1,19 +1,20 @@
-drwxrwxrwx   0        0        0        0 2023-08-05 00:13:43.323396 dep_lerng-0.18/
--rw-rw-rw-   0        0        0      211 2023-08-05 00:13:43.323396 dep_lerng-0.18/PKG-INFO
-drwxrwxrwx   0        0        0        0 2023-08-05 00:13:43.318370 dep_lerng-0.18/dep_lerng/
--rw-rw-rw-   0        0        0     3733 2023-08-05 00:12:22.000000 dep_lerng-0.18/dep_lerng/ClassifierNet.py
--rw-rw-rw-   0        0        0     3168 2023-08-05 00:12:23.000000 dep_lerng-0.18/dep_lerng/ConvBlock.py
--rw-rw-rw-   0        0        0     1268 2023-08-04 23:22:10.000000 dep_lerng-0.18/dep_lerng/Dataset.py
--rw-rw-rw-   0        0        0     7187 2023-08-05 00:12:24.000000 dep_lerng-0.18/dep_lerng/ResBlock.py
--rw-rw-rw-   0        0        0     7892 2023-08-05 00:12:24.000000 dep_lerng-0.18/dep_lerng/ResNet.py
--rw-rw-rw-   0        0        0       75 2023-08-04 23:22:07.000000 dep_lerng-0.18/dep_lerng/__init__.py
--rw-rw-rw-   0        0        0    10166 2023-08-04 23:22:08.000000 dep_lerng-0.18/dep_lerng/custom_blocks.py
--rw-rw-rw-   0        0        0     9670 2023-08-05 00:12:24.000000 dep_lerng-0.18/dep_lerng/model_init.py
-drwxrwxrwx   0        0        0        0 2023-08-05 00:13:43.322370 dep_lerng-0.18/dep_lerng.egg-info/
--rw-rw-rw-   0        0        0      211 2023-08-05 00:13:43.000000 dep_lerng-0.18/dep_lerng.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      358 2023-08-05 00:13:43.000000 dep_lerng-0.18/dep_lerng.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-08-05 00:13:43.000000 dep_lerng-0.18/dep_lerng.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-08-05 00:00:57.000000 dep_lerng-0.18/dep_lerng.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       10 2023-08-05 00:13:43.000000 dep_lerng-0.18/dep_lerng.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-08-05 00:13:43.323396 dep_lerng-0.18/setup.cfg
--rw-rw-rw-   0        0        0      276 2023-08-05 00:13:32.000000 dep_lerng-0.18/setup.py
+drwxrwxrwx   0        0        0        0 2023-08-07 23:25:29.602887 dep_lerng-0.19/
+-rw-rw-rw-   0        0        0      211 2023-08-07 23:25:29.601889 dep_lerng-0.19/PKG-INFO
+drwxrwxrwx   0        0        0        0 2023-08-07 23:25:29.575890 dep_lerng-0.19/dep_lerng/
+-rw-rw-rw-   0        0        0     2373 2023-08-07 23:23:09.000000 dep_lerng-0.19/dep_lerng/ClassifierNet.py
+-rw-rw-rw-   0        0        0     3168 2023-08-07 23:23:09.000000 dep_lerng-0.19/dep_lerng/ConvBlock.py
+-rw-rw-rw-   0        0        0     1090 2023-08-07 23:23:10.000000 dep_lerng-0.19/dep_lerng/Dataset.py
+-rw-rw-rw-   0        0        0     3636 2023-08-07 23:23:17.000000 dep_lerng-0.19/dep_lerng/RadonBlock.py
+-rw-rw-rw-   0        0        0     7098 2023-08-07 23:23:16.000000 dep_lerng-0.19/dep_lerng/ResBlock.py
+-rw-rw-rw-   0        0        0     8307 2023-08-07 23:23:17.000000 dep_lerng-0.19/dep_lerng/ResNet.py
+-rw-rw-rw-   0        0        0       75 2023-08-07 23:21:29.000000 dep_lerng-0.19/dep_lerng/__init__.py
+-rw-rw-rw-   0        0        0    10166 2023-08-07 23:23:10.000000 dep_lerng-0.19/dep_lerng/custom_blocks.py
+-rw-rw-rw-   0        0        0     8939 2023-08-07 23:23:16.000000 dep_lerng-0.19/dep_lerng/model_init.py
+drwxrwxrwx   0        0        0        0 2023-08-07 23:25:29.598886 dep_lerng-0.19/dep_lerng.egg-info/
+-rw-rw-rw-   0        0        0      211 2023-08-07 23:25:29.000000 dep_lerng-0.19/dep_lerng.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      382 2023-08-07 23:25:29.000000 dep_lerng-0.19/dep_lerng.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-08-07 23:25:29.000000 dep_lerng-0.19/dep_lerng.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-08-07 23:25:28.000000 dep_lerng-0.19/dep_lerng.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       10 2023-08-07 23:25:29.000000 dep_lerng-0.19/dep_lerng.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-08-07 23:25:29.602887 dep_lerng-0.19/setup.cfg
+-rw-rw-rw-   0        0        0      276 2023-08-07 23:23:13.000000 dep_lerng-0.19/setup.py
```

### Comparing `dep_lerng-0.18/dep_lerng/ConvBlock.py` & `dep_lerng-0.19/dep_lerng/ConvBlock.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.18/dep_lerng/Dataset.py` & `dep_lerng-0.19/dep_lerng/Dataset.py`

 * *Files 7% similar despite different names*

```diff
@@ -6,75 +6,64 @@
 00000050: 4552 5c44 6573 6b74 6f70 5c6a 6f73 685c  ER\Desktop\josh\
 00000060: 4461 7461 5c52 4157 5f44 4154 4127 2020  Data\RAW_DATA'  
 00000070: 2020 0d0a 0d0a 746f 7263 682e 6d61 6e75    ....torch.manu
 00000080: 616c 5f73 6565 6428 3433 290d 0a0d 0a63  al_seed(43)....c
 00000090: 6c61 7373 2057 6166 6572 4453 5f4c 6162  lass WaferDS_Lab
 000000a0: 6c65 6428 4461 7461 7365 7429 3a0d 0a20  led(Dataset):.. 
 000000b0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-000000c0: 7365 6c66 2c20 6175 676d 656e 7420 3d20  self, augment = 
-000000d0: 4661 6c73 6529 3a0d 0a0d 0a20 2020 2020  False):....     
-000000e0: 2020 2073 656c 662e 6175 676d 656e 7420     self.augment 
-000000f0: 3d20 6175 676d 656e 740d 0a0d 0a20 2020  = augment....   
-00000100: 2020 2020 2073 656c 662e 6c61 6265 6c73       self.labels
-00000110: 203d 2074 6f72 6368 2e6c 6f61 6428 6627   = torch.load(f'
-00000120: 7b64 6174 615f 6469 727d 2f74 6573 745f  {data_dir}/test_
-00000130: 6c61 6265 6c73 2e70 7427 290d 0a20 2020  labels.pt')..   
-00000140: 2020 2020 2073 656c 662e 7761 6665 7273       self.wafers
-00000150: 203d 2074 6f72 6368 2e6c 6f61 6428 6627   = torch.load(f'
-00000160: 7b64 6174 615f 6469 727d 2f74 6573 745f  {data_dir}/test_
-00000170: 7761 6665 7273 2e70 7427 2920 2020 2020  wafers.pt')     
-00000180: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
-00000190: 656c 662e 6175 676d 656e 743a 0d0a 0d0a  elf.augment:....
-000001a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000001b0: 2e72 6164 6f6e 203d 2074 6f72 6368 2e6e  .radon = torch.n
-000001c0: 616e 5f74 6f5f 6e75 6d28 746f 7263 682e  an_to_num(torch.
-000001d0: 6c6f 6164 2866 277b 6461 7461 5f64 6972  load(f'{data_dir
-000001e0: 7d2f 7465 7374 5f72 6164 6f6e 2e70 7427  }/test_radon.pt'
-000001f0: 2929 2020 200d 0a20 2020 2020 2020 2020  ))   ..         
-00000200: 2020 2023 2073 656c 662e 7265 6769 6f6e     # self.region
-00000210: 616c 203d 2074 6f72 6368 2e6c 6f61 6428  al = torch.load(
-00000220: 6627 7b64 6174 615f 6469 725f 327d 2f72  f'{data_dir_2}/r
-00000230: 6567 696f 6e61 6c2e 7074 2729 2020 2020  egional.pt')    
-00000240: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00000250: 7365 6c66 2e73 7461 7469 7374 6963 616c  self.statistical
-00000260: 203d 2074 6f72 6368 2e6c 6f61 6428 6627   = torch.load(f'
-00000270: 7b64 6174 615f 6469 725f 327d 2f73 7461  {data_dir_2}/sta
-00000280: 7469 7374 6963 616c 2e70 7427 2920 2020  tistical.pt')   
-00000290: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-000002a0: 2073 656c 662e 6465 6e73 6974 7920 3d20   self.density = 
-000002b0: 746f 7263 682e 6c6f 6164 2866 277b 6461  torch.load(f'{da
-000002c0: 7461 5f64 6972 5f32 7d2f 6465 6e73 6974  ta_dir_2}/densit
-000002d0: 792e 7074 2729 2020 2020 0d0a 0d0a 2020  y.pt')    ....  
-000002e0: 2020 6465 6620 5f5f 6c65 6e5f 5f28 7365    def __len__(se
-000002f0: 6c66 293a 0d0a 0d0a 2020 2020 2020 2020  lf):....        
-00000300: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
-00000310: 6c61 6265 6c73 290d 0a0d 0a20 2020 2064  labels)....    d
-00000320: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
-00000330: 656c 662c 2069 6478 293a 0d0a 0d0a 2020  elf, idx):....  
-00000340: 2020 2020 2020 6c61 6265 6c20 3d20 7365        label = se
-00000350: 6c66 2e6c 6162 656c 735b 6964 785d 2e6c  lf.labels[idx].l
-00000360: 6f6e 6728 290d 0a20 2020 2020 2020 2069  ong()..        i
-00000370: 6d61 6765 203d 2073 656c 662e 7761 6665  mage = self.wafe
-00000380: 7273 5b69 6478 5d0d 0a0d 0a20 2020 2020  rs[idx]....     
-00000390: 2020 2069 6620 7365 6c66 2e61 7567 6d65     if self.augme
-000003a0: 6e74 3a0d 0a0d 0a20 2020 2020 2020 2020  nt:....         
-000003b0: 2020 2072 6164 6f6e 203d 2073 656c 662e     radon = self.
-000003c0: 7261 646f 6e5b 6964 785d 0d0a 2020 2020  radon[idx]..    
-000003d0: 2020 2020 2020 2020 2320 7265 6769 6f6e          # region
-000003e0: 616c 203d 2073 656c 662e 7265 6769 6f6e  al = self.region
-000003f0: 616c 5b69 6478 5d0d 0a20 2020 2020 2020  al[idx]..       
-00000400: 2020 2020 2023 2073 7461 7469 7374 6963       # statistic
-00000410: 616c 203d 2073 656c 662e 7374 6174 6973  al = self.statis
-00000420: 7469 6361 6c5b 6964 785d 0d0a 2020 2020  tical[idx]..    
-00000430: 2020 2020 2020 2020 2320 6465 6e73 6974          # densit
-00000440: 7920 3d20 7365 6c66 2e64 656e 7369 7479  y = self.density
-00000450: 5b69 6478 5d0d 0a0d 0a20 2020 2020 2020  [idx]....       
-00000460: 2020 2020 2023 2072 6574 7572 6e20 696d       # return im
-00000470: 6167 652c 2072 6164 6f6e 2c20 2872 6567  age, radon, (reg
-00000480: 696f 6e61 6c2c 2073 7461 7469 7374 6963  ional, statistic
-00000490: 616c 2c20 6465 6e73 6974 7929 2c20 6c61  al, density), la
-000004a0: 6265 6c0d 0a20 2020 2020 2020 2020 2020  bel..           
-000004b0: 2072 6574 7572 6e20 696d 6167 652c 2072   return image, r
-000004c0: 6164 6f6e 2c20 6c61 6265 6c0d 0a20 2020  adon, label..   
-000004d0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-000004e0: 6574 7572 6e20 696d 6167 652c 206c 6162  eturn image, lab
-000004f0: 656c 0d0a                                el..
+000000c0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+000000d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000000e0: 6162 656c 7320 3d20 746f 7263 682e 6c6f  abels = torch.lo
+000000f0: 6164 2866 277b 6461 7461 5f64 6972 7d2f  ad(f'{data_dir}/
+00000100: 7465 7374 5f6c 6162 656c 732e 7074 2729  test_labels.pt')
+00000110: 0d0a 2020 2020 2020 2020 7365 6c66 2e77  ..        self.w
+00000120: 6166 6572 7320 3d20 746f 7263 682e 6c6f  afers = torch.lo
+00000130: 6164 2866 277b 6461 7461 5f64 6972 7d2f  ad(f'{data_dir}/
+00000140: 7465 7374 5f77 6166 6572 732e 7074 2729  test_wafers.pt')
+00000150: 2020 2020 200d 0a0d 0a20 2020 2020 2020       ....       
+00000160: 2073 656c 662e 7261 646f 6e20 3d20 746f   self.radon = to
+00000170: 7263 682e 6e61 6e5f 746f 5f6e 756d 2874  rch.nan_to_num(t
+00000180: 6f72 6368 2e6c 6f61 6428 6627 7b64 6174  orch.load(f'{dat
+00000190: 615f 6469 727d 2f74 6573 745f 7261 646f  a_dir}/test_rado
+000001a0: 6e2e 7074 2729 2920 2020 0d0a 2020 2020  n.pt'))   ..    
+000001b0: 2020 2020 2320 7365 6c66 2e72 6567 696f      # self.regio
+000001c0: 6e61 6c20 3d20 746f 7263 682e 6c6f 6164  nal = torch.load
+000001d0: 2866 277b 6461 7461 5f64 6972 5f32 7d2f  (f'{data_dir_2}/
+000001e0: 7265 6769 6f6e 616c 2e70 7427 2920 2020  regional.pt')   
+000001f0: 200d 0a20 2020 2020 2020 2023 2073 656c   ..        # sel
+00000200: 662e 7374 6174 6973 7469 6361 6c20 3d20  f.statistical = 
+00000210: 746f 7263 682e 6c6f 6164 2866 277b 6461  torch.load(f'{da
+00000220: 7461 5f64 6972 5f32 7d2f 7374 6174 6973  ta_dir_2}/statis
+00000230: 7469 6361 6c2e 7074 2729 2020 2020 0d0a  tical.pt')    ..
+00000240: 2020 2020 2020 2020 2320 7365 6c66 2e64          # self.d
+00000250: 656e 7369 7479 203d 2074 6f72 6368 2e6c  ensity = torch.l
+00000260: 6f61 6428 6627 7b64 6174 615f 6469 725f  oad(f'{data_dir_
+00000270: 327d 2f64 656e 7369 7479 2e70 7427 2920  2}/density.pt') 
+00000280: 2020 200d 0a0d 0a20 2020 2064 6566 205f     ....    def _
+00000290: 5f6c 656e 5f5f 2873 656c 6629 3a0d 0a0d  _len__(self):...
+000002a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000002b0: 6c65 6e28 7365 6c66 2e6c 6162 656c 7329  len(self.labels)
+000002c0: 0d0a 0d0a 2020 2020 6465 6620 5f5f 6765  ....    def __ge
+000002d0: 7469 7465 6d5f 5f28 7365 6c66 2c20 6964  titem__(self, id
+000002e0: 7829 3a0d 0a0d 0a20 2020 2020 2020 206c  x):....        l
+000002f0: 6162 656c 203d 2073 656c 662e 6c61 6265  abel = self.labe
+00000300: 6c73 5b69 6478 5d2e 6c6f 6e67 2829 0d0a  ls[idx].long()..
+00000310: 2020 2020 2020 2020 696d 6167 6520 3d20          image = 
+00000320: 7365 6c66 2e77 6166 6572 735b 6964 785d  self.wafers[idx]
+00000330: 0d0a 0d0a 2020 2020 2020 2020 7261 646f  ....        rado
+00000340: 6e20 3d20 7365 6c66 2e72 6164 6f6e 5b69  n = self.radon[i
+00000350: 6478 5d0d 0a20 2020 2020 2020 2023 2072  dx]..        # r
+00000360: 6567 696f 6e61 6c20 3d20 7365 6c66 2e72  egional = self.r
+00000370: 6567 696f 6e61 6c5b 6964 785d 0d0a 2020  egional[idx]..  
+00000380: 2020 2020 2020 2320 7374 6174 6973 7469        # statisti
+00000390: 6361 6c20 3d20 7365 6c66 2e73 7461 7469  cal = self.stati
+000003a0: 7374 6963 616c 5b69 6478 5d0d 0a20 2020  stical[idx]..   
+000003b0: 2020 2020 2023 2064 656e 7369 7479 203d       # density =
+000003c0: 2073 656c 662e 6465 6e73 6974 795b 6964   self.density[id
+000003d0: 785d 0d0a 0d0a 2020 2020 2020 2020 2320  x]....        # 
+000003e0: 7265 7475 726e 2069 6d61 6765 2c20 7261  return image, ra
+000003f0: 646f 6e2c 2028 7265 6769 6f6e 616c 2c20  don, (regional, 
+00000400: 7374 6174 6973 7469 6361 6c2c 2064 656e  statistical, den
+00000410: 7369 7479 292c 206c 6162 656c 0d0a 2020  sity), label..  
+00000420: 2020 2020 2020 7265 7475 726e 2069 6d61        return ima
+00000430: 6765 2c20 7261 646f 6e2c 206c 6162 656c  ge, radon, label
+00000440: 0d0a                                     ..
```

### Comparing `dep_lerng-0.18/dep_lerng/ResBlock.py` & `dep_lerng-0.19/dep_lerng/ResBlock.py`

 * *Files 3% similar despite different names*

```diff
@@ -23,428 +23,422 @@
 00000160: 7369 6f6e 2e6f 7073 2069 6d70 6f72 7420  sion.ops import 
 00000170: 4472 6f70 426c 6f63 6b32 640d 0a0d 0a66  DropBlock2d....f
 00000180: 726f 6d20 6b6f 726e 6961 2e61 7567 6d65  rom kornia.augme
 00000190: 6e74 6174 696f 6e20 696d 706f 7274 2052  ntation import R
 000001a0: 6573 697a 650d 0a69 6d70 6f72 7420 746f  esize..import to
 000001b0: 7263 680d 0a0d 0a23 2d2d 2d2d 2d2d 2d2d  rch....#--------
 000001c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000001d0: 2d2d 2d2d 2d2d 0d0a 0d0a 6672 6f6d 202e  ------....from .
-000001e0: 6375 7374 6f6d 5f62 6c6f 636b 7320 696d  custom_blocks im
-000001f0: 706f 7274 2041 4646 2c4d 5343 414d 2c20  port AFF,MSCAM, 
-00000200: 5341 4d2c 2069 4146 462c 2045 4341 0d0a  SAM, iAFF, ECA..
-00000210: 0d0a 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ..#-------------
-00000220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000230: 2d0d 0a0d 0a74 6f72 6368 2e6d 616e 7561  -....torch.manua
-00000240: 6c5f 7365 6564 2834 3329 0d0a 0d0a 6163  l_seed(43)....ac
-00000250: 7469 203d 204d 6973 6828 696e 706c 6163  ti = Mish(inplac
-00000260: 6520 3d20 5472 7565 290d 0a23 2061 6374  e = True)..# act
-00000270: 6920 3d20 5052 654c 5528 290d 0a0d 0a23  i = PReLU()....#
-00000280: 2074 6f72 6368 2e73 6574 5f66 6c6f 6174   torch.set_float
-00000290: 3332 5f6d 6174 6d75 6c5f 7072 6563 6973  32_matmul_precis
-000002a0: 696f 6e28 2268 6967 6822 290d 0a0d 0a64  ion("high")....d
-000002b0: 6566 2052 6573 426c 6f63 6b28 6d6f 6469  ef ResBlock(modi
-000002c0: 6669 6572 732c 2073 7175 6565 7a65 2c20  fiers, squeeze, 
-000002d0: 6175 676d 656e 742c 206c 6179 6572 203d  augment, layer =
-000002e0: 204e 6f6e 6529 3a0d 0a0d 0a20 2020 2022   None):....    "
-000002f0: 2222 0d0a 2020 2020 5661 6e69 6c6c 6120  ""..    Vanilla 
-00000300: 426c 6f63 6b20 3a20 4f72 6967 696e 616c  Block : Original
-00000310: 2052 6573 6964 7561 6c20 426c 6f63 6b20   Residual Block 
-00000320: 6173 206d 656e 7469 6f6e 6564 2069 6e20  as mentioned in 
-00000330: 3135 3132 2e30 3333 3835 205b 4465 6570  1512.03385 [Deep
-00000340: 2052 6573 6964 7561 6c20 4c65 6172 6e69   Residual Learni
-00000350: 6e67 2066 6f72 2049 6d61 6765 2052 6563  ng for Image Rec
-00000360: 6f67 6e69 7469 6f6e 5d0d 0a0d 0a20 2020  ognition]....   
-00000370: 2042 6f74 746c 656e 6563 6b20 426c 6f63   Bottleneck Bloc
-00000380: 6b20 3a20 4f72 6967 696e 616c 2042 6f74  k : Original Bot
-00000390: 746c 656e 6563 6b20 426c 6f63 6b20 6173  tleneck Block as
-000003a0: 206d 656e 7469 6f6e 6564 2069 6e20 3135   mentioned in 15
-000003b0: 3132 2e30 3333 3835 205b 4465 6570 2052  12.03385 [Deep R
-000003c0: 6573 6964 7561 6c20 4c65 6172 6e69 6e67  esidual Learning
-000003d0: 2066 6f72 2049 6d61 6765 2052 6563 6f67   for Image Recog
-000003e0: 6e69 7469 6f6e 5d0d 0a20 2020 200d 0a20  nition]..    .. 
-000003f0: 2020 2042 6f74 746c 656e 6563 6b20 426c     Bottleneck Bl
-00000400: 6f63 6b20 5632 203a 204d 6f64 6966 6965  ock V2 : Modifie
-00000410: 7320 5265 7369 6475 616c 2042 6c6f 636b  s Residual Block
-00000420: 7320 746f 2068 6176 6520 6c61 7267 6572  s to have larger
-00000430: 206c 6561 726e 696e 6720 6361 7061 6369   learning capaci
-00000440: 7479 2c20 6173 206d 656e 7469 6f6e 6564  ty, as mentioned
-00000450: 2069 6e20 3138 3132 2e30 3131 3837 205b   in 1812.01187 [
-00000460: 4261 6720 6f66 2054 7269 636b 7320 666f  Bag of Tricks fo
-00000470: 7220 496d 6167 6520 436c 6173 7369 6669  r Image Classifi
-00000480: 6361 7469 6f6e 2077 6974 6820 436f 6e76  cation with Conv
-00000490: 6f6c 7574 696f 6e61 6c20 4e65 7572 616c  olutional Neural
-000004a0: 204e 6574 776f 726b 735d 0d0a 0d0a 2020   Networks]....  
-000004b0: 2020 4e65 7874 2042 6c6f 636b 203a 2052    Next Block : R
-000004c0: 6570 6c61 6365 7320 436f 6e76 6f6c 7574  eplaces Convolut
-000004d0: 696f 6e73 2077 6974 6820 4772 6f75 7065  ions with Groupe
-000004e0: 6420 436f 6e76 6f6c 7574 696f 6e73 2061  d Convolutions a
-000004f0: 7320 7365 6520 696e 2031 3631 312e 3035  s see in 1611.05
-00000500: 3433 3120 5b41 6767 7265 6761 7465 6420  431 [Aggregated 
-00000510: 5265 7369 6475 616c 2054 7261 6e73 666f  Residual Transfo
-00000520: 726d 6174 696f 6e73 2066 6f72 2044 6565  rmations for Dee
-00000530: 7020 4e65 7572 616c 204e 6574 776f 726b  p Neural Network
-00000540: 735d 0d0a 2020 2020 2222 220d 0a20 2020  s]..    """..   
-00000550: 200d 0a20 2020 2064 6570 7468 2c20 666c   ..    depth, fl
-00000560: 6176 6f72 203d 206d 6f64 6966 6965 7273  avor = modifiers
-00000570: 0d0a 0d0a 2020 2020 6966 2066 6c61 766f  ....    if flavo
-00000580: 7220 3d3d 2027 7661 6e69 6c6c 6127 3a0d  r == 'vanilla':.
-00000590: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000005a0: 5661 6e69 6c6c 615f 426c 6f63 6b28 6465  Vanilla_Block(de
-000005b0: 7074 682c 2073 7175 6565 7a65 2c20 6175  pth, squeeze, au
-000005c0: 676d 656e 742c 206c 6179 6572 290d 0a0d  gment, layer)...
-000005d0: 0a20 2020 2065 6c69 6620 666c 6176 6f72  .    elif flavor
-000005e0: 203d 3d20 2762 6f74 746c 656e 6563 6b27   == 'bottleneck'
-000005f0: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
-00000600: 6e20 426f 7474 6c65 6e65 636b 5f42 6c6f  n Bottleneck_Blo
-00000610: 636b 2864 6570 7468 2c20 7371 7565 657a  ck(depth, squeez
-00000620: 652c 2061 7567 6d65 6e74 2c20 6c61 7965  e, augment, laye
-00000630: 7229 0d0a 0d0a 2020 2020 2320 656c 6966  r)....    # elif
-00000640: 2066 6c61 766f 7220 3d3d 2027 6375 7374   flavor == 'cust
-00000650: 6f6d 273a 0d0a 0d0a 2020 2020 2320 2020  om':....    #   
-00000660: 2020 6966 206d 6f64 6966 6965 7273 5b30    if modifiers[0
-00000670: 5d20 696e 205b 302c 2031 5d3a 0d0a 2020  ] in [0, 1]:..  
-00000680: 2020 2320 2020 2020 2020 2020 7265 7475    #         retu
-00000690: 726e 2056 616e 696c 6c61 5f42 6c6f 636b  rn Vanilla_Block
-000006a0: 286d 6f64 6966 6965 7273 2c20 7371 7565  (modifiers, sque
-000006b0: 657a 652c 2061 7567 6d65 6e74 2c20 6c61  eze, augment, la
-000006c0: 7965 7229 200d 0a20 2020 2023 2020 2020  yer) ..    #    
-000006d0: 2065 6c69 6620 6d6f 6469 6669 6572 735b   elif modifiers[
-000006e0: 305d 2069 6e20 5b32 2c20 335d 3a0d 0a20  0] in [2, 3]:.. 
-000006f0: 2020 2023 2020 2020 2020 2020 2072 6574     #         ret
-00000700: 7572 6e20 426f 7474 6c65 6e65 636b 5f42  urn Bottleneck_B
-00000710: 6c6f 636b 5f56 3228 6d6f 6469 6669 6572  lock_V2(modifier
-00000720: 732c 2073 7175 6565 7a65 2c20 6175 676d  s, squeeze, augm
-00000730: 656e 742c 206c 6179 6572 290d 0a0d 0a0d  ent, layer).....
-00000740: 0a63 6c61 7373 2056 616e 696c 6c61 5f42  .class Vanilla_B
-00000750: 6c6f 636b 284d 6f64 756c 6529 3a0d 0a20  lock(Module):.. 
-00000760: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00000770: 7365 6c66 2c20 2064 6570 7468 2c20 7371  self,  depth, sq
-00000780: 7565 657a 652c 2061 7567 6d65 6e74 2c20  ueeze, augment, 
-00000790: 6c61 7965 7220 3d20 4e6f 6e65 293a 0d0a  layer = None):..
-000007a0: 2020 2020 2020 2020 7375 7065 7228 5661          super(Va
-000007b0: 6e69 6c6c 615f 426c 6f63 6b2c 2073 656c  nilla_Block, sel
-000007c0: 6629 2e5f 5f69 6e69 745f 5f28 290d 0a0d  f).__init__()...
-000007d0: 0a20 2020 2020 2020 206c 6179 6572 5f64  .        layer_d
-000007e0: 6570 7468 203d 2064 6570 7468 0d0a 2020  epth = depth..  
-000007f0: 2020 2020 2020 7365 6c66 2e6c 6179 6572        self.layer
-00000800: 5f64 6570 7468 203d 206c 6179 6572 5f64  _depth = layer_d
-00000810: 6570 7468 0d0a 2020 2020 2020 2020 7365  epth..        se
-00000820: 6c66 2e73 7175 6565 7a65 203d 2073 7175  lf.squeeze = squ
-00000830: 6565 7a65 0d0a 2020 2020 2020 2020 7365  eeze..        se
-00000840: 6c66 2e61 7567 6d65 6e74 203d 2061 7567  lf.augment = aug
-00000850: 6d65 6e74 0d0a 0d0a 2020 2020 2020 2020  ment....        
-00000860: 7365 6c66 2e6c 6179 6572 203d 206c 6179  self.layer = lay
-00000870: 6572 0d0a 0d0a 2020 2020 2020 2020 6966  er....        if
-00000880: 206c 6179 6572 203d 3d20 2766 6972 7374   layer == 'first
-00000890: 273a 0d0a 0d0a 2020 2020 2020 2020 2020  ':....          
-000008a0: 2020 6966 206c 6179 6572 5f64 6570 7468    if layer_depth
-000008b0: 203d 3d20 303a 0d0a 0d0a 2020 2020 2020   == 0:....      
-000008c0: 2020 2020 2020 2020 2020 2320 695f 6368            # i_ch
-000008d0: 616e 6e65 6c20 3d20 3634 0d0a 2020 2020  annel = 64..    
-000008e0: 2020 2020 2020 2020 2020 2020 2320 6f5f              # o_
-000008f0: 6368 616e 6e65 6c20 3d20 3634 0d0a 0d0a  channel = 64....
-00000900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000920: 2020 695f 6368 616e 6e65 6c20 3d20 3136    i_channel = 16
-00000930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000940: 2020 6f5f 6368 616e 6e65 6c20 3d20 3136    o_channel = 16
-00000950: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00000960: 2020 2020 7374 7269 6465 203d 2031 0d0a      stride = 1..
-00000970: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00000980: 7365 3a0d 0a0d 0a20 2020 2020 2020 2020  se:....         
-00000990: 2020 2020 2020 2023 2069 5f63 6861 6e6e         # i_chann
-000009a0: 656c 203d 2033 3220 2a20 2832 202a 2a20  el = 32 * (2 ** 
-000009b0: 6c61 7965 725f 6465 7074 6829 0d0a 2020  layer_depth)..  
-000009c0: 2020 2020 2020 2020 2020 2020 2020 695f                i_
-000009d0: 6368 616e 6e65 6c20 3d20 3820 2a20 2832  channel = 8 * (2
-000009e0: 202a 2a20 6c61 7965 725f 6465 7074 6829   ** layer_depth)
-000009f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000a00: 2020 6f5f 6368 616e 6e65 6c20 3d20 695f    o_channel = i_
-00000a10: 6368 616e 6e65 6c20 2a20 320d 0a20 2020  channel * 2..   
-00000a20: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00000a30: 6964 6520 3d20 320d 0a20 2020 2020 2020  ide = 2..       
-00000a40: 2065 6c73 653a 0d0a 0d0a 2020 2020 2020   else:....      
-00000a50: 2020 2020 2020 2320 695f 6368 616e 6e65        # i_channe
-00000a60: 6c20 3d20 3634 202a 2028 3220 2a2a 206c  l = 64 * (2 ** l
-00000a70: 6179 6572 5f64 6570 7468 290d 0a20 2020  ayer_depth)..   
-00000a80: 2020 2020 2020 2020 2069 5f63 6861 6e6e           i_chann
-00000a90: 656c 203d 2031 3620 2a20 2832 202a 2a20  el = 16 * (2 ** 
-00000aa0: 6c61 7965 725f 6465 7074 6829 0d0a 2020  layer_depth)..  
-00000ab0: 2020 2020 2020 2020 2020 6f5f 6368 616e            o_chan
-00000ac0: 6e65 6c20 3d20 695f 6368 616e 6e65 6c0d  nel = i_channel.
-00000ad0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00000ae0: 6964 6520 3d20 310d 0a0d 0a0d 0a0d 0a20  ide = 1........ 
-00000af0: 2020 2020 2020 2070 203d 2030 0d0a 2020         p = 0..  
-00000b00: 2020 2020 2020 626c 6f63 6b5f 7369 7a65        block_size
-00000b10: 203d 2033 202b 2028 6c61 7965 725f 6465   = 3 + (layer_de
-00000b20: 7074 6820 2a20 3229 0d0a 0d0a 2020 2020  pth * 2)....    
-00000b30: 2020 2020 6966 2073 7175 6565 7a65 3a0d      if squeeze:.
-00000b40: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00000b50: 2020 2020 2020 2020 2020 2072 203d 2031             r = 1
-00000b60: 360d 0a0d 0a20 2020 2020 2020 2020 2020  6....           
-00000b70: 2073 656c 662e 5345 203d 204d 5343 414d   self.SE = MSCAM
-00000b80: 286f 5f63 6861 6e6e 656c 2c20 7229 0d0a  (o_channel, r)..
-00000b90: 2020 2020 2020 2020 2020 2020 2320 7365              # se
-00000ba0: 6c66 2e53 4520 3d20 4543 4128 290d 0a20  lf.SE = ECA().. 
-00000bb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000bc0: 7370 6174 6961 6c20 3d20 5341 4d28 290d  spatial = SAM().
-00000bd0: 0a0d 0a20 2020 2020 2020 206d 6f6d 656e  ...        momen
-00000be0: 7420 3d20 3145 2d31 0d0a 0d0a 2020 2020  t = 1E-1....    
-00000bf0: 2020 2020 7365 6c66 2e76 616e 696c 6c61      self.vanilla
-00000c00: 5f62 6c6f 636b 203d 2053 6571 7565 6e74  _block = Sequent
-00000c10: 6961 6c28 0d0a 2020 2020 2020 2020 2020  ial(..          
-00000c20: 2020 2020 2020 436f 6e76 3264 2869 6e5f        Conv2d(in_
-00000c30: 6368 616e 6e65 6c73 203d 2069 5f63 6861  channels = i_cha
-00000c40: 6e6e 656c 2c20 6f75 745f 6368 616e 6e65  nnel, out_channe
-00000c50: 6c73 203d 206f 5f63 6861 6e6e 656c 2c20  ls = o_channel, 
-00000c60: 6b65 726e 656c 5f73 697a 6520 3d20 332c  kernel_size = 3,
-00000c70: 2073 7472 6964 6520 3d20 312c 2070 6164   stride = 1, pad
-00000c80: 6469 6e67 203d 2031 2c20 6269 6173 203d  ding = 1, bias =
-00000c90: 2046 616c 7365 2c20 6772 6f75 7073 203d   False, groups =
-00000ca0: 2032 292c 0d0a 2020 2020 2020 2020 2020   2),..          
-00000cb0: 2020 2020 2020 4261 7463 684e 6f72 6d32        BatchNorm2
-00000cc0: 6428 6f5f 6368 616e 6e65 6c2c 206d 6f6d  d(o_channel, mom
-00000cd0: 656e 7475 6d20 3d20 6d6f 6d65 6e74 292c  entum = moment),
-00000ce0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000cf0: 2020 6163 7469 2c0d 0a20 2020 2020 2020    acti,..       
-00000d00: 2020 2020 2020 2020 2023 2044 726f 7042           # DropB
-00000d10: 6c6f 636b 3264 2870 203d 2030 2e32 352c  lock2d(p = 0.25,
-00000d20: 2062 6c6f 636b 5f73 697a 6520 3d20 3220   block_size = 2 
-00000d30: 2a2a 2028 3520 2d20 6c61 7965 725f 6465  ** (5 - layer_de
-00000d40: 7074 6829 292c 0d0a 0d0a 2020 2020 2020  pth)),....      
-00000d50: 2020 2020 2020 2020 2020 436f 6e76 3264            Conv2d
-00000d60: 2869 6e5f 6368 616e 6e65 6c73 203d 206f  (in_channels = o
-00000d70: 5f63 6861 6e6e 656c 2c20 6f75 745f 6368  _channel, out_ch
-00000d80: 616e 6e65 6c73 203d 206f 5f63 6861 6e6e  annels = o_chann
-00000d90: 656c 2c20 6b65 726e 656c 5f73 697a 6520  el, kernel_size 
-00000da0: 3d20 332c 2073 7472 6964 6520 3d20 7374  = 3, stride = st
-00000db0: 7269 6465 2c20 7061 6464 696e 6720 3d20  ride, padding = 
-00000dc0: 312c 2062 6961 7320 3d20 4661 6c73 652c  1, bias = False,
-00000dd0: 2067 726f 7570 7320 3d20 3229 2c0d 0a20   groups = 2),.. 
-00000de0: 2020 2020 2020 2020 2020 2020 2020 2042                 B
-00000df0: 6174 6368 4e6f 726d 3264 286f 5f63 6861  atchNorm2d(o_cha
-00000e00: 6e6e 656c 2c20 6d6f 6d65 6e74 756d 203d  nnel, momentum =
-00000e10: 206d 6f6d 656e 7429 2c0d 0a20 2020 2020   moment),..     
-00000e20: 2020 2020 2020 2020 2020 2023 2044 726f             # Dro
-00000e30: 7042 6c6f 636b 3264 2870 203d 2030 2e32  pBlock2d(p = 0.2
-00000e40: 352c 2062 6c6f 636b 5f73 697a 6520 3d20  5, block_size = 
-00000e50: 3220 2a2a 2028 3520 2d20 6c61 7965 725f  2 ** (5 - layer_
-00000e60: 6465 7074 6829 292c 0d0a 2020 2020 2020  depth)),..      
-00000e70: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00000e80: 200d 0a20 2020 2020 2020 2069 6620 6c61   ..        if la
-00000e90: 7965 7220 3d3d 2027 6669 7273 7427 2061  yer == 'first' a
-00000ea0: 6e64 206c 6179 6572 5f64 6570 7468 2021  nd layer_depth !
-00000eb0: 3d20 303a 200d 0a0d 0a20 2020 2020 2020  = 0: ....       
-00000ec0: 2020 2020 2073 656c 662e 646f 776e 7361       self.downsa
-00000ed0: 6d70 6c65 203d 2053 6571 7565 6e74 6961  mple = Sequentia
-00000ee0: 6c28 0d0a 2020 2020 2020 2020 2020 2020  l(..            
-00000ef0: 2020 2020 4176 6750 6f6f 6c32 6428 6b65      AvgPool2d(ke
-00000f00: 726e 656c 5f73 697a 6520 3d20 7374 7269  rnel_size = stri
-00000f10: 6465 2c20 7374 7269 6465 203d 2073 7472  de, stride = str
-00000f20: 6964 6529 2c0d 0a20 2020 2020 2020 2020  ide),..         
-00000f30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00000f40: 2020 2020 2020 2020 2043 6f6e 7632 6428           Conv2d(
-00000f50: 696e 5f63 6861 6e6e 656c 7320 3d20 695f  in_channels = i_
-00000f60: 6368 616e 6e65 6c2c 206f 7574 5f63 6861  channel, out_cha
-00000f70: 6e6e 656c 7320 3d20 6f5f 6368 616e 6e65  nnels = o_channe
-00000f80: 6c2c 206b 6572 6e65 6c5f 7369 7a65 203d  l, kernel_size =
-00000f90: 2031 2c20 7374 7269 6465 203d 2031 2c20   1, stride = 1, 
-00000fa0: 7061 6464 696e 6720 3d20 302c 2062 6961  padding = 0, bia
-00000fb0: 7320 3d20 4661 6c73 652c 2067 726f 7570  s = False, group
-00000fc0: 7320 3d20 3229 2c0d 0a20 2020 2020 2020  s = 2),..       
-00000fd0: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
-00000fe0: 726d 3264 286f 5f63 6861 6e6e 656c 2c20  rm2d(o_channel, 
-00000ff0: 6d6f 6d65 6e74 756d 203d 206d 6f6d 656e  momentum = momen
-00001000: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
-00001010: 2020 2020 2061 6374 692c 0d0a 2020 2020       acti,..    
-00001020: 2020 2020 2020 2020 2020 2020 2320 4472              # Dr
-00001030: 6f70 426c 6f63 6b32 6428 7020 3d20 302e  opBlock2d(p = 0.
-00001040: 3235 2c20 626c 6f63 6b5f 7369 7a65 203d  25, block_size =
-00001050: 2032 202a 2a20 2835 202d 206c 6179 6572   2 ** (5 - layer
-00001060: 5f64 6570 7468 2929 2c0d 0a20 2020 2020  _depth)),..     
-00001070: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-00001080: 2020 2020 7365 6c66 2e66 696e 616c 5f61      self.final_a
-00001090: 6374 6920 3d20 6163 7469 0d0a 0d0a 2020  cti = acti....  
-000010a0: 2020 6465 6620 666f 7277 6172 6428 7365    def forward(se
-000010b0: 6c66 2c20 7829 3a0d 0a0d 0a20 2020 2020  lf, x):....     
-000010c0: 2020 2069 6465 6e74 6974 7920 3d20 780d     identity = x.
-000010d0: 0a20 2020 2020 2020 2078 203d 2073 656c  .        x = sel
-000010e0: 662e 7661 6e69 6c6c 615f 626c 6f63 6b28  f.vanilla_block(
-000010f0: 7829 0d0a 0d0a 2020 2020 2020 2020 6966  x)....        if
-00001100: 2073 656c 662e 6c61 7965 7220 3d3d 2027   self.layer == '
-00001110: 6669 7273 7427 2061 6e64 2073 656c 662e  first' and self.
-00001120: 6c61 7965 725f 6465 7074 6820 213d 2030  layer_depth != 0
-00001130: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00001140: 6465 6e74 6974 7920 3d20 7365 6c66 2e64  dentity = self.d
-00001150: 6f77 6e73 616d 706c 6528 6964 656e 7469  ownsample(identi
-00001160: 7479 290d 0a0d 0a20 2020 2020 2020 2069  ty)....        i
-00001170: 6620 7365 6c66 2e73 7175 6565 7a65 3a20  f self.squeeze: 
-00001180: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00001190: 2023 2078 203d 2073 656c 662e 5345 2869   # x = self.SE(i
-000011a0: 6465 6e74 6974 792c 2078 290d 0a20 2020  dentity, x)..   
-000011b0: 2020 2020 2020 2020 2078 203d 2073 656c           x = sel
-000011c0: 662e 5345 2878 290d 0a20 2020 2020 2020  f.SE(x)..       
-000011d0: 2020 2020 2078 203d 2073 656c 662e 7370       x = self.sp
-000011e0: 6174 6961 6c28 7829 0d0a 0d0a 2020 2020  atial(x)....    
-000011f0: 2020 2020 7820 2b3d 2069 6465 6e74 6974      x += identit
-00001200: 790d 0a20 2020 2020 2020 2078 203d 2073  y..        x = s
-00001210: 656c 662e 6669 6e61 6c5f 6163 7469 2878  elf.final_acti(x
-00001220: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-00001230: 7572 6e20 7820 0d0a 0d0a 0d0a 636c 6173  urn x ......clas
-00001240: 7320 426f 7474 6c65 6e65 636b 5f42 6c6f  s Bottleneck_Blo
-00001250: 636b 284d 6f64 756c 6529 3a0d 0a20 2020  ck(Module):..   
-00001260: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00001270: 6c66 2c20 2064 6570 7468 2c20 7371 7565  lf,  depth, sque
-00001280: 657a 652c 2061 7567 6d65 6e74 2c20 6c61  eze, augment, la
-00001290: 7965 7220 3d20 4e6f 6e65 293a 0d0a 2020  yer = None):..  
-000012a0: 2020 2020 2020 7375 7065 7228 426f 7474        super(Bott
-000012b0: 6c65 6e65 636b 5f42 6c6f 636b 2c20 7365  leneck_Block, se
-000012c0: 6c66 292e 5f5f 696e 6974 5f5f 2829 0d0a  lf).__init__()..
-000012d0: 0d0a 2020 2020 2020 2020 6c61 7965 725f  ..        layer_
-000012e0: 6465 7074 6820 3d20 6465 7074 680d 0a20  depth = depth.. 
-000012f0: 2020 2020 2020 2073 656c 662e 6c61 7965         self.laye
-00001300: 725f 6465 7074 6820 3d20 6c61 7965 725f  r_depth = layer_
-00001310: 6465 7074 680d 0a20 2020 2020 2020 2073  depth..        s
-00001320: 656c 662e 7371 7565 657a 6520 3d20 7371  elf.squeeze = sq
-00001330: 7565 657a 650d 0a20 2020 2020 2020 2073  ueeze..        s
-00001340: 656c 662e 6175 676d 656e 7420 3d20 6175  elf.augment = au
-00001350: 676d 656e 740d 0a0d 0a20 2020 2020 2020  gment....       
-00001360: 2073 656c 662e 6c61 7965 7220 3d20 6c61   self.layer = la
-00001370: 7965 720d 0a0d 0a20 2020 2020 2020 2069  yer....        i
-00001380: 6620 6c61 7965 7220 3d3d 2027 6669 7273  f layer == 'firs
-00001390: 7427 3a0d 0a0d 0a20 2020 2020 2020 2020  t':....         
-000013a0: 2020 2069 6620 6c61 7965 725f 6465 7074     if layer_dept
-000013b0: 6820 3d3d 2030 3a0d 0a0d 0a20 2020 2020  h == 0:....     
-000013c0: 2020 2020 2020 2020 2020 2069 5f63 6861             i_cha
-000013d0: 6e6e 656c 203d 2036 340d 0a20 2020 2020  nnel = 64..     
-000013e0: 2020 2020 2020 2020 2020 206d 5f63 6861             m_cha
-000013f0: 6e6e 656c 203d 2069 5f63 6861 6e6e 656c  nnel = i_channel
-00001400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001410: 2020 6f5f 6368 616e 6e65 6c20 3d20 3235    o_channel = 25
-00001420: 360d 0a20 2020 2020 2020 2020 2020 2020  6..             
-00001430: 2020 2073 7472 6964 6520 3d20 310d 0a0d     stride = 1...
-00001440: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00001450: 653a 0d0a 0d0a 2020 2020 2020 2020 2020  e:....          
-00001460: 2020 2020 2020 695f 6368 616e 6e65 6c20        i_channel 
-00001470: 3d20 3132 3820 2a20 2832 202a 2a20 6c61  = 128 * (2 ** la
-00001480: 7965 725f 6465 7074 6829 0d0a 2020 2020  yer_depth)..    
-00001490: 2020 2020 2020 2020 2020 2020 6d5f 6368              m_ch
-000014a0: 616e 6e65 6c20 3d20 695f 6368 616e 6e65  annel = i_channe
-000014b0: 6c20 2f2f 2032 0d0a 2020 2020 2020 2020  l // 2..        
-000014c0: 2020 2020 2020 2020 6f5f 6368 616e 6e65          o_channe
-000014d0: 6c20 3d20 695f 6368 616e 6e65 6c20 2a20  l = i_channel * 
-000014e0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
-000014f0: 2020 2073 7472 6964 6520 3d20 320d 0a0d     stride = 2...
-00001500: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00001510: 0d0a 2020 2020 2020 2020 2020 2020 695f  ..            i_
-00001520: 6368 616e 6e65 6c20 3d20 3235 3620 2a20  channel = 256 * 
-00001530: 2832 202a 2a20 6c61 7965 725f 6465 7074  (2 ** layer_dept
-00001540: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-00001550: 6d5f 6368 616e 6e65 6c20 3d20 695f 6368  m_channel = i_ch
-00001560: 616e 6e65 6c20 2f2f 2034 0d0a 2020 2020  annel // 4..    
-00001570: 2020 2020 2020 2020 6f5f 6368 616e 6e65          o_channe
-00001580: 6c20 3d20 695f 6368 616e 6e65 6c0d 0a20  l = i_channel.. 
-00001590: 2020 2020 2020 2020 2020 2073 7472 6964             strid
-000015a0: 6520 3d20 310d 0a0d 0a0d 0a20 2020 2020  e = 1......     
-000015b0: 2020 2070 203d 2030 0d0a 2020 2020 2020     p = 0..      
-000015c0: 2020 626c 6f63 6b5f 7369 7a65 203d 2033    block_size = 3
-000015d0: 202b 2028 6c61 7965 725f 6465 7074 6820   + (layer_depth 
-000015e0: 2a20 3229 0d0a 0d0a 2020 2020 2020 2020  * 2)....        
-000015f0: 6966 2073 7175 6565 7a65 3a0d 0a0d 0a20  if squeeze:.... 
-00001600: 2020 2020 2020 2020 2020 2072 203d 2031             r = 1
-00001610: 360d 0a0d 0a20 2020 2020 2020 2020 2020  6....           
-00001620: 2073 656c 662e 5345 203d 2053 6571 7565   self.SE = Seque
-00001630: 6e74 6961 6c28 0d0a 2020 2020 2020 2020  ntial(..        
-00001640: 2020 2020 2020 2020 4d53 4341 4d28 6f5f          MSCAM(o_
-00001650: 6368 616e 6e65 6c2c 2072 292c 0d0a 2020  channel, r),..  
-00001660: 2020 2020 2020 2020 2020 2020 2020 5341                SA
-00001670: 4d28 292c 0d0a 2020 2020 2020 2020 2020  M(),..          
-00001680: 2020 290d 0a20 2020 200d 0a20 2020 2020    )..    ..     
-00001690: 2020 2020 2020 2023 2073 656c 662e 5345         # self.SE
-000016a0: 203d 2041 4646 286f 5f63 6861 6e6e 656c   = AFF(o_channel
-000016b0: 2c20 7229 0d0a 0d0a 2020 2020 2020 2020  , r)....        
-000016c0: 7365 6c66 2e62 6f74 746c 656e 6563 6b5f  self.bottleneck_
-000016d0: 626c 6f63 6b20 3d20 5365 7175 656e 7469  block = Sequenti
-000016e0: 616c 280d 0a20 2020 2020 2020 2020 2020  al(..           
-000016f0: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
-00001700: 6861 6e6e 656c 7320 3d20 695f 6368 616e  hannels = i_chan
-00001710: 6e65 6c2c 206f 7574 5f63 6861 6e6e 656c  nel, out_channel
-00001720: 7320 3d20 6d5f 6368 616e 6e65 6c2c 206b  s = m_channel, k
-00001730: 6572 6e65 6c5f 7369 7a65 203d 2031 2c20  ernel_size = 1, 
-00001740: 7374 7269 6465 203d 2031 2c20 7061 6464  stride = 1, padd
-00001750: 696e 6720 3d20 302c 2062 6961 7320 3d20  ing = 0, bias = 
-00001760: 4661 6c73 6529 2c0d 0a20 2020 2020 2020  False),..       
-00001770: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
-00001780: 726d 3264 286d 5f63 6861 6e6e 656c 292c  rm2d(m_channel),
-00001790: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000017a0: 2020 6163 7469 2c0d 0a0d 0a20 2020 2020    acti,....     
-000017b0: 2020 2020 2020 2020 2020 2043 6f6e 7632             Conv2
-000017c0: 6428 696e 5f63 6861 6e6e 656c 7320 3d20  d(in_channels = 
-000017d0: 6d5f 6368 616e 6e65 6c2c 206f 7574 5f63  m_channel, out_c
-000017e0: 6861 6e6e 656c 7320 3d20 6d5f 6368 616e  hannels = m_chan
-000017f0: 6e65 6c2c 206b 6572 6e65 6c5f 7369 7a65  nel, kernel_size
-00001800: 203d 2033 2c20 7374 7269 6465 203d 2073   = 3, stride = s
-00001810: 7472 6964 652c 2070 6164 6469 6e67 203d  tride, padding =
-00001820: 2031 2c20 6269 6173 203d 2046 616c 7365   1, bias = False
-00001830: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00001840: 2020 2020 4261 7463 684e 6f72 6d32 6428      BatchNorm2d(
-00001850: 6d5f 6368 616e 6e65 6c29 2c0d 0a20 2020  m_channel),..   
-00001860: 2020 2020 2020 2020 2020 2020 2061 6374               act
-00001870: 692c 0d0a 0d0a 2020 2020 2020 2020 2020  i,....          
-00001880: 2020 2020 2020 436f 6e76 3264 2869 6e5f        Conv2d(in_
-00001890: 6368 616e 6e65 6c73 203d 206d 5f63 6861  channels = m_cha
-000018a0: 6e6e 656c 2c20 6f75 745f 6368 616e 6e65  nnel, out_channe
-000018b0: 6c73 203d 206f 5f63 6861 6e6e 656c 2c20  ls = o_channel, 
-000018c0: 6b65 726e 656c 5f73 697a 6520 3d20 312c  kernel_size = 1,
-000018d0: 2073 7472 6964 6520 3d20 312c 2070 6164   stride = 1, pad
-000018e0: 6469 6e67 203d 2030 2c20 6269 6173 203d  ding = 0, bias =
-000018f0: 2046 616c 7365 292c 0d0a 2020 2020 2020   False),..      
-00001900: 2020 2020 2020 2020 2020 4261 7463 684e            BatchN
-00001910: 6f72 6d32 6428 6f5f 6368 616e 6e65 6c29  orm2d(o_channel)
-00001920: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00001930: 2020 2023 2061 6374 692c 0d0a 2020 2020     # acti,..    
-00001940: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-00001950: 2020 2020 2069 6620 6c61 7965 7220 3d3d       if layer ==
-00001960: 2027 6669 7273 7427 3a20 0d0a 2020 2020   'first': ..    
-00001970: 2020 2020 2020 2020 7365 6c66 2e64 6f77          self.dow
-00001980: 6e73 616d 706c 6520 3d20 5365 7175 656e  nsample = Sequen
-00001990: 7469 616c 280d 0a20 2020 2020 2020 2020  tial(..         
-000019a0: 2020 2020 2020 2041 7667 506f 6f6c 3264         AvgPool2d
-000019b0: 286b 6572 6e65 6c5f 7369 7a65 203d 2073  (kernel_size = s
-000019c0: 7472 6964 652c 2073 7472 6964 6520 3d20  tride, stride = 
-000019d0: 7374 7269 6465 292c 0d0a 0d0a 2020 2020  stride),....    
-000019e0: 2020 2020 2020 2020 2020 2020 436f 6e76              Conv
-000019f0: 3264 2869 6e5f 6368 616e 6e65 6c73 203d  2d(in_channels =
-00001a00: 2069 5f63 6861 6e6e 656c 2c20 6f75 745f   i_channel, out_
-00001a10: 6368 616e 6e65 6c73 203d 206f 5f63 6861  channels = o_cha
-00001a20: 6e6e 656c 2c20 6b65 726e 656c 5f73 697a  nnel, kernel_siz
-00001a30: 6520 3d20 312c 2073 7472 6964 6520 3d20  e = 1, stride = 
-00001a40: 312c 2070 6164 6469 6e67 203d 2030 2c20  1, padding = 0, 
-00001a50: 6269 6173 203d 2046 616c 7365 292c 0d0a  bias = False),..
-00001a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001a70: 4261 7463 684e 6f72 6d32 6428 6f5f 6368  BatchNorm2d(o_ch
-00001a80: 616e 6e65 6c29 2c0d 0a20 2020 2020 2020  annel),..       
-00001a90: 2020 2020 2020 2020 2061 6374 692c 0d0a           acti,..
-00001aa0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-00001ab0: 0a20 2020 2020 2020 2073 656c 662e 6669  .        self.fi
-00001ac0: 6e61 6c5f 6163 7469 203d 2061 6374 690d  nal_acti = acti.
-00001ad0: 0a0d 0a20 2020 2064 6566 2066 6f72 7761  ...    def forwa
-00001ae0: 7264 2873 656c 662c 2078 293a 0d0a 0d0a  rd(self, x):....
-00001af0: 2020 2020 2020 2020 6964 656e 7469 7479          identity
-00001b00: 203d 2078 0d0a 0d0a 2020 2020 2020 2020   = x....        
-00001b10: 7820 3d20 7365 6c66 2e62 6f74 746c 656e  x = self.bottlen
-00001b20: 6563 6b5f 626c 6f63 6b28 7829 0d0a 0d0a  eck_block(x)....
-00001b30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001b40: 6c61 7965 7220 3d3d 2027 6669 7273 7427  layer == 'first'
-00001b50: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00001b60: 6465 6e74 6974 7920 3d20 7365 6c66 2e64  dentity = self.d
-00001b70: 6f77 6e73 616d 706c 6528 6964 656e 7469  ownsample(identi
-00001b80: 7479 290d 0a0d 0a20 2020 2020 2020 2069  ty)....        i
-00001b90: 6620 7365 6c66 2e73 7175 6565 7a65 3a20  f self.squeeze: 
-00001ba0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00001bb0: 2078 203d 2073 656c 662e 5345 2878 2c20   x = self.SE(x, 
-00001bc0: 6964 656e 7469 7479 290d 0a0d 0a20 2020  identity)....   
-00001bd0: 2020 2020 2078 203d 2073 656c 662e 6669       x = self.fi
-00001be0: 6e61 6c5f 6163 7469 2878 290d 0a0d 0a20  nal_acti(x).... 
-00001bf0: 2020 2020 2020 2072 6574 7572 6e20 780d         return x.
-00001c00: 0a0d 0a0d 0a0d 0a0d 0a0d 0a0d 0a0d 0a0d  ................
-00001c10: 0a0d 0a                                  ...
+000001d0: 2d2d 2d2d 2d2d 0d0a 6672 6f6d 202e 6375  ------..from .cu
+000001e0: 7374 6f6d 5f62 6c6f 636b 7320 696d 706f  stom_blocks impo
+000001f0: 7274 2041 4646 2c4d 5343 414d 2c20 5341  rt AFF,MSCAM, SA
+00000200: 4d2c 2069 4146 462c 2045 4341 0d0a 0d0a  M, iAFF, ECA....
+00000210: 2320 6672 6f6d 2063 7573 746f 6d5f 626c  # from custom_bl
+00000220: 6f63 6b73 2069 6d70 6f72 7420 4146 462c  ocks import AFF,
+00000230: 4d53 4341 4d2c 2053 414d 2c20 6941 4646  MSCAM, SAM, iAFF
+00000240: 2c20 4543 410d 0a23 2d2d 2d2d 2d2d 2d2d  , ECA..#--------
+00000250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000260: 2d2d 2d2d 2d2d 0d0a 0d0a 746f 7263 682e  ------....torch.
+00000270: 6d61 6e75 616c 5f73 6565 6428 3433 290d  manual_seed(43).
+00000280: 0a0d 0a61 6374 6920 3d20 4d69 7368 2869  ...acti = Mish(i
+00000290: 6e70 6c61 6365 203d 2054 7275 6529 0d0a  nplace = True)..
+000002a0: 2320 6163 7469 203d 2050 5265 4c55 2829  # acti = PReLU()
+000002b0: 0d0a 0d0a 2320 746f 7263 682e 7365 745f  ....# torch.set_
+000002c0: 666c 6f61 7433 325f 6d61 746d 756c 5f70  float32_matmul_p
+000002d0: 7265 6369 7369 6f6e 2822 6869 6768 2229  recision("high")
+000002e0: 0d0a 0d0a 6465 6620 5265 7342 6c6f 636b  ....def ResBlock
+000002f0: 286d 6f64 6966 6965 7273 2c20 7371 7565  (modifiers, sque
+00000300: 657a 652c 206d 6f6d 656e 742c 206c 6179  eze, moment, lay
+00000310: 6572 203d 204e 6f6e 6529 3a0d 0a0d 0a20  er = None):.... 
+00000320: 2020 2022 2222 0d0a 2020 2020 5661 6e69     """..    Vani
+00000330: 6c6c 6120 426c 6f63 6b20 3a20 4f72 6967  lla Block : Orig
+00000340: 696e 616c 2052 6573 6964 7561 6c20 426c  inal Residual Bl
+00000350: 6f63 6b20 6173 206d 656e 7469 6f6e 6564  ock as mentioned
+00000360: 2069 6e20 3135 3132 2e30 3333 3835 205b   in 1512.03385 [
+00000370: 4465 6570 2052 6573 6964 7561 6c20 4c65  Deep Residual Le
+00000380: 6172 6e69 6e67 2066 6f72 2049 6d61 6765  arning for Image
+00000390: 2052 6563 6f67 6e69 7469 6f6e 5d0d 0a0d   Recognition]...
+000003a0: 0a20 2020 2042 6f74 746c 656e 6563 6b20  .    Bottleneck 
+000003b0: 426c 6f63 6b20 3a20 4f72 6967 696e 616c  Block : Original
+000003c0: 2042 6f74 746c 656e 6563 6b20 426c 6f63   Bottleneck Bloc
+000003d0: 6b20 6173 206d 656e 7469 6f6e 6564 2069  k as mentioned i
+000003e0: 6e20 3135 3132 2e30 3333 3835 205b 4465  n 1512.03385 [De
+000003f0: 6570 2052 6573 6964 7561 6c20 4c65 6172  ep Residual Lear
+00000400: 6e69 6e67 2066 6f72 2049 6d61 6765 2052  ning for Image R
+00000410: 6563 6f67 6e69 7469 6f6e 5d0d 0a20 2020  ecognition]..   
+00000420: 200d 0a20 2020 2042 6f74 746c 656e 6563   ..    Bottlenec
+00000430: 6b20 426c 6f63 6b20 5632 203a 204d 6f64  k Block V2 : Mod
+00000440: 6966 6965 7320 5265 7369 6475 616c 2042  ifies Residual B
+00000450: 6c6f 636b 7320 746f 2068 6176 6520 6c61  locks to have la
+00000460: 7267 6572 206c 6561 726e 696e 6720 6361  rger learning ca
+00000470: 7061 6369 7479 2c20 6173 206d 656e 7469  pacity, as menti
+00000480: 6f6e 6564 2069 6e20 3138 3132 2e30 3131  oned in 1812.011
+00000490: 3837 205b 4261 6720 6f66 2054 7269 636b  87 [Bag of Trick
+000004a0: 7320 666f 7220 496d 6167 6520 436c 6173  s for Image Clas
+000004b0: 7369 6669 6361 7469 6f6e 2077 6974 6820  sification with 
+000004c0: 436f 6e76 6f6c 7574 696f 6e61 6c20 4e65  Convolutional Ne
+000004d0: 7572 616c 204e 6574 776f 726b 735d 0d0a  ural Networks]..
+000004e0: 0d0a 2020 2020 4e65 7874 2042 6c6f 636b  ..    Next Block
+000004f0: 203a 2052 6570 6c61 6365 7320 436f 6e76   : Replaces Conv
+00000500: 6f6c 7574 696f 6e73 2077 6974 6820 4772  olutions with Gr
+00000510: 6f75 7065 6420 436f 6e76 6f6c 7574 696f  ouped Convolutio
+00000520: 6e73 2061 7320 7365 6520 696e 2031 3631  ns as see in 161
+00000530: 312e 3035 3433 3120 5b41 6767 7265 6761  1.05431 [Aggrega
+00000540: 7465 6420 5265 7369 6475 616c 2054 7261  ted Residual Tra
+00000550: 6e73 666f 726d 6174 696f 6e73 2066 6f72  nsformations for
+00000560: 2044 6565 7020 4e65 7572 616c 204e 6574   Deep Neural Net
+00000570: 776f 726b 735d 0d0a 2020 2020 2222 220d  works]..    """.
+00000580: 0a0d 0a20 2020 2064 6570 7468 2c20 666c  ...    depth, fl
+00000590: 6176 6f72 203d 206d 6f64 6966 6965 7273  avor = modifiers
+000005a0: 0d0a 0d0a 2020 2020 6966 2066 6c61 766f  ....    if flavo
+000005b0: 7220 3d3d 2027 7661 6e69 6c6c 6127 3a0d  r == 'vanilla':.
+000005c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000005d0: 5661 6e69 6c6c 615f 426c 6f63 6b28 6465  Vanilla_Block(de
+000005e0: 7074 682c 2073 7175 6565 7a65 2c20 6d6f  pth, squeeze, mo
+000005f0: 6d65 6e74 2c20 6c61 7965 7229 0d0a 0d0a  ment, layer)....
+00000600: 2020 2020 656c 6966 2066 6c61 766f 7220      elif flavor 
+00000610: 3d3d 2027 626f 7474 6c65 6e65 636b 273a  == 'bottleneck':
+00000620: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00000630: 2042 6f74 746c 656e 6563 6b5f 426c 6f63   Bottleneck_Bloc
+00000640: 6b28 6465 7074 682c 2073 7175 6565 7a65  k(depth, squeeze
+00000650: 2c20 6d6f 6d65 6e74 2c20 6c61 7965 7229  , moment, layer)
+00000660: 0d0a 0d0a 2020 2020 2320 656c 6966 2066  ....    # elif f
+00000670: 6c61 766f 7220 3d3d 2027 6375 7374 6f6d  lavor == 'custom
+00000680: 273a 0d0a 0d0a 2020 2020 2320 2020 2020  ':....    #     
+00000690: 6966 206d 6f64 6966 6965 7273 5b30 5d20  if modifiers[0] 
+000006a0: 696e 205b 302c 2031 5d3a 0d0a 2020 2020  in [0, 1]:..    
+000006b0: 2320 2020 2020 2020 2020 7265 7475 726e  #         return
+000006c0: 2056 616e 696c 6c61 5f42 6c6f 636b 286d   Vanilla_Block(m
+000006d0: 6f64 6966 6965 7273 2c20 7371 7565 657a  odifiers, squeez
+000006e0: 652c 2061 7567 6d65 6e74 2c20 6c61 7965  e, augment, laye
+000006f0: 7229 200d 0a20 2020 2023 2020 2020 2065  r) ..    #     e
+00000700: 6c69 6620 6d6f 6469 6669 6572 735b 305d  lif modifiers[0]
+00000710: 2069 6e20 5b32 2c20 335d 3a0d 0a20 2020   in [2, 3]:..   
+00000720: 2023 2020 2020 2020 2020 2072 6574 7572   #         retur
+00000730: 6e20 426f 7474 6c65 6e65 636b 5f42 6c6f  n Bottleneck_Blo
+00000740: 636b 5f56 3228 6d6f 6469 6669 6572 732c  ck_V2(modifiers,
+00000750: 2073 7175 6565 7a65 2c20 6175 676d 656e   squeeze, augmen
+00000760: 742c 206c 6179 6572 290d 0a0d 0a0d 0a63  t, layer)......c
+00000770: 6c61 7373 2056 616e 696c 6c61 5f42 6c6f  lass Vanilla_Blo
+00000780: 636b 284d 6f64 756c 6529 3a0d 0a20 2020  ck(Module):..   
+00000790: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+000007a0: 6c66 2c20 2064 6570 7468 2c20 7371 7565  lf,  depth, sque
+000007b0: 657a 652c 206d 6f6d 656e 742c 206c 6179  eze, moment, lay
+000007c0: 6572 203d 204e 6f6e 6529 3a0d 0a20 2020  er = None):..   
+000007d0: 2020 2020 2073 7570 6572 2856 616e 696c       super(Vanil
+000007e0: 6c61 5f42 6c6f 636b 2c20 7365 6c66 292e  la_Block, self).
+000007f0: 5f5f 696e 6974 5f5f 2829 0d0a 0d0a 2020  __init__()....  
+00000800: 2020 2020 2020 6c61 7965 725f 6465 7074        layer_dept
+00000810: 6820 3d20 6465 7074 680d 0a20 2020 2020  h = depth..     
+00000820: 2020 2073 656c 662e 6c61 7965 725f 6465     self.layer_de
+00000830: 7074 6820 3d20 6c61 7965 725f 6465 7074  pth = layer_dept
+00000840: 680d 0a20 2020 2020 2020 2073 656c 662e  h..        self.
+00000850: 7371 7565 657a 6520 3d20 7371 7565 657a  squeeze = squeez
+00000860: 650d 0a0d 0a20 2020 2020 2020 2073 656c  e....        sel
+00000870: 662e 6c61 7965 7220 3d20 6c61 7965 720d  f.layer = layer.
+00000880: 0a0d 0a20 2020 2020 2020 2069 6620 6c61  ...        if la
+00000890: 7965 7220 3d3d 2027 6669 7273 7427 3a0d  yer == 'first':.
+000008a0: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+000008b0: 6620 6c61 7965 725f 6465 7074 6820 3d3d  f layer_depth ==
+000008c0: 2030 3a0d 0a0d 0a20 2020 2020 2020 2020   0:....         
+000008d0: 2020 2020 2020 2023 2069 5f63 6861 6e6e         # i_chann
+000008e0: 656c 203d 2036 340d 0a20 2020 2020 2020  el = 64..       
+000008f0: 2020 2020 2020 2020 2023 206f 5f63 6861           # o_cha
+00000900: 6e6e 656c 203d 2036 340d 0a0d 0a20 2020  nnel = 64....   
+00000910: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00000920: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00000930: 5f63 6861 6e6e 656c 203d 2031 360d 0a20  _channel = 16.. 
+00000940: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00000950: 5f63 6861 6e6e 656c 203d 2031 360d 0a0d  _channel = 16...
+00000960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000970: 2073 7472 6964 6520 3d20 310d 0a0d 0a20   stride = 1.... 
+00000980: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00000990: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000009a0: 2020 2020 2320 695f 6368 616e 6e65 6c20      # i_channel 
+000009b0: 3d20 3332 202a 2028 3220 2a2a 206c 6179  = 32 * (2 ** lay
+000009c0: 6572 5f64 6570 7468 290d 0a20 2020 2020  er_depth)..     
+000009d0: 2020 2020 2020 2020 2020 2069 5f63 6861             i_cha
+000009e0: 6e6e 656c 203d 2038 202a 2028 3220 2a2a  nnel = 8 * (2 **
+000009f0: 206c 6179 6572 5f64 6570 7468 290d 0a20   layer_depth).. 
+00000a00: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00000a10: 5f63 6861 6e6e 656c 203d 2069 5f63 6861  _channel = i_cha
+00000a20: 6e6e 656c 202a 2032 0d0a 2020 2020 2020  nnel * 2..      
+00000a30: 2020 2020 2020 2020 2020 7374 7269 6465            stride
+00000a40: 203d 2032 0d0a 2020 2020 2020 2020 656c   = 2..        el
+00000a50: 7365 3a0d 0a0d 0a20 2020 2020 2020 2020  se:....         
+00000a60: 2020 2023 2069 5f63 6861 6e6e 656c 203d     # i_channel =
+00000a70: 2036 3420 2a20 2832 202a 2a20 6c61 7965   64 * (2 ** laye
+00000a80: 725f 6465 7074 6829 0d0a 2020 2020 2020  r_depth)..      
+00000a90: 2020 2020 2020 695f 6368 616e 6e65 6c20        i_channel 
+00000aa0: 3d20 3136 202a 2028 3220 2a2a 206c 6179  = 16 * (2 ** lay
+00000ab0: 6572 5f64 6570 7468 290d 0a20 2020 2020  er_depth)..     
+00000ac0: 2020 2020 2020 206f 5f63 6861 6e6e 656c         o_channel
+00000ad0: 203d 2069 5f63 6861 6e6e 656c 0d0a 2020   = i_channel..  
+00000ae0: 2020 2020 2020 2020 2020 7374 7269 6465            stride
+00000af0: 203d 2031 0d0a 0d0a 0d0a 0d0a 2020 2020   = 1........    
+00000b00: 2020 2020 7020 3d20 300d 0a20 2020 2020      p = 0..     
+00000b10: 2020 2062 6c6f 636b 5f73 697a 6520 3d20     block_size = 
+00000b20: 3320 2b20 286c 6179 6572 5f64 6570 7468  3 + (layer_depth
+00000b30: 202a 2032 290d 0a0d 0a20 2020 2020 2020   * 2)....       
+00000b40: 2069 6620 7371 7565 657a 653a 0d0a 2020   if squeeze:..  
+00000b50: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00000b60: 2020 2020 2020 2020 7220 3d20 3136 0d0a          r = 16..
+00000b70: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00000b80: 7365 6c66 2e53 4520 3d20 4d53 4341 4d28  self.SE = MSCAM(
+00000b90: 6f5f 6368 616e 6e65 6c2c 2072 290d 0a20  o_channel, r).. 
+00000ba0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000bb0: 5345 203d 2045 4341 2829 0d0a 2020 2020  SE = ECA()..    
+00000bc0: 2020 2020 2020 2020 7365 6c66 2e73 7061          self.spa
+00000bd0: 7469 616c 203d 2053 414d 2829 0d0a 0d0a  tial = SAM()....
+00000be0: 2020 2020 2020 2020 7365 6c66 2e76 616e          self.van
+00000bf0: 696c 6c61 5f62 6c6f 636b 203d 2053 6571  illa_block = Seq
+00000c00: 7565 6e74 6961 6c28 0d0a 2020 2020 2020  uential(..      
+00000c10: 2020 2020 2020 2020 2020 436f 6e76 3264            Conv2d
+00000c20: 2869 6e5f 6368 616e 6e65 6c73 203d 2069  (in_channels = i
+00000c30: 5f63 6861 6e6e 656c 2c20 6f75 745f 6368  _channel, out_ch
+00000c40: 616e 6e65 6c73 203d 206f 5f63 6861 6e6e  annels = o_chann
+00000c50: 656c 2c20 6b65 726e 656c 5f73 697a 6520  el, kernel_size 
+00000c60: 3d20 332c 2073 7472 6964 6520 3d20 312c  = 3, stride = 1,
+00000c70: 2070 6164 6469 6e67 203d 2031 2c20 6269   padding = 1, bi
+00000c80: 6173 203d 2046 616c 7365 292c 0d0a 2020  as = False),..  
+00000c90: 2020 2020 2020 2020 2020 2020 2020 4261                Ba
+00000ca0: 7463 684e 6f72 6d32 6428 6f5f 6368 616e  tchNorm2d(o_chan
+00000cb0: 6e65 6c2c 206d 6f6d 656e 7475 6d20 3d20  nel, momentum = 
+00000cc0: 6d6f 6d65 6e74 292c 0d0a 2020 2020 2020  moment),..      
+00000cd0: 2020 2020 2020 2020 2020 6163 7469 2c0d            acti,.
+00000ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000cf0: 2023 2044 726f 7042 6c6f 636b 3264 2870   # DropBlock2d(p
+00000d00: 203d 2030 2e32 352c 2062 6c6f 636b 5f73   = 0.25, block_s
+00000d10: 697a 6520 3d20 3220 2a2a 2028 3520 2d20  ize = 2 ** (5 - 
+00000d20: 6c61 7965 725f 6465 7074 6829 292c 0d0a  layer_depth)),..
+00000d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000d40: 2020 436f 6e76 3264 2869 6e5f 6368 616e    Conv2d(in_chan
+00000d50: 6e65 6c73 203d 206f 5f63 6861 6e6e 656c  nels = o_channel
+00000d60: 2c20 6f75 745f 6368 616e 6e65 6c73 203d  , out_channels =
+00000d70: 206f 5f63 6861 6e6e 656c 2c20 6b65 726e   o_channel, kern
+00000d80: 656c 5f73 697a 6520 3d20 332c 2073 7472  el_size = 3, str
+00000d90: 6964 6520 3d20 7374 7269 6465 2c20 7061  ide = stride, pa
+00000da0: 6464 696e 6720 3d20 312c 2062 6961 7320  dding = 1, bias 
+00000db0: 3d20 4661 6c73 6529 2c0d 0a20 2020 2020  = False),..     
+00000dc0: 2020 2020 2020 2020 2020 2042 6174 6368             Batch
+00000dd0: 4e6f 726d 3264 286f 5f63 6861 6e6e 656c  Norm2d(o_channel
+00000de0: 2c20 6d6f 6d65 6e74 756d 203d 206d 6f6d  , momentum = mom
+00000df0: 656e 7429 2c0d 0a20 2020 2020 2020 2020  ent),..         
+00000e00: 2020 2020 2020 2023 2044 726f 7042 6c6f         # DropBlo
+00000e10: 636b 3264 2870 203d 2030 2e32 352c 2062  ck2d(p = 0.25, b
+00000e20: 6c6f 636b 5f73 697a 6520 3d20 3220 2a2a  lock_size = 2 **
+00000e30: 2028 3520 2d20 6c61 7965 725f 6465 7074   (5 - layer_dept
+00000e40: 6829 292c 0d0a 2020 2020 2020 2020 2020  h)),..          
+00000e50: 2020 290d 0a20 2020 2020 2020 200d 0a20    )..        .. 
+00000e60: 2020 2020 2020 2069 6620 6c61 7965 7220         if layer 
+00000e70: 3d3d 2027 6669 7273 7427 2061 6e64 206c  == 'first' and l
+00000e80: 6179 6572 5f64 6570 7468 2021 3d20 303a  ayer_depth != 0:
+00000e90: 200d 0a0d 0a20 2020 2020 2020 2020 2020   ....           
+00000ea0: 2073 656c 662e 646f 776e 7361 6d70 6c65   self.downsample
+00000eb0: 203d 2053 6571 7565 6e74 6961 6c28 0d0a   = Sequential(..
+00000ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ed0: 4176 6750 6f6f 6c32 6428 6b65 726e 656c  AvgPool2d(kernel
+00000ee0: 5f73 697a 6520 3d20 7374 7269 6465 2c20  _size = stride, 
+00000ef0: 7374 7269 6465 203d 2073 7472 6964 6529  stride = stride)
+00000f00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00000f10: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00000f20: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
+00000f30: 6861 6e6e 656c 7320 3d20 695f 6368 616e  hannels = i_chan
+00000f40: 6e65 6c2c 206f 7574 5f63 6861 6e6e 656c  nel, out_channel
+00000f50: 7320 3d20 6f5f 6368 616e 6e65 6c2c 206b  s = o_channel, k
+00000f60: 6572 6e65 6c5f 7369 7a65 203d 2031 2c20  ernel_size = 1, 
+00000f70: 7374 7269 6465 203d 2031 2c20 7061 6464  stride = 1, padd
+00000f80: 696e 6720 3d20 302c 2062 6961 7320 3d20  ing = 0, bias = 
+00000f90: 4661 6c73 6529 2c0d 0a20 2020 2020 2020  False),..       
+00000fa0: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
+00000fb0: 726d 3264 286f 5f63 6861 6e6e 656c 2c20  rm2d(o_channel, 
+00000fc0: 6d6f 6d65 6e74 756d 203d 206d 6f6d 656e  momentum = momen
+00000fd0: 7429 2c0d 0a20 2020 2020 2020 2020 2020  t),..           
+00000fe0: 2020 2020 2061 6374 692c 0d0a 2020 2020       acti,..    
+00000ff0: 2020 2020 2020 2020 2020 2020 2320 4472              # Dr
+00001000: 6f70 426c 6f63 6b32 6428 7020 3d20 302e  opBlock2d(p = 0.
+00001010: 3235 2c20 626c 6f63 6b5f 7369 7a65 203d  25, block_size =
+00001020: 2032 202a 2a20 2835 202d 206c 6179 6572   2 ** (5 - layer
+00001030: 5f64 6570 7468 2929 2c0d 0a20 2020 2020  _depth)),..     
+00001040: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00001050: 2020 2020 7365 6c66 2e66 696e 616c 5f61      self.final_a
+00001060: 6374 6920 3d20 6163 7469 0d0a 0d0a 2020  cti = acti....  
+00001070: 2020 6465 6620 666f 7277 6172 6428 7365    def forward(se
+00001080: 6c66 2c20 7829 3a0d 0a0d 0a20 2020 2020  lf, x):....     
+00001090: 2020 2069 6465 6e74 6974 7920 3d20 780d     identity = x.
+000010a0: 0a20 2020 2020 2020 2078 203d 2073 656c  .        x = sel
+000010b0: 662e 7661 6e69 6c6c 615f 626c 6f63 6b28  f.vanilla_block(
+000010c0: 7829 0d0a 0d0a 2020 2020 2020 2020 6966  x)....        if
+000010d0: 2073 656c 662e 6c61 7965 7220 3d3d 2027   self.layer == '
+000010e0: 6669 7273 7427 2061 6e64 2073 656c 662e  first' and self.
+000010f0: 6c61 7965 725f 6465 7074 6820 213d 2030  layer_depth != 0
+00001100: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00001110: 6465 6e74 6974 7920 3d20 7365 6c66 2e64  dentity = self.d
+00001120: 6f77 6e73 616d 706c 6528 6964 656e 7469  ownsample(identi
+00001130: 7479 290d 0a0d 0a20 2020 2020 2020 2069  ty)....        i
+00001140: 6620 7365 6c66 2e73 7175 6565 7a65 3a20  f self.squeeze: 
+00001150: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00001160: 2023 2078 203d 2073 656c 662e 5345 2869   # x = self.SE(i
+00001170: 6465 6e74 6974 792c 2078 290d 0a20 2020  dentity, x)..   
+00001180: 2020 2020 2020 2020 2078 203d 2073 656c           x = sel
+00001190: 662e 5345 2878 290d 0a20 2020 2020 2020  f.SE(x)..       
+000011a0: 2020 2020 2078 203d 2073 656c 662e 7370       x = self.sp
+000011b0: 6174 6961 6c28 7829 0d0a 0d0a 2020 2020  atial(x)....    
+000011c0: 2020 2020 7820 2b3d 2069 6465 6e74 6974      x += identit
+000011d0: 790d 0a20 2020 2020 2020 2078 203d 2073  y..        x = s
+000011e0: 656c 662e 6669 6e61 6c5f 6163 7469 2878  elf.final_acti(x
+000011f0: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
+00001200: 7572 6e20 7820 0d0a 0d0a 0d0a 636c 6173  urn x ......clas
+00001210: 7320 426f 7474 6c65 6e65 636b 5f42 6c6f  s Bottleneck_Blo
+00001220: 636b 284d 6f64 756c 6529 3a0d 0a20 2020  ck(Module):..   
+00001230: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00001240: 6c66 2c20 2064 6570 7468 2c20 7371 7565  lf,  depth, sque
+00001250: 657a 652c 206c 6179 6572 203d 204e 6f6e  eze, layer = Non
+00001260: 6529 3a0d 0a20 2020 2020 2020 2073 7570  e):..        sup
+00001270: 6572 2842 6f74 746c 656e 6563 6b5f 426c  er(Bottleneck_Bl
+00001280: 6f63 6b2c 2073 656c 6629 2e5f 5f69 6e69  ock, self).__ini
+00001290: 745f 5f28 290d 0a0d 0a20 2020 2020 2020  t__()....       
+000012a0: 206c 6179 6572 5f64 6570 7468 203d 2064   layer_depth = d
+000012b0: 6570 7468 0d0a 2020 2020 2020 2020 7365  epth..        se
+000012c0: 6c66 2e6c 6179 6572 5f64 6570 7468 203d  lf.layer_depth =
+000012d0: 206c 6179 6572 5f64 6570 7468 0d0a 2020   layer_depth..  
+000012e0: 2020 2020 2020 7365 6c66 2e73 7175 6565        self.squee
+000012f0: 7a65 203d 2073 7175 6565 7a65 0d0a 0d0a  ze = squeeze....
+00001300: 2020 2020 2020 2020 7365 6c66 2e6c 6179          self.lay
+00001310: 6572 203d 206c 6179 6572 0d0a 0d0a 2020  er = layer....  
+00001320: 2020 2020 2020 6966 206c 6179 6572 203d        if layer =
+00001330: 3d20 2766 6972 7374 273a 0d0a 0d0a 2020  = 'first':....  
+00001340: 2020 2020 2020 2020 2020 6966 206c 6179            if lay
+00001350: 6572 5f64 6570 7468 203d 3d20 303a 0d0a  er_depth == 0:..
+00001360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001370: 2020 695f 6368 616e 6e65 6c20 3d20 3634    i_channel = 64
+00001380: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001390: 2020 6d5f 6368 616e 6e65 6c20 3d20 695f    m_channel = i_
+000013a0: 6368 616e 6e65 6c0d 0a20 2020 2020 2020  channel..       
+000013b0: 2020 2020 2020 2020 206f 5f63 6861 6e6e           o_chann
+000013c0: 656c 203d 2032 3536 0d0a 2020 2020 2020  el = 256..      
+000013d0: 2020 2020 2020 2020 2020 7374 7269 6465            stride
+000013e0: 203d 2031 0d0a 0d0a 2020 2020 2020 2020   = 1....        
+000013f0: 2020 2020 656c 7365 3a0d 0a0d 0a20 2020      else:....   
+00001400: 2020 2020 2020 2020 2020 2020 2069 5f63               i_c
+00001410: 6861 6e6e 656c 203d 2031 3238 202a 2028  hannel = 128 * (
+00001420: 3220 2a2a 206c 6179 6572 5f64 6570 7468  2 ** layer_depth
+00001430: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00001440: 2020 206d 5f63 6861 6e6e 656c 203d 2069     m_channel = i
+00001450: 5f63 6861 6e6e 656c 202f 2f20 320d 0a20  _channel // 2.. 
+00001460: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00001470: 5f63 6861 6e6e 656c 203d 2069 5f63 6861  _channel = i_cha
+00001480: 6e6e 656c 202a 2032 0d0a 2020 2020 2020  nnel * 2..      
+00001490: 2020 2020 2020 2020 2020 7374 7269 6465            stride
+000014a0: 203d 2032 0d0a 0d0a 2020 2020 2020 2020   = 2....        
+000014b0: 656c 7365 3a0d 0a0d 0a20 2020 2020 2020  else:....       
+000014c0: 2020 2020 2069 5f63 6861 6e6e 656c 203d       i_channel =
+000014d0: 2032 3536 202a 2028 3220 2a2a 206c 6179   256 * (2 ** lay
+000014e0: 6572 5f64 6570 7468 290d 0a20 2020 2020  er_depth)..     
+000014f0: 2020 2020 2020 206d 5f63 6861 6e6e 656c         m_channel
+00001500: 203d 2069 5f63 6861 6e6e 656c 202f 2f20   = i_channel // 
+00001510: 340d 0a20 2020 2020 2020 2020 2020 206f  4..            o
+00001520: 5f63 6861 6e6e 656c 203d 2069 5f63 6861  _channel = i_cha
+00001530: 6e6e 656c 0d0a 2020 2020 2020 2020 2020  nnel..          
+00001540: 2020 7374 7269 6465 203d 2031 0d0a 0d0a    stride = 1....
+00001550: 0d0a 2020 2020 2020 2020 7020 3d20 300d  ..        p = 0.
+00001560: 0a20 2020 2020 2020 2062 6c6f 636b 5f73  .        block_s
+00001570: 697a 6520 3d20 3320 2b20 286c 6179 6572  ize = 3 + (layer
+00001580: 5f64 6570 7468 202a 2032 290d 0a0d 0a20  _depth * 2).... 
+00001590: 2020 2020 2020 2069 6620 7371 7565 657a         if squeez
+000015a0: 653a 0d0a 0d0a 2020 2020 2020 2020 2020  e:....          
+000015b0: 2020 7220 3d20 3136 0d0a 0d0a 2020 2020    r = 16....    
+000015c0: 2020 2020 2020 2020 7365 6c66 2e53 4520          self.SE 
+000015d0: 3d20 5365 7175 656e 7469 616c 280d 0a20  = Sequential(.. 
+000015e0: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+000015f0: 5343 414d 286f 5f63 6861 6e6e 656c 2c20  SCAM(o_channel, 
+00001600: 7229 2c0d 0a20 2020 2020 2020 2020 2020  r),..           
+00001610: 2020 2020 2053 414d 2829 2c0d 0a20 2020       SAM(),..   
+00001620: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00001630: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00001640: 7365 6c66 2e53 4520 3d20 4146 4628 6f5f  self.SE = AFF(o_
+00001650: 6368 616e 6e65 6c2c 2072 290d 0a0d 0a20  channel, r).... 
+00001660: 2020 2020 2020 2073 656c 662e 626f 7474         self.bott
+00001670: 6c65 6e65 636b 5f62 6c6f 636b 203d 2053  leneck_block = S
+00001680: 6571 7565 6e74 6961 6c28 0d0a 2020 2020  equential(..    
+00001690: 2020 2020 2020 2020 2020 2020 436f 6e76              Conv
+000016a0: 3264 2869 6e5f 6368 616e 6e65 6c73 203d  2d(in_channels =
+000016b0: 2069 5f63 6861 6e6e 656c 2c20 6f75 745f   i_channel, out_
+000016c0: 6368 616e 6e65 6c73 203d 206d 5f63 6861  channels = m_cha
+000016d0: 6e6e 656c 2c20 6b65 726e 656c 5f73 697a  nnel, kernel_siz
+000016e0: 6520 3d20 312c 2073 7472 6964 6520 3d20  e = 1, stride = 
+000016f0: 312c 2070 6164 6469 6e67 203d 2030 2c20  1, padding = 0, 
+00001700: 6269 6173 203d 2046 616c 7365 292c 0d0a  bias = False),..
+00001710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001720: 4261 7463 684e 6f72 6d32 6428 6d5f 6368  BatchNorm2d(m_ch
+00001730: 616e 6e65 6c29 2c0d 0a20 2020 2020 2020  annel),..       
+00001740: 2020 2020 2020 2020 2061 6374 692c 0d0a           acti,..
+00001750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001760: 2020 436f 6e76 3264 2869 6e5f 6368 616e    Conv2d(in_chan
+00001770: 6e65 6c73 203d 206d 5f63 6861 6e6e 656c  nels = m_channel
+00001780: 2c20 6f75 745f 6368 616e 6e65 6c73 203d  , out_channels =
+00001790: 206d 5f63 6861 6e6e 656c 2c20 6b65 726e   m_channel, kern
+000017a0: 656c 5f73 697a 6520 3d20 332c 2073 7472  el_size = 3, str
+000017b0: 6964 6520 3d20 7374 7269 6465 2c20 7061  ide = stride, pa
+000017c0: 6464 696e 6720 3d20 312c 2062 6961 7320  dding = 1, bias 
+000017d0: 3d20 4661 6c73 6529 2c0d 0a20 2020 2020  = False),..     
+000017e0: 2020 2020 2020 2020 2020 2042 6174 6368             Batch
+000017f0: 4e6f 726d 3264 286d 5f63 6861 6e6e 656c  Norm2d(m_channel
+00001800: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00001810: 2020 2020 6163 7469 2c0d 0a0d 0a20 2020      acti,....   
+00001820: 2020 2020 2020 2020 2020 2020 2043 6f6e               Con
+00001830: 7632 6428 696e 5f63 6861 6e6e 656c 7320  v2d(in_channels 
+00001840: 3d20 6d5f 6368 616e 6e65 6c2c 206f 7574  = m_channel, out
+00001850: 5f63 6861 6e6e 656c 7320 3d20 6f5f 6368  _channels = o_ch
+00001860: 616e 6e65 6c2c 206b 6572 6e65 6c5f 7369  annel, kernel_si
+00001870: 7a65 203d 2031 2c20 7374 7269 6465 203d  ze = 1, stride =
+00001880: 2031 2c20 7061 6464 696e 6720 3d20 302c   1, padding = 0,
+00001890: 2062 6961 7320 3d20 4661 6c73 6529 2c0d   bias = False),.
+000018a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000018b0: 2042 6174 6368 4e6f 726d 3264 286f 5f63   BatchNorm2d(o_c
+000018c0: 6861 6e6e 656c 292c 0d0a 2020 2020 2020  hannel),..      
+000018d0: 2020 2020 2020 2020 2020 2320 6163 7469            # acti
+000018e0: 2c0d 0a20 2020 2020 2020 2020 2020 2029  ,..            )
+000018f0: 0d0a 0d0a 2020 2020 2020 2020 6966 206c  ....        if l
+00001900: 6179 6572 203d 3d20 2766 6972 7374 273a  ayer == 'first':
+00001910: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+00001920: 656c 662e 646f 776e 7361 6d70 6c65 203d  elf.downsample =
+00001930: 2053 6571 7565 6e74 6961 6c28 0d0a 2020   Sequential(..  
+00001940: 2020 2020 2020 2020 2020 2020 2020 4176                Av
+00001950: 6750 6f6f 6c32 6428 6b65 726e 656c 5f73  gPool2d(kernel_s
+00001960: 697a 6520 3d20 7374 7269 6465 2c20 7374  ize = stride, st
+00001970: 7269 6465 203d 2073 7472 6964 6529 2c0d  ride = stride),.
+00001980: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00001990: 2020 2043 6f6e 7632 6428 696e 5f63 6861     Conv2d(in_cha
+000019a0: 6e6e 656c 7320 3d20 695f 6368 616e 6e65  nnels = i_channe
+000019b0: 6c2c 206f 7574 5f63 6861 6e6e 656c 7320  l, out_channels 
+000019c0: 3d20 6f5f 6368 616e 6e65 6c2c 206b 6572  = o_channel, ker
+000019d0: 6e65 6c5f 7369 7a65 203d 2031 2c20 7374  nel_size = 1, st
+000019e0: 7269 6465 203d 2031 2c20 7061 6464 696e  ride = 1, paddin
+000019f0: 6720 3d20 302c 2062 6961 7320 3d20 4661  g = 0, bias = Fa
+00001a00: 6c73 6529 2c0d 0a20 2020 2020 2020 2020  lse),..         
+00001a10: 2020 2020 2020 2042 6174 6368 4e6f 726d         BatchNorm
+00001a20: 3264 286f 5f63 6861 6e6e 656c 292c 0d0a  2d(o_channel),..
+00001a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001a40: 6163 7469 2c0d 0a20 2020 2020 2020 2020  acti,..         
+00001a50: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+00001a60: 7365 6c66 2e66 696e 616c 5f61 6374 6920  self.final_acti 
+00001a70: 3d20 6163 7469 0d0a 0d0a 2020 2020 6465  = acti....    de
+00001a80: 6620 666f 7277 6172 6428 7365 6c66 2c20  f forward(self, 
+00001a90: 7829 3a0d 0a0d 0a20 2020 2020 2020 2069  x):....        i
+00001aa0: 6465 6e74 6974 7920 3d20 780d 0a0d 0a20  dentity = x.... 
+00001ab0: 2020 2020 2020 2078 203d 2073 656c 662e         x = self.
+00001ac0: 626f 7474 6c65 6e65 636b 5f62 6c6f 636b  bottleneck_block
+00001ad0: 2878 290d 0a0d 0a20 2020 2020 2020 2069  (x)....        i
+00001ae0: 6620 7365 6c66 2e6c 6179 6572 203d 3d20  f self.layer == 
+00001af0: 2766 6972 7374 273a 0d0a 2020 2020 2020  'first':..      
+00001b00: 2020 2020 2020 6964 656e 7469 7479 203d        identity =
+00001b10: 2073 656c 662e 646f 776e 7361 6d70 6c65   self.downsample
+00001b20: 2869 6465 6e74 6974 7929 0d0a 0d0a 2020  (identity)....  
+00001b30: 2020 2020 2020 6966 2073 656c 662e 7371        if self.sq
+00001b40: 7565 657a 653a 2020 2020 0d0a 2020 2020  ueeze:    ..    
+00001b50: 2020 2020 2020 2020 7820 3d20 7365 6c66          x = self
+00001b60: 2e53 4528 782c 2069 6465 6e74 6974 7929  .SE(x, identity)
+00001b70: 0d0a 0d0a 2020 2020 2020 2020 7820 3d20  ....        x = 
+00001b80: 7365 6c66 2e66 696e 616c 5f61 6374 6928  self.final_acti(
+00001b90: 7829 0d0a 0d0a 2020 2020 2020 2020 7265  x)....        re
+00001ba0: 7475 726e 2078 0d0a 0d0a 0d0a 0d0a 0d0a  turn x..........
+00001bb0: 0d0a 0d0a 0d0a 0d0a 0d0a                 ..........
```

### Comparing `dep_lerng-0.18/dep_lerng/ResNet.py` & `dep_lerng-0.19/dep_lerng/ResNet.py`

 * *Files 11% similar despite different names*

```diff
@@ -21,474 +21,500 @@
 00000140: 6672 6f6d 2074 6f72 6368 2069 6d70 6f72  from torch impor
 00000150: 7420 666c 6174 7465 6e2c 2075 6e73 7175  t flatten, unsqu
 00000160: 6565 7a65 0d0a 0d0a 696d 706f 7274 2074  eeze....import t
 00000170: 6f72 6368 0d0a 0d0a 746f 7263 682e 6d61  orch....torch.ma
 00000180: 6e75 616c 5f73 6565 6428 3433 290d 0a0d  nual_seed(43)...
 00000190: 0a23 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .#--------------
 000001a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000001b0: 0d0a 0d0a 6672 6f6d 202e 5265 7342 6c6f  ....from .ResBlo
-000001c0: 636b 2069 6d70 6f72 7420 5265 7342 6c6f  ck import ResBlo
-000001d0: 636b 0d0a 6672 6f6d 202e 436f 6e76 426c  ck..from .ConvBl
-000001e0: 6f63 6b20 696d 706f 7274 2043 6f6e 7642  ock import ConvB
+000001b0: 0d0a 6672 6f6d 202e 5265 7342 6c6f 636b  ..from .ResBlock
+000001c0: 2069 6d70 6f72 7420 5265 7342 6c6f 636b   import ResBlock
+000001d0: 0d0a 6672 6f6d 202e 5261 646f 6e42 6c6f  ..from .RadonBlo
+000001e0: 636b 2069 6d70 6f72 7420 5261 646f 6e42  ck import RadonB
 000001f0: 6c6f 636b 0d0a 6672 6f6d 202e 6375 7374  lock..from .cust
 00000200: 6f6d 5f62 6c6f 636b 7320 696d 706f 7274  om_blocks import
 00000210: 2046 6173 7447 6c6f 6261 6c41 7667 506f   FastGlobalAvgPo
 00000220: 6f6c 3264 2c20 5341 4d2c 2041 4646 2c20  ol2d, SAM, AFF, 
 00000230: 4d53 4341 4d0d 0a66 726f 6d20 2e43 6c61  MSCAM..from .Cla
 00000240: 7373 6966 6965 724e 6574 2069 6d70 6f72  ssifierNet impor
 00000250: 7420 436c 6173 7369 6669 6572 4e65 740d  t ClassifierNet.
-00000260: 0a0d 0a23 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ...#------------
-00000270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000280: 2d2d 0d0a 2020 0d0a 2320 746f 7263 682e  --..  ..# torch.
-00000290: 7365 745f 666c 6f61 7433 325f 6d61 746d  set_float32_matm
-000002a0: 756c 5f70 7265 6369 7369 6f6e 2822 6869  ul_precision("hi
-000002b0: 6768 2229 0d0a 0d0a 6163 7469 203d 204d  gh")....acti = M
-000002c0: 6973 6828 696e 706c 6163 6520 3d20 5472  ish(inplace = Tr
-000002d0: 7565 290d 0a23 2061 6374 6920 3d20 5052  ue)..# acti = PR
-000002e0: 654c 5528 290d 0a0d 0a64 6566 206d 616b  eLU()....def mak
-000002f0: 655f 6c61 7965 7273 2874 7970 652c 206d  e_layers(type, m
-00000300: 6f64 6966 6965 7273 2c20 7371 7565 657a  odifiers, squeez
-00000310: 652c 2061 7567 6d65 6e74 293a 0d0a 0d0a  e, augment):....
-00000320: 2020 2020 6c61 7965 7273 203d 206d 6f64      layers = mod
-00000330: 6966 6965 7273 5b30 5d0d 0a20 2020 2066  ifiers[0]..    f
-00000340: 6c61 766f 7220 3d20 6d6f 6469 6669 6572  lavor = modifier
-00000350: 735b 315d 0d0a 0d0a 2020 2020 7265 735f  s[1]....    res_
-00000360: 6c61 7965 7273 203d 205b 5d0d 0a20 0d0a  layers = [].. ..
-00000370: 2020 2020 666f 7220 692c 206e 756d 5f62      for i, num_b
-00000380: 6c6f 636b 7320 696e 2065 6e75 6d65 7261  locks in enumera
-00000390: 7465 286c 6179 6572 7329 3a0d 0a20 2020  te(layers):..   
-000003a0: 2020 2020 200d 0a20 2020 2020 2020 206c       ..        l
-000003b0: 6179 6572 7320 3d20 5b5d 0d0a 0d0a 2020  ayers = []....  
-000003c0: 2020 2020 2020 6465 7074 6820 3d20 690d        depth = i.
-000003d0: 0a0d 0a20 2020 2020 2020 2069 6620 7479  ...        if ty
-000003e0: 7065 203d 3d20 2772 6573 6e65 7427 3a0d  pe == 'resnet':.
-000003f0: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
-00000400: 6f72 2064 2069 6e20 7261 6e67 6528 6e75  or d in range(nu
-00000410: 6d5f 626c 6f63 6b73 293a 0d0a 2020 2020  m_blocks):..    
-00000420: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-00000430: 2b31 203d 3d20 6e75 6d5f 626c 6f63 6b73  +1 == num_blocks
-00000440: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00000450: 2020 2020 2020 206c 6179 6572 732e 6170         layers.ap
-00000460: 7065 6e64 2852 6573 426c 6f63 6b28 2864  pend(ResBlock((d
-00000470: 6570 7468 2c20 666c 6176 6f72 292c 2073  epth, flavor), s
-00000480: 7175 6565 7a65 2c20 6175 676d 656e 742c  queeze, augment,
-00000490: 206c 6179 6572 203d 2027 6c61 7374 2729   layer = 'last')
-000004a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000004b0: 2020 2065 6c69 6620 6420 3d3d 2030 3a0d     elif d == 0:.
-000004c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000004d0: 2020 2020 206c 6179 6572 732e 6170 7065       layers.appe
-000004e0: 6e64 2852 6573 426c 6f63 6b28 2864 6570  nd(ResBlock((dep
-000004f0: 7468 2c20 666c 6176 6f72 292c 2073 7175  th, flavor), squ
-00000500: 6565 7a65 2c20 6175 676d 656e 742c 206c  eeze, augment, l
-00000510: 6179 6572 203d 2027 6669 7273 7427 2929  ayer = 'first'))
-00000520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000530: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00000540: 2020 2020 2020 2020 2020 2020 206c 6179               lay
-00000550: 6572 732e 6170 7065 6e64 2852 6573 426c  ers.append(ResBl
-00000560: 6f63 6b28 2864 6570 7468 2c20 666c 6176  ock((depth, flav
-00000570: 6f72 292c 2073 7175 6565 7a65 2c20 6175  or), squeeze, au
-00000580: 676d 656e 742c 206c 6179 6572 203d 204e  gment, layer = N
-00000590: 6f6e 6529 290d 0a0d 0a20 2020 2020 2020  one))....       
-000005a0: 2065 6c69 6620 7479 7065 203d 3d20 2763   elif type == 'c
-000005b0: 6e6e 273a 0d0a 2020 2020 2020 2020 2020  nn':..          
-000005c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-000005d0: 666f 7220 6420 696e 2072 616e 6765 286e  for d in range(n
-000005e0: 756d 5f62 6c6f 636b 7329 3a0d 0a20 2020  um_blocks):..   
-000005f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00000600: 642b 3120 3d3d 206e 756d 5f62 6c6f 636b  d+1 == num_block
-00000610: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00000620: 2020 2020 2020 2020 6c61 7965 7273 2e61          layers.a
-00000630: 7070 656e 6428 436f 6e76 426c 6f63 6b28  ppend(ConvBlock(
-00000640: 2864 6570 7468 2c20 666c 6176 6f72 292c  (depth, flavor),
-00000650: 2073 7175 6565 7a65 2c20 6175 676d 656e   squeeze, augmen
-00000660: 742c 206c 6179 6572 203d 2027 6c61 7374  t, layer = 'last
-00000670: 2729 290d 0a20 2020 2020 2020 2020 2020  '))..           
-00000680: 2020 2020 2065 6c69 6620 6420 3d3d 2030       elif d == 0
-00000690: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000006a0: 2020 2020 2020 206c 6179 6572 732e 6170         layers.ap
-000006b0: 7065 6e64 2843 6f6e 7642 6c6f 636b 2828  pend(ConvBlock((
-000006c0: 6465 7074 682c 2066 6c61 766f 7229 2c20  depth, flavor), 
-000006d0: 7371 7565 657a 652c 2061 7567 6d65 6e74  squeeze, augment
-000006e0: 2c20 6c61 7965 7220 3d20 2766 6972 7374  , layer = 'first
-000006f0: 2729 290d 0a20 2020 2020 2020 2020 2020  '))..           
-00000700: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00000710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000720: 6c61 7965 7273 2e61 7070 656e 6428 436f  layers.append(Co
-00000730: 6e76 426c 6f63 6b28 2864 6570 7468 2c20  nvBlock((depth, 
-00000740: 666c 6176 6f72 292c 2073 7175 6565 7a65  flavor), squeeze
-00000750: 2c20 6175 676d 656e 742c 206c 6179 6572  , augment, layer
-00000760: 203d 204e 6f6e 6529 290d 0a0d 0a20 2020   = None))....   
-00000770: 2020 2020 2072 6573 5f6c 6179 6572 732e       res_layers.
-00000780: 6170 7065 6e64 2853 6571 7565 6e74 6961  append(Sequentia
-00000790: 6c28 2a6c 6179 6572 7329 290d 0a0d 0a20  l(*layers)).... 
-000007a0: 2020 2072 6574 7572 6e20 5365 7175 656e     return Sequen
-000007b0: 7469 616c 282a 7265 735f 6c61 7965 7273  tial(*res_layers
-000007c0: 290d 0a0d 0a63 6c61 7373 2052 6573 6e65  )....class Resne
-000007d0: 7428 4d6f 6475 6c65 293a 0d0a 2020 2020  t(Module):..    
-000007e0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-000007f0: 662c 206e 756d 5f63 6c61 7373 6573 2c20  f, num_classes, 
-00000800: 7265 736e 6574 5f76 6172 6961 6e74 2c20  resnet_variant, 
-00000810: 6175 676d 656e 742c 2073 7175 6565 7a65  augment, squeeze
-00000820: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-00000830: 220d 0a20 2020 2020 2020 2041 6363 6570  "..        Accep
-00000840: 7465 6420 5661 7269 616e 7473 3a0d 0a20  ted Variants:.. 
-00000850: 2020 2020 2020 2031 3820 3a20 5b32 2c20         18 : [2, 
-00000860: 322c 2032 2c20 325d 202d 2d20 5661 6e69  2, 2, 2] -- Vani
-00000870: 6c6c 6120 426c 6f63 6b0d 0a20 2020 2020  lla Block..     
-00000880: 2020 2033 3420 3a20 5b33 2c20 342c 2036     34 : [3, 4, 6
-00000890: 2c20 335d 202d 2d20 5661 6e69 6c6c 6120  , 3] -- Vanilla 
-000008a0: 426c 6f63 6b0d 0a20 2020 2020 2020 2035  Block..        5
-000008b0: 3020 3a20 5b33 2c20 342c 2036 2c20 335d  0 : [3, 4, 6, 3]
-000008c0: 202d 2d20 426f 7474 6c65 6e65 636b 2042   -- Bottleneck B
-000008d0: 6c6f 636b 0d0a 2020 2020 2020 2020 3130  lock..        10
-000008e0: 3120 3a20 5b33 2c20 342c 2036 2c20 335d  1 : [3, 4, 6, 3]
-000008f0: 202d 2d20 426f 7474 6c65 6e65 636b 2042   -- Bottleneck B
-00000900: 6c6f 636b 0d0a 2020 2020 2020 2020 3135  lock..        15
-00000910: 3220 3a20 5b33 2c20 342c 2036 2c20 335d  2 : [3, 4, 6, 3]
-00000920: 202d 2d20 426f 7474 6c65 6e65 636b 2042   -- Bottleneck B
-00000930: 6c6f 636b 0d0a 0d0a 2020 2020 2020 2020  lock....        
-00000940: 4163 6365 7074 6564 2041 7567 6d65 6e74  Accepted Augment
-00000950: 733a 0d0a 2020 2020 2020 2020 4e6f 6e65  s:..        None
-00000960: 203a 204e 6f20 4175 676d 656e 7469 6e67   : No Augmenting
-00000970: 0d0a 2020 2020 2020 2020 5631 203a 2041  ..        V1 : A
-00000980: 7567 6d65 6e74 6564 2064 6174 6120 676f  ugmented data go
-00000990: 6573 2074 6872 6f75 6768 2073 6861 6c6c  es through shall
-000009a0: 6f77 204e 4e20 6669 7273 742c 206f 7574  ow NN first, out
-000009b0: 7075 7474 696e 6720 6120 7369 6e67 6c65  putting a single
-000009c0: 2064 6967 6974 2023 2320 4445 5052 4543   digit ## DEPREC
-000009d0: 4154 4544 2023 230d 0a0d 0a20 2020 2020  ATED ##....     
-000009e0: 2020 2056 315f 4120 3a20 4f6e 6c79 2041     V1_A : Only A
-000009f0: 7567 6d65 6e74 2031 2023 2320 4445 5052  ugment 1 ## DEPR
-00000a00: 4543 4154 4544 2023 230d 0a20 2020 2020  ECATED ##..     
-00000a10: 2020 2056 315f 4220 3a20 4f6e 6c79 2041     V1_B : Only A
-00000a20: 7567 6d65 6e74 2032 2023 2320 4445 5052  ugment 2 ## DEPR
-00000a30: 4543 4154 4544 2023 230d 0a0d 0a0d 0a20  ECATED ##...... 
-00000a40: 2020 2020 2020 2056 3220 3a20 4175 676d         V2 : Augm
-00000a50: 656e 7465 6420 6973 2063 6f6e 6361 7465  ented is concate
-00000a60: 6420 6469 7265 6374 6c79 2077 6974 6820  d directly with 
-00000a70: 6f72 6967 696e 616c 2064 6174 6120 2323  original data ##
-00000a80: 2044 4550 5245 4341 5445 4420 2323 0d0a   DEPRECATED ##..
-00000a90: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00000aa0: 2020 2020 5633 203a 2041 7567 6d65 6e74      V3 : Augment
-00000ab0: 6564 2064 6174 6120 6973 2053 4527 6420  ed data is SE'd 
-00000ac0: 7468 656e 2063 686f 7365 6e20 2020 2020  then chosen     
-00000ad0: 6279 2061 204e 4e20 746f 2064 6972 6563  by a NN to direc
-00000ae0: 746c 7920 6175 676d 656e 7420 6f72 6967  tly augment orig
-00000af0: 696e 616c 2077 6166 6572 2023 2320 4445  inal wafer ## DE
-00000b00: 5052 4543 4154 4544 2023 230d 0a20 2020  PRECATED ##..   
-00000b10: 2020 2020 2056 332d 4b61 6920 2020 3a20       V3-Kai   : 
-00000b20: 436f 6d62 696e 6573 2056 3320 616e 6420  Combines V3 and 
-00000b30: 5631 2074 6f67 6574 6865 7220 2323 2044  V1 together ## D
-00000b40: 4550 5245 4341 5445 4420 2323 0d0a 2020  EPRECATED ##..  
-00000b50: 2020 2020 2020 5633 2d4b 6169 2041 203a        V3-Kai A :
-00000b60: 204f 6e6c 7920 4175 676d 656e 7420 3120   Only Augment 1 
-00000b70: 2323 2044 4550 5245 4341 5445 4420 2323  ## DEPRECATED ##
-00000b80: 200d 0a20 2020 2020 2020 2056 342d 4b61   ..        V4-Ka
-00000b90: 6920 4220 3a20 4f6e 6c79 2041 7567 6d65  i B : Only Augme
-00000ba0: 6e74 2032 2023 2320 4445 5052 4543 4154  nt 2 ## DEPRECAT
-00000bb0: 4544 2023 230d 0a0d 0a20 2020 2020 2020  ED ##....       
-00000bc0: 2056 3420 0d0a 2020 2020 2020 200d 0a20   V4 ..       .. 
-00000bd0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00000be0: 2020 2020 7661 7269 616e 7473 203d 207b      variants = {
-00000bf0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00000c00: 2772 6164 6f6e 2720 3a20 5b5b 322c 2032  'radon' : [[2, 2
-00000c10: 2c20 325d 2c20 2776 616e 696c 6c61 275d  , 2], 'vanilla']
-00000c20: 2c0d 0a0d 0a20 2020 2020 2020 2020 2020  ,....           
-00000c30: 2027 3235 5f76 3227 203a 205b 5b32 2c20   '25_v2' : [[2, 
-00000c40: 342c 2036 2c20 325d 2c20 2762 6f74 746c  4, 6, 2], 'bottl
-00000c50: 656e 6563 6b27 5d2c 0d0a 2020 2020 2020  eneck'],..      
-00000c60: 2020 2020 2020 2763 7573 746f 6d27 203a        'custom' :
-00000c70: 205b 5b32 2c20 322c 2032 2c20 335d 2c20   [[2, 2, 2, 3], 
-00000c80: 2776 616e 696c 6c61 275d 2c0d 0a0d 0a20  'vanilla'],.... 
-00000c90: 2020 2020 2020 2020 2020 2027 3138 2720             '18' 
-00000ca0: 203a 205b 5b32 2c20 322c 2032 2c20 325d   : [[2, 2, 2, 2]
-00000cb0: 2c20 2776 616e 696c 6c61 275d 2c0d 0a20  , 'vanilla'],.. 
-00000cc0: 2020 2020 2020 2020 2020 2027 3334 2720             '34' 
-00000cd0: 203a 205b 5b33 2c20 342c 2036 2c20 335d   : [[3, 4, 6, 3]
-00000ce0: 2c20 2776 616e 696c 6c61 275d 2c0d 0a0d  , 'vanilla'],...
-00000cf0: 0a20 2020 2020 2020 2020 2020 2027 3530  .            '50
-00000d00: 2720 203a 205b 5b33 202c 342c 2036 2c20  '  : [[3 ,4, 6, 
-00000d10: 335d 2c20 2762 6f74 746c 656e 6563 6b27  3], 'bottleneck'
-00000d20: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00000d30: 2731 3031 2720 3a20 5b5b 3320 2c34 2c20  '101' : [[3 ,4, 
-00000d40: 3233 2c20 335d 2c20 2762 6f74 746c 656e  23, 3], 'bottlen
-00000d50: 6563 6b27 5d2c 200d 0a20 2020 2020 2020  eck'], ..       
-00000d60: 2020 2020 2027 3135 3227 203a 205b 5b33       '152' : [[3
-00000d70: 2c20 382c 2033 362c 2033 5d2c 2027 626f  , 8, 36, 3], 'bo
-00000d80: 7474 6c65 6e65 636b 275d 2c0d 0a20 2020  ttleneck'],..   
-00000d90: 2020 2020 207d 0d0a 0d0a 2020 2020 2020       }....      
-00000da0: 2020 7375 7065 7228 5265 736e 6574 2c20    super(Resnet, 
-00000db0: 7365 6c66 292e 5f5f 696e 6974 5f5f 2829  self).__init__()
-00000dc0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00000dd0: 2e61 7567 6d65 6e74 203d 2061 7567 6d65  .augment = augme
-00000de0: 6e74 0d0a 2020 2020 2020 2020 7365 6c66  nt..        self
-00000df0: 2e73 7175 6565 7a65 203d 2073 7175 6565  .squeeze = squee
-00000e00: 7a65 0d0a 0d0a 2020 2020 2020 2020 232d  ze....        #-
-00000e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000e60: 2d20 4845 4144 0d0a 0d0a 2020 2020 2020  - HEAD....      
-00000e70: 2020 6d6f 6d65 6e74 203d 2031 452d 320d    moment = 1E-2.
-00000e80: 0a0d 0a20 2020 2020 2020 2069 6620 7265  ...        if re
-00000e90: 736e 6574 5f76 6172 6961 6e74 2069 6e20  snet_variant in 
-00000ea0: 5b27 3138 272c 2027 3334 275d 3a0d 0a0d  ['18', '34']:...
-00000eb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00000ec0: 662e 4865 6164 203d 2053 6571 7565 6e74  f.Head = Sequent
-00000ed0: 6961 6c28 0d0a 2020 2020 2020 2020 2020  ial(..          
-00000ee0: 2020 2320 436f 6e76 3264 2869 6e5f 6368    # Conv2d(in_ch
-00000ef0: 616e 6e65 6c73 203d 2031 2c20 6f75 745f  annels = 1, out_
-00000f00: 6368 616e 6e65 6c73 203d 2033 322c 206b  channels = 32, k
-00000f10: 6572 6e65 6c5f 7369 7a65 203d 2037 2c20  ernel_size = 7, 
-00000f20: 7374 7269 6465 203d 2032 2c20 7061 6464  stride = 2, padd
-00000f30: 696e 6720 3d20 332c 2062 6961 7320 3d20  ing = 3, bias = 
-00000f40: 4661 6c73 6529 2c0d 0a20 2020 2020 2020  False),..       
-00000f50: 2020 2020 2023 2042 6174 6368 4e6f 726d       # BatchNorm
-00000f60: 3264 2833 322c 206d 6f6d 656e 7475 6d20  2d(32, momentum 
-00000f70: 3d20 6d6f 6d65 6e74 292c 0d0a 2020 2020  = moment),..    
-00000f80: 2020 2020 2020 2020 2320 6163 7469 2c0d          # acti,.
-00000f90: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00000fa0: 204d 6178 506f 6f6c 3264 286b 6572 6e65   MaxPool2d(kerne
-00000fb0: 6c5f 7369 7a65 203d 2033 2c20 7374 7269  l_size = 3, stri
-00000fc0: 6465 203d 2032 2c20 7061 6464 696e 6720  de = 2, padding 
-00000fd0: 3d20 3129 2c0d 0a0d 0a20 2020 2020 2020  = 1),....       
-00000fe0: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
-00000ff0: 6861 6e6e 656c 7320 3d20 312c 206f 7574  hannels = 1, out
-00001000: 5f63 6861 6e6e 656c 7320 3d20 3136 2c20  _channels = 16, 
-00001010: 6b65 726e 656c 5f73 697a 6520 3d20 332c  kernel_size = 3,
-00001020: 2073 7472 6964 6520 3d20 322c 2070 6164   stride = 2, pad
-00001030: 6469 6e67 203d 2031 2c20 6269 6173 203d  ding = 1, bias =
-00001040: 2046 616c 7365 2c20 6772 6f75 7073 203d   False, groups =
-00001050: 2031 292c 0d0a 2020 2020 2020 2020 2020   1),..          
-00001060: 2020 4261 7463 684e 6f72 6d32 6428 3136    BatchNorm2d(16
-00001070: 2c20 6d6f 6d65 6e74 756d 203d 206d 6f6d  , momentum = mom
-00001080: 656e 7429 2c0d 0a20 2020 2020 2020 2020  ent),..         
-00001090: 2020 2061 6374 692c 0d0a 0d0a 2020 2020     acti,....    
-000010a0: 2020 2020 2020 2020 436f 6e76 3264 2869          Conv2d(i
-000010b0: 6e5f 6368 616e 6e65 6c73 203d 2031 362c  n_channels = 16,
-000010c0: 206f 7574 5f63 6861 6e6e 656c 7320 3d20   out_channels = 
-000010d0: 3136 2c20 6b65 726e 656c 5f73 697a 6520  16, kernel_size 
-000010e0: 3d20 332c 2073 7472 6964 6520 3d20 312c  = 3, stride = 1,
-000010f0: 2070 6164 6469 6e67 203d 2031 2c20 6269   padding = 1, bi
-00001100: 6173 203d 2046 616c 7365 2c20 6772 6f75  as = False, grou
-00001110: 7073 203d 2032 292c 0d0a 2020 2020 2020  ps = 2),..      
-00001120: 2020 2020 2020 4261 7463 684e 6f72 6d32        BatchNorm2
-00001130: 6428 3136 2c20 6d6f 6d65 6e74 756d 203d  d(16, momentum =
-00001140: 206d 6f6d 656e 7429 2c0d 0a20 2020 2020   moment),..     
-00001150: 2020 2020 2020 2061 6374 692c 0d0a 0d0a         acti,....
-00001160: 2020 2020 2020 2020 2020 2020 436f 6e76              Conv
-00001170: 3264 2869 6e5f 6368 616e 6e65 6c73 203d  2d(in_channels =
-00001180: 2031 362c 206f 7574 5f63 6861 6e6e 656c   16, out_channel
-00001190: 7320 3d20 3136 2c20 6b65 726e 656c 5f73  s = 16, kernel_s
-000011a0: 697a 6520 3d20 332c 2073 7472 6964 6520  ize = 3, stride 
-000011b0: 3d20 312c 2070 6164 6469 6e67 203d 2031  = 1, padding = 1
-000011c0: 2c20 6269 6173 203d 2046 616c 7365 2c20  , bias = False, 
-000011d0: 6772 6f75 7073 203d 2032 292c 0d0a 2020  groups = 2),..  
-000011e0: 2020 2020 2020 2020 2020 4261 7463 684e            BatchN
-000011f0: 6f72 6d32 6428 3136 2c20 6d6f 6d65 6e74  orm2d(16, moment
-00001200: 756d 203d 206d 6f6d 656e 7429 2c0d 0a20  um = moment),.. 
-00001210: 2020 2020 2020 2020 2020 2061 6374 692c             acti,
-00001220: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00001230: 2320 4d61 7850 6f6f 6c32 6428 6b65 726e  # MaxPool2d(kern
-00001240: 656c 5f73 697a 6520 3d20 332c 2073 7472  el_size = 3, str
-00001250: 6964 6520 3d20 322c 2070 6164 6469 6e67  ide = 2, padding
-00001260: 203d 2031 292c 2020 2020 2020 2020 2020   = 1),          
-00001270: 2020 0d0a 2020 2020 2020 2020 290d 0a20    ..        ).. 
-00001280: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00001290: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000012a0: 2020 2020 7365 6c66 2e48 6561 6420 3d20      self.Head = 
-000012b0: 5365 7175 656e 7469 616c 280d 0a0d 0a20  Sequential(.... 
-000012c0: 2020 2020 2020 2020 2020 2043 6f6e 7632             Conv2
-000012d0: 6428 696e 5f63 6861 6e6e 656c 7320 3d20  d(in_channels = 
-000012e0: 312c 206f 7574 5f63 6861 6e6e 656c 7320  1, out_channels 
-000012f0: 3d20 3634 2c20 6b65 726e 656c 5f73 697a  = 64, kernel_siz
-00001300: 6520 3d20 332c 2073 7472 6964 6520 3d20  e = 3, stride = 
-00001310: 322c 2070 6164 6469 6e67 203d 2031 2c20  2, padding = 1, 
-00001320: 6269 6173 203d 2046 616c 7365 292c 0d0a  bias = False),..
-00001330: 2020 2020 2020 2020 2020 2020 4261 7463              Batc
-00001340: 684e 6f72 6d32 6428 3634 292c 0d0a 2020  hNorm2d(64),..  
-00001350: 2020 2020 2020 2020 2020 6163 7469 2c0d            acti,.
-00001360: 0a0d 0a20 2020 2020 2020 2020 2020 2043  ...            C
-00001370: 6f6e 7632 6428 696e 5f63 6861 6e6e 656c  onv2d(in_channel
-00001380: 7320 3d20 3634 2c20 6f75 745f 6368 616e  s = 64, out_chan
-00001390: 6e65 6c73 203d 2036 342c 206b 6572 6e65  nels = 64, kerne
-000013a0: 6c5f 7369 7a65 203d 2033 2c20 7374 7269  l_size = 3, stri
-000013b0: 6465 203d 2032 2c20 7061 6464 696e 6720  de = 2, padding 
-000013c0: 3d20 312c 2062 6961 7320 3d20 4661 6c73  = 1, bias = Fals
-000013d0: 6529 2c0d 0a20 2020 2020 2020 2020 2020  e),..           
-000013e0: 2042 6174 6368 4e6f 726d 3264 2836 3429   BatchNorm2d(64)
-000013f0: 2c0d 0a20 2020 2020 2020 2020 2020 2061  ,..            a
-00001400: 6374 692c 0d0a 0d0a 2020 2020 2020 2020  cti,....        
-00001410: 2020 2020 436f 6e76 3264 2869 6e5f 6368      Conv2d(in_ch
-00001420: 616e 6e65 6c73 203d 2036 342c 206f 7574  annels = 64, out
-00001430: 5f63 6861 6e6e 656c 7320 3d20 3634 2c20  _channels = 64, 
-00001440: 6b65 726e 656c 5f73 697a 6520 3d20 332c  kernel_size = 3,
-00001450: 2073 7472 6964 6520 3d20 322c 2070 6164   stride = 2, pad
-00001460: 6469 6e67 203d 2031 2c20 6269 6173 203d  ding = 1, bias =
-00001470: 2046 616c 7365 292c 0d0a 2020 2020 2020   False),..      
-00001480: 2020 2020 2020 4261 7463 684e 6f72 6d32        BatchNorm2
-00001490: 6428 3634 292c 0d0a 2020 2020 2020 2020  d(64),..        
-000014a0: 2020 2020 6163 7469 2c0d 0a0d 0a20 2020      acti,....   
-000014b0: 2020 2020 2020 2020 2023 204d 6178 506f           # MaxPo
-000014c0: 6f6c 3264 286b 6572 6e65 6c5f 7369 7a65  ol2d(kernel_size
-000014d0: 203d 2033 2c20 7374 7269 6465 203d 2032   = 3, stride = 2
-000014e0: 2c20 7061 6464 696e 6720 3d20 3129 2c0d  , padding = 1),.
-000014f0: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-00001500: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00001510: 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    #-------------
+00000260: 0a0d 0a23 2066 726f 6d20 5265 7342 6c6f  ...# from ResBlo
+00000270: 636b 2069 6d70 6f72 7420 5265 7342 6c6f  ck import ResBlo
+00000280: 636b 0d0a 2320 6672 6f6d 2052 6164 6f6e  ck..# from Radon
+00000290: 426c 6f63 6b20 696d 706f 7274 2052 6164  Block import Rad
+000002a0: 6f6e 426c 6f63 6b0d 0a23 2066 726f 6d20  onBlock..# from 
+000002b0: 6375 7374 6f6d 5f62 6c6f 636b 7320 696d  custom_blocks im
+000002c0: 706f 7274 2046 6173 7447 6c6f 6261 6c41  port FastGlobalA
+000002d0: 7667 506f 6f6c 3264 2c20 5341 4d2c 2041  vgPool2d, SAM, A
+000002e0: 4646 2c20 4d53 4341 4d0d 0a23 2066 726f  FF, MSCAM..# fro
+000002f0: 6d20 436c 6173 7369 6669 6572 4e65 7420  m ClassifierNet 
+00000300: 696d 706f 7274 2043 6c61 7373 6966 6965  import Classifie
+00000310: 724e 6574 0d0a 232d 2d2d 2d2d 2d2d 2d2d  rNet..#---------
+00000320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000330: 2d2d 2d2d 2d0d 0a20 200d 0a23 2074 6f72  -----..  ..# tor
+00000340: 6368 2e73 6574 5f66 6c6f 6174 3332 5f6d  ch.set_float32_m
+00000350: 6174 6d75 6c5f 7072 6563 6973 696f 6e28  atmul_precision(
+00000360: 2268 6967 6822 290d 0a0d 0a61 6374 6920  "high")....acti 
+00000370: 3d20 4d69 7368 2869 6e70 6c61 6365 203d  = Mish(inplace =
+00000380: 2054 7275 6529 0d0a 2320 6163 7469 203d   True)..# acti =
+00000390: 2050 5265 4c55 2829 0d0a 0d0a 6465 6620   PReLU()....def 
+000003a0: 6d61 6b65 5f6c 6179 6572 7328 7479 7065  make_layers(type
+000003b0: 2c20 6d6f 6469 6669 6572 732c 2073 7175  , modifiers, squ
+000003c0: 6565 7a65 2c20 6d6f 6d65 6e74 293a 0d0a  eeze, moment):..
+000003d0: 0d0a 2020 2020 6c61 7965 7273 203d 206d  ..    layers = m
+000003e0: 6f64 6966 6965 7273 5b30 5d0d 0a20 2020  odifiers[0]..   
+000003f0: 2066 6c61 766f 7220 3d20 6d6f 6469 6669   flavor = modifi
+00000400: 6572 735b 315d 0d0a 0d0a 2020 2020 7265  ers[1]....    re
+00000410: 735f 6c61 7965 7273 203d 205b 5d0d 0a20  s_layers = [].. 
+00000420: 0d0a 2020 2020 666f 7220 692c 206e 756d  ..    for i, num
+00000430: 5f62 6c6f 636b 7320 696e 2065 6e75 6d65  _blocks in enume
+00000440: 7261 7465 286c 6179 6572 7329 3a0d 0a20  rate(layers):.. 
+00000450: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00000460: 206c 6179 6572 7320 3d20 5b5d 0d0a 0d0a   layers = []....
+00000470: 2020 2020 2020 2020 6465 7074 6820 3d20          depth = 
+00000480: 690d 0a0d 0a20 2020 2020 2020 2069 6620  i....        if 
+00000490: 7479 7065 203d 3d20 2772 6573 6e65 7427  type == 'resnet'
+000004a0: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+000004b0: 2066 6f72 2064 2069 6e20 7261 6e67 6528   for d in range(
+000004c0: 6e75 6d5f 626c 6f63 6b73 293a 0d0a 2020  num_blocks):..  
+000004d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000004e0: 2064 2b31 203d 3d20 6e75 6d5f 626c 6f63   d+1 == num_bloc
+000004f0: 6b73 3a0d 0a20 2020 2020 2020 2020 2020  ks:..           
+00000500: 2020 2020 2020 2020 206c 6179 6572 732e           layers.
+00000510: 6170 7065 6e64 2852 6573 426c 6f63 6b28  append(ResBlock(
+00000520: 2864 6570 7468 2c20 666c 6176 6f72 292c  (depth, flavor),
+00000530: 2073 7175 6565 7a65 2c20 6d6f 6d65 6e74   squeeze, moment
+00000540: 2c20 6c61 7965 7220 3d20 276c 6173 7427  , layer = 'last'
+00000550: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00000560: 2020 2020 656c 6966 2064 203d 3d20 303a      elif d == 0:
+00000570: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000580: 2020 2020 2020 6c61 7965 7273 2e61 7070        layers.app
+00000590: 656e 6428 5265 7342 6c6f 636b 2828 6465  end(ResBlock((de
+000005a0: 7074 682c 2066 6c61 766f 7229 2c20 7371  pth, flavor), sq
+000005b0: 7565 657a 652c 206d 6f6d 656e 742c 206c  ueeze, moment, l
+000005c0: 6179 6572 203d 2027 6669 7273 7427 2929  ayer = 'first'))
+000005d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000005e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000005f0: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+00000600: 6572 732e 6170 7065 6e64 2852 6573 426c  ers.append(ResBl
+00000610: 6f63 6b28 2864 6570 7468 2c20 666c 6176  ock((depth, flav
+00000620: 6f72 292c 2073 7175 6565 7a65 2c20 6d6f  or), squeeze, mo
+00000630: 6d65 6e74 2c20 6c61 7965 7220 3d20 4e6f  ment, layer = No
+00000640: 6e65 2929 0d0a 0d0a 2020 2020 2020 2020  ne))....        
+00000650: 2320 656c 6966 2074 7970 6520 3d3d 2027  # elif type == '
+00000660: 636e 6e27 3a0d 0a20 2020 2020 2020 2020  cnn':..         
+00000670: 2020 200d 0a20 2020 2020 2020 2023 2020     ..        #  
+00000680: 2020 2066 6f72 2064 2069 6e20 7261 6e67     for d in rang
+00000690: 6528 6e75 6d5f 626c 6f63 6b73 293a 0d0a  e(num_blocks):..
+000006a0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+000006b0: 2020 6966 2064 2b31 203d 3d20 6e75 6d5f    if d+1 == num_
+000006c0: 626c 6f63 6b73 3a0d 0a20 2020 2020 2020  blocks:..       
+000006d0: 2023 2020 2020 2020 2020 2020 2020 206c   #             l
+000006e0: 6179 6572 732e 6170 7065 6e64 2843 6f6e  ayers.append(Con
+000006f0: 7642 6c6f 636b 2828 6465 7074 682c 2066  vBlock((depth, f
+00000700: 6c61 766f 7229 2c20 7371 7565 657a 652c  lavor), squeeze,
+00000710: 2061 7567 6d65 6e74 2c20 6c61 7965 7220   augment, layer 
+00000720: 3d20 276c 6173 7427 2929 0d0a 2020 2020  = 'last'))..    
+00000730: 2020 2020 2320 2020 2020 2020 2020 656c      #         el
+00000740: 6966 2064 203d 3d20 303a 0d0a 2020 2020  if d == 0:..    
+00000750: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+00000760: 2020 6c61 7965 7273 2e61 7070 656e 6428    layers.append(
+00000770: 436f 6e76 426c 6f63 6b28 2864 6570 7468  ConvBlock((depth
+00000780: 2c20 666c 6176 6f72 292c 2073 7175 6565  , flavor), squee
+00000790: 7a65 2c20 6175 676d 656e 742c 206c 6179  ze, augment, lay
+000007a0: 6572 203d 2027 6669 7273 7427 2929 0d0a  er = 'first'))..
+000007b0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+000007c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000007d0: 2023 2020 2020 2020 2020 2020 2020 206c   #             l
+000007e0: 6179 6572 732e 6170 7065 6e64 2843 6f6e  ayers.append(Con
+000007f0: 7642 6c6f 636b 2828 6465 7074 682c 2066  vBlock((depth, f
+00000800: 6c61 766f 7229 2c20 7371 7565 657a 652c  lavor), squeeze,
+00000810: 2061 7567 6d65 6e74 2c20 6c61 7965 7220   augment, layer 
+00000820: 3d20 4e6f 6e65 2929 0d0a 0d0a 2020 2020  = None))....    
+00000830: 2020 2020 656c 6966 2074 7970 6520 3d3d      elif type ==
+00000840: 2027 7261 646f 6e27 3a0d 0a0d 0a20 2020   'radon':....   
+00000850: 2020 2020 2020 2020 2066 6f72 2064 2069           for d i
+00000860: 6e20 7261 6e67 6528 6e75 6d5f 626c 6f63  n range(num_bloc
+00000870: 6b73 293a 0d0a 2020 2020 2020 2020 2020  ks):..          
+00000880: 2020 2020 2020 6966 2064 2b31 203d 3d20        if d+1 == 
+00000890: 6e75 6d5f 626c 6f63 6b73 3a0d 0a20 2020  num_blocks:..   
+000008a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000008b0: 206c 6179 6572 732e 6170 7065 6e64 2852   layers.append(R
+000008c0: 6573 426c 6f63 6b28 2864 6570 7468 2c20  esBlock((depth, 
+000008d0: 666c 6176 6f72 292c 2073 7175 6565 7a65  flavor), squeeze
+000008e0: 2c20 6d6f 6d65 6e74 2c20 6c61 7965 7220  , moment, layer 
+000008f0: 3d20 276c 6173 7427 2929 0d0a 2020 2020  = 'last'))..    
+00000900: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00000910: 2064 203d 3d20 303a 0d0a 2020 2020 2020   d == 0:..      
+00000920: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00000930: 7965 7273 2e61 7070 656e 6428 5265 7342  yers.append(ResB
+00000940: 6c6f 636b 2828 6465 7074 682c 2066 6c61  lock((depth, fla
+00000950: 766f 7229 2c20 7371 7565 657a 652c 206d  vor), squeeze, m
+00000960: 6f6d 656e 742c 206c 6179 6572 203d 2027  oment, layer = '
+00000970: 6669 7273 7427 2929 0d0a 2020 2020 2020  first'))..      
+00000980: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00000990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000009a0: 2020 2020 206c 6179 6572 732e 6170 7065       layers.appe
+000009b0: 6e64 2852 6573 426c 6f63 6b28 2864 6570  nd(ResBlock((dep
+000009c0: 7468 2c20 666c 6176 6f72 292c 2073 7175  th, flavor), squ
+000009d0: 6565 7a65 2c20 6d6f 6d65 6e74 2c20 6c61  eeze, moment, la
+000009e0: 7965 7220 3d20 4e6f 6e65 2929 0d0a 0d0a  yer = None))....
+000009f0: 0d0a 2020 2020 2020 2020 7265 735f 6c61  ..        res_la
+00000a00: 7965 7273 2e61 7070 656e 6428 5365 7175  yers.append(Sequ
+00000a10: 656e 7469 616c 282a 6c61 7965 7273 2929  ential(*layers))
+00000a20: 0d0a 0d0a 2020 2020 7265 7475 726e 2053  ....    return S
+00000a30: 6571 7565 6e74 6961 6c28 2a72 6573 5f6c  equential(*res_l
+00000a40: 6179 6572 7329 0d0a 0d0a 636c 6173 7320  ayers)....class 
+00000a50: 5265 736e 6574 284d 6f64 756c 6529 3a0d  Resnet(Module):.
+00000a60: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00000a70: 5f28 7365 6c66 2c20 7265 736e 6574 5f76  _(self, resnet_v
+00000a80: 6172 6961 6e74 2c20 7371 7565 657a 652c  ariant, squeeze,
+00000a90: 2064 726f 706f 7574 5f70 2c20 625f 6d6f   dropout_p, b_mo
+00000aa0: 6d65 6e74 293a 0d0a 0d0a 2020 2020 2020  ment):....      
+00000ab0: 2020 2222 220d 0a20 2020 2020 2020 2041    """..        A
+00000ac0: 6363 6570 7465 6420 5661 7269 616e 7473  ccepted Variants
+00000ad0: 3a0d 0a20 2020 2020 2020 2031 3820 3a20  :..        18 : 
+00000ae0: 5b32 2c20 322c 2032 2c20 325d 202d 2d20  [2, 2, 2, 2] -- 
+00000af0: 5661 6e69 6c6c 6120 426c 6f63 6b0d 0a20  Vanilla Block.. 
+00000b00: 2020 2020 2020 2033 3420 3a20 5b33 2c20         34 : [3, 
+00000b10: 342c 2036 2c20 335d 202d 2d20 5661 6e69  4, 6, 3] -- Vani
+00000b20: 6c6c 6120 426c 6f63 6b0d 0a20 2020 2020  lla Block..     
+00000b30: 2020 2035 3020 3a20 5b33 2c20 342c 2036     50 : [3, 4, 6
+00000b40: 2c20 335d 202d 2d20 426f 7474 6c65 6e65  , 3] -- Bottlene
+00000b50: 636b 2042 6c6f 636b 0d0a 2020 2020 2020  ck Block..      
+00000b60: 2020 3130 3120 3a20 5b33 2c20 342c 2036    101 : [3, 4, 6
+00000b70: 2c20 335d 202d 2d20 426f 7474 6c65 6e65  , 3] -- Bottlene
+00000b80: 636b 2042 6c6f 636b 0d0a 2020 2020 2020  ck Block..      
+00000b90: 2020 3135 3220 3a20 5b33 2c20 342c 2036    152 : [3, 4, 6
+00000ba0: 2c20 335d 202d 2d20 426f 7474 6c65 6e65  , 3] -- Bottlene
+00000bb0: 636b 2042 6c6f 636b 0d0a 0d0a 2020 2020  ck Block....    
+00000bc0: 2020 2020 4163 6365 7074 6564 2041 7567      Accepted Aug
+00000bd0: 6d65 6e74 733a 0d0a 2020 2020 2020 2020  ments:..        
+00000be0: 4e6f 6e65 203a 204e 6f20 4175 676d 656e  None : No Augmen
+00000bf0: 7469 6e67 0d0a 2020 2020 2020 2020 5631  ting..        V1
+00000c00: 203a 2041 7567 6d65 6e74 6564 2064 6174   : Augmented dat
+00000c10: 6120 676f 6573 2074 6872 6f75 6768 2073  a goes through s
+00000c20: 6861 6c6c 6f77 204e 4e20 6669 7273 742c  hallow NN first,
+00000c30: 206f 7574 7075 7474 696e 6720 6120 7369   outputting a si
+00000c40: 6e67 6c65 2064 6967 6974 2023 2320 4445  ngle digit ## DE
+00000c50: 5052 4543 4154 4544 2023 230d 0a0d 0a20  PRECATED ##.... 
+00000c60: 2020 2020 2020 2056 315f 4120 3a20 4f6e         V1_A : On
+00000c70: 6c79 2041 7567 6d65 6e74 2031 2023 2320  ly Augment 1 ## 
+00000c80: 4445 5052 4543 4154 4544 2023 230d 0a20  DEPRECATED ##.. 
+00000c90: 2020 2020 2020 2056 315f 4220 3a20 4f6e         V1_B : On
+00000ca0: 6c79 2041 7567 6d65 6e74 2032 2023 2320  ly Augment 2 ## 
+00000cb0: 4445 5052 4543 4154 4544 2023 230d 0a0d  DEPRECATED ##...
+00000cc0: 0a0d 0a20 2020 2020 2020 2056 3220 3a20  ...        V2 : 
+00000cd0: 4175 676d 656e 7465 6420 6973 2063 6f6e  Augmented is con
+00000ce0: 6361 7465 6420 6469 7265 6374 6c79 2077  cated directly w
+00000cf0: 6974 6820 6f72 6967 696e 616c 2064 6174  ith original dat
+00000d00: 6120 2323 2044 4550 5245 4341 5445 4420  a ## DEPRECATED 
+00000d10: 2323 0d0a 0d0a 2020 2020 2020 2020 0d0a  ##....        ..
+00000d20: 2020 2020 2020 2020 5633 203a 2041 7567          V3 : Aug
+00000d30: 6d65 6e74 6564 2064 6174 6120 6973 2053  mented data is S
+00000d40: 4527 6420 7468 656e 2063 686f 7365 6e20  E'd then chosen 
+00000d50: 2020 2020 6279 2061 204e 4e20 746f 2064      by a NN to d
+00000d60: 6972 6563 746c 7920 6175 676d 656e 7420  irectly augment 
+00000d70: 6f72 6967 696e 616c 2077 6166 6572 2023  original wafer #
+00000d80: 2320 4445 5052 4543 4154 4544 2023 230d  # DEPRECATED ##.
+00000d90: 0a20 2020 2020 2020 2056 332d 4b61 6920  .        V3-Kai 
+00000da0: 2020 3a20 436f 6d62 696e 6573 2056 3320    : Combines V3 
+00000db0: 616e 6420 5631 2074 6f67 6574 6865 7220  and V1 together 
+00000dc0: 2323 2044 4550 5245 4341 5445 4420 2323  ## DEPRECATED ##
+00000dd0: 0d0a 2020 2020 2020 2020 5633 2d4b 6169  ..        V3-Kai
+00000de0: 2041 203a 204f 6e6c 7920 4175 676d 656e   A : Only Augmen
+00000df0: 7420 3120 2323 2044 4550 5245 4341 5445  t 1 ## DEPRECATE
+00000e00: 4420 2323 200d 0a20 2020 2020 2020 2056  D ## ..        V
+00000e10: 342d 4b61 6920 4220 3a20 4f6e 6c79 2041  4-Kai B : Only A
+00000e20: 7567 6d65 6e74 2032 2023 2320 4445 5052  ugment 2 ## DEPR
+00000e30: 4543 4154 4544 2023 230d 0a0d 0a20 2020  ECATED ##....   
+00000e40: 2020 2020 2056 3420 0d0a 2020 2020 2020       V4 ..      
+00000e50: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+00000e60: 2020 2020 2020 2020 7661 7269 616e 7473          variants
+00000e70: 203d 207b 0d0a 0d0a 2020 2020 2020 2020   = {....        
+00000e80: 2020 2020 2772 6164 6f6e 2720 3a20 5b5b      'radon' : [[
+00000e90: 322c 2032 2c20 325d 2c20 2776 616e 696c  2, 2, 2], 'vanil
+00000ea0: 6c61 275d 2c0d 0a0d 0a20 2020 2020 2020  la'],....       
+00000eb0: 2020 2020 2027 3235 5f76 3227 203a 205b       '25_v2' : [
+00000ec0: 5b32 2c20 342c 2036 2c20 325d 2c20 2762  [2, 4, 6, 2], 'b
+00000ed0: 6f74 746c 656e 6563 6b27 5d2c 0d0a 2020  ottleneck'],..  
+00000ee0: 2020 2020 2020 2020 2020 2763 7573 746f            'custo
+00000ef0: 6d27 203a 205b 5b32 2c20 322c 2032 2c20  m' : [[2, 2, 2, 
+00000f00: 335d 2c20 2776 616e 696c 6c61 275d 2c0d  3], 'vanilla'],.
+00000f10: 0a0d 0a20 2020 2020 2020 2020 2020 2027  ...            '
+00000f20: 3138 2720 203a 205b 5b32 2c20 322c 2032  18'  : [[2, 2, 2
+00000f30: 2c20 325d 2c20 2776 616e 696c 6c61 275d  , 2], 'vanilla']
+00000f40: 2c0d 0a20 2020 2020 2020 2020 2020 2027  ,..            '
+00000f50: 3334 2720 203a 205b 5b33 2c20 342c 2036  34'  : [[3, 4, 6
+00000f60: 2c20 335d 2c20 2776 616e 696c 6c61 275d  , 3], 'vanilla']
+00000f70: 2c0d 0a0d 0a20 2020 2020 2020 2020 2020  ,....           
+00000f80: 2027 3530 2720 203a 205b 5b33 202c 342c   '50'  : [[3 ,4,
+00000f90: 2036 2c20 335d 2c20 2762 6f74 746c 656e   6, 3], 'bottlen
+00000fa0: 6563 6b27 5d2c 0d0a 2020 2020 2020 2020  eck'],..        
+00000fb0: 2020 2020 2731 3031 2720 3a20 5b5b 3320      '101' : [[3 
+00000fc0: 2c34 2c20 3233 2c20 335d 2c20 2762 6f74  ,4, 23, 3], 'bot
+00000fd0: 746c 656e 6563 6b27 5d2c 200d 0a20 2020  tleneck'], ..   
+00000fe0: 2020 2020 2020 2020 2027 3135 3227 203a           '152' :
+00000ff0: 205b 5b33 2c20 382c 2033 362c 2033 5d2c   [[3, 8, 36, 3],
+00001000: 2027 626f 7474 6c65 6e65 636b 275d 2c0d   'bottleneck'],.
+00001010: 0a20 2020 2020 2020 207d 0d0a 0d0a 2020  .        }....  
+00001020: 2020 2020 2020 7375 7065 7228 5265 736e        super(Resn
+00001030: 6574 2c20 7365 6c66 292e 5f5f 696e 6974  et, self).__init
+00001040: 5f5f 2829 0d0a 0d0a 2020 2020 2020 2020  __()....        
+00001050: 7365 6c66 2e73 7175 6565 7a65 203d 2073  self.squeeze = s
+00001060: 7175 6565 7a65 0d0a 2020 2020 2020 2020  queeze..        
+00001070: 7365 6c66 2e6d 6f6d 656e 7420 3d20 625f  self.moment = b_
+00001080: 6d6f 6d65 6e74 0d0a 0d0a 2020 2020 2020  moment....      
+00001090: 2020 6320 3d20 3136 0d0a 2020 2020 2020    c = 16..      
+000010a0: 2020 7220 3d20 310d 0a0d 0a20 2020 2020    r = 1....     
+000010b0: 2020 2023 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     #------------
+000010c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000010d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000010e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000010f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001100: 2d2d 2d2d 2d2d 2048 4541 440d 0a0d 0a20  ------ HEAD.... 
+00001110: 2020 2020 2020 2073 656c 662e 4865 6164         self.Head
+00001120: 203d 2053 6571 7565 6e74 6961 6c28 0d0a   = Sequential(..
+00001130: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
+00001140: 6e76 3264 2869 6e5f 6368 616e 6e65 6c73  nv2d(in_channels
+00001150: 203d 2031 2c20 6f75 745f 6368 616e 6e65   = 1, out_channe
+00001160: 6c73 203d 2033 322c 206b 6572 6e65 6c5f  ls = 32, kernel_
+00001170: 7369 7a65 203d 2037 2c20 7374 7269 6465  size = 7, stride
+00001180: 203d 2032 2c20 7061 6464 696e 6720 3d20   = 2, padding = 
+00001190: 332c 2062 6961 7320 3d20 4661 6c73 6529  3, bias = False)
+000011a0: 2c0d 0a20 2020 2020 2020 2020 2020 2023  ,..            #
+000011b0: 2042 6174 6368 4e6f 726d 3264 2833 322c   BatchNorm2d(32,
+000011c0: 206d 6f6d 656e 7475 6d20 3d20 6d6f 6d65   momentum = mome
+000011d0: 6e74 292c 0d0a 2020 2020 2020 2020 2020  nt),..          
+000011e0: 2020 2320 6163 7469 2c0d 0a0d 0a20 2020    # acti,....   
+000011f0: 2020 2020 2020 2020 2023 204d 6178 506f           # MaxPo
+00001200: 6f6c 3264 286b 6572 6e65 6c5f 7369 7a65  ol2d(kernel_size
+00001210: 203d 2033 2c20 7374 7269 6465 203d 2032   = 3, stride = 2
+00001220: 2c20 7061 6464 696e 6720 3d20 3129 2c0d  , padding = 1),.
+00001230: 0a0d 0a20 2020 2020 2020 2020 2020 2043  ...            C
+00001240: 6f6e 7632 6428 696e 5f63 6861 6e6e 656c  onv2d(in_channel
+00001250: 7320 3d20 312c 206f 7574 5f63 6861 6e6e  s = 1, out_chann
+00001260: 656c 7320 3d20 632c 206b 6572 6e65 6c5f  els = c, kernel_
+00001270: 7369 7a65 203d 2033 2c20 7374 7269 6465  size = 3, stride
+00001280: 203d 2032 2c20 7061 6464 696e 6720 3d20   = 2, padding = 
+00001290: 312c 2062 6961 7320 3d20 4661 6c73 652c  1, bias = False,
+000012a0: 2067 726f 7570 7320 3d20 3129 2c0d 0a20   groups = 1),.. 
+000012b0: 2020 2020 2020 2020 2020 2042 6174 6368             Batch
+000012c0: 4e6f 726d 3264 2863 2c20 6d6f 6d65 6e74  Norm2d(c, moment
+000012d0: 756d 203d 2073 656c 662e 6d6f 6d65 6e74  um = self.moment
+000012e0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+000012f0: 6163 7469 2c0d 0a0d 0a20 2020 2020 2020  acti,....       
+00001300: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
+00001310: 6861 6e6e 656c 7320 3d20 632c 206f 7574  hannels = c, out
+00001320: 5f63 6861 6e6e 656c 7320 3d20 632c 206b  _channels = c, k
+00001330: 6572 6e65 6c5f 7369 7a65 203d 2033 2c20  ernel_size = 3, 
+00001340: 7374 7269 6465 203d 2031 2c20 7061 6464  stride = 1, padd
+00001350: 696e 6720 3d20 312c 2062 6961 7320 3d20  ing = 1, bias = 
+00001360: 4661 6c73 652c 2067 726f 7570 7320 3d20  False, groups = 
+00001370: 3229 2c0d 0a20 2020 2020 2020 2020 2020  2),..           
+00001380: 2042 6174 6368 4e6f 726d 3264 2863 2c20   BatchNorm2d(c, 
+00001390: 6d6f 6d65 6e74 756d 203d 2073 656c 662e  momentum = self.
+000013a0: 6d6f 6d65 6e74 292c 0d0a 2020 2020 2020  moment),..      
+000013b0: 2020 2020 2020 6163 7469 2c0d 0a0d 0a20        acti,.... 
+000013c0: 2020 2020 2020 2020 2020 2043 6f6e 7632             Conv2
+000013d0: 6428 696e 5f63 6861 6e6e 656c 7320 3d20  d(in_channels = 
+000013e0: 632c 206f 7574 5f63 6861 6e6e 656c 7320  c, out_channels 
+000013f0: 3d20 632c 206b 6572 6e65 6c5f 7369 7a65  = c, kernel_size
+00001400: 203d 2033 2c20 7374 7269 6465 203d 2031   = 3, stride = 1
+00001410: 2c20 7061 6464 696e 6720 3d20 312c 2062  , padding = 1, b
+00001420: 6961 7320 3d20 4661 6c73 652c 2067 726f  ias = False, gro
+00001430: 7570 7320 3d20 3229 2c0d 0a20 2020 2020  ups = 2),..     
+00001440: 2020 2020 2020 2042 6174 6368 4e6f 726d         BatchNorm
+00001450: 3264 2863 2c20 6d6f 6d65 6e74 756d 203d  2d(c, momentum =
+00001460: 2073 656c 662e 6d6f 6d65 6e74 292c 0d0a   self.moment),..
+00001470: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+00001480: 2c0d 0a0d 0a20 2020 2020 2020 2020 2020  ,....           
+00001490: 2023 204d 6178 506f 6f6c 3264 286b 6572   # MaxPool2d(ker
+000014a0: 6e65 6c5f 7369 7a65 203d 2033 2c20 7374  nel_size = 3, st
+000014b0: 7269 6465 203d 2032 2c20 7061 6464 696e  ride = 2, paddin
+000014c0: 6720 3d20 3129 2c20 2020 2020 2020 2020  g = 1),         
+000014d0: 2020 200d 0a20 2020 2020 2020 2029 0d0a     ..        )..
+000014e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+000014f0: 2020 2020 2020 232d 2d2d 2d2d 2d2d 2d2d        #---------
+00001500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001560: 2d2d 2d2d 2d20 5245 5342 4c4f 434b 530d  ----- RESBLOCKS.
-00001570: 0a0d 0a0d 0a20 2020 2020 2020 2073 656c  .....        sel
-00001580: 662e 5265 7342 6c6f 636b 7320 3d20 6d61  f.ResBlocks = ma
-00001590: 6b65 5f6c 6179 6572 7328 2772 6573 6e65  ke_layers('resne
-000015a0: 7427 2c20 7661 7269 616e 7473 5b72 6573  t', variants[res
-000015b0: 6e65 745f 7661 7269 616e 745d 2c20 7365  net_variant], se
-000015c0: 6c66 2e73 7175 6565 7a65 2c20 7365 6c66  lf.squeeze, self
-000015d0: 2e61 7567 6d65 6e74 290d 0a0d 0a20 2020  .augment)....   
-000015e0: 2020 2020 2023 2d2d 2d2d 2d2d 2d2d 2d2d       #----------
+00001540: 2d2d 2d2d 2d2d 2d2d 2d20 5245 5342 4c4f  --------- RESBLO
+00001550: 434b 530d 0a0d 0a0d 0a20 2020 2020 2020  CKS......       
+00001560: 2073 656c 662e 5265 7342 6c6f 636b 7320   self.ResBlocks 
+00001570: 3d20 6d61 6b65 5f6c 6179 6572 7328 2772  = make_layers('r
+00001580: 6573 6e65 7427 2c20 7661 7269 616e 7473  esnet', variants
+00001590: 5b72 6573 6e65 745f 7661 7269 616e 745d  [resnet_variant]
+000015a0: 2c20 7365 6c66 2e73 7175 6565 7a65 2c20  , self.squeeze, 
+000015b0: 7365 6c66 2e6d 6f6d 656e 7429 0d0a 0d0a  self.moment)....
+000015c0: 2020 2020 2020 2020 232d 2d2d 2d2d 2d2d          #-------
+000015d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000015e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000015f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001620: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001630: 2d2d 2d2d 2d2d 2d2d 2045 5854 5241 2046  -------- EXTRA F
-00001640: 4541 5455 5245 530d 0a0d 0a20 2020 2020  EATURES....     
-00001650: 2020 2063 203d 2031 360d 0a20 2020 2020     c = 16..     
-00001660: 2020 2072 203d 2031 0d0a 0d0a 2020 2020     r = 1....    
-00001670: 2020 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d      #-----------
-00001680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000016a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000016b0: 2d2d 2d20 4845 4144 0d0a 0d0a 2020 2020  --- HEAD....    
-000016c0: 2020 2020 7365 6c66 2e66 6561 7475 7265      self.feature
-000016d0: 5f61 7474 656e 7469 6f6e 5f68 6561 6420  _attention_head 
-000016e0: 3d20 5365 7175 656e 7469 616c 280d 0a20  = Sequential(.. 
-000016f0: 2020 2020 2020 2020 2020 2023 2043 6f6e             # Con
-00001700: 7632 6428 696e 5f63 6861 6e6e 656c 7320  v2d(in_channels 
-00001710: 3d20 312c 206f 7574 5f63 6861 6e6e 656c  = 1, out_channel
-00001720: 7320 3d20 3332 2c20 6b65 726e 656c 5f73  s = 32, kernel_s
-00001730: 697a 6520 3d20 372c 2073 7472 6964 6520  ize = 7, stride 
-00001740: 3d20 322c 2070 6164 6469 6e67 203d 2033  = 2, padding = 3
-00001750: 2c20 6269 6173 203d 2046 616c 7365 292c  , bias = False),
-00001760: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00001770: 4261 7463 684e 6f72 6d32 6428 3332 292c  BatchNorm2d(32),
-00001780: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00001790: 6163 7469 2c0d 0a0d 0a20 2020 2020 2020  acti,....       
-000017a0: 2020 2020 2043 6f6e 7632 6428 696e 5f63       Conv2d(in_c
-000017b0: 6861 6e6e 656c 7320 3d20 312c 206f 7574  hannels = 1, out
-000017c0: 5f63 6861 6e6e 656c 7320 3d20 3136 2c20  _channels = 16, 
-000017d0: 6b65 726e 656c 5f73 697a 6520 3d20 332c  kernel_size = 3,
-000017e0: 2073 7472 6964 6520 3d20 312c 2070 6164   stride = 1, pad
-000017f0: 6469 6e67 203d 2031 2c20 6269 6173 203d  ding = 1, bias =
-00001800: 2046 616c 7365 292c 0d0a 2020 2020 2020   False),..      
-00001810: 2020 2020 2020 4261 7463 684e 6f72 6d32        BatchNorm2
-00001820: 6428 3136 2c20 6d6f 6d65 6e74 756d 203d  d(16, momentum =
-00001830: 206d 6f6d 656e 7429 2c0d 0a20 2020 2020   moment),..     
-00001840: 2020 2020 2020 2061 6374 692c 0d0a 0d0a         acti,....
-00001850: 2020 2020 2020 2020 2020 2020 436f 6e76              Conv
-00001860: 3264 2869 6e5f 6368 616e 6e65 6c73 203d  2d(in_channels =
-00001870: 2031 362c 206f 7574 5f63 6861 6e6e 656c   16, out_channel
-00001880: 7320 3d20 3136 2c20 6b65 726e 656c 5f73  s = 16, kernel_s
-00001890: 697a 6520 3d20 332c 2073 7472 6964 6520  ize = 3, stride 
-000018a0: 3d20 312c 2070 6164 6469 6e67 203d 2031  = 1, padding = 1
-000018b0: 2c20 6269 6173 203d 2046 616c 7365 292c  , bias = False),
-000018c0: 0d0a 2020 2020 2020 2020 2020 2020 4261  ..            Ba
-000018d0: 7463 684e 6f72 6d32 6428 3136 2c20 6d6f  tchNorm2d(16, mo
-000018e0: 6d65 6e74 756d 203d 206d 6f6d 656e 7429  mentum = moment)
-000018f0: 2c0d 0a20 2020 2020 2020 2020 2020 2061  ,..            a
-00001900: 6374 692c 0d0a 0d0a 2020 2020 2020 2020  cti,....        
-00001910: 2020 2020 436f 6e76 3264 2869 6e5f 6368      Conv2d(in_ch
-00001920: 616e 6e65 6c73 203d 2031 362c 206f 7574  annels = 16, out
-00001930: 5f63 6861 6e6e 656c 7320 3d20 3136 2c20  _channels = 16, 
-00001940: 6b65 726e 656c 5f73 697a 6520 3d20 332c  kernel_size = 3,
-00001950: 2073 7472 6964 6520 3d20 312c 2070 6164   stride = 1, pad
-00001960: 6469 6e67 203d 2031 2c20 6269 6173 203d  ding = 1, bias =
-00001970: 2046 616c 7365 292c 0d0a 2020 2020 2020   False),..      
-00001980: 2020 2020 2020 4261 7463 684e 6f72 6d32        BatchNorm2
-00001990: 6428 3136 2c20 6d6f 6d65 6e74 756d 203d  d(16, momentum =
-000019a0: 206d 6f6d 656e 7429 2c0d 0a20 2020 2020   moment),..     
-000019b0: 2020 2020 2020 2061 6374 692c 0d0a 0d0a         acti,....
-000019c0: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
-000019d0: 7850 6f6f 6c32 6428 6b65 726e 656c 5f73  xPool2d(kernel_s
-000019e0: 697a 6520 3d20 332c 2073 7472 6964 6520  ize = 3, stride 
-000019f0: 3d20 322c 2070 6164 6469 6e67 203d 2031  = 2, padding = 1
-00001a00: 292c 0d0a 2020 2020 2020 2020 290d 0a0d  ),..        )...
-00001a10: 0a20 2020 2020 2020 2023 2d2d 2d2d 2d2d  .        #------
-00001a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001a50: 2d2d 2d2d 2d2d 2d2d 2052 4553 424c 4f43  -------- RESBLOC
-00001a60: 4b53 0d0a 0d0a 2020 2020 2020 2020 7365  KS....        se
-00001a70: 6c66 2e66 6561 7475 7265 5f61 7474 656e  lf.feature_atten
-00001a80: 7469 6f6e 203d 206d 616b 655f 6c61 7965  tion = make_laye
-00001a90: 7273 2827 7265 736e 6574 272c 2076 6172  rs('resnet', var
-00001aa0: 6961 6e74 735b 2772 6164 6f6e 275d 2c20  iants['radon'], 
-00001ab0: 7365 6c66 2e73 7175 6565 7a65 2c20 7365  self.squeeze, se
-00001ac0: 6c66 2e61 7567 6d65 6e74 290d 0a0d 0a20  lf.augment).... 
-00001ad0: 2020 2020 2020 2023 2d2d 2d2d 2d2d 2d2d         #--------
+00001610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d20 4558 5452  ----------- EXTR
+00001620: 4120 4645 4154 5552 4553 0d0a 0d0a 0d0a  A FEATURES......
+00001630: 2020 2020 2020 2020 232d 2d2d 2d2d 2d2d          #-------
+00001640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001670: 2d2d 2d2d 2d2d 2d20 4845 4144 0d0a 0d0a  ------- HEAD....
+00001680: 2020 2020 2020 2020 7365 6c66 2e66 6561          self.fea
+00001690: 7475 7265 5f61 7474 656e 7469 6f6e 5f68  ture_attention_h
+000016a0: 6561 6420 3d20 5365 7175 656e 7469 616c  ead = Sequential
+000016b0: 280d 0a20 2020 2020 2020 2020 2020 2023  (..            #
+000016c0: 2043 6f6e 7632 6428 696e 5f63 6861 6e6e   Conv2d(in_chann
+000016d0: 656c 7320 3d20 312c 206f 7574 5f63 6861  els = 1, out_cha
+000016e0: 6e6e 656c 7320 3d20 3332 2c20 6b65 726e  nnels = 32, kern
+000016f0: 656c 5f73 697a 6520 3d20 372c 2073 7472  el_size = 7, str
+00001700: 6964 6520 3d20 322c 2070 6164 6469 6e67  ide = 2, padding
+00001710: 203d 2033 2c20 6269 6173 203d 2046 616c   = 3, bias = Fal
+00001720: 7365 292c 0d0a 2020 2020 2020 2020 2020  se),..          
+00001730: 2020 2320 4261 7463 684e 6f72 6d32 6428    # BatchNorm2d(
+00001740: 3332 292c 0d0a 2020 2020 2020 2020 2020  32),..          
+00001750: 2020 2320 6163 7469 2c0d 0a0d 0a20 2020    # acti,....   
+00001760: 2020 2020 2020 2020 2043 6f6e 7632 6428           Conv2d(
+00001770: 696e 5f63 6861 6e6e 656c 7320 3d20 312c  in_channels = 1,
+00001780: 206f 7574 5f63 6861 6e6e 656c 7320 3d20   out_channels = 
+00001790: 632c 206b 6572 6e65 6c5f 7369 7a65 203d  c, kernel_size =
+000017a0: 2033 2c20 7374 7269 6465 203d 2031 2c20   3, stride = 1, 
+000017b0: 7061 6464 696e 6720 3d20 312c 2062 6961  padding = 1, bia
+000017c0: 7320 3d20 4661 6c73 6529 2c0d 0a20 2020  s = False),..   
+000017d0: 2020 2020 2020 2020 2042 6174 6368 4e6f           BatchNo
+000017e0: 726d 3264 2863 2c20 6d6f 6d65 6e74 756d  rm2d(c, momentum
+000017f0: 203d 2073 656c 662e 6d6f 6d65 6e74 292c   = self.moment),
+00001800: 0d0a 2020 2020 2020 2020 2020 2020 6163  ..            ac
+00001810: 7469 2c0d 0a0d 0a20 2020 2020 2020 2020  ti,....         
+00001820: 2020 2043 6f6e 7632 6428 696e 5f63 6861     Conv2d(in_cha
+00001830: 6e6e 656c 7320 3d20 632c 206f 7574 5f63  nnels = c, out_c
+00001840: 6861 6e6e 656c 7320 3d20 632c 206b 6572  hannels = c, ker
+00001850: 6e65 6c5f 7369 7a65 203d 2033 2c20 7374  nel_size = 3, st
+00001860: 7269 6465 203d 2031 2c20 7061 6464 696e  ride = 1, paddin
+00001870: 6720 3d20 312c 2062 6961 7320 3d20 4661  g = 1, bias = Fa
+00001880: 6c73 6529 2c0d 0a20 2020 2020 2020 2020  lse),..         
+00001890: 2020 2042 6174 6368 4e6f 726d 3264 2863     BatchNorm2d(c
+000018a0: 2c20 6d6f 6d65 6e74 756d 203d 2073 656c  , momentum = sel
+000018b0: 662e 6d6f 6d65 6e74 292c 0d0a 2020 2020  f.moment),..    
+000018c0: 2020 2020 2020 2020 6163 7469 2c0d 0a0d          acti,...
+000018d0: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
+000018e0: 7632 6428 696e 5f63 6861 6e6e 656c 7320  v2d(in_channels 
+000018f0: 3d20 632c 206f 7574 5f63 6861 6e6e 656c  = c, out_channel
+00001900: 7320 3d20 632c 206b 6572 6e65 6c5f 7369  s = c, kernel_si
+00001910: 7a65 203d 2033 2c20 7374 7269 6465 203d  ze = 3, stride =
+00001920: 2031 2c20 7061 6464 696e 6720 3d20 312c   1, padding = 1,
+00001930: 2062 6961 7320 3d20 4661 6c73 6529 2c0d   bias = False),.
+00001940: 0a20 2020 2020 2020 2020 2020 2042 6174  .            Bat
+00001950: 6368 4e6f 726d 3264 2863 2c20 6d6f 6d65  chNorm2d(c, mome
+00001960: 6e74 756d 203d 2073 656c 662e 6d6f 6d65  ntum = self.mome
+00001970: 6e74 292c 0d0a 2020 2020 2020 2020 2020  nt),..          
+00001980: 2020 6163 7469 2c0d 0a0d 0a20 2020 2020    acti,....     
+00001990: 2020 2020 2020 2023 204d 6178 506f 6f6c         # MaxPool
+000019a0: 3264 286b 6572 6e65 6c5f 7369 7a65 203d  2d(kernel_size =
+000019b0: 2033 2c20 7374 7269 6465 203d 2032 2c20   3, stride = 2, 
+000019c0: 7061 6464 696e 6720 3d20 3129 2c0d 0a20  padding = 1),.. 
+000019d0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+000019e0: 2020 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d      #-----------
+000019f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a20: 2d2d 2d20 5245 5342 4c4f 434b 530d 0a0d  --- RESBLOCKS...
+00001a30: 0a20 2020 2020 2020 2073 656c 662e 6665  .        self.fe
+00001a40: 6174 7572 655f 6174 7465 6e74 696f 6e20  ature_attention 
+00001a50: 3d20 6d61 6b65 5f6c 6179 6572 7328 2772  = make_layers('r
+00001a60: 6164 6f6e 272c 2076 6172 6961 6e74 735b  adon', variants[
+00001a70: 2772 6164 6f6e 275d 2c20 7365 6c66 2e73  'radon'], self.s
+00001a80: 7175 6565 7a65 2c20 7365 6c66 2e6d 6f6d  queeze, self.mom
+00001a90: 656e 7429 0d0a 0d0a 2020 2020 2020 2020  ent)....        
+00001aa0: 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  #---------------
+00001ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00001ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2046 554c 4c59  ---------- FULLY
-00001b30: 2043 4f4e 4e45 4354 4544 0d0a 0d0a 2020   CONNECTED....  
-00001b40: 2020 2020 2020 7365 6c66 2e41 7667 506f        self.AvgPo
-00001b50: 6f6c 203d 2046 6173 7447 6c6f 6261 6c41  ol = FastGlobalA
-00001b60: 7667 506f 6f6c 3264 2866 6c61 7474 656e  vgPool2d(flatten
-00001b70: 203d 2046 616c 7365 290d 0a0d 0a20 2020   = False)....   
-00001b80: 2020 2020 2073 656c 662e 6663 203d 2043       self.fc = C
-00001b90: 6c61 7373 6966 6965 724e 6574 2872 6573  lassifierNet(res
-00001ba0: 6e65 745f 7661 7269 616e 742c 2073 656c  net_variant, sel
-00001bb0: 662e 6175 676d 656e 742c 2031 3030 2c20  f.augment, 100, 
-00001bc0: 302c 206e 756d 5f63 6c61 7373 6573 290d  0, num_classes).
-00001bd0: 0a0d 0a20 2020 2064 6566 2066 6f72 7761  ...    def forwa
-00001be0: 7264 2873 656c 662c 2078 293a 0d0a 0d0a  rd(self, x):....
-00001bf0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001c00: 6175 676d 656e 743a 0d0a 2020 2020 2020  augment:..      
-00001c10: 2020 2020 2020 2320 7831 2c20 7832 2c20        # x1, x2, 
-00001c20: 7833 203d 2078 0d0a 2020 2020 2020 2020  x3 = x..        
-00001c30: 2020 2020 7831 2c20 7832 203d 2078 0d0a      x1, x2 = x..
-00001c40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00001c50: 2020 2020 2020 2020 2020 2078 3120 3d20             x1 = 
-00001c60: 780d 0a0d 0a20 2020 2020 2020 2023 2d2d  x....        #--
-00001c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001c90: 2d2d 2d2d 2d20 4845 4144 0d0a 0d0a 2020  ----- HEAD....  
-00001ca0: 2020 2020 2020 7831 203d 2073 656c 662e        x1 = self.
-00001cb0: 4865 6164 2878 3129 0d0a 0d0a 2020 2020  Head(x1)....    
-00001cc0: 2020 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d      #-----------
+00001af0: 2d2d 2d20 4655 4c4c 5920 434f 4e4e 4543  --- FULLY CONNEC
+00001b00: 5445 440d 0a0d 0a20 2020 2020 2020 2073  TED....        s
+00001b10: 656c 662e 4176 6750 6f6f 6c20 3d20 4661  elf.AvgPool = Fa
+00001b20: 7374 476c 6f62 616c 4176 6750 6f6f 6c32  stGlobalAvgPool2
+00001b30: 6428 666c 6174 7465 6e20 3d20 4661 6c73  d(flatten = Fals
+00001b40: 6529 0d0a 0d0a 2020 2020 2020 2020 7365  e)....        se
+00001b50: 6c66 2e66 6320 3d20 436c 6173 7369 6669  lf.fc = Classifi
+00001b60: 6572 4e65 7428 6472 6f70 6f75 745f 7020  erNet(dropout_p 
+00001b70: 3d20 6472 6f70 6f75 745f 702c 2062 5f6d  = dropout_p, b_m
+00001b80: 6f6d 656e 7420 3d20 7365 6c66 2e6d 6f6d  oment = self.mom
+00001b90: 656e 7429 0d0a 0d0a 2020 2020 6465 6620  ent)....    def 
+00001ba0: 666f 7277 6172 6428 7365 6c66 2c20 7829  forward(self, x)
+00001bb0: 3a0d 0a0d 0a20 2020 2020 2020 2023 2070  :....        # p
+00001bc0: 7269 6e74 2874 6f72 6368 2e63 7564 612e  rint(torch.cuda.
+00001bd0: 6d65 6d6f 7279 5f73 756d 6d61 7279 2864  memory_summary(d
+00001be0: 6576 6963 653d 4e6f 6e65 2c20 6162 6272  evice=None, abbr
+00001bf0: 6576 6961 7465 643d 4661 6c73 6529 290d  eviated=False)).
+00001c00: 0a0d 0a20 2020 2020 2020 2078 312c 2078  ...        x1, x
+00001c10: 3220 3d20 780d 0a0d 0a20 2020 2020 2020  2 = x....       
+00001c20: 2023 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   #--------------
+00001c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001c40: 2d2d 2d2d 2d2d 2d2d 2d20 4845 4144 0d0a  --------- HEAD..
+00001c50: 200d 0a20 2020 2020 2020 2023 2070 7269   ..        # pri
+00001c60: 6e74 2874 6f72 6368 2e63 7564 612e 6d65  nt(torch.cuda.me
+00001c70: 6d6f 7279 5f73 756d 6d61 7279 2864 6576  mory_summary(dev
+00001c80: 6963 653d 4e6f 6e65 2c20 6162 6272 6576  ice=None, abbrev
+00001c90: 6961 7465 643d 4661 6c73 6529 290d 0a0d  iated=False))...
+00001ca0: 0a20 2020 2020 2020 2078 3120 3d20 7365  .        x1 = se
+00001cb0: 6c66 2e48 6561 6428 7831 290d 0a0d 0a20  lf.Head(x1).... 
+00001cc0: 2020 2020 2020 2023 2d2d 2d2d 2d2d 2d2d         #--------
 00001cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2052 4553  ------------ RES
-00001cf0: 424c 4f43 4b53 0d0a 0d0a 2020 2020 2020  BLOCKS....      
-00001d00: 2020 7831 203d 2073 656c 662e 5265 7342    x1 = self.ResB
-00001d10: 6c6f 636b 7328 7831 290d 0a20 2020 2020  locks(x1)..     
-00001d20: 2020 2078 3120 3d20 7365 6c66 2e41 7667     x1 = self.Avg
-00001d30: 506f 6f6c 2878 3129 0d0a 0d0a 2020 2020  Pool(x1)....    
-00001d40: 2020 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d      #-----------
-00001d50: 2d2d 2d2d 2d2d 2d2d 2d20 5245 5342 4c4f  --------- RESBLO
-00001d60: 434b 5320 2d2d 2045 5854 5241 2046 4541  CKS -- EXTRA FEA
-00001d70: 5455 5245 530d 0a0d 0a20 2020 2020 2020  TURES....       
-00001d80: 2069 6620 7365 6c66 2e61 7567 6d65 6e74   if self.augment
-00001d90: 3a0d 0a20 2020 2020 2020 2020 2020 2078  :..            x
-00001da0: 3220 3d20 7365 6c66 2e66 6561 7475 7265  2 = self.feature
-00001db0: 5f61 7474 656e 7469 6f6e 5f68 6561 6428  _attention_head(
-00001dc0: 7832 290d 0a20 2020 2020 2020 2020 2020  x2)..           
-00001dd0: 2078 3220 3d20 7365 6c66 2e66 6561 7475   x2 = self.featu
-00001de0: 7265 5f61 7474 656e 7469 6f6e 2878 3229  re_attention(x2)
-00001df0: 0d0a 2020 2020 2020 2020 2020 2020 7832  ..            x2
-00001e00: 203d 2073 656c 662e 4176 6750 6f6f 6c28   = self.AvgPool(
-00001e10: 7832 290d 0a0d 0a20 2020 2020 2020 2020  x2)....         
-00001e20: 2020 2023 2078 3120 3d20 2878 312c 2078     # x1 = (x1, x
-00001e30: 322c 2078 3329 0d0a 2020 2020 2020 2020  2, x3)..        
-00001e40: 2020 2020 7831 203d 2028 7831 2c20 7832      x1 = (x1, x2
-00001e50: 290d 0a0d 0a20 2020 2020 2020 2023 2d2d  )....        #--
-00001e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001e80: 2d2d 2d2d 2d20 4655 4c4c 5920 434f 4e4e  ----- FULLY CONN
-00001e90: 4543 5445 440d 0a20 2020 2020 2020 200d  ECTED..        .
-00001ea0: 0a20 2020 2020 2020 2078 3120 3d20 7365  .        x1 = se
-00001eb0: 6c66 2e66 6328 7831 290d 0a0d 0a20 2020  lf.fc(x1)....   
-00001ec0: 2020 2020 2072 6574 7572 6e20 7831 0d0a       return x1..
-00001ed0: 2020 2020                                    
+00001ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d20  --------------- 
+00001cf0: 5245 5342 4c4f 434b 530d 0a0d 0a20 2020  RESBLOCKS....   
+00001d00: 2020 2020 2023 2070 7269 6e74 2874 6f72       # print(tor
+00001d10: 6368 2e63 7564 612e 6d65 6d6f 7279 5f73  ch.cuda.memory_s
+00001d20: 756d 6d61 7279 2864 6576 6963 653d 4e6f  ummary(device=No
+00001d30: 6e65 2c20 6162 6272 6576 6961 7465 643d  ne, abbreviated=
+00001d40: 4661 6c73 6529 290d 0a0d 0a20 2020 2020  False))....     
+00001d50: 2020 2078 3120 3d20 7365 6c66 2e52 6573     x1 = self.Res
+00001d60: 426c 6f63 6b73 2878 3129 0d0a 2020 2020  Blocks(x1)..    
+00001d70: 2020 2020 7831 203d 2073 656c 662e 4176      x1 = self.Av
+00001d80: 6750 6f6f 6c28 7831 290d 0a0d 0a20 2020  gPool(x1)....   
+00001d90: 2020 2020 2023 2d2d 2d2d 2d2d 2d2d 2d2d       #----------
+00001da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2052 4553 424c  ---------- RESBL
+00001db0: 4f43 4b53 202d 2d20 4558 5452 4120 4645  OCKS -- EXTRA FE
+00001dc0: 4154 5552 4553 0d0a 0d0a 2020 2020 2020  ATURES....      
+00001dd0: 2020 2320 7072 696e 7428 746f 7263 682e    # print(torch.
+00001de0: 6375 6461 2e6d 656d 6f72 795f 7375 6d6d  cuda.memory_summ
+00001df0: 6172 7928 6465 7669 6365 3d4e 6f6e 652c  ary(device=None,
+00001e00: 2061 6262 7265 7669 6174 6564 3d46 616c   abbreviated=Fal
+00001e10: 7365 2929 0d0a 0d0a 2020 2020 2020 2020  se))....        
+00001e20: 7832 203d 2073 656c 662e 6665 6174 7572  x2 = self.featur
+00001e30: 655f 6174 7465 6e74 696f 6e5f 6865 6164  e_attention_head
+00001e40: 2878 3229 0d0a 2020 2020 2020 2020 2320  (x2)..        # 
+00001e50: 7072 696e 7428 746f 7263 682e 6375 6461  print(torch.cuda
+00001e60: 2e6d 656d 6f72 795f 7375 6d6d 6172 7928  .memory_summary(
+00001e70: 6465 7669 6365 3d4e 6f6e 652c 2061 6262  device=None, abb
+00001e80: 7265 7669 6174 6564 3d46 616c 7365 2929  reviated=False))
+00001e90: 0d0a 2020 2020 2020 2020 7832 203d 2073  ..        x2 = s
+00001ea0: 656c 662e 6665 6174 7572 655f 6174 7465  elf.feature_atte
+00001eb0: 6e74 696f 6e28 7832 290d 0a20 2020 2020  ntion(x2)..     
+00001ec0: 2020 2023 2070 7269 6e74 2874 6f72 6368     # print(torch
+00001ed0: 2e63 7564 612e 6d65 6d6f 7279 5f73 756d  .cuda.memory_sum
+00001ee0: 6d61 7279 2864 6576 6963 653d 4e6f 6e65  mary(device=None
+00001ef0: 2c20 6162 6272 6576 6961 7465 643d 4661  , abbreviated=Fa
+00001f00: 6c73 6529 290d 0a20 2020 2020 2020 2078  lse))..        x
+00001f10: 3220 3d20 7365 6c66 2e41 7667 506f 6f6c  2 = self.AvgPool
+00001f20: 2878 3229 0d0a 2020 2020 2020 2020 2320  (x2)..        # 
+00001f30: 7072 696e 7428 746f 7263 682e 6375 6461  print(torch.cuda
+00001f40: 2e6d 656d 6f72 795f 7375 6d6d 6172 7928  .memory_summary(
+00001f50: 6465 7669 6365 3d4e 6f6e 652c 2061 6262  device=None, abb
+00001f60: 7265 7669 6174 6564 3d46 616c 7365 2929  reviated=False))
+00001f70: 0d0a 0d0a 2020 2020 2020 2020 2320 7831  ....        # x1
+00001f80: 203d 2028 7831 2c20 7832 2c20 7833 290d   = (x1, x2, x3).
+00001f90: 0a20 2020 2020 2020 2078 203d 2028 7831  .        x = (x1
+00001fa0: 2c20 7832 290d 0a0d 0a20 2020 2020 2020  , x2)....       
+00001fb0: 2023 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   #--------------
+00001fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001fd0: 2d2d 2d2d 2d2d 2d2d 2d20 4655 4c4c 5920  --------- FULLY 
+00001fe0: 434f 4e4e 4543 5445 440d 0a0d 0a20 2020  CONNECTED....   
+00001ff0: 2020 2020 2023 2070 7269 6e74 2874 6f72       # print(tor
+00002000: 6368 2e63 7564 612e 6d65 6d6f 7279 5f73  ch.cuda.memory_s
+00002010: 756d 6d61 7279 2864 6576 6963 653d 4e6f  ummary(device=No
+00002020: 6e65 2c20 6162 6272 6576 6961 7465 643d  ne, abbreviated=
+00002030: 4661 6c73 6529 290d 0a20 2020 2020 2020  False))..       
+00002040: 200d 0a20 2020 2020 2020 2078 203d 2073   ..        x = s
+00002050: 656c 662e 6663 2878 290d 0a0d 0a20 2020  elf.fc(x)....   
+00002060: 2020 2020 2072 6574 7572 6e20 780d 0a20       return x.. 
+00002070: 2020 20
```

### Comparing `dep_lerng-0.18/dep_lerng/custom_blocks.py` & `dep_lerng-0.19/dep_lerng/custom_blocks.py`

 * *Files identical despite different names*

### Comparing `dep_lerng-0.18/dep_lerng/model_init.py` & `dep_lerng-0.19/dep_lerng/model_init.py`

 * *Files 2% similar despite different names*

```diff
@@ -14,31 +14,30 @@
 from kornia.geometry.transform import rotate
 import random
 
 from argparse import ArgumentParser
 
 #------------------------------
 from .ResNet import Resnet
+# from ResNet import Resnet
 #------------------------------
 
 torch.manual_seed(43)
 
 torch.set_float32_matmul_precision("high")
 
 class classifier(LightningModule):
-    def __init__(self, class_weights, learning_rate, squeeze):
+    def __init__(self, class_weights, learning_rate, squeeze, dropout_p, b_momemt):
         super(classifier, self).__init__()
         self.save_hyperparameters()
 
         self.LR = learning_rate
         self.num_classes = 9
 
-        self.variant = '18'
-        self.augment = False
-        self.squeeze = squeeze
+        self.moment = b_momemt
 
         self.cm_total = []
         self.all_classes = []
 
         self.class_weights = torch.as_tensor(class_weights, device = torch.device("cuda"))
 
         def weights_init(m):
@@ -48,15 +47,21 @@
             elif isinstance(m, Linear):
                 kaiming_normal_(m.weight.data)
 
             elif isinstance(m, BatchNorm2d) or isinstance(m, BatchNorm1d):
                 ones_(m.bias.data)
                 zeros_(m.bias.data)
 
-        self.net = Resnet(num_classes = self.num_classes, resnet_variant = self.variant, augment = self.augment, squeeze = self.squeeze)
+        self.net = Resnet(
+            resnet_variant = '18', 
+            squeeze = squeeze,
+            dropout_p = dropout_p,
+            b_moment = self.moment,
+            )
+        
         self.net.apply(weights_init)
 
         self.net = self.net.to(memory_format = torch.channels_last)
 
         # ----------------------Metrics
 
         standard_metrics = MetricCollection([
@@ -85,63 +90,45 @@
         self.test_step_output = []
         self.test_step_target = []
 
         # self.types = ['None', 'Loc', 'Edge-Loc', 'Center', 'Edge-Ring', 'Scratch', 'Random', 'Near-full', 'Donut']
 
     def forward(self, x):
 
-        if self.augment:
-
-            # x1, x2, x3 = x
-            x1, x2 = x
-
-            p = 1
-            rng = random.random()
-            def radon_augment(feature, angle):
-                return torch.cat((torch.roll(feature[:, 0, :, angle:], -1, dims = -2), feature[:, 1, :, :angle]), dim = -1).unsqueeze(1)
+        # x1, x2, x3 = x
+        x1, x2 = x
 
-            if rng < p:
-                angle = random.choice(range(0, 180))
+        p = 1
+        rng = random.random()
+        def radon_augment(feature, angle):
+            return torch.cat((torch.roll(feature[:, 0, :, angle:], -1, dims = -2), feature[:, 1, :, :angle]), dim = -1).unsqueeze(1)
 
-                angle_tensor =  torch.tensor(angle, dtype = torch.float32, device = torch.device("cuda"))
-
-                x1 = rotate(x1, angle_tensor) / 127
-                x2 = radon_augment(x2, angle)
-            
-            else:
-                x2 = radon_augment(x2, 0)
+        if rng < p:
+            angle = random.choice(range(0, 180))
 
+            angle_tensor =  torch.tensor(angle, dtype = torch.float32, device = torch.device("cuda"))
 
-            x1 = x1.to(memory_format = torch.channels_last)
-            x2 = x2.to(memory_format = torch.channels_last)
-            return self.net((x1, x2))
+            x1 = rotate(x1, angle_tensor) / 127
+            x2 = radon_augment(x2, angle)
         
         else:
+            x2 = radon_augment(x2, 0)
 
-            x1 = x
-
-            angle_tensor =  torch.tensor(0, dtype = torch.float32, device = torch.device("cuda"))
-
-            x1 = rotate(x1, angle_tensor) / 127
-
-            x1 = x1.to(memory_format = torch.channels_last)
 
-            return self.net(x1)
+        x1 = x1.to(memory_format = torch.channels_last)
+        x2 = x2.to(memory_format = torch.channels_last)
+        return self.net((x1, x2))
 
     def training_step(self, batch, batch_idx):
+            
+        # x1, x2, x3, y = batch
+        x1, x2, y = batch
+        # pred_y = self((x1, x2, x3))
+        pred_y = self((x1, x2))
 
-        if self.augment:
-            # x1, x2, x3, y = batch
-            x1, x2, y = batch
-            # pred_y = self((x1, x2, x3))
-            pred_y = self((x1, x2))
-        else:
-            x1, y = batch
-            pred_y = self(x1)
-    
         loss = F.cross_entropy(pred_y, y, weight = self.class_weights, label_smoothing = 0.05)
         # loss = F.multi_margin_loss(pred_y, y, weight = self.class_weights, margin = 0.5)
 
         self.train_step_output.extend(pred_y.argmax(dim=1).cpu().tolist())
         self.train_step_target.extend(y.cpu().tolist())
 
         self.log("train_loss", loss, on_epoch = True, on_step = False, rank_zero_only = True)
@@ -162,23 +149,19 @@
         self.log_dict(m1, on_epoch = True, on_step = False, rank_zero_only = True)
         self.log_dict(m2, on_epoch = True, on_step = False, rank_zero_only = True)
 
         self.train_step_output.clear()
         self.train_step_target.clear()
     
     def validation_step(self, batch, batch_idx):
-        
-        if self.augment:
-            # x1, x2, x3, y = batch
-            x1, x2, y = batch
-            # pred_y = self((x1, x2, x3))
-            pred_y = self((x1, x2))
-        else:
-            x1, y = batch
-            pred_y = self(x1)
+
+        # x1, x2, x3, y = batch
+        x1, x2, y = batch
+        # pred_y = self((x1, x2, x3))
+        pred_y = self((x1, x2))
 
         loss = F.cross_entropy(pred_y, y, weight = self.class_weights, label_smoothing = 0.05)
         # loss = F.multi_margin_loss(pred_y, y, weight = self.class_weights, margin = 0.5)
 
         self.valid_step_output.extend(pred_y.argmax(dim=1).cpu().tolist())
         self.valid_step_target.extend(y.cpu().tolist())
 
@@ -199,24 +182,19 @@
         self.log_dict(m2, on_epoch = True, on_step = False, rank_zero_only = True)
 
         self.valid_step_output.clear()
         self.valid_step_target.clear()
 
 
     def test_step(self, batch, batch_idx):
-
-        if self.augment:
-            # x1, x2, x3, y = batch
-            x1, x2, y = batch
-            # pred_y = self((x1, x2, x3))
-            pred_y = self((x1, x2))
-        else:
-            x1, y = batch
-            pred_y = self(x1)
-            # cam = self.cam(input_tensor = x1)
+        
+        # x1, x2, x3, y = batch
+        x1, x2, y = batch
+        # pred_y = self((x1, x2, x3))
+        pred_y = self((x1, x2))
 
         test_metric_1 = self.std_metrics.clone(prefix = 'test_', postfix = '_macro')
         test_metric_1 = self.wei_metrics.clone(prefix = 'test_', postfix = '_weighted')
 
         m1 = test_metric_1(pred_y, y)
         m2 = test_metric_1(pred_y, y)
```

