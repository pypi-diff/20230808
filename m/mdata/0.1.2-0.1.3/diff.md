# Comparing `tmp/mdata-0.1.2.tar.gz` & `tmp/mdata-0.1.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "mdata-0.1.2.tar", max compression
+gzip compressed data, was "mdata-0.1.3.tar", max compression
```

## Comparing `mdata-0.1.2.tar` & `mdata-0.1.3.tar`

### file list

```diff
@@ -1,94 +1,98 @@
--rw-r--r--   0        0        0      878 2023-07-31 08:44:07.626727 mdata-0.1.2/pyproject.toml
--rw-r--r--   0        0        0      335 2023-05-24 11:21:39.824410 mdata-0.1.2/README.md
--rw-r--r--   0        0        0        0 2023-04-24 08:17:06.548381 mdata-0.1.2/src/mdata/__init__.py
--rw-r--r--   0        0        0        0 2023-05-17 14:47:33.159982 mdata-0.1.2/src/mdata/analysis/__init__.py
--rw-r--r--   0        0        0      159 2023-05-19 08:45:38.105261 mdata-0.1.2/src/mdata/analysis/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      983 2023-05-19 08:57:03.979460 mdata-0.1.2/src/mdata/analysis/__pycache__/frequency.cpython-310.pyc
--rw-r--r--   0        0        0      813 2023-07-31 08:42:10.789100 mdata-0.1.2/src/mdata/analysis/frequency.py
--rw-r--r--   0        0        0        0 2023-05-03 09:02:31.524432 mdata-0.1.2/src/mdata/conversions/__init__.py
--rw-r--r--   0        0        0        0 2023-05-03 09:02:40.138181 mdata-0.1.2/src/mdata/conversions/ocel/__init__.py
--rw-r--r--   0        0        0      628 2023-07-31 08:42:10.790750 mdata-0.1.2/src/mdata/conversions/ocel/ocel_export.py
--rw-r--r--   0        0        0       94 2023-07-31 08:42:10.790750 mdata-0.1.2/src/mdata/core/__init__.py
--rw-r--r--   0        0        0      231 2023-06-22 13:03:56.284347 mdata-0.1.2/src/mdata/core/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      277 2023-07-25 14:46:05.021067 mdata-0.1.2/src/mdata/core/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0      928 2023-05-02 08:49:05.625504 mdata-0.1.2/src/mdata/core/__pycache__/df_utils.cpython-310.pyc
--rw-r--r--   0        0        0     1370 2023-07-21 11:28:35.393077 mdata-0.1.2/src/mdata/core/__pycache__/df_utils.cpython-311.pyc
--rw-r--r--   0        0        0     2528 2023-06-23 13:21:03.857649 mdata-0.1.2/src/mdata/core/__pycache__/factory.cpython-310.pyc
--rw-r--r--   0        0        0     5523 2023-07-26 10:44:49.531281 mdata-0.1.2/src/mdata/core/__pycache__/factory.cpython-311.pyc
--rw-r--r--   0        0        0     7319 2023-06-23 14:40:43.086571 mdata-0.1.2/src/mdata/core/__pycache__/header.cpython-310.pyc
--rw-r--r--   0        0        0    16098 2023-07-28 13:46:51.073836 mdata-0.1.2/src/mdata/core/__pycache__/header.cpython-311.pyc
--rw-r--r--   0        0        0    23541 2023-07-21 09:41:19.548768 mdata-0.1.2/src/mdata/core/__pycache__/machine_data_def.cpython-310.pyc
--rw-r--r--   0        0        0    47735 2023-07-28 14:58:24.887395 mdata-0.1.2/src/mdata/core/__pycache__/machine_data_def.cpython-311.pyc
--rw-r--r--   0        0        0     5155 2023-06-23 14:43:21.183472 mdata-0.1.2/src/mdata/core/__pycache__/raw.cpython-310.pyc
--rw-r--r--   0        0        0     8961 2023-07-25 14:46:04.921635 mdata-0.1.2/src/mdata/core/__pycache__/raw.cpython-311.pyc
--rw-r--r--   0        0        0     4049 2023-06-22 13:43:35.657351 mdata-0.1.2/src/mdata/core/__pycache__/util.cpython-310.pyc
--rw-r--r--   0        0        0     6522 2023-07-25 14:46:03.911359 mdata-0.1.2/src/mdata/core/__pycache__/util.cpython-311.pyc
--rw-r--r--   0        0        0      427 2023-05-02 08:49:05.536425 mdata-0.1.2/src/mdata/core/df_utils.py
--rw-r--r--   0        0        0      228 2023-07-31 08:42:10.792010 mdata-0.1.2/src/mdata/core/extensions/__init__.py
--rw-r--r--   0        0        0      219 2023-06-22 13:15:16.520453 mdata-0.1.2/src/mdata/core/extensions/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      249 2023-07-25 14:46:04.036823 mdata-0.1.2/src/mdata/core/extensions/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0      905 2023-06-22 13:43:35.663453 mdata-0.1.2/src/mdata/core/extensions/__pycache__/annotations.cpython-310.pyc
--rw-r--r--   0        0        0      999 2023-07-25 14:46:04.040140 mdata-0.1.2/src/mdata/core/extensions/__pycache__/annotations.cpython-311.pyc
--rw-r--r--   0        0        0     3257 2023-07-21 09:41:19.554851 mdata-0.1.2/src/mdata/core/extensions/__pycache__/metadata.cpython-310.pyc
--rw-r--r--   0        0        0     8335 2023-07-25 14:46:04.056987 mdata-0.1.2/src/mdata/core/extensions/__pycache__/metadata.cpython-311.pyc
--rw-r--r--   0        0        0     7266 2023-06-22 12:50:54.230359 mdata-0.1.2/src/mdata/core/extensions/__pycache__/multiplicity.cpython-310.pyc
--rw-r--r--   0        0        0      565 2023-06-22 13:43:14.287133 mdata-0.1.2/src/mdata/core/extensions/__pycache__/registry.cpython-310.pyc
--rw-r--r--   0        0        0      726 2023-07-25 14:46:04.014187 mdata-0.1.2/src/mdata/core/extensions/__pycache__/registry.cpython-311.pyc
--rw-r--r--   0        0        0      583 2023-07-31 08:42:10.792010 mdata-0.1.2/src/mdata/core/extensions/annotations.py
--rw-r--r--   0        0        0     4693 2023-07-31 08:42:10.793434 mdata-0.1.2/src/mdata/core/extensions/metadata.py
--rw-r--r--   0        0        0     5921 2023-07-31 08:42:10.793434 mdata-0.1.2/src/mdata/core/extensions/multiplicity.py
--rw-r--r--   0        0        0      279 2023-07-31 08:42:10.794440 mdata-0.1.2/src/mdata/core/extensions/registry.py
--rw-r--r--   0        0        0      447 2023-07-31 08:42:10.794440 mdata-0.1.2/src/mdata/core/extensions/segmentation.py
--rw-r--r--   0        0        0     3273 2023-07-31 08:42:10.795440 mdata-0.1.2/src/mdata/core/factory.py
--rw-r--r--   0        0        0     7771 2023-07-31 08:42:10.796440 mdata-0.1.2/src/mdata/core/header.py
--rw-r--r--   0        0        0    25650 2023-07-31 08:42:10.796440 mdata-0.1.2/src/mdata/core/machine_data_def.py
--rw-r--r--   0        0        0     5637 2023-07-31 08:42:10.797440 mdata-0.1.2/src/mdata/core/raw.py
--rw-r--r--   0        0        0     3019 2023-07-31 08:42:10.798440 mdata-0.1.2/src/mdata/core/util.py
--rw-r--r--   0        0        0      183 2023-07-31 08:42:10.798655 mdata-0.1.2/src/mdata/file_formats/__init__.py
--rw-r--r--   0        0        0      423 2023-05-17 09:17:42.509792 mdata-0.1.2/src/mdata/file_formats/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      485 2023-07-31 08:34:08.712253 mdata-0.1.2/src/mdata/file_formats/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0     2428 2023-06-22 07:58:14.962611 mdata-0.1.2/src/mdata/file_formats/__pycache__/io_utils.cpython-310.pyc
--rw-r--r--   0        0        0     5129 2023-07-25 14:46:05.041922 mdata-0.1.2/src/mdata/file_formats/__pycache__/io_utils.cpython-311.pyc
--rw-r--r--   0        0        0     2845 2023-06-22 07:58:14.975746 mdata-0.1.2/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-310.pyc
--rw-r--r--   0        0        0     4699 2023-07-25 14:46:05.074101 mdata-0.1.2/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-311.pyc
--rw-r--r--   0        0        0      251 2023-07-31 08:42:10.799889 mdata-0.1.2/src/mdata/file_formats/csv/__init__.py
--rw-r--r--   0        0        0      427 2023-05-04 14:37:18.586529 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      495 2023-07-31 08:34:08.713981 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0     4401 2023-06-22 13:59:35.522310 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/checking.cpython-310.pyc
--rw-r--r--   0        0        0     8815 2023-07-31 08:34:08.717223 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/checking.cpython-311.pyc
--rw-r--r--   0        0        0     3767 2023-06-22 08:30:59.383717 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/exporting.cpython-310.pyc
--rw-r--r--   0        0        0    11794 2023-07-31 08:34:09.294572 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/exporting.cpython-311.pyc
--rw-r--r--   0        0        0     4582 2023-06-22 10:03:20.690848 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/importing.cpython-310.pyc
--rw-r--r--   0        0        0     8639 2023-07-31 08:34:09.286491 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/importing.cpython-311.pyc
--rw-r--r--   0        0        0      514 2023-06-20 13:51:47.407662 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/shared.cpython-310.pyc
--rw-r--r--   0        0        0     1134 2023-07-25 14:46:05.041922 mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/shared.cpython-311.pyc
--rw-r--r--   0        0        0     5263 2023-07-31 08:42:10.799889 mdata-0.1.2/src/mdata/file_formats/csv/checking.py
--rw-r--r--   0        0        0     5710 2023-07-31 08:42:10.800903 mdata-0.1.2/src/mdata/file_formats/csv/exporting.py
--rw-r--r--   0        0        0     5963 2023-07-31 08:42:10.800903 mdata-0.1.2/src/mdata/file_formats/csv/importing.py
--rw-r--r--   0        0        0      483 2023-07-31 08:42:10.801902 mdata-0.1.2/src/mdata/file_formats/csv/shared.py
--rw-r--r--   0        0        0      145 2023-04-27 12:35:27.078537 mdata-0.1.2/src/mdata/file_formats/hdf/__init__.py
--rw-r--r--   0        0        0      276 2023-04-27 12:35:59.963859 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      324 2023-07-21 11:28:35.575053 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0     1456 2023-06-20 13:51:47.417660 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-310.pyc
--rw-r--r--   0        0        0     4698 2023-07-25 14:46:05.334922 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-311.pyc
--rw-r--r--   0        0        0     1079 2023-06-20 13:51:47.415663 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/importing.cpython-310.pyc
--rw-r--r--   0        0        0     4696 2023-07-25 14:46:05.313861 mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/importing.cpython-311.pyc
--rw-r--r--   0        0        0      190 2023-04-21 14:16:55.019498 mdata-0.1.2/src/mdata/file_formats/hdf/checking.py
--rw-r--r--   0        0        0     2493 2023-07-31 08:42:10.802904 mdata-0.1.2/src/mdata/file_formats/hdf/exporting.py
--rw-r--r--   0        0        0     3147 2023-07-31 08:42:10.803203 mdata-0.1.2/src/mdata/file_formats/hdf/importing.py
--rw-r--r--   0        0        0     4829 2023-07-31 08:42:10.803833 mdata-0.1.2/src/mdata/file_formats/header_schema.json
--rw-r--r--   0        0        0     2818 2023-07-31 08:42:10.804814 mdata-0.1.2/src/mdata/file_formats/io_utils.py
--rw-r--r--   0        0        0     4530 2023-07-31 08:42:10.805000 mdata-0.1.2/src/mdata/file_formats/schema_template.json
--rw-r--r--   0        0        0     2218 2023-07-31 08:42:10.806087 mdata-0.1.2/src/mdata/file_formats/validity_checking_utils.py
--rw-r--r--   0        0        0       32 2023-07-31 08:42:10.806773 mdata-0.1.2/src/mdata/io/__init__.py
--rw-r--r--   0        0        0      155 2023-05-22 11:21:08.266604 mdata-0.1.2/src/mdata/visualization/__init__.py
--rw-r--r--   0        0        0      355 2023-05-22 11:21:08.475981 mdata-0.1.2/src/mdata/visualization/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      413 2023-07-21 11:28:35.584583 mdata-0.1.2/src/mdata/visualization/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0        0        0     1387 2023-06-13 11:11:58.321484 mdata-0.1.2/src/mdata/visualization/__pycache__/matplot.cpython-310.pyc
--rw-r--r--   0        0        0     2514 2023-07-25 14:46:05.390789 mdata-0.1.2/src/mdata/visualization/__pycache__/matplot.cpython-311.pyc
--rw-r--r--   0        0        0     6665 2023-07-11 10:58:27.205279 mdata-0.1.2/src/mdata/visualization/__pycache__/plotting.cpython-310.pyc
--rw-r--r--   0        0        0    12465 2023-07-25 14:46:05.342723 mdata-0.1.2/src/mdata/visualization/__pycache__/plotting.cpython-311.pyc
--rw-r--r--   0        0        0     1102 2023-07-31 08:42:10.807546 mdata-0.1.2/src/mdata/visualization/matplot.py
--rw-r--r--   0        0        0     7738 2023-07-31 08:42:10.807641 mdata-0.1.2/src/mdata/visualization/plotting.py
--rw-r--r--   0        0        0      255 2023-07-31 08:42:10.808661 mdata-0.1.2/src/mdata/visualization/textual.py
--rw-r--r--   0        0        0     1129 1970-01-01 00:00:00.000000 mdata-0.1.2/PKG-INFO
+-rw-r--r--   0        0        0     1007 2023-08-08 07:14:21.356278 mdata-0.1.3/pyproject.toml
+-rw-r--r--   0        0        0      335 2023-05-24 11:21:39.824410 mdata-0.1.3/README.md
+-rw-r--r--   0        0        0        0 2023-04-24 08:17:06.548381 mdata-0.1.3/src/mdata/__init__.py
+-rw-r--r--   0        0        0        0 2023-05-17 14:47:33.159982 mdata-0.1.3/src/mdata/analysis/__init__.py
+-rw-r--r--   0        0        0      159 2023-05-19 08:45:38.105261 mdata-0.1.3/src/mdata/analysis/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      983 2023-05-19 08:57:03.979460 mdata-0.1.3/src/mdata/analysis/__pycache__/frequency.cpython-310.pyc
+-rw-r--r--   0        0        0      889 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/analysis/frequency.py
+-rw-r--r--   0        0        0        0 2023-05-03 09:02:31.524432 mdata-0.1.3/src/mdata/conversions/__init__.py
+-rw-r--r--   0        0        0        0 2023-05-03 09:02:40.138181 mdata-0.1.3/src/mdata/conversions/ocel/__init__.py
+-rw-r--r--   0        0        0      658 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/conversions/ocel/ocel_export.py
+-rw-r--r--   0        0        0      252 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/__init__.py
+-rw-r--r--   0        0        0      231 2023-06-22 13:03:56.284347 mdata-0.1.3/src/mdata/core/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      574 2023-08-07 13:32:46.180593 mdata-0.1.3/src/mdata/core/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0    54664 2023-08-07 14:59:54.709002 mdata-0.1.3/src/mdata/core/__pycache__/base_machine_data.cpython-311.pyc
+-rw-r--r--   0        0        0      928 2023-05-02 08:49:05.625504 mdata-0.1.3/src/mdata/core/__pycache__/df_utils.cpython-310.pyc
+-rw-r--r--   0        0        0     1370 2023-07-21 11:28:35.393077 mdata-0.1.3/src/mdata/core/__pycache__/df_utils.cpython-311.pyc
+-rw-r--r--   0        0        0     7319 2023-06-23 14:40:43.086571 mdata-0.1.3/src/mdata/core/__pycache__/header.cpython-310.pyc
+-rw-r--r--   0        0        0    16084 2023-08-07 12:56:18.211571 mdata-0.1.3/src/mdata/core/__pycache__/header.cpython-311.pyc
+-rw-r--r--   0        0        0    18222 2023-08-07 14:56:54.374412 mdata-0.1.3/src/mdata/core/__pycache__/protocols.cpython-311.pyc
+-rw-r--r--   0        0        0     5155 2023-06-23 14:43:21.183472 mdata-0.1.3/src/mdata/core/__pycache__/raw.cpython-310.pyc
+-rw-r--r--   0        0        0     8152 2023-08-07 12:56:18.239874 mdata-0.1.3/src/mdata/core/__pycache__/raw.cpython-311.pyc
+-rw-r--r--   0        0        0     2709 2023-08-07 12:56:18.207569 mdata-0.1.3/src/mdata/core/__pycache__/shared_defs.cpython-311.pyc
+-rw-r--r--   0        0        0     4049 2023-06-22 13:43:35.657351 mdata-0.1.3/src/mdata/core/__pycache__/util.cpython-310.pyc
+-rw-r--r--   0        0        0     7415 2023-08-07 13:51:58.917111 mdata-0.1.3/src/mdata/core/__pycache__/util.cpython-311.pyc
+-rw-r--r--   0        0        0    29735 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/base_machine_data.py
+-rw-r--r--   0        0        0      427 2023-05-02 08:49:05.536425 mdata-0.1.3/src/mdata/core/df_utils.py
+-rw-r--r--   0        0        0      259 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/extensions/__init__.py
+-rw-r--r--   0        0        0      219 2023-06-22 13:15:16.520453 mdata-0.1.3/src/mdata/core/extensions/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      358 2023-08-07 12:56:18.215569 mdata-0.1.3/src/mdata/core/extensions/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0      905 2023-06-22 13:43:35.663453 mdata-0.1.3/src/mdata/core/extensions/__pycache__/annotations.cpython-310.pyc
+-rw-r--r--   0        0        0     1118 2023-08-07 10:22:21.105489 mdata-0.1.3/src/mdata/core/extensions/__pycache__/annotations.cpython-311.pyc
+-rw-r--r--   0        0        0     3257 2023-07-21 09:41:19.554851 mdata-0.1.3/src/mdata/core/extensions/__pycache__/metadata.cpython-310.pyc
+-rw-r--r--   0        0        0     8596 2023-08-07 14:47:34.729039 mdata-0.1.3/src/mdata/core/extensions/__pycache__/metadata.cpython-311.pyc
+-rw-r--r--   0        0        0      565 2023-06-22 13:43:14.287133 mdata-0.1.3/src/mdata/core/extensions/__pycache__/registry.cpython-310.pyc
+-rw-r--r--   0        0        0      726 2023-07-31 10:47:34.781496 mdata-0.1.3/src/mdata/core/extensions/__pycache__/registry.cpython-311.pyc
+-rw-r--r--   0        0        0      663 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/extensions/annotations.py
+-rw-r--r--   0        0        0     4949 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/extensions/metadata.py
+-rw-r--r--   0        0        0     5999 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/extensions/multiplicity.py.txt
+-rw-r--r--   0        0        0      279 2023-07-31 08:42:10.794440 mdata-0.1.3/src/mdata/core/extensions/registry.py
+-rw-r--r--   0        0        0      447 2023-07-31 08:42:10.794440 mdata-0.1.3/src/mdata/core/extensions/segmentation.py
+-rw-r--r--   0        0        0      185 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/factory/__init__.py
+-rw-r--r--   0        0        0      452 2023-08-07 14:47:34.745006 mdata-0.1.3/src/mdata/core/factory/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0    17528 2023-08-08 07:04:08.029300 mdata-0.1.3/src/mdata/core/factory/__pycache__/factories.cpython-311.pyc
+-rw-r--r--   0        0        0    12330 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/factory/factories.py
+-rw-r--r--   0        0        0     7758 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/header.py
+-rw-r--r--   0        0        0     9086 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/protocols.py
+-rw-r--r--   0        0        0     5224 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/raw.py
+-rw-r--r--   0        0        0     1350 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/shared_defs.py
+-rw-r--r--   0        0        0     3403 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/core/util.py
+-rw-r--r--   0        0        0      183 2023-07-31 08:42:10.798655 mdata-0.1.3/src/mdata/file_formats/__init__.py
+-rw-r--r--   0        0        0      423 2023-05-17 09:17:42.509792 mdata-0.1.3/src/mdata/file_formats/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      485 2023-07-31 10:44:33.299658 mdata-0.1.3/src/mdata/file_formats/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0     2428 2023-06-22 07:58:14.962611 mdata-0.1.3/src/mdata/file_formats/__pycache__/io_utils.cpython-310.pyc
+-rw-r--r--   0        0        0     5129 2023-08-07 07:12:20.705254 mdata-0.1.3/src/mdata/file_formats/__pycache__/io_utils.cpython-311.pyc
+-rw-r--r--   0        0        0     2845 2023-06-22 07:58:14.975746 mdata-0.1.3/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-310.pyc
+-rw-r--r--   0        0        0     4793 2023-08-07 12:56:18.248909 mdata-0.1.3/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-311.pyc
+-rw-r--r--   0        0        0      192 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/csv/__init__.py
+-rw-r--r--   0        0        0      427 2023-05-04 14:37:18.586529 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      493 2023-08-07 10:22:20.708550 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0     4401 2023-06-22 13:59:35.522310 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/checking.cpython-310.pyc
+-rw-r--r--   0        0        0     8803 2023-08-07 13:10:40.952274 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/checking.cpython-311.pyc
+-rw-r--r--   0        0        0     3767 2023-06-22 08:30:59.383717 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/exporting.cpython-310.pyc
+-rw-r--r--   0        0        0    11755 2023-08-08 07:04:08.041231 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/exporting.cpython-311.pyc
+-rw-r--r--   0        0        0     4582 2023-06-22 10:03:20.690848 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/importing.cpython-310.pyc
+-rw-r--r--   0        0        0     8707 2023-08-07 14:47:34.918693 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/importing.cpython-311.pyc
+-rw-r--r--   0        0        0      514 2023-06-20 13:51:47.407662 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/shared.cpython-310.pyc
+-rw-r--r--   0        0        0     1134 2023-08-07 07:12:20.712233 mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/shared.cpython-311.pyc
+-rw-r--r--   0        0        0     5281 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/csv/checking.py
+-rw-r--r--   0        0        0     5718 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/csv/exporting.py
+-rw-r--r--   0        0        0     6150 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/csv/importing.py
+-rw-r--r--   0        0        0      483 2023-07-31 08:42:10.801902 mdata-0.1.3/src/mdata/file_formats/csv/shared.py
+-rw-r--r--   0        0        0      136 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/hdf/__init__.py
+-rw-r--r--   0        0        0      276 2023-04-27 12:35:59.963859 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      392 2023-08-07 10:22:21.127483 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0      536 2023-08-07 10:22:21.129855 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/checking.cpython-311.pyc
+-rw-r--r--   0        0        0     1456 2023-06-20 13:51:47.417660 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-310.pyc
+-rw-r--r--   0        0        0     4560 2023-08-07 13:10:41.040947 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-311.pyc
+-rw-r--r--   0        0        0     1079 2023-06-20 13:51:47.415663 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/importing.cpython-310.pyc
+-rw-r--r--   0        0        0     5254 2023-08-07 12:56:18.260288 mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/importing.cpython-311.pyc
+-rw-r--r--   0        0        0      190 2023-04-21 14:16:55.019498 mdata-0.1.3/src/mdata/file_formats/hdf/checking.py
+-rw-r--r--   0        0        0     2493 2023-08-08 07:06:32.852860 mdata-0.1.3/src/mdata/file_formats/hdf/exporting.py
+-rw-r--r--   0        0        0     3279 2023-08-08 07:06:32.866871 mdata-0.1.3/src/mdata/file_formats/hdf/importing.py
+-rw-r--r--   0        0        0     4829 2023-07-31 08:42:10.803833 mdata-0.1.3/src/mdata/file_formats/header_schema.json
+-rw-r--r--   0        0        0     2818 2023-07-31 08:42:10.804814 mdata-0.1.3/src/mdata/file_formats/io_utils.py
+-rw-r--r--   0        0        0     4530 2023-07-31 08:42:10.805000 mdata-0.1.3/src/mdata/file_formats/schema_template.json
+-rw-r--r--   0        0        0     2308 2023-08-08 07:06:32.866871 mdata-0.1.3/src/mdata/file_formats/validity_checking_utils.py
+-rw-r--r--   0        0        0       30 2023-08-08 07:06:32.866871 mdata-0.1.3/src/mdata/io/__init__.py
+-rw-r--r--   0        0        0      206 2023-08-07 13:10:40.851368 mdata-0.1.3/src/mdata/io/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0      155 2023-05-22 11:21:08.266604 mdata-0.1.3/src/mdata/visualization/__init__.py
+-rw-r--r--   0        0        0      355 2023-05-22 11:21:08.475981 mdata-0.1.3/src/mdata/visualization/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      413 2023-07-21 11:28:35.584583 mdata-0.1.3/src/mdata/visualization/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0        0        0     1387 2023-06-13 11:11:58.321484 mdata-0.1.3/src/mdata/visualization/__pycache__/matplot.cpython-310.pyc
+-rw-r--r--   0        0        0     2306 2023-08-07 13:51:59.097080 mdata-0.1.3/src/mdata/visualization/__pycache__/matplot.cpython-311.pyc
+-rw-r--r--   0        0        0     6665 2023-07-11 10:58:27.205279 mdata-0.1.3/src/mdata/visualization/__pycache__/plotting.cpython-310.pyc
+-rw-r--r--   0        0        0    11861 2023-08-07 13:51:59.010505 mdata-0.1.3/src/mdata/visualization/__pycache__/plotting.cpython-311.pyc
+-rw-r--r--   0        0        0     1030 2023-08-08 07:06:32.866871 mdata-0.1.3/src/mdata/visualization/matplot.py
+-rw-r--r--   0        0        0     7794 2023-08-08 07:06:32.866871 mdata-0.1.3/src/mdata/visualization/plotting.py
+-rw-r--r--   0        0        0     1007 1970-01-01 00:00:00.000000 mdata-0.1.3/PKG-INFO
```

### Comparing `mdata-0.1.2/pyproject.toml` & `mdata-0.1.3/pyproject.toml`

 * *Files 13% similar despite different names*

```diff
@@ -1,30 +1,31 @@
 [tool.poetry]
 name = "mdata"
-version = "0.1.2"
+version = "0.1.3"
 description = ""
 authors = ["Leah Tacke genannt Unterberg <leah.tgu@pads.rwth-aachen.de>"]
 readme = "README.md"
 license = "MIT"
 keywords = ["data format", "machine data"]
 exclude = ["files/", "test/"]
 
 [tool.poetry.dependencies]
-pandas = { version = "^1.5" } # after v2.0, extras = ["all"]
-python = "^3.10"
+#numpy = "^1.25"
+pandas = { version = "^2.0", extras = ["performance", "excel", "hdf5", "output_formatting", "computation", "postgresql", "clipboard"] } # after v2.0, extras = ["all"]
+python = "^3.11"
 immutabledict = "*"
 matplotlib = "*"
 seaborn = "*"
 plotly = "^5.15"
 tsdownsample = "^0.1.2"
-tables = "*"
-numba = "^0.57"
-numexpr = "*"
-bottleneck = "*"
-llvmlite = "^0.40"
+#tables = "*"
+#numba = "^0.57"
+#numexpr = "*"
+#bottleneck = "*"
+#llvmlite = "^0.40"
 
 [tool.poetry.group.dev.dependencies]
 pm4py = "^2.7.5"
 jupyter = "^1.0"
 
 [[tool.poetry.source]]
 name = "testpypi"
```

### Comparing `mdata-0.1.2/src/mdata/analysis/__pycache__/frequency.cpython-310.pyc` & `mdata-0.1.3/src/mdata/analysis/__pycache__/frequency.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/conversions/ocel/ocel_export.py` & `mdata-0.1.3/src/mdata/conversions/ocel/ocel_export.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,17 +1,19 @@
 import pandas as pd
 
-import mdata.core.machine_data_def as mdd
+from mdata.core import MachineData, MDConcepts
 from pm4py.objects.ocel.obj import OCEL, constants
 
+import mdata.core.shared_defs
 
-def create_ocel(md: mdd.MachineData):
+
+def create_ocel(md: MachineData):
     raise NotImplemented
     pd.DataFrame()
-    os = md.index_frame[mdd.MDConcepts.Object].unique()
+    os = md.index_frame[MDConcepts.Object].unique()
     for mt, tsc in md.measurement_series.items():
         i = 0
         m_obj = pd.DataFrame(tsc.df, columns=list(tsc.timeseries_spec.features))
         m_obj = m_obj.assign(**{constants.DEFAULT_OBJECT_TYPE: tsc.timeseries_spec.label, constants.DEFAULT_OBJECT_ID: i})
     for et, tsc in md.event_series.items():
         tsc.timeseries_spec.features
```

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/df_utils.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/df_utils.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/df_utils.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/df_utils.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/factory.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/importing.cpython-311.pyc`

 * *Files 26% similar despite different names*

#### Python bytecode

```diff
@@ -1,753 +1,710 @@
 magic:    0xa70d0d0a
-moddate:  0x20f9c064 (Wed Jul 26 10:44:48 2023 UTC)
-files sz: 3273
+moddate:  0xefe9d064 (Mon Aug  7 12:56:15 2023 UTC)
+files sz: 3279
 code
    argcount  : 0
    nlocals   : 0
-   stacksize : 14
-   flags     : 16777216
+   stacksize : 5
+   flags     : 0
    code
-      0x9700640064016c006d015a010100640064026c025a02640064036c036d
-      045a040100640064046c056d065a060100640064026c075a08640064056c
-      096d0a5a0a6d0b5a0b0100640064066c0c6d0d5a0d6d0e5a0e6d0f5a0f6d
-      105a106d115a116d125a126d135a136d145a146d155a156d165a16010064
-      0064076c176d185a186d195a196d1a5a1a6d1b5a1b0100640064086c1c6d
-      1d5a1d01006421640b84045a1e6421640c84045a1f64226423641384055a
-      20020065066414640965086a210000000000000000650d6a220000000000
-      0000006523650d6a2400000000000000006523650d6a2500000000000000
-      006523640f6526651b190000000000000000006905640eac15a6030000ab
-      0300000000000000005a270200650ba6000000ab00000000000000000064
-      16640e64179c036424641c84065a286425642084045a2964025300
+      0x9700640064016c005a01640064026c026d035a036d045a046d055a0501
+      00640064036c066d075a070100640064046c086d095a0901000200470064
+      0584006406650aa6030000ab0300000000000000005a0b64076504660264
+      0884045a0c64015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
-                 4 LOAD_CONST               1 (('annotations',))
-                 6 IMPORT_NAME              0 (__future__)
-                 8 IMPORT_FROM              1 (annotations)
-                10 STORE_NAME               1 (annotations)
-                12 POP_TOP
-   
-     3          14 LOAD_CONST               0 (0)
-                16 LOAD_CONST               2 (None)
-                18 IMPORT_NAME              2 (itertools)
-                20 STORE_NAME               2 (itertools)
-   
-     4          22 LOAD_CONST               0 (0)
-                24 LOAD_CONST               3 (('Iterable',))
-                26 IMPORT_NAME              3 (collections.abc)
-                28 IMPORT_FROM              4 (Iterable)
-                30 STORE_NAME               4 (Iterable)
-                32 POP_TOP
-   
-     5          34 LOAD_CONST               0 (0)
-                36 LOAD_CONST               4 (('TypedDict',))
-                38 IMPORT_NAME              5 (typing)
-                40 IMPORT_FROM              6 (TypedDict)
-                42 STORE_NAME               6 (TypedDict)
-                44 POP_TOP
-   
-     7          46 LOAD_CONST               0 (0)
-                48 LOAD_CONST               2 (None)
-                50 IMPORT_NAME              7 (pandas)
-                52 STORE_NAME               8 (pd)
-   
-     9          54 LOAD_CONST               0 (0)
-                56 LOAD_CONST               5 (('ObservationSpec', 'Meta'))
-                58 IMPORT_NAME              9 (mdata.core.header)
-                60 IMPORT_FROM             10 (ObservationSpec)
-                62 STORE_NAME              10 (ObservationSpec)
-                64 IMPORT_FROM             11 (Meta)
-                66 STORE_NAME              11 (Meta)
-                68 POP_TOP
-   
-    10          70 LOAD_CONST               0 (0)
-                72 LOAD_CONST               6 (('MDConcepts', 'TimeseriesSpecFactory', 'only_feature_columns', 'TimeseriesCollectionFactory', 'EventTimeseriesCollection', 'MachineData', 'MeasurementTimeseriesCollection', 'ObservationTypes', 'build_shared_index', 'TypedTimeseriesCollection'))
-                74 IMPORT_NAME             12 (mdata.core.machine_data_def)
-                76 IMPORT_FROM             13 (MDConcepts)
-                78 STORE_NAME              13 (MDConcepts)
-                80 IMPORT_FROM             14 (TimeseriesSpecFactory)
-                82 STORE_NAME              14 (TimeseriesSpecFactory)
-                84 IMPORT_FROM             15 (only_feature_columns)
-                86 STORE_NAME              15 (only_feature_columns)
-                88 IMPORT_FROM             16 (TimeseriesCollectionFactory)
-                90 STORE_NAME              16 (TimeseriesCollectionFactory)
-                92 IMPORT_FROM             17 (EventTimeseriesCollection)
-                94 STORE_NAME              17 (EventTimeseriesCollection)
-                96 IMPORT_FROM             18 (MachineData)
-                98 STORE_NAME              18 (MachineData)
-               100 IMPORT_FROM             19 (MeasurementTimeseriesCollection)
-               102 STORE_NAME              19 (MeasurementTimeseriesCollection)
-               104 IMPORT_FROM             20 (ObservationTypes)
-               106 STORE_NAME              20 (ObservationTypes)
-               108 IMPORT_FROM             21 (build_shared_index)
-               110 STORE_NAME              21 (build_shared_index)
-               112 IMPORT_FROM             22 (TypedTimeseriesCollection)
-               114 STORE_NAME              22 (TypedTimeseriesCollection)
-               116 POP_TOP
-   
-    13         118 LOAD_CONST               0 (0)
-               120 LOAD_CONST               7 (('create_machine_data_from_raw', 'RawHeaderSpec', 'RawDataType', 'RawMetadataFeatureSpec'))
-               122 IMPORT_NAME             23 (mdata.core.raw)
-               124 IMPORT_FROM             24 (create_machine_data_from_raw)
-               126 STORE_NAME              24 (create_machine_data_from_raw)
-               128 IMPORT_FROM             25 (RawHeaderSpec)
-               130 STORE_NAME              25 (RawHeaderSpec)
-               132 IMPORT_FROM             26 (RawDataType)
-               134 STORE_NAME              26 (RawDataType)
-               136 IMPORT_FROM             27 (RawMetadataFeatureSpec)
-               138 STORE_NAME              27 (RawMetadataFeatureSpec)
-               140 POP_TOP
-   
-    14         142 LOAD_CONST               0 (0)
-               144 LOAD_CONST               8 (('take_first',))
-               146 IMPORT_NAME             28 (mdata.core.util)
-               148 IMPORT_FROM             29 (take_first)
-               150 STORE_NAME              29 (take_first)
-               152 POP_TOP
-   
-    17         154 LOAD_CONST              33 (('df', 'pd.DataFrame'))
-               156 LOAD_CONST              11 (<code object ets_from_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 17>)
-               158 MAKE_FUNCTION            4 (annotations)
-               160 STORE_NAME              30 (ets_from_df)
-   
-    21         162 LOAD_CONST              33 (('df', 'pd.DataFrame'))
-               164 LOAD_CONST              12 (<code object mts_from_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 21>)
-               166 MAKE_FUNCTION            4 (annotations)
-               168 STORE_NAME              31 (mts_from_df)
-   
-    25         170 LOAD_CONST              34 (((), False))
-               172 LOAD_CONST              35 (('df', 'pd.DataFrame', 'specmeta', 'Iterable[RawMetadataFeatureSpec]', 'return', 'TypedTimeseriesCollection'))
-               174 LOAD_CONST              19 (<code object ts_from_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 25>)
-               176 MAKE_FUNCTION            5 (defaults, annotations)
-               178 STORE_NAME              32 (ts_from_df)
-   
-    57         180 PUSH_NULL
-               182 LOAD_NAME                6 (TypedDict)
-               184 LOAD_CONST              20 ('ObservationSeriesDef')
-   
-    58         186 LOAD_CONST               9 ('df')
-               188 LOAD_NAME                8 (pd)
-               190 LOAD_ATTR               33 (DataFrame)
-               200 LOAD_NAME               13 (MDConcepts)
-               202 LOAD_ATTR               34 (Object)
-               212 LOAD_NAME               35 (str)
-               214 LOAD_NAME               13 (MDConcepts)
-               216 LOAD_ATTR               36 (Time)
-               226 LOAD_NAME               35 (str)
-   
-    59         228 LOAD_NAME               13 (MDConcepts)
-               230 LOAD_ATTR               37 (Label)
-               240 LOAD_NAME               35 (str)
-               242 LOAD_CONST              15 ('specmeta')
-               244 LOAD_NAME               38 (list)
-               246 LOAD_NAME               27 (RawMetadataFeatureSpec)
-               248 BINARY_SUBSCR
-   
-    58         258 BUILD_MAP                5
-   
-    60         260 LOAD_CONST              14 (False)
-   
-    57         262 KW_NAMES                21
-               264 PRECALL                  3
-               268 CALL                     3
-               278 STORE_NAME              39 (ObservationSeriesDef)
-   
-    63         280 PUSH_NULL
-               282 LOAD_NAME               11 (Meta)
-               284 PRECALL                  0
-               288 CALL                     0
-               298 LOAD_CONST              22 (True)
-               300 LOAD_CONST              14 (False)
-               302 LOAD_CONST              23 (('meta', 'sort_by_time', 'copy_dfs'))
-               304 BUILD_CONST_KEY_MAP      3
-               306 LOAD_CONST              36 (('series_defs', 'ObservationSeriesDef', 'meta', 'Meta', 'return', 'MachineData'))
-               308 LOAD_CONST              28 (<code object machine_data_from_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 63>)
-               310 MAKE_FUNCTION            6 (kwdefaults, annotations)
-               312 STORE_NAME              40 (machine_data_from_series)
-   
-    78         314 LOAD_CONST              37 (('df', 'RawDataType', 'header', 'RawHeaderSpec', 'return', 'MachineData'))
-               316 LOAD_CONST              32 (<code object machine_data_from_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 78>)
-               318 MAKE_FUNCTION            4 (annotations)
-               320 STORE_NAME              41 (machine_data_from_df)
-               322 LOAD_CONST               2 (None)
-               324 RETURN_VALUE
+                 4 LOAD_CONST               1 (None)
+                 6 IMPORT_NAME              0 (pandas)
+                 8 STORE_NAME               1 (pd)
+   
+     3          10 LOAD_CONST               0 (0)
+                12 LOAD_CONST               2 (('MDConcepts', 'MachineData', 'ObservationTypes'))
+                14 IMPORT_NAME              2 (mdata.core)
+                16 IMPORT_FROM              3 (MDConcepts)
+                18 STORE_NAME               3 (MDConcepts)
+                20 IMPORT_FROM              4 (MachineData)
+                22 STORE_NAME               4 (MachineData)
+                24 IMPORT_FROM              5 (ObservationTypes)
+                26 STORE_NAME               5 (ObservationTypes)
+                28 POP_TOP
+   
+     4          30 LOAD_CONST               0 (0)
+                32 LOAD_CONST               3 (('Meta',))
+                34 IMPORT_NAME              6 (mdata.core.header)
+                36 IMPORT_FROM              7 (Meta)
+                38 STORE_NAME               7 (Meta)
+                40 POP_TOP
+   
+     5          42 LOAD_CONST               0 (0)
+                44 LOAD_CONST               4 (('RawMetadataFeatureSpec',))
+                46 IMPORT_NAME              8 (mdata.core.raw)
+                48 IMPORT_FROM              9 (RawMetadataFeatureSpec)
+                50 STORE_NAME               9 (RawMetadataFeatureSpec)
+                52 POP_TOP
+   
+     8          54 PUSH_NULL
+                56 LOAD_BUILD_CLASS
+                58 LOAD_CONST               5 (<code object InvalidHeaderException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\importing.py", line 8>)
+                60 MAKE_FUNCTION            0
+                62 LOAD_CONST               6 ('InvalidHeaderException')
+                64 LOAD_NAME               10 (Exception)
+                66 PRECALL                  3
+                70 CALL                     3
+                80 STORE_NAME              11 (InvalidHeaderException)
+   
+    12          82 LOAD_CONST               7 ('return')
+                84 LOAD_NAME                4 (MachineData)
+                86 BUILD_TUPLE              2
+                88 LOAD_CONST               8 (<code object read_machine_data_h5, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\importing.py", line 12>)
+                90 MAKE_FUNCTION            4 (annotations)
+                92 STORE_NAME              12 (read_machine_data_h5)
+                94 LOAD_CONST               1 (None)
+                96 RETURN_VALUE
    consts
       0
-      ('annotations',)
       None
-      ('Iterable',)
-      ('TypedDict',)
-      ('ObservationSpec', 'Meta')
-      ('MDConcepts', 'TimeseriesSpecFactory', 'only_feature_columns', 'TimeseriesCollectionFactory', 'EventTimeseriesCollection', 'MachineData', 'MeasurementTimeseriesCollection', 'ObservationTypes', 'build_shared_index', 'TypedTimeseriesCollection')
-      ('create_machine_data_from_raw', 'RawHeaderSpec', 'RawDataType', 'RawMetadataFeatureSpec')
-      ('take_first',)
-      'df'
-      'pd.DataFrame'
-      code
-         argcount  : 1
-         nlocals   : 2
-         stacksize : 5
-         flags     : 16777227
-         code
-            0x97007401000000000000000000007c0066016401740200000000000000
-            0000006a02000000000000000069017c01a4018e015300
-          17           0 RESUME                   0
-         
-          18           2 LOAD_GLOBAL              1 (NULL + ts_from_df)
-                      14 LOAD_FAST                0 (df)
-                      16 BUILD_TUPLE              1
-                      18 LOAD_CONST               1 ('type')
-                      20 LOAD_GLOBAL              2 (ObservationTypes)
-                      32 LOAD_ATTR                2 (E)
-                      42 BUILD_MAP                1
-                      44 LOAD_FAST                1 (kwargs)
-                      46 DICT_MERGE               1
-                      48 CALL_FUNCTION_EX         1
-                      50 RETURN_VALUE
-         consts
-            None
-            'type'
-         names      ('ts_from_df', 'ObservationTypes', 'E')
-         varnames   ('df', 'kwargs')
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-         name       'ets_from_df'
-         firstlineno 17
-         lnotab 0x0201
+      ('MDConcepts', 'MachineData', 'ObservationTypes')
+      ('Meta',)
+      ('RawMetadataFeatureSpec',)
       code
-         argcount  : 1
-         nlocals   : 2
-         stacksize : 5
-         flags     : 16777227
-         code
-            0x97007401000000000000000000007c0066016401740200000000000000
-            0000006a02000000000000000069017c01a4018e015300
-          21           0 RESUME                   0
-         
-          22           2 LOAD_GLOBAL              1 (NULL + ts_from_df)
-                      14 LOAD_FAST                0 (df)
-                      16 BUILD_TUPLE              1
-                      18 LOAD_CONST               1 ('type')
-                      20 LOAD_GLOBAL              2 (ObservationTypes)
-                      32 LOAD_ATTR                2 (M)
-                      42 BUILD_MAP                1
-                      44 LOAD_FAST                1 (kwargs)
-                      46 DICT_MERGE               1
-                      48 CALL_FUNCTION_EX         1
-                      50 RETURN_VALUE
+         argcount  : 0
+         nlocals   : 0
+         stacksize : 1
+         flags     : 0
+         code 0x970065005a0164005a0264015300
+           8           0 RESUME                   0
+                       2 LOAD_NAME                0 (__name__)
+                       4 STORE_NAME               1 (__module__)
+                       6 LOAD_CONST               0 ('InvalidHeaderException')
+                       8 STORE_NAME               2 (__qualname__)
+                      10 LOAD_CONST               1 (None)
+                      12 RETURN_VALUE
          consts
+            'InvalidHeaderException'
             None
-            'type'
-         names      ('ts_from_df', 'ObservationTypes', 'M')
-         varnames   ('df', 'kwargs')
+         names      ('__name__', '__module__', '__qualname__')
+         varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-         name       'mts_from_df'
-         firstlineno 21
-         lnotab 0x0201
-      ()
-      False
-      'specmeta'
-      'Iterable[RawMetadataFeatureSpec]'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
+         name       'InvalidHeaderException'
+         firstlineno 8
+         lnotab 0x
+      'InvalidHeaderException'
       'return'
-      'TypedTimeseriesCollection'
       code
-         argcount  : 3
+         argcount  : 1
          nlocals   : 13
          stacksize : 7
-         flags     : 16777227
+         flags     : 3
          code
-            0x87008701870397007c0272148900a00000000000000000000000000000
-            00000000000000a6000000ab0000000000000000006e0189008a00880088
-            036602640184087d047402000000000000000000006a0200000000000000
-            0089037600725289037402000000000000000000006a0200000000000000
-            00190000000000000000007d057c0564026b0200000000723a640364046c
-            036d047d0601008900a00500000000000000000000000000000000000000
-            0064037402000000000000000000006a0200000000000000007c06a00600
-            000000000000000000000000000000000000008900a6010000ab01000000
-            0000000000a6030000ab030000000000000000010002007c047402000000
-            000000000000006a0700000000000000006405a6020000ab020000000000
-            0000007d0702007c047402000000000000000000006a0800000000000000
-            006406a6020000ab0200000000000000007d0802007c0474020000000000
-            00000000006a0900000000000000006407a6020000ab0200000000000000
-            007d097415000000000000000000006a0b00000000000000007c08a60100
-            00ab0100000000000000007d0a74190000000000000000000089006a0d00
-            00000000000000a6010000ab0100000000000000007d0b64088400890144
-            00a6000000ab0000000000000000008a0102007c0a7c09741d0000000000
-            00000000006a0f000000000000000088016601640984087c0b4400a60000
-            00ab000000000000000000a6010000ab010000000000000000a6020000ab
-            0200000000000000007d0c02007421000000000000000000006a0b000000
-            00000000007c0ca6010000ab0100000000000000008900a6010000ab0100
-            000000000000005300
-                       0 MAKE_CELL                0 (df)
-                       2 MAKE_CELL                1 (specmeta)
-                       4 MAKE_CELL                3 (kwargs)
-         
-          25           6 RESUME                   0
-         
-          27           8 LOAD_FAST                2 (copy)
-                      10 POP_JUMP_FORWARD_IF_FALSE    20 (to 52)
-                      12 LOAD_DEREF               0 (df)
-                      14 LOAD_METHOD              0 (copy)
-                      36 PRECALL                  0
-                      40 CALL                     0
-                      50 JUMP_FORWARD             1 (to 54)
-                 >>   52 LOAD_DEREF               0 (df)
-                 >>   54 STORE_DEREF              0 (df)
-         
-          29          56 LOAD_CLOSURE             0 (df)
-                      58 LOAD_CLOSURE             3 (kwargs)
-                      60 BUILD_TUPLE              2
-                      62 LOAD_CONST               1 (<code object match_spec_and_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 29>)
-                      64 MAKE_FUNCTION            8 (closure)
-                      66 STORE_FAST               4 (match_spec_and_df)
-         
-          40          68 LOAD_GLOBAL              2 (MDConcepts)
-                      80 LOAD_ATTR                2 (Time)
-                      90 LOAD_DEREF               3 (kwargs)
-                      92 CONTAINS_OP              0
-                      94 POP_JUMP_FORWARD_IF_FALSE    82 (to 260)
-         
-          41          96 LOAD_DEREF               3 (kwargs)
-                      98 LOAD_GLOBAL              2 (MDConcepts)
-                     110 LOAD_ATTR                2 (Time)
-                     120 BINARY_SUBSCR
-                     130 STORE_FAST               5 (spec_time)
-         
-          42         132 LOAD_FAST                5 (spec_time)
-                     134 LOAD_CONST               2 ('artificial')
-                     136 COMPARE_OP               2 (==)
-                     142 POP_JUMP_FORWARD_IF_FALSE    58 (to 260)
-         
-          43         144 LOAD_CONST               3 (0)
-                     146 LOAD_CONST               4 (('df_utils',))
-                     148 IMPORT_NAME              3 (mdata.core)
-                     150 IMPORT_FROM              4 (df_utils)
-                     152 STORE_FAST               6 (df_utils)
-                     154 POP_TOP
-         
-          44         156 LOAD_DEREF               0 (df)
-                     158 LOAD_METHOD              5 (insert)
-                     180 LOAD_CONST               3 (0)
-                     182 LOAD_GLOBAL              2 (MDConcepts)
-                     194 LOAD_ATTR                2 (Time)
-                     204 LOAD_FAST                6 (df_utils)
-                     206 LOAD_METHOD              6 (create_artificial_daterange)
-                     228 LOAD_DEREF               0 (df)
-                     230 PRECALL                  1
-                     234 CALL                     1
-                     244 PRECALL                  3
-                     248 CALL                     3
-                     258 POP_TOP
-         
-          45     >>  260 PUSH_NULL
-                     262 LOAD_FAST                4 (match_spec_and_df)
-                     264 LOAD_GLOBAL              2 (MDConcepts)
-                     276 LOAD_ATTR                7 (Object)
-                     286 LOAD_CONST               5 (1)
-                     288 PRECALL                  2
-                     292 CALL                     2
-                     302 STORE_FAST               7 (spec_object)
-         
-          46         304 PUSH_NULL
-                     306 LOAD_FAST                4 (match_spec_and_df)
-                     308 LOAD_GLOBAL              2 (MDConcepts)
-                     320 LOAD_ATTR                8 (Type)
-                     330 LOAD_CONST               6 (2)
-                     332 PRECALL                  2
-                     336 CALL                     2
-                     346 STORE_FAST               8 (spec_type)
-         
-          47         348 PUSH_NULL
-                     350 LOAD_FAST                4 (match_spec_and_df)
-                     352 LOAD_GLOBAL              2 (MDConcepts)
-                     364 LOAD_ATTR                9 (Label)
-                     374 LOAD_CONST               7 (3)
-                     376 PRECALL                  2
-                     380 CALL                     2
-                     390 STORE_FAST               9 (spec_label)
-         
-          49         392 LOAD_GLOBAL             21 (NULL + TimeseriesSpecFactory)
-                     404 LOAD_ATTR               11 (for_type)
-                     414 LOAD_FAST                8 (spec_type)
-                     416 PRECALL                  1
-                     420 CALL                     1
-                     430 STORE_FAST              10 (tspec_cls)
-         
-          50         432 LOAD_GLOBAL             25 (NULL + only_feature_columns)
-                     444 LOAD_DEREF               0 (df)
-                     446 LOAD_ATTR               13 (columns)
-                     456 PRECALL                  1
-                     460 CALL                     1
-                     470 STORE_FAST              11 (features)
-         
-          52         472 LOAD_CONST               8 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 52>)
-                     474 MAKE_FUNCTION            0
-                     476 LOAD_DEREF               1 (specmeta)
-                     478 GET_ITER
-                     480 PRECALL                  0
-                     484 CALL                     0
-                     494 STORE_DEREF              1 (specmeta)
-         
-          53         496 PUSH_NULL
-                     498 LOAD_FAST               10 (tspec_cls)
-                     500 LOAD_FAST                9 (spec_label)
-                     502 LOAD_GLOBAL             29 (NULL + ObservationSpec)
-                     514 LOAD_ATTR               15 (from_raw)
-                     524 LOAD_CLOSURE             1 (specmeta)
-                     526 BUILD_TUPLE              1
-                     528 LOAD_CONST               9 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\factory.py", line 53>)
-                     530 MAKE_FUNCTION            8 (closure)
-                     532 LOAD_FAST               11 (features)
-                     534 GET_ITER
-                     536 PRECALL                  0
-                     540 CALL                     0
-                     550 PRECALL                  1
-                     554 CALL                     1
-                     564 PRECALL                  2
-                     568 CALL                     2
-                     578 STORE_FAST              12 (tt)
-         
-          54         580 PUSH_NULL
-                     582 LOAD_GLOBAL             33 (NULL + TimeseriesCollectionFactory)
-                     594 LOAD_ATTR               11 (for_type)
-                     604 LOAD_FAST               12 (tt)
-                     606 PRECALL                  1
-                     610 CALL                     1
-                     620 LOAD_DEREF               0 (df)
-                     622 PRECALL                  1
-                     626 CALL                     1
-                     636 RETURN_VALUE
+            0x870d870e870f871087118712871387149700640164026c006d017d0101
+            007405000000000000000000006a0300000000000000007c006403ac04a6
+            020000ab02000000000000000035008a13670067007d037d027409000000
+            000000000000008913a00500000000000000000000000000000000000000
+            006405a6010000ab010000000000000000a6010000ab0100000000000000
+            006406190000000000000000008a10740d00000000000000000000a60000
+            00ab0000000000000000007d0464078a148913a007000000000000000000
+            00000000000000000000006408a6010000ab010000000000000000812674
+            0d000000000000000000008913a008000000000000000000000000000000
+            00000000006408a6010000ab010000000000000000a6010000ab01000000
+            00000000007d0464097c0476008a1469007d058914725e8913a007000000
+            0000000000000000000000000000000000640aa6010000ab010000000000
+            00000081498913a008000000000000000000000000000000000000000064
+            0aa6010000ab0100000000000000007d067c06a009000000000000000000
+            0000000000000000000000a6000000ab00000000000000000044005d1f5c
+            0200007d077d087c08640b190000000000000000007d097c097c05741500
+            0000000000000000007c07a6010000ab0100000000000000003c0000008c
+            20891472428913a007000000000000000000000000000000000000000064
+            0ca6010000ab010000000000000000812d8913a008000000000000000000
+            0000000000000000000000640ca6010000ab0100000000000000008a1264
+            0d7416000000000000000000007418000000000000000000001900000000
+            0000000000660288126601640e840c8a0e741b000000000000000000006a
+            0e00000000000000007c047c05a6020000ab0200000000000000007d0a02
+            007c017c0a6a0f0000000000000000a6010000ab0100000000000000008a
+            0d880d880e881388146604640f84088a0f67008a11880f88108811881366
+            04641084087d0b02007c0b64117420000000000000000000006a11000000
+            0000000000a6020000ab020000000000000000010002007c0b6412742000
+            0000000000000000006a120000000000000000a6020000ab020000000000
+            00000001008913a008000000000000000000000000000000000000000064
+            13a6010000ab0100000000000000007d0c890da013000000000000000000
+            00000000000000000000007c0a7c037c027c0cac14a6040000ab04000000
+            00000000006302640064006400a6020000ab020000000000000000010053
+            002300310073047702780359007701010059000100010064005300
+                       0 MAKE_CELL               13 (factory)
+                       2 MAKE_CELL               14 (get_meta)
+                       4 MAKE_CELL               15 (make_series_cont)
+                       6 MAKE_CELL               16 (rel_groups)
+                       8 MAKE_CELL               17 (series_containers)
+                      10 MAKE_CELL               18 (spec_extra_metadata)
+                      12 MAKE_CELL               19 (store)
+                      14 MAKE_CELL               20 (use_metadata)
+         
+          12          16 RESUME                   0
+         
+          14          18 LOAD_CONST               1 (0)
+                      20 LOAD_CONST               2 (('get_factory',))
+                      22 IMPORT_NAME              0 (mdata.core.factory)
+                      24 IMPORT_FROM              1 (get_factory)
+                      26 STORE_FAST               1 (get_factory)
+                      28 POP_TOP
+         
+          16          30 LOAD_GLOBAL              5 (NULL + pd)
+                      42 LOAD_ATTR                3 (HDFStore)
+                      52 LOAD_FAST                0 (filename)
+                      54 LOAD_CONST               3 ('r')
+                      56 KW_NAMES                 4
+                      58 PRECALL                  2
+                      62 CALL                     2
+                      72 BEFORE_WITH
+                      74 STORE_DEREF             19 (store)
+         
+          17          76 BUILD_LIST               0
+                      78 BUILD_LIST               0
+                      80 STORE_FAST               3 (events)
+                      82 STORE_FAST               2 (measurements)
+         
+          18          84 LOAD_GLOBAL              9 (NULL + next)
+                      96 LOAD_DEREF              19 (store)
+                      98 LOAD_METHOD              5 (walk)
+                     120 LOAD_CONST               5 ('/')
+                     122 PRECALL                  1
+                     126 CALL                     1
+                     136 PRECALL                  1
+                     140 CALL                     1
+                     150 LOAD_CONST               6 (1)
+                     152 BINARY_SUBSCR
+                     162 STORE_DEREF             16 (rel_groups)
+         
+          20         164 LOAD_GLOBAL             13 (NULL + set)
+                     176 PRECALL                  0
+                     180 CALL                     0
+                     190 STORE_FAST               4 (extensions)
+         
+          21         192 LOAD_CONST               7 (False)
+                     194 STORE_DEREF             20 (use_metadata)
+         
+          22         196 LOAD_DEREF              19 (store)
+                     198 LOAD_METHOD              7 (get_node)
+                     220 LOAD_CONST               8 ('meta/extensions')
+                     222 PRECALL                  1
+                     226 CALL                     1
+                     236 POP_JUMP_FORWARD_IF_NONE    38 (to 314)
+         
+          23         238 LOAD_GLOBAL             13 (NULL + set)
+                     250 LOAD_DEREF              19 (store)
+                     252 LOAD_METHOD              8 (get)
+                     274 LOAD_CONST               8 ('meta/extensions')
+                     276 PRECALL                  1
+                     280 CALL                     1
+                     290 PRECALL                  1
+                     294 CALL                     1
+                     304 STORE_FAST               4 (extensions)
+         
+          24         306 LOAD_CONST               9 ('metadata')
+                     308 LOAD_FAST                4 (extensions)
+                     310 CONTAINS_OP              0
+                     312 STORE_DEREF             20 (use_metadata)
+         
+          26     >>  314 BUILD_MAP                0
+                     316 STORE_FAST               5 (metadata)
+         
+          27         318 LOAD_DEREF              20 (use_metadata)
+                     320 POP_JUMP_FORWARD_IF_FALSE    94 (to 510)
+                     322 LOAD_DEREF              19 (store)
+                     324 LOAD_METHOD              7 (get_node)
+                     346 LOAD_CONST              10 ('meta/metadata')
+                     348 PRECALL                  1
+                     352 CALL                     1
+                     362 POP_JUMP_FORWARD_IF_NONE    73 (to 510)
+         
+          28         364 LOAD_DEREF              19 (store)
+                     366 LOAD_METHOD              8 (get)
+                     388 LOAD_CONST              10 ('meta/metadata')
+                     390 PRECALL                  1
+                     394 CALL                     1
+                     404 STORE_FAST               6 (metadata_df)
+         
+          29         406 LOAD_FAST                6 (metadata_df)
+                     408 LOAD_METHOD              9 (iterrows)
+                     430 PRECALL                  0
+                     434 CALL                     0
+                     444 GET_ITER
+                 >>  446 FOR_ITER                31 (to 510)
+                     448 UNPACK_SEQUENCE          2
+                     452 STORE_FAST               7 (key)
+                     454 STORE_FAST               8 (row)
+         
+          30         456 LOAD_FAST                8 (row)
+                     458 LOAD_CONST              11 ('value')
+                     460 BINARY_SUBSCR
+                     470 STORE_FAST               9 (value)
+         
+          31         472 LOAD_FAST                9 (value)
+                     474 LOAD_FAST                5 (metadata)
+                     476 LOAD_GLOBAL             21 (NULL + str)
+                     488 LOAD_FAST                7 (key)
+                     490 PRECALL                  1
+                     494 CALL                     1
+                     504 STORE_SUBSCR
+                     508 JUMP_BACKWARD           32 (to 446)
+         
+          33     >>  510 LOAD_DEREF              20 (use_metadata)
+                     512 POP_JUMP_FORWARD_IF_FALSE    66 (to 646)
+                     514 LOAD_DEREF              19 (store)
+                     516 LOAD_METHOD              7 (get_node)
+                     538 LOAD_CONST              12 ('meta/specs')
+                     540 PRECALL                  1
+                     544 CALL                     1
+                     554 POP_JUMP_FORWARD_IF_NONE    45 (to 646)
+         
+          34         556 LOAD_DEREF              19 (store)
+                     558 LOAD_METHOD              8 (get)
+                     580 LOAD_CONST              12 ('meta/specs')
+                     582 PRECALL                  1
+                     586 CALL                     1
+                     596 STORE_DEREF             18 (spec_extra_metadata)
+         
+          36         598 LOAD_CONST              13 ('return')
+                     600 LOAD_GLOBAL             22 (list)
+                     612 LOAD_GLOBAL             24 (RawMetadataFeatureSpec)
+                     624 BINARY_SUBSCR
+                     634 BUILD_TUPLE              2
+                     636 LOAD_CLOSURE            18 (spec_extra_metadata)
+                     638 BUILD_TUPLE              1
+                     640 LOAD_CONST              14 (<code object get_meta, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\importing.py", line 36>)
+                     642 MAKE_FUNCTION           12 (annotations, closure)
+                     644 STORE_DEREF             14 (get_meta)
+         
+          51     >>  646 LOAD_GLOBAL             27 (NULL + Meta)
+                     658 LOAD_ATTR               14 (of)
+                     668 LOAD_FAST                4 (extensions)
+                     670 LOAD_FAST                5 (metadata)
+                     672 PRECALL                  2
+                     676 CALL                     2
+                     686 STORE_FAST              10 (meta)
+         
+          53         688 PUSH_NULL
+                     690 LOAD_FAST                1 (get_factory)
+                     692 LOAD_FAST               10 (meta)
+                     694 LOAD_ATTR               15 (extensions)
+                     704 PRECALL                  1
+                     708 CALL                     1
+                     718 STORE_DEREF             13 (factory)
+         
+          55         720 LOAD_CLOSURE            13 (factory)
+                     722 LOAD_CLOSURE            14 (get_meta)
+                     724 LOAD_CLOSURE            19 (store)
+                     726 LOAD_CLOSURE            20 (use_metadata)
+                     728 BUILD_TUPLE              4
+                     730 LOAD_CONST              15 (<code object make_series_cont, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\importing.py", line 55>)
+                     732 MAKE_FUNCTION            8 (closure)
+                     734 STORE_DEREF             15 (make_series_cont)
+         
+          62         736 BUILD_LIST               0
+                     738 STORE_DEREF             17 (series_containers)
+         
+          64         740 LOAD_CLOSURE            15 (make_series_cont)
+                     742 LOAD_CLOSURE            16 (rel_groups)
+                     744 LOAD_CLOSURE            17 (series_containers)
+                     746 LOAD_CLOSURE            19 (store)
+                     748 BUILD_TUPLE              4
+                     750 LOAD_CONST              16 (<code object add_series_containers, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\importing.py", line 64>)
+                     752 MAKE_FUNCTION            8 (closure)
+                     754 STORE_FAST              11 (add_series_containers)
+         
+          70         756 PUSH_NULL
+                     758 LOAD_FAST               11 (add_series_containers)
+                     760 LOAD_CONST              17 ('events')
+                     762 LOAD_GLOBAL             32 (ObservationTypes)
+                     774 LOAD_ATTR               17 (E)
+                     784 PRECALL                  2
+                     788 CALL                     2
+                     798 POP_TOP
+         
+          71         800 PUSH_NULL
+                     802 LOAD_FAST               11 (add_series_containers)
+                     804 LOAD_CONST              18 ('measurements')
+                     806 LOAD_GLOBAL             32 (ObservationTypes)
+                     818 LOAD_ATTR               18 (M)
+                     828 PRECALL                  2
+                     832 CALL                     2
+                     842 POP_TOP
+         
+          73         844 LOAD_DEREF              19 (store)
+                     846 LOAD_METHOD              8 (get)
+                     868 LOAD_CONST              19 ('index')
+                     870 PRECALL                  1
+                     874 CALL                     1
+                     884 STORE_FAST              12 (index_frame)
+         
+          75         886 LOAD_DEREF              13 (factory)
+                     888 LOAD_METHOD             19 (make)
+                     910 LOAD_FAST               10 (meta)
+                     912 LOAD_FAST                3 (events)
+                     914 LOAD_FAST                2 (measurements)
+                     916 LOAD_FAST               12 (index_frame)
+                     918 KW_NAMES                20
+                     920 PRECALL                  4
+                     924 CALL                     4
+         
+          16         934 SWAP                     2
+                     936 LOAD_CONST               0 (None)
+                     938 LOAD_CONST               0 (None)
+                     940 LOAD_CONST               0 (None)
+                     942 PRECALL                  2
+                     946 CALL                     2
+                     956 POP_TOP
+                     958 RETURN_VALUE
+                 >>  960 PUSH_EXC_INFO
+                     962 WITH_EXCEPT_START
+                     964 POP_JUMP_FORWARD_IF_TRUE     4 (to 974)
+                     966 RERAISE                  2
+                 >>  968 COPY                     3
+                     970 POP_EXCEPT
+                     972 RERAISE                  1
+                 >>  974 POP_TOP
+                     976 POP_EXCEPT
+                     978 POP_TOP
+                     980 POP_TOP
+                     982 LOAD_CONST               0 (None)
+                     984 RETURN_VALUE
+         ExceptionTable:
+           74 to 932 -> 960 [1] lasti
+           960 to 966 -> 968 [3] lasti
+           974 to 974 -> 968 [3] lasti
          consts
             None
+            0
+            ('get_factory',)
+            'r'
+            ('mode',)
+            '/'
+            1
+            False
+            'meta/extensions'
+            'metadata'
+            'meta/metadata'
+            'value'
+            'meta/specs'
+            'return'
             code
                argcount  : 2
-               nlocals   : 4
-               stacksize : 5
-               flags     : 16777235
+               nlocals   : 9
+               stacksize : 9
+               flags     : 19
                code
-                  0x950297008905a00000000000000000000000000000000000000000007c
-                  00a6010000ab0100000000000000007d027c0089046a0100000000000000
-                  007601721c7c0280024a0082018904a00200000000000000000000000000
-                  000000000000007c017c007c02a6030000ab03000000000000000001006e
-                  1f89046a0300000000000000006401190000000000000000007c00190000
-                  000000000000007d037c0281087c027c036b020000000073024a0082017c
-                  037d027c025300
-                             0 COPY_FREE_VARS           2
-               
-                29           2 RESUME                   0
-               
-                30           4 LOAD_DEREF               5 (kwargs)
-                             6 LOAD_METHOD              0 (get)
-                            28 LOAD_FAST                0 (concept)
-                            30 PRECALL                  1
-                            34 CALL                     1
-                            44 STORE_FAST               2 (spec)
-               
-                31          46 LOAD_FAST                0 (concept)
-                            48 LOAD_DEREF               4 (df)
-                            50 LOAD_ATTR                1 (columns)
-                            60 CONTAINS_OP              1
-                            62 POP_JUMP_FORWARD_IF_FALSE    28 (to 120)
-               
-                32          64 LOAD_FAST                2 (spec)
-                            66 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 72)
-                            68 LOAD_ASSERTION_ERROR
-                            70 RAISE_VARARGS            1
-               
-                33     >>   72 LOAD_DEREF               4 (df)
-                            74 LOAD_METHOD              2 (insert)
-                            96 LOAD_FAST                1 (col_idx)
-                            98 LOAD_FAST                0 (concept)
-                           100 LOAD_FAST                2 (spec)
-                           102 PRECALL                  3
-                           106 CALL                     3
-                           116 POP_TOP
-                           118 JUMP_FORWARD            31 (to 182)
-               
-                35     >>  120 LOAD_DEREF               4 (df)
-                           122 LOAD_ATTR                3 (iloc)
-                           132 LOAD_CONST               1 (0)
-                           134 BINARY_SUBSCR
-                           144 LOAD_FAST                0 (concept)
-                           146 BINARY_SUBSCR
-                           156 STORE_FAST               3 (df_type)
-               
-                36         158 LOAD_FAST                2 (spec)
-                           160 POP_JUMP_FORWARD_IF_NONE     8 (to 178)
-                           162 LOAD_FAST                2 (spec)
-                           164 LOAD_FAST                3 (df_type)
-                           166 COMPARE_OP               2 (==)
-                           172 POP_JUMP_FORWARD_IF_TRUE     2 (to 178)
-                           174 LOAD_ASSERTION_ERROR
-                           176 RAISE_VARARGS            1
+                  0x9501970089096a00000000000000000089097402000000000000000000
+                  006a020000000000000000190000000000000000007c006b020000000089
+                  097402000000000000000000006a03000000000000000019000000000000
+                  0000007c016b02000000007a01000067006401a201660219000000000000
+                  0000007d0267007d037c02a0040000000000000000000000000000000000
+                  0000006402a6010000ab0100000000000000006a050000000000000000a0
+                  060000000000000000000000000000000000000000a6000000ab00000000
+                  000000000044005d775c0200007d047d057c026a0000000000000000007c
+                  0519000000000000000000640364046702190000000000000000007d0674
+                  0f000000000000000000007c06a6010000ab01000000000000000064056b
+                  0300000000721374110000000000000000000064067c049b0064079d03a6
+                  010000ab01000000000000000082017c066a090000000000000000640819
+                  0000000000000000005c0200007d077d087c03a00a000000000000000000
+                  00000000000000000000007417000000000000000000007c047c077c0864
+                  099c026901a6010000ab010000000000000000a6010000ab010000000000
+                  00000001008c787c035300
+                             0 COPY_FREE_VARS           1
+               
+                36           2 RESUME                   0
+               
+                37           4 LOAD_DEREF               9 (spec_extra_metadata)
+                             6 LOAD_ATTR                0 (loc)
+               
+                38          16 LOAD_DEREF               9 (spec_extra_metadata)
+                            18 LOAD_GLOBAL              2 (MDConcepts)
+                            30 LOAD_ATTR                2 (Type)
+                            40 BINARY_SUBSCR
+                            50 LOAD_FAST                0 (t)
+                            52 COMPARE_OP               2 (==)
+               
+                39          58 LOAD_DEREF               9 (spec_extra_metadata)
+                            60 LOAD_GLOBAL              2 (MDConcepts)
+                            72 LOAD_ATTR                3 (Label)
+                            82 BINARY_SUBSCR
+                            92 LOAD_FAST                1 (label)
+                            94 COMPARE_OP               2 (==)
+               
+                38         100 BINARY_OP                1 (&)
+               
+                39         104 BUILD_LIST               0
+                           106 LOAD_CONST               1 (('feature', 'print_name', 'data_type'))
+                           108 LIST_EXTEND              1
                
-                37     >>  178 LOAD_FAST                3 (df_type)
-                           180 STORE_FAST               2 (spec)
+                38         110 BUILD_TUPLE              2
                
-                38     >>  182 LOAD_FAST                2 (spec)
-                           184 RETURN_VALUE
+                37         112 BINARY_SUBSCR
+                           122 STORE_FAST               2 (results)
+               
+                42         124 BUILD_LIST               0
+                           126 STORE_FAST               3 (specs)
+               
+                43         128 LOAD_FAST                2 (results)
+                           130 LOAD_METHOD              4 (groupby)
+                           152 LOAD_CONST               2 ('feature')
+                           154 PRECALL                  1
+                           158 CALL                     1
+                           168 LOAD_ATTR                5 (groups)
+                           178 LOAD_METHOD              6 (items)
+                           200 PRECALL                  0
+                           204 CALL                     0
+                           214 GET_ITER
+                       >>  216 FOR_ITER               119 (to 456)
+                           218 UNPACK_SEQUENCE          2
+                           222 STORE_FAST               4 (f)
+                           224 STORE_FAST               5 (idx)
+               
+                44         226 LOAD_FAST                2 (results)
+                           228 LOAD_ATTR                0 (loc)
+                           238 LOAD_FAST                5 (idx)
+                           240 BINARY_SUBSCR
+                           250 LOAD_CONST               3 ('print_name')
+                           252 LOAD_CONST               4 ('data_type')
+                           254 BUILD_LIST               2
+                           256 BINARY_SUBSCR
+                           266 STORE_FAST               6 (g)
+               
+                45         268 LOAD_GLOBAL             15 (NULL + len)
+                           280 LOAD_FAST                6 (g)
+                           282 PRECALL                  1
+                           286 CALL                     1
+                           296 LOAD_CONST               5 (1)
+                           298 COMPARE_OP               3 (!=)
+                           304 POP_JUMP_FORWARD_IF_FALSE    19 (to 344)
+               
+                46         306 LOAD_GLOBAL             17 (NULL + InvalidHeaderException)
+                           318 LOAD_CONST               6 ('Duplicate feature metadata for ')
+                           320 LOAD_FAST                4 (f)
+                           322 FORMAT_VALUE             0
+                           324 LOAD_CONST               7 ('.')
+                           326 BUILD_STRING             3
+                           328 PRECALL                  1
+                           332 CALL                     1
+                           342 RAISE_VARARGS            1
+               
+                47     >>  344 LOAD_FAST                6 (g)
+                           346 LOAD_ATTR                9 (iloc)
+                           356 LOAD_CONST               8 (0)
+                           358 BINARY_SUBSCR
+                           368 UNPACK_SEQUENCE          2
+                           372 STORE_FAST               7 (pn)
+                           374 STORE_FAST               8 (dt)
+               
+                48         376 LOAD_FAST                3 (specs)
+                           378 LOAD_METHOD             10 (append)
+                           400 LOAD_GLOBAL             23 (NULL + RawMetadataFeatureSpec)
+                           412 LOAD_FAST                4 (f)
+                           414 LOAD_FAST                7 (pn)
+                           416 LOAD_FAST                8 (dt)
+                           418 LOAD_CONST               9 (('print_name', 'data_type'))
+                           420 BUILD_CONST_KEY_MAP      2
+                           422 BUILD_MAP                1
+                           424 PRECALL                  1
+                           428 CALL                     1
+                           438 PRECALL                  1
+                           442 CALL                     1
+                           452 POP_TOP
+                           454 JUMP_BACKWARD          120 (to 216)
+               
+                49     >>  456 LOAD_FAST                3 (specs)
+                           458 RETURN_VALUE
                consts
                   None
+                  ('feature', 'print_name', 'data_type')
+                  'feature'
+                  'print_name'
+                  'data_type'
+                  1
+                  'Duplicate feature metadata for '
+                  '.'
                   0
-               names      ('get', 'columns', 'insert', 'iloc')
-               varnames   ('concept', 'col_idx', 'spec', 'df_type')
-               freevars   ('df', 'kwargs')
+                  ('print_name', 'data_type')
+               names      ('loc', 'MDConcepts', 'Type', 'Label', 'groupby', 'groups', 'items', 'len', 'InvalidHeaderException', 'iloc', 'append', 'RawMetadataFeatureSpec')
+               varnames   ('t', 'label', 'results', 'specs', 'f', 'idx', 'g', 'pn', 'dt')
+               freevars   ('spec_extra_metadata',)
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-               name       'match_spec_and_df'
-               firstlineno 29
-               lnotab 0x04012a01120108013002260114010401
-            'artificial'
-            0
-            ('df_utils',)
-            1
-            2
-            3
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
+               name       'get_meta'
+               firstlineno 36
+               lnotab
+                  0x04010c012a012aff040106ff02ff0c05040162012a0126012601200150
+                  01
             code
-               argcount  : 1
-               nlocals   : 2
+               argcount  : 3
+               nlocals   : 7
                stacksize : 5
-               flags     : 16777235
+               flags     : 19
                code
-                  0x970069007c005d127d017401000000000000000000007c01a6010000ab
-                  0100000000000000007c0193028c135300
-                52           0 RESUME                   0
-                             2 BUILD_MAP                0
-                             4 LOAD_FAST                0 (.0)
-                       >>    6 FOR_ITER                18 (to 44)
-                             8 STORE_FAST               1 (fspec)
-                            10 LOAD_GLOBAL              1 (NULL + take_first)
-                            22 LOAD_FAST                1 (fspec)
-                            24 PRECALL                  1
-                            28 CALL                     1
-                            38 LOAD_FAST                1 (fspec)
-                            40 MAP_ADD                  2
-                            42 JUMP_BACKWARD           19 (to 6)
-                       >>   44 RETURN_VALUE
+                  0x950497006401a00000000000000000000000000000000000000000007c
+                  007c026702a6010000ab0100000000000000007d038909a0010000000000
+                  0000000000000000000000000000007c03a6010000ab0100000000000000
+                  007d04890a720c020089087c017c02a6020000ab0200000000000000006e
+                  0164027d058907a00200000000000000000000000000000000000000007c
+                  017c0266027c047c05ac03a6030000ab0300000000000000007d068907a0
+                  0300000000000000000000000000000000000000007c067c04a6020000ab
+                  0200000000000000005300
+                             0 COPY_FREE_VARS           4
+               
+                55           2 RESUME                   0
+               
+                56           4 LOAD_CONST               1 ('/')
+                             6 LOAD_METHOD              0 (join)
+                            28 LOAD_FAST                0 (path)
+                            30 LOAD_FAST                2 (label)
+                            32 BUILD_LIST               2
+                            34 PRECALL                  1
+                            38 CALL                     1
+                            48 STORE_FAST               3 (key)
+               
+                57          50 LOAD_DEREF               9 (store)
+                            52 LOAD_METHOD              1 (get)
+                            74 LOAD_FAST                3 (key)
+                            76 PRECALL                  1
+                            80 CALL                     1
+                            90 STORE_FAST               4 (df)
+               
+                58          92 LOAD_DEREF              10 (use_metadata)
+                            94 POP_JUMP_FORWARD_IF_FALSE    12 (to 120)
+                            96 PUSH_NULL
+                            98 LOAD_DEREF               8 (get_meta)
+                           100 LOAD_FAST                1 (o_type)
+                           102 LOAD_FAST                2 (label)
+                           104 PRECALL                  2
+                           108 CALL                     2
+                           118 JUMP_FORWARD             1 (to 122)
+                       >>  120 LOAD_CONST               2 (())
+                       >>  122 STORE_FAST               5 (specs)
+               
+                59         124 LOAD_DEREF               7 (factory)
+                           126 LOAD_METHOD              2 (make_ts_spec_from_data)
+                           148 LOAD_FAST                1 (o_type)
+                           150 LOAD_FAST                2 (label)
+                           152 BUILD_TUPLE              2
+                           154 LOAD_FAST                4 (df)
+                           156 LOAD_FAST                5 (specs)
+                           158 KW_NAMES                 3
+                           160 PRECALL                  3
+                           164 CALL                     3
+                           174 STORE_FAST               6 (ts_spec)
+               
+                60         176 LOAD_DEREF               7 (factory)
+                           178 LOAD_METHOD              3 (make_ts_container)
+                           200 LOAD_FAST                6 (ts_spec)
+                           202 LOAD_FAST                4 (df)
+                           204 PRECALL                  2
+                           208 CALL                     2
+                           218 RETURN_VALUE
                consts
-               names      ('take_first',)
-               varnames   ('.0', 'fspec')
-               freevars   ()
+                  None
+                  '/'
+                  ()
+                  ('spec_id', 'df', 'extra_metadata')
+               names      ('join', 'get', 'make_ts_spec_from_data', 'make_ts_container')
+               varnames   ('path', 'o_type', 'label', 'key', 'df', 'specs', 'ts_spec')
+               freevars   ('factory', 'get_meta', 'store', 'use_metadata')
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-               name       '<dictcomp>'
-               firstlineno 52
-               lnotab 0x
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
+               name       'make_series_cont'
+               firstlineno 55
+               lnotab 0x04012e012a0120013401
             code
-               argcount  : 1
-               nlocals   : 2
-               stacksize : 4
-               flags     : 16777235
+               argcount  : 2
+               nlocals   : 6
+               stacksize : 8
+               flags     : 19
                code
-                  0x9501970067007c005d107d017c0189027600720889027c011900000000
-                  00000000006e017c0191028c115300
-                             0 COPY_FREE_VARS           1
+                  0x950497007c0089077600724e7401000000000000000000008909a00100
+                  0000000000000000000000000000000000000064017c009b009d02a60100
+                  00ab010000000000000000a6010000ab0100000000000000005c0300007d
+                  027d037d047c0444005d247d058908a00200000000000000000000000000
+                  00000000000000020089067c027c017c05a6030000ab0300000000000000
+                  00a6010000ab01000000000000000001008c236400530064005300
+                             0 COPY_FREE_VARS           4
+               
+                64           2 RESUME                   0
                
-                53           2 RESUME                   0
-                             4 BUILD_LIST               0
-                             6 LOAD_FAST                0 (.0)
-                       >>    8 FOR_ITER                16 (to 42)
-                            10 STORE_FAST               1 (f)
-                            12 LOAD_FAST                1 (f)
-                            14 LOAD_DEREF               2 (specmeta)
-                            16 CONTAINS_OP              0
-                            18 POP_JUMP_FORWARD_IF_FALSE     8 (to 36)
-                            20 LOAD_DEREF               2 (specmeta)
-                            22 LOAD_FAST                1 (f)
-                            24 BINARY_SUBSCR
-                            34 JUMP_FORWARD             1 (to 38)
-                       >>   36 LOAD_FAST                1 (f)
-                       >>   38 LIST_APPEND              2
-                            40 JUMP_BACKWARD           17 (to 8)
-                       >>   42 RETURN_VALUE
+                65           4 LOAD_FAST                0 (base_key)
+                             6 LOAD_DEREF               7 (rel_groups)
+                             8 CONTAINS_OP              0
+                            10 POP_JUMP_FORWARD_IF_FALSE    78 (to 168)
+               
+                66          12 LOAD_GLOBAL              1 (NULL + next)
+                            24 LOAD_DEREF               9 (store)
+                            26 LOAD_METHOD              1 (walk)
+                            48 LOAD_CONST               1 ('/')
+                            50 LOAD_FAST                0 (base_key)
+                            52 FORMAT_VALUE             0
+                            54 BUILD_STRING             2
+                            56 PRECALL                  1
+                            60 CALL                     1
+                            70 PRECALL                  1
+                            74 CALL                     1
+                            84 UNPACK_SEQUENCE          3
+                            88 STORE_FAST               2 (path)
+                            90 STORE_FAST               3 (groups)
+                            92 STORE_FAST               4 (leaves)
+               
+                67          94 LOAD_FAST                4 (leaves)
+                            96 GET_ITER
+                       >>   98 FOR_ITER                36 (to 172)
+                           100 STORE_FAST               5 (label)
+               
+                68         102 LOAD_DEREF               8 (series_containers)
+                           104 LOAD_METHOD              2 (append)
+                           126 PUSH_NULL
+                           128 LOAD_DEREF               6 (make_series_cont)
+                           130 LOAD_FAST                2 (path)
+                           132 LOAD_FAST                1 (o_type)
+                           134 LOAD_FAST                5 (label)
+                           136 PRECALL                  3
+                           140 CALL                     3
+                           150 PRECALL                  1
+                           154 CALL                     1
+                           164 POP_TOP
+                           166 JUMP_BACKWARD           35 (to 98)
+               
+                65     >>  168 LOAD_CONST               0 (None)
+                           170 RETURN_VALUE
+               
+                67     >>  172 LOAD_CONST               0 (None)
+                           174 RETURN_VALUE
                consts
-               names      ()
-               varnames   ('.0', 'f')
-               freevars   ('specmeta',)
+                  None
+                  '/'
+               names      ('next', 'walk', 'append')
+               varnames   ('base_key', 'o_type', 'path', 'groups', 'leaves', 'label')
+               freevars   ('make_series_cont', 'rel_groups', 'series_containers', 'store')
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-               name       '<listcomp>'
-               firstlineno 53
-               lnotab 0x
-         names      ('copy', 'MDConcepts', 'Time', 'mdata.core', 'df_utils', 'insert', 'create_artificial_daterange', 'Object', 'Type', 'Label', 'TimeseriesSpecFactory', 'for_type', 'only_feature_columns', 'columns', 'ObservationSpec', 'from_raw', 'TimeseriesCollectionFactory')
-         varnames   ('df', 'specmeta', 'copy', 'kwargs', 'match_spec_and_df', 'spec_time', 'df_utils', 'spec_object', 'spec_type', 'spec_label', 'tspec_cls', 'features', 'tt')
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
+               name       'add_series_containers'
+               firstlineno 64
+               lnotab 0x040108015201080142fd0402
+            'events'
+            'measurements'
+            'index'
+            ('index_frame',)
+         names      ('mdata.core.factory', 'get_factory', 'pd', 'HDFStore', 'next', 'walk', 'set', 'get_node', 'get', 'iterrows', 'str', 'list', 'RawMetadataFeatureSpec', 'Meta', 'of', 'extensions', 'ObservationTypes', 'E', 'M', 'make')
+         varnames   ('filename', 'get_factory', 'measurements', 'events', 'extensions', 'metadata', 'metadata_df', 'key', 'row', 'value', 'meta', 'add_series_containers', 'index_frame')
          freevars   ()
-         cellvars   ('df', 'specmeta', 'kwargs')
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-         name       'ts_from_df'
-         firstlineno 25
+         cellvars   ('factory', 'get_meta', 'make_series_cont', 'rel_groups', 'series_containers', 'spec_extra_metadata', 'store', 'use_metadata')
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
+         name       'read_machine_data_h5'
+         firstlineno 12
          lnotab
-            0x080230020c0b1c0124010c010c0168012c012c012c0228012802180154
-            01
-      'ObservationSeriesDef'
-      ('total',)
-      True
-      ('meta', 'sort_by_time', 'copy_dfs')
-      'series_defs'
-      'meta'
-      'Meta'
-      'MachineData'
-      code
-         argcount  : 0
-         nlocals   : 10
-         stacksize : 7
-         flags     : 16777231
-         code
-            0x9700670067007d067d057c0344005d6d7d0764017c07760073024a0082
-            01740100000000000000000000640469007c07a40164027c026901a4018e
-            017d087403000000000000000000007c08740400000000000000000000a6
-            020000ab02000000000000000072167c05a0030000000000000000000000
-            0000000000000000007c08a6010000ab01000000000000000001008c4374
-            03000000000000000000007c08740800000000000000000000a6020000ab
-            02000000000000000072157c06a003000000000000000000000000000000
-            00000000007c08a6010000ab01000000000000000001008c6e740b000000
-            00000000000000740d000000000000000000006a0700000000000000007c
-            057c06a6020000ab020000000000000000660164037c0169017c04a4018e
-            017d097411000000000000000000007c007c057c067c09a6040000ab0400
-            000000000000005300
-          63           0 RESUME                   0
-         
-          65           2 BUILD_LIST               0
-                       4 BUILD_LIST               0
-                       6 STORE_FAST               6 (mts)
-                       8 STORE_FAST               5 (ets)
-         
-          66          10 LOAD_FAST                3 (series_defs)
-                      12 GET_ITER
-                 >>   14 FOR_ITER               109 (to 234)
-                      16 STORE_FAST               7 (sd)
-         
-          67          18 LOAD_CONST               1 ('df')
-                      20 LOAD_FAST                7 (sd)
-                      22 CONTAINS_OP              0
-                      24 POP_JUMP_FORWARD_IF_TRUE     2 (to 30)
-                      26 LOAD_ASSERTION_ERROR
-                      28 RAISE_VARARGS            1
-         
-          68     >>   30 LOAD_GLOBAL              1 (NULL + ts_from_df)
-                      42 LOAD_CONST               4 (())
-                      44 BUILD_MAP                0
-                      46 LOAD_FAST                7 (sd)
-                      48 DICT_MERGE               1
-                      50 LOAD_CONST               2 ('copy')
-                      52 LOAD_FAST                2 (copy_dfs)
-                      54 BUILD_MAP                1
-                      56 DICT_MERGE               1
-                      58 CALL_FUNCTION_EX         1
-                      60 STORE_FAST               8 (tsc)
-         
-          69          62 LOAD_GLOBAL              3 (NULL + isinstance)
-                      74 LOAD_FAST                8 (tsc)
-                      76 LOAD_GLOBAL              4 (EventTimeseriesCollection)
-                      88 PRECALL                  2
-                      92 CALL                     2
-                     102 POP_JUMP_FORWARD_IF_FALSE    22 (to 148)
-         
-          70         104 LOAD_FAST                5 (ets)
-                     106 LOAD_METHOD              3 (append)
-                     128 LOAD_FAST                8 (tsc)
-                     130 PRECALL                  1
-                     134 CALL                     1
-                     144 POP_TOP
-                     146 JUMP_BACKWARD           67 (to 14)
-         
-          71     >>  148 LOAD_GLOBAL              3 (NULL + isinstance)
-                     160 LOAD_FAST                8 (tsc)
-                     162 LOAD_GLOBAL              8 (MeasurementTimeseriesCollection)
-                     174 PRECALL                  2
-                     178 CALL                     2
-                     188 POP_JUMP_FORWARD_IF_FALSE    21 (to 232)
-         
-          72         190 LOAD_FAST                6 (mts)
-                     192 LOAD_METHOD              3 (append)
-                     214 LOAD_FAST                8 (tsc)
-                     216 PRECALL                  1
-                     220 CALL                     1
-                     230 POP_TOP
-                 >>  232 JUMP_BACKWARD          110 (to 14)
-         
-          74     >>  234 LOAD_GLOBAL             11 (NULL + build_shared_index)
-                     246 LOAD_GLOBAL             13 (NULL + itertools)
-                     258 LOAD_ATTR                7 (chain)
-                     268 LOAD_FAST                5 (ets)
-                     270 LOAD_FAST                6 (mts)
-                     272 PRECALL                  2
-                     276 CALL                     2
-                     286 BUILD_TUPLE              1
-                     288 LOAD_CONST               3 ('sort_by_time')
-                     290 LOAD_FAST                1 (sort_by_time)
-                     292 BUILD_MAP                1
-                     294 LOAD_FAST                4 (kwargs)
-                     296 DICT_MERGE               1
-                     298 CALL_FUNCTION_EX         1
-                     300 STORE_FAST               9 (index_frame)
-         
-          75         302 LOAD_GLOBAL             17 (NULL + MachineData)
-                     314 LOAD_FAST                0 (meta)
-                     316 LOAD_FAST                5 (ets)
-                     318 LOAD_FAST                6 (mts)
-                     320 LOAD_FAST                9 (index_frame)
-                     322 PRECALL                  4
-                     326 CALL                     4
-                     336 RETURN_VALUE
-         consts
-            None
-            'df'
-            'copy'
-            'sort_by_time'
-            ()
-         names      ('ts_from_df', 'isinstance', 'EventTimeseriesCollection', 'append', 'MeasurementTimeseriesCollection', 'build_shared_index', 'itertools', 'chain', 'MachineData')
-         varnames   ('meta', 'sort_by_time', 'copy_dfs', 'series_defs', 'kwargs', 'ets', 'mts', 'sd', 'tsc', 'index_frame')
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-         name       'machine_data_from_series'
-         firstlineno 63
-         lnotab 0x0202080108010c0120012a012c012a012c024401
-      'RawDataType'
-      'header'
-      'RawHeaderSpec'
-      code
-         argcount  : 2
-         nlocals   : 2
-         stacksize : 4
-         flags     : 16777219
-         code
-            0x97007401000000000000000000007c007c01a6020000ab020000000000
-            0000005300
-          78           0 RESUME                   0
-         
-          79           2 LOAD_GLOBAL              1 (NULL + create_machine_data_from_raw)
-                      14 LOAD_FAST                0 (df)
-                      16 LOAD_FAST                1 (header)
-                      18 PRECALL                  2
-                      22 CALL                     2
-                      32 RETURN_VALUE
-         consts
-            None
-         names      ('create_machine_data_from_raw',)
-         varnames   ('df', 'header')
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
-         name       'machine_data_from_df'
-         firstlineno 78
-         lnotab 0x0201
-      ('df', 'pd.DataFrame')
-      ((), False)
-      ('df', 'pd.DataFrame', 'specmeta', 'Iterable[RawMetadataFeatureSpec]', 'return', 'TypedTimeseriesCollection')
-      ('series_defs', 'ObservationSeriesDef', 'meta', 'Meta', 'return', 'MachineData')
-      ('df', 'RawDataType', 'header', 'RawHeaderSpec', 'return', 'MachineData')
-   names      ('__future__', 'annotations', 'itertools', 'collections.abc', 'Iterable', 'typing', 'TypedDict', 'pandas', 'pd', 'mdata.core.header', 'ObservationSpec', 'Meta', 'mdata.core.machine_data_def', 'MDConcepts', 'TimeseriesSpecFactory', 'only_feature_columns', 'TimeseriesCollectionFactory', 'EventTimeseriesCollection', 'MachineData', 'MeasurementTimeseriesCollection', 'ObservationTypes', 'build_shared_index', 'TypedTimeseriesCollection', 'mdata.core.raw', 'create_machine_data_from_raw', 'RawHeaderSpec', 'RawDataType', 'RawMetadataFeatureSpec', 'mdata.core.util', 'take_first', 'ets_from_df', 'mts_from_df', 'ts_from_df', 'DataFrame', 'Object', 'str', 'Time', 'Label', 'list', 'ObservationSeriesDef', 'machine_data_from_series', 'machine_data_from_df')
+            0x12020c022e01080150021c0104012a014401080204012e012a01320110
+            0126022e012a02300f2a0220021007040210062c012c022a0230c5
+   names      ('pandas', 'pd', 'mdata.core', 'MDConcepts', 'MachineData', 'ObservationTypes', 'mdata.core.header', 'Meta', 'mdata.core.raw', 'RawMetadataFeatureSpec', 'Exception', 'InvalidHeaderException', 'read_machine_data_h5')
    varnames   ()
    freevars   ()
    cellvars   ()
-   filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\factory.py'
+   filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\importing.py'
    name       '<module>'
    firstlineno 1
-   lnotab
-      0x00ff02010c0208010c010c0208021001300318010c03080408040a2006
-      012a011eff020202fd1206220f
+   lnotab 0x00ff0201080214010c010c031c04
```

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/header.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/header.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/header.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/header.cpython-311.pyc`

 * *Files 0% similar despite different names*

#### Python bytecode

```diff
@@ -1,10 +1,10 @@
 magic:    0xa70d0d0a
-moddate:  0xa853c264 (Thu Jul 27 11:23:20 2023 UTC)
-files sz: 7771
+moddate:  0xefe9d064 (Mon Aug  7 12:56:15 2023 UTC)
+files sz: 7758
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 6
    flags     : 16777216
    code
       0x9700640064016c006d015a010100640064026c026d035a036d045a046d
@@ -1365,17 +1365,17 @@
          
          111          88 PRECALL                  0
                       92 CALL                     0
          
          112         102 STORE_NAME              10 (of)
          
          115         104 LOAD_CONST              16 (('other', 'Meta'))
-                     106 LOAD_CONST              10 (<code object is_mergable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\header.py", line 115>)
+                     106 LOAD_CONST              10 (<code object is_mergeable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\header.py", line 115>)
                      108 MAKE_FUNCTION            4 (annotations)
-                     110 STORE_NAME              11 (is_mergable)
+                     110 STORE_NAME              11 (is_mergeable)
          
          118         112 LOAD_CONST              17 (('b', 'Meta', 'return', 'Meta'))
                      114 LOAD_CONST              13 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\header.py", line 118>)
                      116 MAKE_FUNCTION            4 (annotations)
                      118 STORE_NAME              12 (merge)
                      120 LOAD_CONST              14 (None)
                      122 RETURN_VALUE
@@ -1442,15 +1442,15 @@
                consts
                   None
                names      ('extensions',)
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\header.py'
-               name       'is_mergable'
+               name       'is_mergeable'
                firstlineno 115
                lnotab 0x0201
             'b'
             'return'
             code
                argcount  : 2
                nlocals   : 2
@@ -1464,15 +1464,15 @@
                   00740b000000000000000000007c006a060000000000000000a6010000ab
                   010000000000000000740b000000000000000000007c016a060000000000
                   000000a6010000ab0100000000000000007a070000a6020000ab02000000
                   00000000005300
                118           0 RESUME                   0
                
                119           2 LOAD_FAST                0 (self)
-                             4 LOAD_METHOD              0 (is_mergable)
+                             4 LOAD_METHOD              0 (is_mergeable)
                             26 LOAD_FAST                1 (b)
                             28 PRECALL                  1
                             32 CALL                     1
                             42 POP_JUMP_FORWARD_IF_TRUE     7 (to 58)
                
                120          44 LOAD_GLOBAL              2 (NotMergeableException)
                             56 RAISE_VARARGS            1
@@ -1496,27 +1496,27 @@
                            186 CALL                     1
                            196 BINARY_OP                7 (|)
                            200 PRECALL                  2
                            204 CALL                     2
                            214 RETURN_VALUE
                consts
                   None
-               names      ('is_mergable', 'NotMergeableException', 'Meta', 'of', 'extensions', 'dict', 'metadata')
+               names      ('is_mergeable', 'NotMergeableException', 'Meta', 'of', 'extensions', 'dict', 'metadata')
                varnames   ('self', 'b')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\header.py'
                name       'merge'
                firstlineno 118
                lnotab 0x02012a010e01
             None
             ('extensions', 'Collection[Extension]', 'metadata', 'Mapping[str, Any]')
             ('other', 'Meta')
             ('b', 'Meta', 'return', 'Meta')
-         names      ('__name__', '__module__', '__qualname__', 'field', 'frozenset', 'extensions', '__annotations__', 'immutabledict', 'metadata', 'classmethod', 'of', 'is_mergable', 'merge')
+         names      ('__name__', '__module__', '__qualname__', 'field', 'frozenset', 'extensions', '__annotations__', 'immutabledict', 'metadata', 'classmethod', 'of', 'is_mergeable', 'merge')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\header.py'
          name       'Meta'
          firstlineno 106
          lnotab 0x0c0222012202020106ff0e0102030803
@@ -1678,17 +1678,17 @@
                   000000000000007c02a6010000ab01000000000000000053007c05740e00
                   0000000000000000006a0c00000000000000006b020000000072217c006a
                   0a00000000000000006a0d0000000000000000a004000000000000000000
                   00000000000000000000007c02a6010000ab010000000000000000530064
                   00530064005300
                134           0 RESUME                   0
                
-               135           2 LOAD_CONST               1 (0)
+               135           2 LOAD_CONST               1 (1)
                              4 LOAD_CONST               2 (('ObservationTypes',))
-                             6 IMPORT_NAME              0 (mdata.core.machine_data_def)
+                             6 IMPORT_NAME              0 (shared_defs)
                              8 IMPORT_FROM              1 (ObservationTypes)
                             10 STORE_FAST               3 (ObservationTypes)
                             12 POP_TOP
                
                136          14 LOAD_FAST                1 (spec_type)
                             16 LOAD_FAST                3 (ObservationTypes)
                             18 LOAD_ATTR                2 (E)
@@ -1761,17 +1761,17 @@
                140     >>  388 LOAD_CONST               0 (None)
                            390 RETURN_VALUE
                
                144     >>  392 LOAD_CONST               0 (None)
                            394 RETURN_VALUE
                consts
                   None
-                  0
+                  1
                   ('ObservationTypes',)
-               names      ('mdata.core.machine_data_def', 'ObservationTypes', 'E', 'event_specs', 'get', 'M', 'measurement_specs', 'AnnotationTypes', 'csv_tuple_qualifiers', 'Input', 'annotation_specs', 'input', 'Output', 'output')
+               names      ('shared_defs', 'ObservationTypes', 'E', 'event_specs', 'get', 'M', 'measurement_specs', 'AnnotationTypes', 'csv_tuple_qualifiers', 'Input', 'annotation_specs', 'input', 'Output', 'output')
                varnames   ('self', 'spec_type', 'label', 'ObservationTypes', '_', 'subtype')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\header.py'
                name       'lookup_spec'
                firstlineno 134
                lnotab 0x02010c0116013401160134011c010a0120013e0120013efb0404
```

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/machine_data_def.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/base_machine_data.cpython-311.pyc`

 * *Files 14% similar despite different names*

#### Python bytecode

```diff
@@ -1,66 +1,49 @@
 magic:    0xa70d0d0a
-moddate:  0x90d7c364 (Fri Jul 28 14:58:24 2023 UTC)
-files sz: 25650
+moddate:  0xea06d164 (Mon Aug  7 14:59:54 2023 UTC)
+files sz: 29735
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 11
    flags     : 16777216
    code
-      0x9700640064016c006d015a010100640064026c025a02640064036c036d
-      045a040100640064046c056d065a066d075a070100640064056c086d095a
-      090100640064066c0a6d0b5a0b6d0c5a0c6d0d5a0d6d0e5a0e6d0f5a0f6d
-      105a106d115a116d125a126d135a130100640064026c145a15640064026c
-      165a17640764086c186d195a190100640764096c1a6d1b5a1b6d1c5a1c6d
-      1d5a1d6d1e5a1e01006407640a6c1f6d205a206d215a216d225a226d235a
-      236d245a246d255a256d265a266d275a270100650f7201090065285a2902
-      004700640b8400640c6527a6030000ab0300000000000000005a2a020047
-      00640d8400640e6527a6030000ab0300000000000000005a2b640f84005a
-      2c644b641284045a2d65285a2e652f652e64136602190000000000000000
-      005a3065285a31020047006414840064156527a6030000ab030000000000
-      0000005a3265285a33652f653165336602190000000000000000005a3465
-      285a3565285a360200650d64166417ac18a6020000ab0200000000000000
-      005a370200470064198400641a6538a6030000ab0300000000000000005a
-      3902004700641b8400641c6538a6030000ab0300000000000000005a3a02
-      004700641d8400641e6538a6030000ab0300000000000000005a3b020065
-      06641f641f641f641f6420ac21a6050000ab050000000000000000020047
-      00642284006417650b650ea6040000ab040000000000000000a6000000ab
-      0000000000000000005a3c02006506641f6420ac23a6020000ab02000000
-      000000000002004700642484006425653ca6030000ab0300000000000000
-      00a6000000ab0000000000000000005a3d02006506641f6420ac23a60200
-      00ab02000000000000000002004700642684006427653ca6030000ab0300
-      00000000000000a6000000ab0000000000000000005a3e02004700642884
-      006429a6020000ab0200000000000000005a3f0200650d642a653cac18a6
-      020000ab0200000000000000005a40650602004700642b8400642c650c65
-      40190000000000000000006504a6040000ab040000000000000000a60000
-      00ab0000000000000000005a41650602004700642d8400642e6541654019
-      000000000000000000a6030000ab030000000000000000a6000000ab0000
-      000000000000005a42650602004700642f840064306542653d1900000000
-      0000000000a6030000ab030000000000000000a6000000ab000000000000
-      0000005a436506020047006431840064326542653e190000000000000000
-      00a6030000ab030000000000000000a6000000ab0000000000000000005a
-      440200650d64336542ac18a6020000ab0200000000000000005a45020065
-      0d64346435ac18a6020000ab0200000000000000005a4602004700643684
-      006435650c654065456602190000000000000000006504a6040000ab0400
-      000000000000005a47020047006437840064386547653d65436602190000
-      00000000000000a6030000ab0300000000000000005a4802004700643984
-      00643a6547653e6544660219000000000000000000a6030000ab03000000
-      00000000005a490200650d643b653cac18a6020000ab0200000000000000
-      005a4a0200650d643c653cac18a6020000ab0200000000000000005a4b02
-      00650d643d6542ac18a6020000ab0200000000000000005a4c0200650d64
-      3e6542ac18a6020000ab0200000000000000005a4d0200650d643f6547ac
-      18a6020000ab0200000000000000005a4e0200650d64406547ac18a60200
-      00ab0200000000000000005a4f02004700644184006442a6020000ab0200
-      000000000000005a500200650d64436444ac18a6020000ab020000000000
-      0000005a5102004700644584006444650c654a654b654c654d654e654f66
-      06190000000000000000006504a6040000ab0400000000000000005a5202
-      0047006446840064476552653d653e654365446548654966061900000000
-      0000000000a6030000ab0300000000000000005a53090009000900644c64
-      4d644a84055a5464025300
+      0x9700640064016c006d015a010100640064026c025a02640064026c035a
+      03640064026c045a04640064036c056d065a060100640064046c076d085a
+      086d095a096d0a5a0a6d0b5a0b6d0c5a0c0100640064056c0d6d0e5a0e01
+      00640064066c046d0f5a0f6d105a106d115a110100640064026c125a1364
+      0064026c145a15640064076c166d165a160100640864096c176d185a186d
+      195a196d1a5a1a6d1b5a1b6d1c5a1c6d1d5a1d6d1e5a1e6d1f5a1f6d205a
+      206d215a216d225a226d235a2301006408640a6c246d255a250100640864
+      0b6c266d275a276d285a286d295a296d2a5a2a01006408640c6c2b6d2c5a
+      2c6d2d5a2d6d2e5a2e6d2f5a2f6d305a306d315a316d325a326d335a336d
+      345a346d355a356d365a366d375a376d385a386d395a396d3a5a3a6d3b5a
+      3b01006408640d6c3c6d3d5a3d6d3e5a3e6d3f5a3f6d405a400100020047
+      00640e8400640f6541a6030000ab0300000000000000005a420200470064
+      10840064116541a6030000ab0300000000000000005a4302004700641284
+      0064136541a6030000ab0300000000000000005a440200650e6414641464
+      146415ac16a6040000ab0400000000000000000200470064178400641865
+      2ea6030000ab030000000000000000a6000000ab0000000000000000005a
+      450200470064198400641a6545652ca6040000ab0400000000000000005a
+      4602004700641b8400641c6545652da6040000ab0400000000000000005a
+      4702004700641d8400641e652f653219000000000000000000650f653219
+      000000000000000000a6040000ab0400000000000000005a486548654619
+      0000000000000000005a4902004700641f84006420654865461900000000
+      0000000000a6030000ab0300000000000000005a4a020047006421840064
+      226548654719000000000000000000a6030000ab0300000000000000005a
+      4b090009006433642384015a4c0200470064248400642565306532653366
+      0219000000000000000000650f6532653366021900000000000000000065
+      06a6050000ab0500000000000000005a4d02004700642684006427654d65
+      46654a660219000000000000000000a6030000ab0300000000000000005a
+      4e02004700642884006429654d6547654b660219000000000000000000a6
+      030000ab0300000000000000005a4f02004700642a8400642b6531653765
+      3665346539653865356606190000000000000000006506a6040000ab0400
+      000000000000005a5002004700642c8400642d65506546654a654e654765
+      4b654f660619000000000000000000a6030000ab0300000000000000005a
+      5109000900090064346435643284055a5264025300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('annotations',))
                  6 IMPORT_NAME              0 (__future__)
                  8 IMPORT_FROM              1 (annotations)
                 10 STORE_NAME               1 (annotations)
@@ -68,1125 +51,720 @@
    
      3          14 LOAD_CONST               0 (0)
                 16 LOAD_CONST               2 (None)
                 18 IMPORT_NAME              2 (itertools)
                 20 STORE_NAME               2 (itertools)
    
      4          22 LOAD_CONST               0 (0)
-                24 LOAD_CONST               3 (('ABC',))
-                26 IMPORT_NAME              3 (abc)
-                28 IMPORT_FROM              4 (ABC)
-                30 STORE_NAME               4 (ABC)
-                32 POP_TOP
-   
-     5          34 LOAD_CONST               0 (0)
-                36 LOAD_CONST               4 (('dataclass', 'field'))
-                38 IMPORT_NAME              5 (dataclasses)
-                40 IMPORT_FROM              6 (dataclass)
-                42 STORE_NAME               6 (dataclass)
-                44 IMPORT_FROM              7 (field)
-                46 STORE_NAME               7 (field)
+                24 LOAD_CONST               2 (None)
+                26 IMPORT_NAME              3 (logging)
+                28 STORE_NAME               3 (logging)
+   
+     5          30 LOAD_CONST               0 (0)
+                32 LOAD_CONST               2 (None)
+                34 IMPORT_NAME              4 (typing)
+                36 STORE_NAME               4 (typing)
+   
+     6          38 LOAD_CONST               0 (0)
+                40 LOAD_CONST               3 (('ABC',))
+                42 IMPORT_NAME              5 (abc)
+                44 IMPORT_FROM              6 (ABC)
+                46 STORE_NAME               6 (ABC)
                 48 POP_TOP
    
-     6          50 LOAD_CONST               0 (0)
-                52 LOAD_CONST               5 (('partial',))
-                54 IMPORT_NAME              8 (functools)
-                56 IMPORT_FROM              9 (partial)
-                58 STORE_NAME               9 (partial)
-                60 POP_TOP
-   
-     7          62 LOAD_CONST               0 (0)
-                64 LOAD_CONST               6 (('Iterable', 'Generic', 'TypeVar', 'Sized', 'TYPE_CHECKING', 'Collection', 'Literal', 'ClassVar', 'Callable'))
-                66 IMPORT_NAME             10 (typing)
-                68 IMPORT_FROM             11 (Iterable)
-                70 STORE_NAME              11 (Iterable)
-                72 IMPORT_FROM             12 (Generic)
-                74 STORE_NAME              12 (Generic)
-                76 IMPORT_FROM             13 (TypeVar)
-                78 STORE_NAME              13 (TypeVar)
-                80 IMPORT_FROM             14 (Sized)
-                82 STORE_NAME              14 (Sized)
-                84 IMPORT_FROM             15 (TYPE_CHECKING)
-                86 STORE_NAME              15 (TYPE_CHECKING)
-                88 IMPORT_FROM             16 (Collection)
-                90 STORE_NAME              16 (Collection)
-                92 IMPORT_FROM             17 (Literal)
-                94 STORE_NAME              17 (Literal)
-                96 IMPORT_FROM             18 (ClassVar)
-                98 STORE_NAME              18 (ClassVar)
-               100 IMPORT_FROM             19 (Callable)
-               102 STORE_NAME              19 (Callable)
-               104 POP_TOP
-   
-     9         106 LOAD_CONST               0 (0)
-               108 LOAD_CONST               2 (None)
-               110 IMPORT_NAME             20 (numpy)
-               112 STORE_NAME              21 (np)
-   
-    10         114 LOAD_CONST               0 (0)
-               116 LOAD_CONST               2 (None)
-               118 IMPORT_NAME             22 (pandas)
-               120 STORE_NAME              23 (pd)
-   
-    12         122 LOAD_CONST               7 (1)
-               124 LOAD_CONST               8 (('derive_categoricals',))
-               126 IMPORT_NAME             24 (df_utils)
-               128 IMPORT_FROM             25 (derive_categoricals)
-               130 STORE_NAME              25 (derive_categoricals)
-               132 POP_TOP
-   
-    13         134 LOAD_CONST               7 (1)
-               136 LOAD_CONST               9 (('Header', 'ObservationSpec', 'Meta', 'FeatureSpec'))
-               138 IMPORT_NAME             26 (header)
-               140 IMPORT_FROM             27 (Header)
-               142 STORE_NAME              27 (Header)
-               144 IMPORT_FROM             28 (ObservationSpec)
-               146 STORE_NAME              28 (ObservationSpec)
-               148 IMPORT_FROM             29 (Meta)
-               150 STORE_NAME              29 (Meta)
-               152 IMPORT_FROM             30 (FeatureSpec)
-               154 STORE_NAME              30 (FeatureSpec)
-               156 POP_TOP
-   
-    14         158 LOAD_CONST               7 (1)
-               160 LOAD_CONST              10 (('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'mangle_arg_to_tuple', 'symmetric_difference', 'intersection', 'assert_in', 'StringEnumeration'))
-               162 IMPORT_NAME             31 (util)
-               164 IMPORT_FROM             32 (mangle_arg_to_set)
-               166 STORE_NAME              32 (mangle_arg_to_set)
-               168 IMPORT_FROM             33 (mangle_arg_with_bool_fallback)
-               170 STORE_NAME              33 (mangle_arg_with_bool_fallback)
-               172 IMPORT_FROM             34 (mangle_arg_to_list)
-               174 STORE_NAME              34 (mangle_arg_to_list)
-               176 IMPORT_FROM             35 (mangle_arg_to_tuple)
-               178 STORE_NAME              35 (mangle_arg_to_tuple)
-               180 IMPORT_FROM             36 (symmetric_difference)
-               182 STORE_NAME              36 (symmetric_difference)
-               184 IMPORT_FROM             37 (intersection)
-               186 STORE_NAME              37 (intersection)
-               188 IMPORT_FROM             38 (assert_in)
-               190 STORE_NAME              38 (assert_in)
-               192 IMPORT_FROM             39 (StringEnumeration)
-               194 STORE_NAME              39 (StringEnumeration)
-               196 POP_TOP
-   
-    17         198 LOAD_NAME               15 (TYPE_CHECKING)
-               200 POP_JUMP_FORWARD_IF_FALSE     1 (to 204)
-   
-    18         202 NOP
-   
-    20     >>  204 LOAD_NAME               40 (str)
-               206 STORE_NAME              41 (MDConcept)
-   
-    23         208 PUSH_NULL
-               210 LOAD_BUILD_CLASS
-               212 LOAD_CONST              11 (<code object MDConcepts, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 23>)
-               214 MAKE_FUNCTION            0
-               216 LOAD_CONST              12 ('MDConcepts')
-               218 LOAD_NAME               39 (StringEnumeration)
-               220 PRECALL                  3
-               224 CALL                     3
-               234 STORE_NAME              42 (MDConcepts)
-   
-    32         236 PUSH_NULL
-               238 LOAD_BUILD_CLASS
-               240 LOAD_CONST              13 (<code object MDExtensionConcepts, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 32>)
-               242 MAKE_FUNCTION            0
-               244 LOAD_CONST              14 ('MDExtensionConcepts')
-               246 LOAD_NAME               39 (StringEnumeration)
-               248 PRECALL                  3
-               252 CALL                     3
-               262 STORE_NAME              43 (MDExtensionConcepts)
-   
-    39         264 LOAD_CONST              15 (<code object only_feature_columns, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 39>)
-               266 MAKE_FUNCTION            0
-               268 STORE_NAME              44 (only_feature_columns)
-   
-    43         270 LOAD_CONST              75 (('df', 'pd.DataFrame'))
-               272 LOAD_CONST              18 (<code object project_on_feature_columns, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 43>)
-               274 MAKE_FUNCTION            4 (annotations)
-               276 STORE_NAME              45 (project_on_feature_columns)
-   
-    47         278 LOAD_NAME               40 (str)
-               280 STORE_NAME              46 (TimeseriesFeatureLabel)
-   
-    48         282 LOAD_NAME               47 (tuple)
-               284 LOAD_NAME               46 (TimeseriesFeatureLabel)
-               286 LOAD_CONST              19 (Ellipsis)
-               288 BUILD_TUPLE              2
-               290 BINARY_SUBSCR
-               300 STORE_NAME              48 (TimeseriesFeatureLabels)
-   
-    50         302 LOAD_NAME               40 (str)
-               304 STORE_NAME              49 (ObservationTypeType)
-   
-    53         306 PUSH_NULL
-               308 LOAD_BUILD_CLASS
-               310 LOAD_CONST              20 (<code object ObservationTypes, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 53>)
-               312 MAKE_FUNCTION            0
-               314 LOAD_CONST              21 ('ObservationTypes')
-               316 LOAD_NAME               39 (StringEnumeration)
-               318 PRECALL                  3
-               322 CALL                     3
-               332 STORE_NAME              50 (ObservationTypes)
-   
-    58         334 LOAD_NAME               40 (str)
-               336 STORE_NAME              51 (ObservationTypeLabel)
-   
-    59         338 LOAD_NAME               47 (tuple)
-               340 LOAD_NAME               49 (ObservationTypeType)
-               342 LOAD_NAME               51 (ObservationTypeLabel)
-               344 BUILD_TUPLE              2
-               346 BINARY_SUBSCR
-               356 STORE_NAME              52 (ObservationSpecIdentifier)
-   
-    61         358 LOAD_NAME               40 (str)
-               360 STORE_NAME              53 (EventSpecLabel)
-   
-    62         362 LOAD_NAME               40 (str)
-               364 STORE_NAME              54 (MeasurementSpecLabel)
-   
-    64         366 PUSH_NULL
-               368 LOAD_NAME               13 (TypeVar)
-               370 LOAD_CONST              22 ('TimeseriesTypeType')
-               372 LOAD_CONST              23 ('TimeseriesSpec')
-               374 KW_NAMES                24
-               376 PRECALL                  2
-               380 CALL                     2
-               390 STORE_NAME              55 (TimeseriesSpecType)
-   
-    67         392 PUSH_NULL
-               394 LOAD_BUILD_CLASS
-               396 LOAD_CONST              25 (<code object TimeseriesTypeMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 67>)
-               398 MAKE_FUNCTION            0
-               400 LOAD_CONST              26 ('TimeseriesTypeMergeException')
-               402 LOAD_NAME               56 (Exception)
-               404 PRECALL                  3
-               408 CALL                     3
-               418 STORE_NAME              57 (TimeseriesTypeMergeException)
-   
-    71         420 PUSH_NULL
-               422 LOAD_BUILD_CLASS
-               424 LOAD_CONST              27 (<code object TimeseriesCollectionMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 71>)
-               426 MAKE_FUNCTION            0
-               428 LOAD_CONST              28 ('TimeseriesCollectionMergeException')
-               430 LOAD_NAME               56 (Exception)
-               432 PRECALL                  3
-               436 CALL                     3
-               446 STORE_NAME              58 (TimeseriesCollectionMergeException)
-   
-    75         448 PUSH_NULL
-               450 LOAD_BUILD_CLASS
-               452 LOAD_CONST              29 (<code object MachineDataMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 75>)
-               454 MAKE_FUNCTION            0
-               456 LOAD_CONST              30 ('MachineDataMergeException')
-               458 LOAD_NAME               56 (Exception)
-               460 PRECALL                  3
-               464 CALL                     3
-               474 STORE_NAME              59 (MachineDataMergeException)
-   
-    79         476 PUSH_NULL
-               478 LOAD_NAME                6 (dataclass)
-               480 LOAD_CONST              31 (True)
-               482 LOAD_CONST              31 (True)
-               484 LOAD_CONST              31 (True)
-               486 LOAD_CONST              31 (True)
-               488 LOAD_CONST              32 (False)
-               490 KW_NAMES                33
-               492 PRECALL                  5
-               496 CALL                     5
-   
-    80         506 PUSH_NULL
-               508 LOAD_BUILD_CLASS
-               510 LOAD_CONST              34 (<code object TimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 79>)
-               512 MAKE_FUNCTION            0
-               514 LOAD_CONST              23 ('TimeseriesSpec')
-               516 LOAD_NAME               11 (Iterable)
-               518 LOAD_NAME               14 (Sized)
-               520 PRECALL                  4
-               524 CALL                     4
-   
-    79         534 PRECALL                  0
-               538 CALL                     0
-   
-    80         548 STORE_NAME              60 (TimeseriesSpec)
-   
-   131         550 PUSH_NULL
-               552 LOAD_NAME                6 (dataclass)
-               554 LOAD_CONST              31 (True)
-               556 LOAD_CONST              32 (False)
-               558 KW_NAMES                35
-               560 PRECALL                  2
-               564 CALL                     2
-   
-   132         574 PUSH_NULL
-               576 LOAD_BUILD_CLASS
-               578 LOAD_CONST              36 (<code object EventTimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 131>)
-               580 MAKE_FUNCTION            0
-               582 LOAD_CONST              37 ('EventTimeseriesSpec')
-               584 LOAD_NAME               60 (TimeseriesSpec)
-               586 PRECALL                  3
-               590 CALL                     3
-   
-   131         600 PRECALL                  0
-               604 CALL                     0
-   
-   132         614 STORE_NAME              61 (EventTimeseriesSpec)
-   
-   136         616 PUSH_NULL
-               618 LOAD_NAME                6 (dataclass)
-               620 LOAD_CONST              31 (True)
-               622 LOAD_CONST              32 (False)
-               624 KW_NAMES                35
-               626 PRECALL                  2
-               630 CALL                     2
-   
-   137         640 PUSH_NULL
-               642 LOAD_BUILD_CLASS
-               644 LOAD_CONST              38 (<code object MeasurementTimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 136>)
-               646 MAKE_FUNCTION            0
-               648 LOAD_CONST              39 ('MeasurementTimeseriesSpec')
-               650 LOAD_NAME               60 (TimeseriesSpec)
-               652 PRECALL                  3
-               656 CALL                     3
-   
-   136         666 PRECALL                  0
-               670 CALL                     0
-   
-   137         680 STORE_NAME              62 (MeasurementTimeseriesSpec)
-   
-   141         682 PUSH_NULL
-               684 LOAD_BUILD_CLASS
-               686 LOAD_CONST              40 (<code object TimeseriesSpecFactory, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 141>)
-               688 MAKE_FUNCTION            0
-               690 LOAD_CONST              41 ('TimeseriesSpecFactory')
-               692 PRECALL                  2
-               696 CALL                     2
-               706 STORE_NAME              63 (TimeseriesSpecFactory)
-   
-   149         708 PUSH_NULL
-               710 LOAD_NAME               13 (TypeVar)
-               712 LOAD_CONST              42 ('TSSpec')
-               714 LOAD_NAME               60 (TimeseriesSpec)
-               716 KW_NAMES                24
-               718 PRECALL                  2
-               722 CALL                     2
-               732 STORE_NAME              64 (TSSpec)
-   
-   152         734 LOAD_NAME                6 (dataclass)
-   
-   153         736 PUSH_NULL
-               738 LOAD_BUILD_CLASS
-               740 LOAD_CONST              43 (<code object AbstractMachineDataTimeseries, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 152>)
-               742 MAKE_FUNCTION            0
-               744 LOAD_CONST              44 ('AbstractMachineDataTimeseries')
-               746 LOAD_NAME               12 (Generic)
-               748 LOAD_NAME               64 (TSSpec)
-               750 BINARY_SUBSCR
-               760 LOAD_NAME                4 (ABC)
-               762 PRECALL                  4
-               766 CALL                     4
-   
-   152         776 PRECALL                  0
-               780 CALL                     0
-   
-   153         790 STORE_NAME              65 (AbstractMachineDataTimeseries)
-   
-   158         792 LOAD_NAME                6 (dataclass)
-   
-   159         794 PUSH_NULL
-               796 LOAD_BUILD_CLASS
-               798 LOAD_CONST              45 (<code object MachineDataTimeseries, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 158>)
-               800 MAKE_FUNCTION            0
-               802 LOAD_CONST              46 ('MachineDataTimeseries')
-               804 LOAD_NAME               65 (AbstractMachineDataTimeseries)
-               806 LOAD_NAME               64 (TSSpec)
-               808 BINARY_SUBSCR
-               818 PRECALL                  3
-               822 CALL                     3
-   
-   158         832 PRECALL                  0
-               836 CALL                     0
-   
-   159         846 STORE_NAME              66 (MachineDataTimeseries)
-   
-   163         848 LOAD_NAME                6 (dataclass)
-   
-   164         850 PUSH_NULL
-               852 LOAD_BUILD_CLASS
-               854 LOAD_CONST              47 (<code object EventSeries, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 163>)
-               856 MAKE_FUNCTION            0
-               858 LOAD_CONST              48 ('EventSeries')
-               860 LOAD_NAME               66 (MachineDataTimeseries)
-               862 LOAD_NAME               61 (EventTimeseriesSpec)
-               864 BINARY_SUBSCR
-               874 PRECALL                  3
-               878 CALL                     3
-   
-   163         888 PRECALL                  0
-               892 CALL                     0
-   
-   164         902 STORE_NAME              67 (EventSeries)
-   
-   168         904 LOAD_NAME                6 (dataclass)
-   
-   169         906 PUSH_NULL
-               908 LOAD_BUILD_CLASS
-               910 LOAD_CONST              49 (<code object MeasurementSeries, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 168>)
-               912 MAKE_FUNCTION            0
-               914 LOAD_CONST              50 ('MeasurementSeries')
-               916 LOAD_NAME               66 (MachineDataTimeseries)
-               918 LOAD_NAME               62 (MeasurementTimeseriesSpec)
-               920 BINARY_SUBSCR
-               930 PRECALL                  3
-               934 CALL                     3
-   
-   168         944 PRECALL                  0
-               948 CALL                     0
-   
-   169         958 STORE_NAME              68 (MeasurementSeries)
-   
-   173         960 PUSH_NULL
-               962 LOAD_NAME               13 (TypeVar)
-               964 LOAD_CONST              51 ('TS')
-               966 LOAD_NAME               66 (MachineDataTimeseries)
-               968 KW_NAMES                24
-               970 PRECALL                  2
-               974 CALL                     2
-               984 STORE_NAME              69 (TS)
-   
-   175         986 PUSH_NULL
-               988 LOAD_NAME               13 (TypeVar)
-               990 LOAD_CONST              52 ('TTC')
-               992 LOAD_CONST              53 ('TypedTimeseriesCollection')
-               994 KW_NAMES                24
-               996 PRECALL                  2
-              1000 CALL                     2
-              1010 STORE_NAME              70 (TTC)
-   
-   178        1012 PUSH_NULL
-              1014 LOAD_BUILD_CLASS
-              1016 LOAD_CONST              54 (<code object TypedTimeseriesCollection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 178>)
-              1018 MAKE_FUNCTION            0
-              1020 LOAD_CONST              53 ('TypedTimeseriesCollection')
-              1022 LOAD_NAME               12 (Generic)
-              1024 LOAD_NAME               64 (TSSpec)
-              1026 LOAD_NAME               69 (TS)
-              1028 BUILD_TUPLE              2
-              1030 BINARY_SUBSCR
-              1040 LOAD_NAME                4 (ABC)
-              1042 PRECALL                  4
-              1046 CALL                     4
-              1056 STORE_NAME              71 (TypedTimeseriesCollection)
-   
-   298        1058 PUSH_NULL
-              1060 LOAD_BUILD_CLASS
-              1062 LOAD_CONST              55 (<code object EventTimeseriesCollection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 298>)
-              1064 MAKE_FUNCTION            0
-              1066 LOAD_CONST              56 ('EventTimeseriesCollection')
-              1068 LOAD_NAME               71 (TypedTimeseriesCollection)
-              1070 LOAD_NAME               61 (EventTimeseriesSpec)
-              1072 LOAD_NAME               67 (EventSeries)
-              1074 BUILD_TUPLE              2
-              1076 BINARY_SUBSCR
-              1086 PRECALL                  3
-              1090 CALL                     3
-              1100 STORE_NAME              72 (EventTimeseriesCollection)
-   
-   303        1102 PUSH_NULL
-              1104 LOAD_BUILD_CLASS
-              1106 LOAD_CONST              57 (<code object MeasurementTimeseriesCollection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 303>)
-              1108 MAKE_FUNCTION            0
-              1110 LOAD_CONST              58 ('MeasurementTimeseriesCollection')
-              1112 LOAD_NAME               71 (TypedTimeseriesCollection)
-              1114 LOAD_NAME               62 (MeasurementTimeseriesSpec)
-              1116 LOAD_NAME               68 (MeasurementSeries)
-              1118 BUILD_TUPLE              2
-              1120 BINARY_SUBSCR
-              1130 PRECALL                  3
-              1134 CALL                     3
-              1144 STORE_NAME              73 (MeasurementTimeseriesCollection)
-   
-   308        1146 PUSH_NULL
-              1148 LOAD_NAME               13 (TypeVar)
-              1150 LOAD_CONST              59 ('ETSType')
-              1152 LOAD_NAME               60 (TimeseriesSpec)
-              1154 KW_NAMES                24
-              1156 PRECALL                  2
-              1160 CALL                     2
-              1170 STORE_NAME              74 (ETSType)
-   
-   309        1172 PUSH_NULL
-              1174 LOAD_NAME               13 (TypeVar)
-              1176 LOAD_CONST              60 ('MTSType')
-              1178 LOAD_NAME               60 (TimeseriesSpec)
-              1180 KW_NAMES                24
-              1182 PRECALL                  2
-              1186 CALL                     2
-              1196 STORE_NAME              75 (MTSType)
-   
-   311        1198 PUSH_NULL
-              1200 LOAD_NAME               13 (TypeVar)
-              1202 LOAD_CONST              61 ('ETS')
-              1204 LOAD_NAME               66 (MachineDataTimeseries)
-              1206 KW_NAMES                24
-              1208 PRECALL                  2
-              1212 CALL                     2
-              1222 STORE_NAME              76 (ETS)
-   
-   312        1224 PUSH_NULL
-              1226 LOAD_NAME               13 (TypeVar)
-              1228 LOAD_CONST              62 ('MTS')
-              1230 LOAD_NAME               66 (MachineDataTimeseries)
-              1232 KW_NAMES                24
-              1234 PRECALL                  2
-              1238 CALL                     2
-              1248 STORE_NAME              77 (MTS)
-   
-   314        1250 PUSH_NULL
-              1252 LOAD_NAME               13 (TypeVar)
-              1254 LOAD_CONST              63 ('ETSC')
-              1256 LOAD_NAME               71 (TypedTimeseriesCollection)
-              1258 KW_NAMES                24
-              1260 PRECALL                  2
-              1264 CALL                     2
-              1274 STORE_NAME              78 (ETSC)
-   
-   315        1276 PUSH_NULL
-              1278 LOAD_NAME               13 (TypeVar)
-              1280 LOAD_CONST              64 ('MTSC')
-              1282 LOAD_NAME               71 (TypedTimeseriesCollection)
-              1284 KW_NAMES                24
-              1286 PRECALL                  2
-              1290 CALL                     2
-              1300 STORE_NAME              79 (MTSC)
-   
-   318        1302 PUSH_NULL
-              1304 LOAD_BUILD_CLASS
-              1306 LOAD_CONST              65 (<code object TimeseriesCollectionFactory, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 318>)
-              1308 MAKE_FUNCTION            0
-              1310 LOAD_CONST              66 ('TimeseriesCollectionFactory')
-              1312 PRECALL                  2
-              1316 CALL                     2
-              1326 STORE_NAME              80 (TimeseriesCollectionFactory)
-   
-   329        1328 PUSH_NULL
-              1330 LOAD_NAME               13 (TypeVar)
-              1332 LOAD_CONST              67 ('AMD')
-              1334 LOAD_CONST              68 ('AbstractMachineData')
-              1336 KW_NAMES                24
-              1338 PRECALL                  2
-              1342 CALL                     2
-              1352 STORE_NAME              81 (AMD)
-   
-   332        1354 PUSH_NULL
-              1356 LOAD_BUILD_CLASS
-              1358 LOAD_CONST              69 (<code object AbstractMachineData, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 332>)
-              1360 MAKE_FUNCTION            0
-              1362 LOAD_CONST              68 ('AbstractMachineData')
-              1364 LOAD_NAME               12 (Generic)
-              1366 LOAD_NAME               74 (ETSType)
-              1368 LOAD_NAME               75 (MTSType)
-              1370 LOAD_NAME               76 (ETS)
-              1372 LOAD_NAME               77 (MTS)
-              1374 LOAD_NAME               78 (ETSC)
-              1376 LOAD_NAME               79 (MTSC)
-              1378 BUILD_TUPLE              6
-              1380 BINARY_SUBSCR
-              1390 LOAD_NAME                4 (ABC)
-              1392 PRECALL                  4
-              1396 CALL                     4
-              1406 STORE_NAME              82 (AbstractMachineData)
-   
-   562        1408 PUSH_NULL
-              1410 LOAD_BUILD_CLASS
-              1412 LOAD_CONST              70 (<code object MachineData, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 562>)
-              1414 MAKE_FUNCTION            0
-              1416 LOAD_CONST              71 ('MachineData')
-              1418 LOAD_NAME               82 (AbstractMachineData)
-   
-   563        1420 LOAD_NAME               61 (EventTimeseriesSpec)
-              1422 LOAD_NAME               62 (MeasurementTimeseriesSpec)
-              1424 LOAD_NAME               67 (EventSeries)
-              1426 LOAD_NAME               68 (MeasurementSeries)
-              1428 LOAD_NAME               72 (EventTimeseriesCollection)
-              1430 LOAD_NAME               73 (MeasurementTimeseriesCollection)
-              1432 BUILD_TUPLE              6
-   
-   562        1434 BINARY_SUBSCR
-              1444 PRECALL                  3
-              1448 CALL                     3
-              1458 STORE_NAME              83 (MachineData)
-   
-   568        1460 NOP
-   
-   569        1462 NOP
-   
-   570        1464 NOP
-   
-   568        1466 LOAD_CONST              76 ((None, True, False))
-              1468 LOAD_CONST              77 (('series', 'Iterable[TypedTimeseriesCollection]'))
-              1470 LOAD_CONST              74 (<code object build_shared_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 568>)
-              1472 MAKE_FUNCTION            5 (defaults, annotations)
-              1474 STORE_NAME              84 (build_shared_index)
-              1476 LOAD_CONST               2 (None)
-              1478 RETURN_VALUE
+     7          50 LOAD_CONST               0 (0)
+                52 LOAD_CONST               4 (('Iterable', 'Collection', 'Mapping', 'Set', 'Iterator'))
+                54 IMPORT_NAME              7 (collections.abc)
+                56 IMPORT_FROM              8 (Iterable)
+                58 STORE_NAME               8 (Iterable)
+                60 IMPORT_FROM              9 (Collection)
+                62 STORE_NAME               9 (Collection)
+                64 IMPORT_FROM             10 (Mapping)
+                66 STORE_NAME              10 (Mapping)
+                68 IMPORT_FROM             11 (Set)
+                70 STORE_NAME              11 (Set)
+                72 IMPORT_FROM             12 (Iterator)
+                74 STORE_NAME              12 (Iterator)
+                76 POP_TOP
+   
+     8          78 LOAD_CONST               0 (0)
+                80 LOAD_CONST               5 (('dataclass',))
+                82 IMPORT_NAME             13 (dataclasses)
+                84 IMPORT_FROM             14 (dataclass)
+                86 STORE_NAME              14 (dataclass)
+                88 POP_TOP
+   
+     9          90 LOAD_CONST               0 (0)
+                92 LOAD_CONST               6 (('Generic', 'Literal', 'Union'))
+                94 IMPORT_NAME              4 (typing)
+                96 IMPORT_FROM             15 (Generic)
+                98 STORE_NAME              15 (Generic)
+               100 IMPORT_FROM             16 (Literal)
+               102 STORE_NAME              16 (Literal)
+               104 IMPORT_FROM             17 (Union)
+               106 STORE_NAME              17 (Union)
+               108 POP_TOP
+   
+    11         110 LOAD_CONST               0 (0)
+               112 LOAD_CONST               2 (None)
+               114 IMPORT_NAME             18 (numpy)
+               116 STORE_NAME              19 (np)
+   
+    12         118 LOAD_CONST               0 (0)
+               120 LOAD_CONST               2 (None)
+               122 IMPORT_NAME             20 (pandas)
+               124 STORE_NAME              21 (pd)
+   
+    13         126 LOAD_CONST               0 (0)
+               128 LOAD_CONST               7 (('immutabledict',))
+               130 IMPORT_NAME             22 (immutabledict)
+               132 IMPORT_FROM             22 (immutabledict)
+               134 STORE_NAME              22 (immutabledict)
+               136 POP_TOP
+   
+    15         138 LOAD_CONST               8 (1)
+               140 LOAD_CONST               9 (('StrIndexer', 'TimeseriesFeatureLabel', 'TimeseriesFeatureLabels', 'ObservationTypeValue', 'ObservationType', 'ObservationSpecLabel', 'ObservationSpecIdentifier', 'EventSpecLabel', 'MeasurementSpecLabel', 'ObservationTypes', 'MDConcepts', 'only_feature_columns'))
+               142 IMPORT_NAME             23 (shared_defs)
+               144 IMPORT_FROM             24 (StrIndexer)
+               146 STORE_NAME              24 (StrIndexer)
+               148 IMPORT_FROM             25 (TimeseriesFeatureLabel)
+               150 STORE_NAME              25 (TimeseriesFeatureLabel)
+               152 IMPORT_FROM             26 (TimeseriesFeatureLabels)
+               154 STORE_NAME              26 (TimeseriesFeatureLabels)
+               156 IMPORT_FROM             27 (ObservationTypeValue)
+               158 STORE_NAME              27 (ObservationTypeValue)
+               160 IMPORT_FROM             28 (ObservationType)
+               162 STORE_NAME              28 (ObservationType)
+               164 IMPORT_FROM             29 (ObservationSpecLabel)
+               166 STORE_NAME              29 (ObservationSpecLabel)
+               168 IMPORT_FROM             30 (ObservationSpecIdentifier)
+               170 STORE_NAME              30 (ObservationSpecIdentifier)
+               172 IMPORT_FROM             31 (EventSpecLabel)
+               174 STORE_NAME              31 (EventSpecLabel)
+               176 IMPORT_FROM             32 (MeasurementSpecLabel)
+               178 STORE_NAME              32 (MeasurementSpecLabel)
+               180 IMPORT_FROM             33 (ObservationTypes)
+               182 STORE_NAME              33 (ObservationTypes)
+               184 IMPORT_FROM             34 (MDConcepts)
+               186 STORE_NAME              34 (MDConcepts)
+               188 IMPORT_FROM             35 (only_feature_columns)
+               190 STORE_NAME              35 (only_feature_columns)
+               192 POP_TOP
+   
+    18         194 LOAD_CONST               8 (1)
+               196 LOAD_CONST              10 (('derive_categoricals',))
+               198 IMPORT_NAME             36 (df_utils)
+               200 IMPORT_FROM             37 (derive_categoricals)
+               202 STORE_NAME              37 (derive_categoricals)
+               204 POP_TOP
+   
+    19         206 LOAD_CONST               8 (1)
+               208 LOAD_CONST              11 (('Header', 'ObservationSpec', 'Meta', 'FeatureSpec'))
+               210 IMPORT_NAME             38 (header)
+               212 IMPORT_FROM             39 (Header)
+               214 STORE_NAME              39 (Header)
+               216 IMPORT_FROM             40 (ObservationSpec)
+               218 STORE_NAME              40 (ObservationSpec)
+               220 IMPORT_FROM             41 (Meta)
+               222 STORE_NAME              41 (Meta)
+               224 IMPORT_FROM             42 (FeatureSpec)
+               226 STORE_NAME              42 (FeatureSpec)
+               228 POP_TOP
+   
+    20         230 LOAD_CONST               8 (1)
+               232 LOAD_CONST              12 (('EventSpecific', 'MeasurementSpecific', 'TimeseriesSpecProtocol', 'TimeseriesViewProtocol', 'TimeseriesContainerProtocol', 'MachineDataProtocol', 'TSSpec', 'TSView', 'ETSC', 'MTSC', 'ETSView', 'ETSSpec', 'MTSView', 'MTSSpec', 'TSContainer', 'MachineData'))
+               234 IMPORT_NAME             43 (protocols)
+               236 IMPORT_FROM             44 (EventSpecific)
+               238 STORE_NAME              44 (EventSpecific)
+               240 IMPORT_FROM             45 (MeasurementSpecific)
+               242 STORE_NAME              45 (MeasurementSpecific)
+               244 IMPORT_FROM             46 (TimeseriesSpecProtocol)
+               246 STORE_NAME              46 (TimeseriesSpecProtocol)
+               248 IMPORT_FROM             47 (TimeseriesViewProtocol)
+               250 STORE_NAME              47 (TimeseriesViewProtocol)
+               252 IMPORT_FROM             48 (TimeseriesContainerProtocol)
+               254 STORE_NAME              48 (TimeseriesContainerProtocol)
+               256 IMPORT_FROM             49 (MachineDataProtocol)
+               258 STORE_NAME              49 (MachineDataProtocol)
+               260 IMPORT_FROM             50 (TSSpec)
+               262 STORE_NAME              50 (TSSpec)
+               264 IMPORT_FROM             51 (TSView)
+               266 STORE_NAME              51 (TSView)
+               268 IMPORT_FROM             52 (ETSC)
+               270 STORE_NAME              52 (ETSC)
+               272 IMPORT_FROM             53 (MTSC)
+               274 STORE_NAME              53 (MTSC)
+               276 IMPORT_FROM             54 (ETSView)
+               278 STORE_NAME              54 (ETSView)
+               280 IMPORT_FROM             55 (ETSSpec)
+               282 STORE_NAME              55 (ETSSpec)
+               284 IMPORT_FROM             56 (MTSView)
+               286 STORE_NAME              56 (MTSView)
+               288 IMPORT_FROM             57 (MTSSpec)
+               290 STORE_NAME              57 (MTSSpec)
+               292 IMPORT_FROM             58 (TSContainer)
+               294 STORE_NAME              58 (TSContainer)
+               296 IMPORT_FROM             59 (MachineData)
+               298 STORE_NAME              59 (MachineData)
+               300 POP_TOP
+   
+    23         302 LOAD_CONST               8 (1)
+               304 LOAD_CONST              13 (('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'assert_in'))
+               306 IMPORT_NAME             60 (util)
+               308 IMPORT_FROM             61 (mangle_arg_to_set)
+               310 STORE_NAME              61 (mangle_arg_to_set)
+               312 IMPORT_FROM             62 (mangle_arg_with_bool_fallback)
+               314 STORE_NAME              62 (mangle_arg_with_bool_fallback)
+               316 IMPORT_FROM             63 (mangle_arg_to_tuple)
+               318 STORE_NAME              63 (mangle_arg_to_tuple)
+               320 IMPORT_FROM             64 (assert_in)
+               322 STORE_NAME              64 (assert_in)
+               324 POP_TOP
+   
+    27         326 PUSH_NULL
+               328 LOAD_BUILD_CLASS
+               330 LOAD_CONST              14 (<code object TimeseriesTypeMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 27>)
+               332 MAKE_FUNCTION            0
+               334 LOAD_CONST              15 ('TimeseriesTypeMergeException')
+               336 LOAD_NAME               65 (Exception)
+               338 PRECALL                  3
+               342 CALL                     3
+               352 STORE_NAME              66 (TimeseriesTypeMergeException)
+   
+    31         354 PUSH_NULL
+               356 LOAD_BUILD_CLASS
+               358 LOAD_CONST              16 (<code object TimeseriesCollectionMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 31>)
+               360 MAKE_FUNCTION            0
+               362 LOAD_CONST              17 ('TimeseriesCollectionMergeException')
+               364 LOAD_NAME               65 (Exception)
+               366 PRECALL                  3
+               370 CALL                     3
+               380 STORE_NAME              67 (TimeseriesCollectionMergeException)
+   
+    35         382 PUSH_NULL
+               384 LOAD_BUILD_CLASS
+               386 LOAD_CONST              18 (<code object MachineDataMergeException, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 35>)
+               388 MAKE_FUNCTION            0
+               390 LOAD_CONST              19 ('MachineDataMergeException')
+               392 LOAD_NAME               65 (Exception)
+               394 PRECALL                  3
+               398 CALL                     3
+               408 STORE_NAME              68 (MachineDataMergeException)
+   
+    39         410 PUSH_NULL
+               412 LOAD_NAME               14 (dataclass)
+               414 LOAD_CONST              20 (True)
+               416 LOAD_CONST              20 (True)
+               418 LOAD_CONST              20 (True)
+               420 LOAD_CONST              21 (False)
+               422 KW_NAMES                22
+               424 PRECALL                  4
+               428 CALL                     4
+   
+    40         438 PUSH_NULL
+               440 LOAD_BUILD_CLASS
+               442 LOAD_CONST              23 (<code object TimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 39>)
+               444 MAKE_FUNCTION            0
+               446 LOAD_CONST              24 ('TimeseriesSpec')
+               448 LOAD_NAME               46 (TimeseriesSpecProtocol)
+               450 PRECALL                  3
+               454 CALL                     3
+   
+    39         464 PRECALL                  0
+               468 CALL                     0
+   
+    40         478 STORE_NAME              69 (TimeseriesSpec)
+   
+   116         480 PUSH_NULL
+               482 LOAD_BUILD_CLASS
+               484 LOAD_CONST              25 (<code object EventTimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 116>)
+               486 MAKE_FUNCTION            0
+               488 LOAD_CONST              26 ('EventTimeseriesSpec')
+               490 LOAD_NAME               69 (TimeseriesSpec)
+               492 LOAD_NAME               44 (EventSpecific)
+               494 PRECALL                  4
+               498 CALL                     4
+               508 STORE_NAME              70 (EventTimeseriesSpec)
+   
+   121         510 PUSH_NULL
+               512 LOAD_BUILD_CLASS
+               514 LOAD_CONST              27 (<code object MeasurementTimeseriesSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 121>)
+               516 MAKE_FUNCTION            0
+               518 LOAD_CONST              28 ('MeasurementTimeseriesSpec')
+               520 LOAD_NAME               69 (TimeseriesSpec)
+               522 LOAD_NAME               45 (MeasurementSpecific)
+               524 PRECALL                  4
+               528 CALL                     4
+               538 STORE_NAME              71 (MeasurementTimeseriesSpec)
+   
+   125         540 PUSH_NULL
+               542 LOAD_BUILD_CLASS
+               544 LOAD_CONST              29 (<code object TimeseriesView, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 125>)
+               546 MAKE_FUNCTION            0
+               548 LOAD_CONST              30 ('TimeseriesView')
+               550 LOAD_NAME               47 (TimeseriesViewProtocol)
+               552 LOAD_NAME               50 (TSSpec)
+               554 BINARY_SUBSCR
+               564 LOAD_NAME               15 (Generic)
+               566 LOAD_NAME               50 (TSSpec)
+               568 BINARY_SUBSCR
+               578 PRECALL                  4
+               582 CALL                     4
+               592 STORE_NAME              72 (TimeseriesView)
+   
+   168         594 LOAD_NAME               72 (TimeseriesView)
+               596 LOAD_NAME               70 (EventTimeseriesSpec)
+               598 BINARY_SUBSCR
+               608 STORE_NAME              73 (cl)
+   
+   171         610 PUSH_NULL
+               612 LOAD_BUILD_CLASS
+               614 LOAD_CONST              31 (<code object EventTimeseriesView, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 171>)
+               616 MAKE_FUNCTION            0
+               618 LOAD_CONST              32 ('EventTimeseriesView')
+               620 LOAD_NAME               72 (TimeseriesView)
+               622 LOAD_NAME               70 (EventTimeseriesSpec)
+               624 BINARY_SUBSCR
+               634 PRECALL                  3
+               638 CALL                     3
+               648 STORE_NAME              74 (EventTimeseriesView)
+   
+   177         650 PUSH_NULL
+               652 LOAD_BUILD_CLASS
+               654 LOAD_CONST              33 (<code object MeasurementTimeseriesView, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 177>)
+               656 MAKE_FUNCTION            0
+               658 LOAD_CONST              34 ('MeasurementTimeseriesView')
+               660 LOAD_NAME               72 (TimeseriesView)
+               662 LOAD_NAME               71 (MeasurementTimeseriesSpec)
+               664 BINARY_SUBSCR
+               674 PRECALL                  3
+               678 CALL                     3
+               688 STORE_NAME              75 (MeasurementTimeseriesView)
+   
+   184         690 NOP
+   
+   185         692 NOP
+   
+   184         694 LOAD_CONST              51 ((True, False, False, False))
+               696 LOAD_CONST              35 (<code object _feature_column_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 184>)
+               698 MAKE_FUNCTION            1 (defaults)
+               700 STORE_NAME              76 (_feature_column_view)
+   
+   212         702 PUSH_NULL
+               704 LOAD_BUILD_CLASS
+               706 LOAD_CONST              36 (<code object AbstractTimeseriesContainer, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 212>)
+               708 MAKE_FUNCTION            0
+               710 LOAD_CONST              37 ('AbstractTimeseriesContainer')
+               712 LOAD_NAME               48 (TimeseriesContainerProtocol)
+               714 LOAD_NAME               50 (TSSpec)
+               716 LOAD_NAME               51 (TSView)
+               718 BUILD_TUPLE              2
+               720 BINARY_SUBSCR
+               730 LOAD_NAME               15 (Generic)
+               732 LOAD_NAME               50 (TSSpec)
+               734 LOAD_NAME               51 (TSView)
+               736 BUILD_TUPLE              2
+               738 BINARY_SUBSCR
+               748 LOAD_NAME                6 (ABC)
+               750 PRECALL                  5
+               754 CALL                     5
+               764 STORE_NAME              77 (AbstractTimeseriesContainer)
+   
+   352         766 PUSH_NULL
+               768 LOAD_BUILD_CLASS
+               770 LOAD_CONST              38 (<code object EventTimeseriesContainer, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 352>)
+               772 MAKE_FUNCTION            0
+               774 LOAD_CONST              39 ('EventTimeseriesContainer')
+               776 LOAD_NAME               77 (AbstractTimeseriesContainer)
+               778 LOAD_NAME               70 (EventTimeseriesSpec)
+               780 LOAD_NAME               74 (EventTimeseriesView)
+               782 BUILD_TUPLE              2
+               784 BINARY_SUBSCR
+               794 PRECALL                  3
+               798 CALL                     3
+               808 STORE_NAME              78 (EventTimeseriesContainer)
+   
+   357         810 PUSH_NULL
+               812 LOAD_BUILD_CLASS
+               814 LOAD_CONST              40 (<code object MeasurementTimeseriesContainer, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 357>)
+               816 MAKE_FUNCTION            0
+               818 LOAD_CONST              41 ('MeasurementTimeseriesContainer')
+               820 LOAD_NAME               77 (AbstractTimeseriesContainer)
+               822 LOAD_NAME               71 (MeasurementTimeseriesSpec)
+               824 LOAD_NAME               75 (MeasurementTimeseriesView)
+               826 BUILD_TUPLE              2
+               828 BINARY_SUBSCR
+               838 PRECALL                  3
+               842 CALL                     3
+               852 STORE_NAME              79 (MeasurementTimeseriesContainer)
+   
+   362         854 PUSH_NULL
+               856 LOAD_BUILD_CLASS
+               858 LOAD_CONST              42 (<code object AbstractMachineData, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 362>)
+               860 MAKE_FUNCTION            0
+               862 LOAD_CONST              43 ('AbstractMachineData')
+               864 LOAD_NAME               49 (MachineDataProtocol)
+               866 LOAD_NAME               55 (ETSSpec)
+               868 LOAD_NAME               54 (ETSView)
+               870 LOAD_NAME               52 (ETSC)
+               872 LOAD_NAME               57 (MTSSpec)
+               874 LOAD_NAME               56 (MTSView)
+               876 LOAD_NAME               53 (MTSC)
+               878 BUILD_TUPLE              6
+               880 BINARY_SUBSCR
+               890 LOAD_NAME                6 (ABC)
+               892 PRECALL                  4
+               896 CALL                     4
+               906 STORE_NAME              80 (AbstractMachineData)
+   
+   641         908 PUSH_NULL
+               910 LOAD_BUILD_CLASS
+               912 LOAD_CONST              44 (<code object BaseMachineData, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 641>)
+               914 MAKE_FUNCTION            0
+               916 LOAD_CONST              45 ('BaseMachineData')
+               918 LOAD_NAME               80 (AbstractMachineData)
+   
+   642         920 LOAD_NAME               70 (EventTimeseriesSpec)
+               922 LOAD_NAME               74 (EventTimeseriesView)
+               924 LOAD_NAME               78 (EventTimeseriesContainer)
+               926 LOAD_NAME               71 (MeasurementTimeseriesSpec)
+               928 LOAD_NAME               75 (MeasurementTimeseriesView)
+               930 LOAD_NAME               79 (MeasurementTimeseriesContainer)
+               932 BUILD_TUPLE              6
+   
+   641         934 BINARY_SUBSCR
+               944 PRECALL                  3
+               948 CALL                     3
+               958 STORE_NAME              81 (BaseMachineData)
+   
+   657         960 NOP
+   
+   658         962 NOP
+   
+   659         964 NOP
+   
+   657         966 LOAD_CONST              52 ((None, True, False))
+               968 LOAD_CONST              53 (('series', 'Iterable[TSContainer]', 'return', 'pd.DataFrame'))
+               970 LOAD_CONST              50 (<code object build_shared_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 657>)
+               972 MAKE_FUNCTION            5 (defaults, annotations)
+               974 STORE_NAME              82 (build_shared_index)
+               976 LOAD_CONST               2 (None)
+               978 RETURN_VALUE
    consts
       0
       ('annotations',)
       None
       ('ABC',)
-      ('dataclass', 'field')
-      ('partial',)
-      ('Iterable', 'Generic', 'TypeVar', 'Sized', 'TYPE_CHECKING', 'Collection', 'Literal', 'ClassVar', 'Callable')
+      ('Iterable', 'Collection', 'Mapping', 'Set', 'Iterator')
+      ('dataclass',)
+      ('Generic', 'Literal', 'Union')
+      ('immutabledict',)
       1
+      ('StrIndexer', 'TimeseriesFeatureLabel', 'TimeseriesFeatureLabels', 'ObservationTypeValue', 'ObservationType', 'ObservationSpecLabel', 'ObservationSpecIdentifier', 'EventSpecLabel', 'MeasurementSpecLabel', 'ObservationTypes', 'MDConcepts', 'only_feature_columns')
       ('derive_categoricals',)
       ('Header', 'ObservationSpec', 'Meta', 'FeatureSpec')
-      ('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'mangle_arg_to_tuple', 'symmetric_difference', 'intersection', 'assert_in', 'StringEnumeration')
-      code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 4
-         flags     : 16777216
-         code
-            0x970065005a0164005a0264015a0364025a0464035a0564045a06650365
-            046505650667045a0764055300
-          23           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MDConcepts')
-                       8 STORE_NAME               2 (__qualname__)
-         
-          24          10 LOAD_CONST               1 ('time')
-                      12 STORE_NAME               3 (Time)
-         
-          25          14 LOAD_CONST               2 ('object')
-                      16 STORE_NAME               4 (Object)
-         
-          26          18 LOAD_CONST               3 ('type')
-                      20 STORE_NAME               5 (Type)
-         
-          27          22 LOAD_CONST               4 ('label')
-                      24 STORE_NAME               6 (Label)
-         
-          29          26 LOAD_NAME                3 (Time)
-                      28 LOAD_NAME                4 (Object)
-                      30 LOAD_NAME                5 (Type)
-                      32 LOAD_NAME                6 (Label)
-                      34 BUILD_LIST               4
-                      36 STORE_NAME               7 (base_columns)
-                      38 LOAD_CONST               5 (None)
-                      40 RETURN_VALUE
-         consts
-            'MDConcepts'
-            'time'
-            'object'
-            'type'
-            'label'
-            None
-         names      ('__name__', '__module__', '__qualname__', 'Time', 'Object', 'Type', 'Label', 'base_columns')
-         varnames   ()
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MDConcepts'
-         firstlineno 23
-         lnotab 0x0a010401040104010402
-      'MDConcepts'
-      code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 2
-         flags     : 16777216
-         code
-            0x970065005a0164005a0264015a03650367015a0465056a060000000000
-            00000065047a0000005a0764025300
-          32           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MDExtensionConcepts')
-                       8 STORE_NAME               2 (__qualname__)
-         
-          33          10 LOAD_CONST               1 ('series_index')
-                      12 STORE_NAME               3 (Index)
-         
-          35          14 LOAD_NAME                3 (Index)
-                      16 BUILD_LIST               1
-                      18 STORE_NAME               4 (extension_columns)
-         
-          36          20 LOAD_NAME                5 (MDConcepts)
-                      22 LOAD_ATTR                6 (base_columns)
-                      32 LOAD_NAME                4 (extension_columns)
-                      34 BINARY_OP                0 (+)
-                      38 STORE_NAME               7 (combined_columns)
-                      40 LOAD_CONST               2 (None)
-                      42 RETURN_VALUE
-         consts
-            'MDExtensionConcepts'
-            'series_index'
-            None
-         names      ('__name__', '__module__', '__qualname__', 'Index', 'extension_columns', 'MDConcepts', 'base_columns', 'combined_columns')
-         varnames   ()
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MDExtensionConcepts'
-         firstlineno 32
-         lnotab 0x0a0104020601
-      'MDExtensionConcepts'
-      code
-         argcount  : 1
-         nlocals   : 1
-         stacksize : 2
-         flags     : 16777219
-         code 0x9700640184007c004400a6000000ab0000000000000000005300
-          39           0 RESUME                   0
-         
-          40           2 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 40>)
-                       4 MAKE_FUNCTION            0
-                       6 LOAD_FAST                0 (cols)
-                       8 GET_ITER
-                      10 PRECALL                  0
-                      14 CALL                     0
-                      24 RETURN_VALUE
-         consts
-            None
-            code
-               argcount  : 1
-               nlocals   : 2
-               stacksize : 4
-               flags     : 16777235
-               code
-                  0x970067007c005d207d017c017400000000000000000000006a01000000
-                  00000000007601af107c017404000000000000000000006a030000000000
-                  0000007601af1e7c0191028c215300
-                40           0 RESUME                   0
-                             2 BUILD_LIST               0
-                             4 LOAD_FAST                0 (.0)
-                       >>    6 FOR_ITER                32 (to 72)
-                             8 STORE_FAST               1 (c)
-                            10 LOAD_FAST                1 (c)
-                            12 LOAD_GLOBAL              0 (MDConcepts)
-                            24 LOAD_ATTR                1 (base_columns)
-                            34 CONTAINS_OP              1
-                            36 POP_JUMP_BACKWARD_IF_FALSE    16 (to 6)
-                            38 LOAD_FAST                1 (c)
-                            40 LOAD_GLOBAL              4 (MDExtensionConcepts)
-                            52 LOAD_ATTR                3 (extension_columns)
-                            62 CONTAINS_OP              1
-                            64 POP_JUMP_BACKWARD_IF_FALSE    30 (to 6)
-                            66 LOAD_FAST                1 (c)
-                            68 LIST_APPEND              2
-                            70 JUMP_BACKWARD           33 (to 6)
-                       >>   72 RETURN_VALUE
-               consts
-               names      ('MDConcepts', 'base_columns', 'MDExtensionConcepts', 'extension_columns')
-               varnames   ('.0', 'c')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       '<listcomp>'
-               firstlineno 40
-               lnotab 0x
-         names      ()
-         varnames   ('cols',)
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'only_feature_columns'
-         firstlineno 39
-         lnotab 0x0201
-      'df'
-      'pd.DataFrame'
-      code
-         argcount  : 1
-         nlocals   : 1
-         stacksize : 4
-         flags     : 16777219
-         code
-            0x97007c007401000000000000000000007c006a010000000000000000a6
-            010000ab010000000000000000190000000000000000005300
-          43           0 RESUME                   0
-         
-          44           2 LOAD_FAST                0 (df)
-                       4 LOAD_GLOBAL              1 (NULL + only_feature_columns)
-                      16 LOAD_FAST                0 (df)
-                      18 LOAD_ATTR                1 (columns)
-                      28 PRECALL                  1
-                      32 CALL                     1
-                      42 BINARY_SUBSCR
-                      52 RETURN_VALUE
-         consts
-            None
-         names      ('only_feature_columns', 'columns')
-         varnames   ('df',)
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'project_on_feature_columns'
-         firstlineno 43
-         lnotab 0x0201
-      Ellipsis
-      code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 3
-         flags     : 16777216
-         code
-            0x970065005a0164005a02550064015a036402650464013c00000064035a
-            056402650464033c00000064045300
-          53           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('ObservationTypes')
-                       8 STORE_NAME               2 (__qualname__)
-                      10 SETUP_ANNOTATIONS
-         
-          54          12 LOAD_CONST               1 ('E')
-                      14 STORE_NAME               3 (E)
-                      16 LOAD_CONST               2 ('ObservationTypeType')
-                      18 LOAD_NAME                4 (__annotations__)
-                      20 LOAD_CONST               1 ('E')
-                      22 STORE_SUBSCR
-         
-          55          26 LOAD_CONST               3 ('M')
-                      28 STORE_NAME               5 (M)
-                      30 LOAD_CONST               2 ('ObservationTypeType')
-                      32 LOAD_NAME                4 (__annotations__)
-                      34 LOAD_CONST               3 ('M')
-                      36 STORE_SUBSCR
-                      40 LOAD_CONST               4 (None)
-                      42 RETURN_VALUE
-         consts
-            'ObservationTypes'
-            'E'
-            'ObservationTypeType'
-            'M'
-            None
-         names      ('__name__', '__module__', '__qualname__', 'E', '__annotations__', 'M')
-         varnames   ()
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'ObservationTypes'
-         firstlineno 53
-         lnotab 0x0c010e01
-      'ObservationTypes'
-      'TimeseriesTypeType'
-      'TimeseriesSpec'
-      ('bound',)
+      ('EventSpecific', 'MeasurementSpecific', 'TimeseriesSpecProtocol', 'TimeseriesViewProtocol', 'TimeseriesContainerProtocol', 'MachineDataProtocol', 'TSSpec', 'TSView', 'ETSC', 'MTSC', 'ETSView', 'ETSSpec', 'MTSView', 'MTSSpec', 'TSContainer', 'MachineData')
+      ('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'assert_in')
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0264015300
-          67           0 RESUME                   0
+          27           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('TimeseriesTypeMergeException')
                        8 STORE_NAME               2 (__qualname__)
          
-          68          10 LOAD_CONST               1 (None)
+          28          10 LOAD_CONST               1 (None)
                       12 RETURN_VALUE
          consts
             'TimeseriesTypeMergeException'
             None
          names      ('__name__', '__module__', '__qualname__')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'TimeseriesTypeMergeException'
-         firstlineno 67
+         firstlineno 27
          lnotab 0x0a01
       'TimeseriesTypeMergeException'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0264015300
-          71           0 RESUME                   0
+          31           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('TimeseriesCollectionMergeException')
                        8 STORE_NAME               2 (__qualname__)
          
-          72          10 LOAD_CONST               1 (None)
+          32          10 LOAD_CONST               1 (None)
                       12 RETURN_VALUE
          consts
             'TimeseriesCollectionMergeException'
             None
          names      ('__name__', '__module__', '__qualname__')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'TimeseriesCollectionMergeException'
-         firstlineno 71
+         firstlineno 31
          lnotab 0x0a01
       'TimeseriesCollectionMergeException'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0264015300
-          75           0 RESUME                   0
+          35           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('MachineDataMergeException')
                        8 STORE_NAME               2 (__qualname__)
          
-          76          10 LOAD_CONST               1 (None)
+          36          10 LOAD_CONST               1 (None)
                       12 RETURN_VALUE
          consts
             'MachineDataMergeException'
             None
          names      ('__name__', '__module__', '__qualname__')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'MachineDataMergeException'
-         firstlineno 75
+         firstlineno 35
          lnotab 0x0a01
       'MachineDataMergeException'
       True
       False
-      ('frozen', 'unsafe_hash', 'eq', 'repr', 'init')
+      ('frozen', 'unsafe_hash', 'eq', 'repr')
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 3
          flags     : 16777216
          code
-            0x8700970065005a0164005a0255006401650364023c0000006403650364
-            043c0000006405650364063c000000020065046407ac08a6010000ab0100
-            000000000000005a0564096503640a3c000000020065046407ac08a60100
-            00ab0100000000000000005a0664096503640b3c00000064218800660164
-            0f840c5a07641084005a08641184005a09650a642264138404a6000000ab
-            0000000000000000005a0b6423641684045a0c6424641884045a0d642564
-            1a84045a0e6426641f84045a0f6427642084045a10880078015a115300
-                       0 MAKE_CELL                0 (__class__)
+            0x970065005a0164005a0255006401650364023c0000006403650364043c
+            0000006405650364063c0000006407650364083c00000065046429640d84
+            04a6000000ab0000000000000000005a056506642a640f8404a6000000ab
+            0000000000000000005a076506642b64108404a6000000ab000000000000
+            0000005a086506642c64128404a6000000ab0000000000000000005a0965
+            06642d64138404a6000000ab0000000000000000005a0a6506642e641484
+            04a6000000ab0000000000000000005a0b6506642e64158404a6000000ab
+            0000000000000000005a0c642f641784045a0d6430641984045a0e641a84
+            005a0f641b84005a106431641f84045a116432642184045a126433642384
+            045a136434642684045a146435642784045a1564285300
+          39           0 RESUME                   0
+                       2 LOAD_NAME                0 (__name__)
+                       4 STORE_NAME               1 (__module__)
+                       6 LOAD_CONST               0 ('TimeseriesSpec')
+                       8 STORE_NAME               2 (__qualname__)
+                      10 SETUP_ANNOTATIONS
          
-          79           2 RESUME                   0
-                       4 LOAD_NAME                0 (__name__)
-                       6 STORE_NAME               1 (__module__)
-                       8 LOAD_CONST               0 ('TimeseriesSpec')
-                      10 STORE_NAME               2 (__qualname__)
-                      12 SETUP_ANNOTATIONS
+          41          12 LOAD_CONST               1 ('typing.ClassVar[ObservationType]')
+                      14 LOAD_NAME                3 (__annotations__)
+                      16 LOAD_CONST               2 ('observation_type')
+                      18 STORE_SUBSCR
+         
+          42          22 LOAD_CONST               3 ('ObservationSpecLabel')
+                      24 LOAD_NAME                3 (__annotations__)
+                      26 LOAD_CONST               4 ('_label')
+                      28 STORE_SUBSCR
          
-          81          14 LOAD_CONST               1 ('ClassVar[ObservationTypeType]')
-                      16 LOAD_NAME                3 (__annotations__)
-                      18 LOAD_CONST               2 ('type')
-                      20 STORE_SUBSCR
-         
-          82          24 LOAD_CONST               3 ('ObservationTypeLabel')
-                      26 LOAD_NAME                3 (__annotations__)
-                      28 LOAD_CONST               4 ('label')
-                      30 STORE_SUBSCR
-         
-          83          34 LOAD_CONST               5 ('ObservationSpec')
-                      36 LOAD_NAME                3 (__annotations__)
-                      38 LOAD_CONST               6 ('base')
-                      40 STORE_SUBSCR
-         
-          84          44 PUSH_NULL
-                      46 LOAD_NAME                4 (field)
-                      48 LOAD_CONST               7 (False)
-                      50 KW_NAMES                 8
-                      52 PRECALL                  1
-                      56 CALL                     1
-                      66 STORE_NAME               5 (features)
-                      68 LOAD_CONST               9 ('TimeseriesFeatureLabels')
-                      70 LOAD_NAME                3 (__annotations__)
-                      72 LOAD_CONST              10 ('features')
-                      74 STORE_SUBSCR
-         
-          85          78 PUSH_NULL
-                      80 LOAD_NAME                4 (field)
-                      82 LOAD_CONST               7 (False)
-                      84 KW_NAMES                 8
-                      86 PRECALL                  1
-                      90 CALL                     1
-                     100 STORE_NAME               6 (display_names)
-                     102 LOAD_CONST               9 ('TimeseriesFeatureLabels')
-                     104 LOAD_NAME                3 (__annotations__)
-                     106 LOAD_CONST              11 ('display_names')
-                     108 STORE_SUBSCR
-         
-          87         112 LOAD_CONST              33 (('label', 'ObservationTypeLabel', 'spec', 'ObservationSpec', 'return', 'None'))
-                     114 LOAD_CLOSURE             0 (__class__)
-                     116 BUILD_TUPLE              1
-                     118 LOAD_CONST              15 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 87>)
-                     120 MAKE_FUNCTION           12 (annotations, closure)
-                     122 STORE_NAME               7 (__init__)
-         
-          94         124 LOAD_CONST              16 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 94>)
-                     126 MAKE_FUNCTION            0
-                     128 STORE_NAME               8 (__iter__)
-         
-          97         130 LOAD_CONST              17 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 97>)
-                     132 MAKE_FUNCTION            0
-                     134 STORE_NAME               9 (__len__)
+          43          32 LOAD_CONST               5 ('ObservationSpec')
+                      34 LOAD_NAME                3 (__annotations__)
+                      36 LOAD_CONST               6 ('_base')
+                      38 STORE_SUBSCR
          
-         100         136 LOAD_NAME               10 (property)
+          44          42 LOAD_CONST               7 ('TimeseriesFeatureLabels')
+                      44 LOAD_NAME                3 (__annotations__)
+                      46 LOAD_CONST               8 ('_features')
+                      48 STORE_SUBSCR
          
-         101         138 LOAD_CONST              34 (('return', 'ObservationSpecIdentifier'))
-                     140 LOAD_CONST              19 (<code object identifier, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 100>)
-                     142 MAKE_FUNCTION            4 (annotations)
+          46          52 LOAD_NAME                4 (classmethod)
          
-         100         144 PRECALL                  0
-                     148 CALL                     0
+          47          54 LOAD_CONST              41 (('label', 'ObservationSpecLabel', 'base_spec', 'ObservationSpec', 'return', 'typing.Self'))
+                      56 LOAD_CONST              13 (<code object of, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 46>)
+                      58 MAKE_FUNCTION            4 (annotations)
+         
+          46          60 PRECALL                  0
+                      64 CALL                     0
+         
+          47          74 STORE_NAME               5 (of)
+         
+          50          76 LOAD_NAME                6 (property)
+         
+          51          78 LOAD_CONST              42 (('return', 'ObservationTypeValue'))
+                      80 LOAD_CONST              15 (<code object type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 50>)
+                      82 MAKE_FUNCTION            4 (annotations)
+         
+          50          84 PRECALL                  0
+                      88 CALL                     0
          
-         101         158 STORE_NAME              11 (identifier)
+          51          98 STORE_NAME               7 (type)
          
-         104         160 LOAD_CONST              35 (('other', 'TimeseriesSpec', 'return', 'bool'))
-                     162 LOAD_CONST              22 (<code object is_mergeable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 104>)
-                     164 MAKE_FUNCTION            4 (annotations)
-                     166 STORE_NAME              12 (is_mergeable)
-         
-         107         168 LOAD_CONST              36 (('other', 'TimeseriesSpec', 'return', 'list[str]'))
-                     170 LOAD_CONST              24 (<code object feature_intersection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 107>)
-                     172 MAKE_FUNCTION            4 (annotations)
-                     174 STORE_NAME              13 (feature_intersection)
-         
-         110         176 LOAD_CONST              37 (('other', 'TimeseriesSpec', 'return', 'tuple[list[str], list[str]]'))
-                     178 LOAD_CONST              26 (<code object feature_symmetric_difference, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 110>)
-                     180 MAKE_FUNCTION            4 (annotations)
-                     182 STORE_NAME              14 (feature_symmetric_difference)
-         
-         114         184 LOAD_CONST              38 (('self', 'TimeseriesSpecType', 'feature_selection', 'bool | str | Collection[str]', 'return', 'TimeseriesSpecType'))
-                     186 LOAD_CONST              31 (<code object project, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 114>)
-                     188 MAKE_FUNCTION            4 (annotations)
-                     190 STORE_NAME              15 (project)
-         
-         119         192 LOAD_CONST              39 (('self', 'TimeseriesSpecType', 'other', 'TimeseriesSpecType', 'return', 'TimeseriesSpecType'))
-                     194 LOAD_CONST              32 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 119>)
-                     196 MAKE_FUNCTION            4 (annotations)
-                     198 STORE_NAME              16 (merge)
-                     200 LOAD_CLOSURE             0 (__class__)
-                     202 COPY                     1
-                     204 STORE_NAME              17 (__classcell__)
-                     206 RETURN_VALUE
+          54         100 LOAD_NAME                6 (property)
+         
+          55         102 LOAD_CONST              43 (('return', 'ObservationSpecLabel'))
+                     104 LOAD_CONST              16 (<code object label, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 54>)
+                     106 MAKE_FUNCTION            4 (annotations)
+         
+          54         108 PRECALL                  0
+                     112 CALL                     0
+         
+          55         122 STORE_NAME               8 (label)
+         
+          58         124 LOAD_NAME                6 (property)
+         
+          59         126 LOAD_CONST              44 (('return', 'ObservationSpecIdentifier'))
+                     128 LOAD_CONST              18 (<code object identifier, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 58>)
+                     130 MAKE_FUNCTION            4 (annotations)
+         
+          58         132 PRECALL                  0
+                     136 CALL                     0
+         
+          59         146 STORE_NAME               9 (identifier)
+         
+          62         148 LOAD_NAME                6 (property)
+         
+          63         150 LOAD_CONST              45 (('return', 'ObservationSpec'))
+                     152 LOAD_CONST              19 (<code object base, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 62>)
+                     154 MAKE_FUNCTION            4 (annotations)
+         
+          62         156 PRECALL                  0
+                     160 CALL                     0
+         
+          63         170 STORE_NAME              10 (base)
+         
+          66         172 LOAD_NAME                6 (property)
+         
+          67         174 LOAD_CONST              46 (('return', 'TimeseriesFeatureLabels'))
+                     176 LOAD_CONST              20 (<code object features, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 66>)
+                     178 MAKE_FUNCTION            4 (annotations)
+         
+          66         180 PRECALL                  0
+                     184 CALL                     0
+         
+          67         194 STORE_NAME              11 (features)
+         
+          70         196 LOAD_NAME                6 (property)
+         
+          71         198 LOAD_CONST              46 (('return', 'TimeseriesFeatureLabels'))
+                     200 LOAD_CONST              21 (<code object long_names, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 70>)
+                     202 MAKE_FUNCTION            4 (annotations)
+         
+          70         204 PRECALL                  0
+                     208 CALL                     0
+         
+          71         218 STORE_NAME              12 (long_names)
+         
+          74         220 LOAD_CONST              47 (('return', 'Iterator[str]'))
+                     222 LOAD_CONST              23 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 74>)
+                     224 MAKE_FUNCTION            4 (annotations)
+                     226 STORE_NAME              13 (__iter__)
+         
+          77         228 LOAD_CONST              48 (('return', 'int'))
+                     230 LOAD_CONST              25 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 77>)
+                     232 MAKE_FUNCTION            4 (annotations)
+                     234 STORE_NAME              14 (__len__)
+         
+          80         236 LOAD_CONST              26 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 80>)
+                     238 MAKE_FUNCTION            0
+                     240 STORE_NAME              15 (__repr__)
+         
+          85         242 LOAD_CONST              27 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 85>)
+                     244 MAKE_FUNCTION            0
+                     246 STORE_NAME              16 (__str__)
+         
+          88         248 LOAD_CONST              49 (('other', 'TimeseriesSpecProtocol', 'return', 'bool'))
+                     250 LOAD_CONST              31 (<code object is_mergeable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 88>)
+                     252 MAKE_FUNCTION            4 (annotations)
+                     254 STORE_NAME              17 (is_mergeable)
+         
+          91         256 LOAD_CONST              50 (('other', 'TimeseriesSpecProtocol', 'return', 'list[str]'))
+                     258 LOAD_CONST              33 (<code object feature_intersection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 91>)
+                     260 MAKE_FUNCTION            4 (annotations)
+                     262 STORE_NAME              18 (feature_intersection)
+         
+          94         264 LOAD_CONST              51 (('other', 'TimeseriesSpecProtocol', 'return', 'tuple[list[str], list[str]]'))
+                     266 LOAD_CONST              35 (<code object feature_symmetric_difference, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 94>)
+                     268 MAKE_FUNCTION            4 (annotations)
+                     270 STORE_NAME              19 (feature_symmetric_difference)
+         
+          98         272 LOAD_CONST              52 (('feature_selection', 'bool | str | Collection[str]', 'return', 'typing.Self'))
+                     274 LOAD_CONST              38 (<code object project, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 98>)
+                     276 MAKE_FUNCTION            4 (annotations)
+                     278 STORE_NAME              20 (project)
+         
+         103         280 LOAD_CONST              53 (('other', 'typing.Self', 'return', 'typing.Self'))
+                     282 LOAD_CONST              39 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 103>)
+                     284 MAKE_FUNCTION            4 (annotations)
+                     286 STORE_NAME              21 (merge)
+                     288 LOAD_CONST              40 (None)
+                     290 RETURN_VALUE
          consts
             'TimeseriesSpec'
-            'ClassVar[ObservationTypeType]'
-            'type'
-            'ObservationTypeLabel'
-            'label'
+            'typing.ClassVar[ObservationType]'
+            'observation_type'
+            'ObservationSpecLabel'
+            '_label'
             'ObservationSpec'
-            'base'
-            False
-            ('init',)
+            '_base'
             'TimeseriesFeatureLabels'
-            'features'
-            'display_names'
-            'spec'
+            '_features'
+            'label'
+            'base_spec'
             'return'
-            'None'
+            'typing.Self'
             code
                argcount  : 3
                nlocals   : 3
                stacksize : 8
                flags     : 16777219
                code
-                  0x95019700740100000000000000000000a6000000ab0000000000000000
-                  00a0010000000000000000000000000000000000000000a6000000ab0000
-                  000000000000000100740400000000000000000000a00300000000000000
-                  000000000000000000000000007c0064017c01a6030000ab030000000000
-                  0000000100740400000000000000000000a0030000000000000000000000
-                  0000000000000000007c0064027c02a6030000ab03000000000000000001
-                  00740400000000000000000000a003000000000000000000000000000000
-                  00000000007c006403740900000000000000000000640484007c024400a6
-                  000000ab000000000000000000a6010000ab010000000000000000a60300
-                  00ab0300000000000000000100740400000000000000000000a003000000
-                  00000000000000000000000000000000007c006405740900000000000000
-                  000000640684007c024400a6000000ab000000000000000000a6010000ab
-                  010000000000000000a6030000ab030000000000000000010064005300
-                             0 COPY_FREE_VARS           1
+                  0x970002007c007c017c02740100000000000000000000640184007c0244
+                  00a6000000ab000000000000000000a6010000ab010000000000000000a6
+                  030000ab0300000000000000005300
+                46           0 RESUME                   0
                
-                87           2 RESUME                   0
-               
-                88           4 LOAD_GLOBAL              1 (NULL + super)
-                            16 PRECALL                  0
-                            20 CALL                     0
-                            30 LOAD_METHOD              1 (__init__)
-                            52 PRECALL                  0
-                            56 CALL                     0
-                            66 POP_TOP
-               
-                89          68 LOAD_GLOBAL              4 (object)
-                            80 LOAD_METHOD              3 (__setattr__)
-                           102 LOAD_FAST                0 (self)
-                           104 LOAD_CONST               1 ('label')
-                           106 LOAD_FAST                1 (label)
-                           108 PRECALL                  3
-                           112 CALL                     3
-                           122 POP_TOP
-               
-                90         124 LOAD_GLOBAL              4 (object)
-                           136 LOAD_METHOD              3 (__setattr__)
-                           158 LOAD_FAST                0 (self)
-                           160 LOAD_CONST               2 ('base')
-                           162 LOAD_FAST                2 (spec)
-                           164 PRECALL                  3
-                           168 CALL                     3
-                           178 POP_TOP
-               
-                91         180 LOAD_GLOBAL              4 (object)
-                           192 LOAD_METHOD              3 (__setattr__)
-                           214 LOAD_FAST                0 (self)
-                           216 LOAD_CONST               3 ('features')
-                           218 LOAD_GLOBAL              9 (NULL + tuple)
-                           230 LOAD_CONST               4 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 91>)
-                           232 MAKE_FUNCTION            0
-                           234 LOAD_FAST                2 (spec)
-                           236 GET_ITER
-                           238 PRECALL                  0
-                           242 CALL                     0
-                           252 PRECALL                  1
-                           256 CALL                     1
-                           266 PRECALL                  3
-                           270 CALL                     3
-                           280 POP_TOP
-               
-                92         282 LOAD_GLOBAL              4 (object)
-                           294 LOAD_METHOD              3 (__setattr__)
-                           316 LOAD_FAST                0 (self)
-                           318 LOAD_CONST               5 ('display_names')
-                           320 LOAD_GLOBAL              9 (NULL + tuple)
-                           332 LOAD_CONST               6 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 92>)
-                           334 MAKE_FUNCTION            0
-                           336 LOAD_FAST                2 (spec)
-                           338 GET_ITER
-                           340 PRECALL                  0
-                           344 CALL                     0
-                           354 PRECALL                  1
-                           358 CALL                     1
-                           368 PRECALL                  3
-                           372 CALL                     3
-                           382 POP_TOP
-                           384 LOAD_CONST               0 (None)
-                           386 RETURN_VALUE
-               consts
-                  None
-                  'label'
-                  'base'
-                  'features'
+                48           2 PUSH_NULL
+                             4 LOAD_FAST                0 (cls)
+                             6 LOAD_FAST                1 (label)
+                             8 LOAD_FAST                2 (base_spec)
+                            10 LOAD_GLOBAL              1 (NULL + tuple)
+                            22 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 48>)
+                            24 MAKE_FUNCTION            0
+                            26 LOAD_FAST                2 (base_spec)
+                            28 GET_ITER
+                            30 PRECALL                  0
+                            34 CALL                     0
+                            44 PRECALL                  1
+                            48 CALL                     1
+                            58 PRECALL                  3
+                            62 CALL                     3
+                            72 RETURN_VALUE
+               consts
+                  None
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 2
                      flags     : 16777267
                      code
                         0x4b00010097007c005d0b7d017c016a0000000000000000005600970101
                         008c0c64005300
-                      91           0 RETURN_GENERATOR
+                      48           0 RETURN_GENERATOR
                                    2 POP_TOP
                                    4 RESUME                   0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                11 (to 32)
                                   10 STORE_FAST               1 (f)
                                   12 LOAD_FAST                1 (f)
                                   14 LOAD_ATTR                0 (name)
@@ -1198,28 +776,172 @@
                                   34 RETURN_VALUE
                      consts
                         None
                      names      ('name',)
                      varnames   ('.0', 'f')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<genexpr>'
-                     firstlineno 91
+                     firstlineno 48
                      lnotab 0x
-                  'display_names'
+               names      ('tuple',)
+               varnames   ('cls', 'label', 'base_spec')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'of'
+               firstlineno 46
+               lnotab 0x0202
+            'ObservationTypeValue'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000006a0100000000000000005300
+                50           0 RESUME                   0
+               
+                52           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (observation_type)
+                            14 LOAD_ATTR                1 (value)
+                            24 RETURN_VALUE
+               consts
+                  None
+               names      ('observation_type', 'value')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'type'
+               firstlineno 50
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+                54           0 RESUME                   0
+               
+                56           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_label)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_label',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'label'
+               firstlineno 54
+               lnotab 0x0202
+            'ObservationSpecIdentifier'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 2
+               flags     : 16777219
+               code
+                  0x97007c006a0000000000000000007c006a010000000000000000660253
+                  00
+                58           0 RESUME                   0
+               
+                60           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (type)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (label)
+                            26 BUILD_TUPLE              2
+                            28 RETURN_VALUE
+               consts
+                  None
+               names      ('type', 'label')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'identifier'
+               firstlineno 58
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+                62           0 RESUME                   0
+               
+                64           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_base)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_base',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'base'
+               firstlineno 62
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+                66           0 RESUME                   0
+               
+                68           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_features)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_features',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'features'
+               firstlineno 66
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 4
+               flags     : 16777219
+               code
+                  0x9700740100000000000000000000640184007c006a0100000000000000
+                  004400a6000000ab000000000000000000a6010000ab0100000000000000
+                  005300
+                70           0 RESUME                   0
+               
+                72           2 LOAD_GLOBAL              1 (NULL + tuple)
+                            14 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 72>)
+                            16 MAKE_FUNCTION            0
+                            18 LOAD_FAST                0 (self)
+                            20 LOAD_ATTR                1 (base)
+                            30 GET_ITER
+                            32 PRECALL                  0
+                            36 CALL                     0
+                            46 PRECALL                  1
+                            50 CALL                     1
+                            60 RETURN_VALUE
+               consts
+                  None
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 2
                      flags     : 16777267
                      code
                         0x4b00010097007c005d0b7d017c016a0000000000000000005600970101
                         008c0c64005300
-                      92           0 RETURN_GENERATOR
+                      72           0 RETURN_GENERATOR
                                    2 POP_TOP
                                    4 RESUME                   0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                11 (to 32)
                                   10 STORE_FAST               1 (f)
                                   12 LOAD_FAST                1 (f)
                                   14 LOAD_ATTR                0 (print_name)
@@ -1231,163 +953,275 @@
                                   34 RETURN_VALUE
                      consts
                         None
                      names      ('print_name',)
                      varnames   ('.0', 'f')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<genexpr>'
-                     firstlineno 92
+                     firstlineno 72
                      lnotab 0x
-               names      ('super', '__init__', 'object', '__setattr__', 'tuple')
-               varnames   ('self', 'label', 'spec')
-               freevars   ('__class__',)
+               names      ('tuple', 'base')
+               varnames   ('self',)
+               freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       '__init__'
-               firstlineno 87
-               lnotab 0x04014001380138016601
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'long_names'
+               firstlineno 70
+               lnotab 0x0202
+            'Iterator[str]'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                94           0 RESUME                   0
+                74           0 RESUME                   0
                
-                95           2 LOAD_GLOBAL              1 (NULL + iter)
+                75           2 LOAD_GLOBAL              1 (NULL + iter)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (features)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('iter', 'features')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__iter__'
-               firstlineno 94
+               firstlineno 74
                lnotab 0x0201
+            'int'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                97           0 RESUME                   0
+                77           0 RESUME                   0
                
-                98           2 LOAD_GLOBAL              1 (NULL + len)
+                78           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (features)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'features')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__len__'
-               firstlineno 97
+               firstlineno 77
                lnotab 0x0201
-            'ObservationSpecIdentifier'
+            code
+               argcount  : 1
+               nlocals   : 2
+               stacksize : 8
+               flags     : 16777219
+               code
+                  0x9700740100000000000000000000640184007403000000000000000000
+                  007c006a0200000000000000007c006a030000000000000000a6020000ab
+                  0200000000000000004400a6000000ab000000000000000000a6010000ab
+                  0100000000000000007d017c006a0400000000000000006a050000000000
+                  0000009b0064027c006a0600000000000000009b0064037c006a07000000
+                  00000000009b0064047c019b0064059d085300
+                80           0 RESUME                   0
+               
+                81           2 LOAD_GLOBAL              1 (NULL + tuple)
+                            14 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 81>)
+                            16 MAKE_FUNCTION            0
+               
+                82          18 LOAD_GLOBAL              3 (NULL + zip)
+                            30 LOAD_FAST                0 (self)
+                            32 LOAD_ATTR                2 (features)
+                            42 LOAD_FAST                0 (self)
+                            44 LOAD_ATTR                3 (long_names)
+                            54 PRECALL                  2
+                            58 CALL                     2
+               
+                81          68 GET_ITER
+                            70 PRECALL                  0
+                            74 CALL                     0
+                            84 PRECALL                  1
+                            88 CALL                     1
+                            98 STORE_FAST               1 (extended_feature_labels)
+               
+                83         100 LOAD_FAST                0 (self)
+                           102 LOAD_ATTR                4 (__class__)
+                           112 LOAD_ATTR                5 (__name__)
+                           122 FORMAT_VALUE             0
+                           124 LOAD_CONST               2 ('(spec_id=(')
+                           126 LOAD_FAST                0 (self)
+                           128 LOAD_ATTR                6 (observation_type)
+                           138 FORMAT_VALUE             0
+                           140 LOAD_CONST               3 (', ')
+                           142 LOAD_FAST                0 (self)
+                           144 LOAD_ATTR                7 (label)
+                           154 FORMAT_VALUE             0
+                           156 LOAD_CONST               4 ('), features=')
+                           158 LOAD_FAST                1 (extended_feature_labels)
+                           160 FORMAT_VALUE             0
+                           162 LOAD_CONST               5 (')')
+                           164 BUILD_STRING             8
+                           166 RETURN_VALUE
+               consts
+                  None
+                  code
+                     argcount  : 1
+                     nlocals   : 3
+                     stacksize : 5
+                     flags     : 16777267
+                     code
+                        0x4b00010097007c005d245c0200007d017d027c017c026b020000000072
+                        0f7401000000000000000000007c01a6010000ab0100000000000000006e
+                        077c019b0064007c029b0064019d045600970101008c2564025300
+                      81           0 RETURN_GENERATOR
+                                   2 POP_TOP
+                                   4 RESUME                   0
+                                   6 LOAD_FAST                0 (.0)
+                             >>    8 FOR_ITER                36 (to 82)
+                     
+                      82          10 UNPACK_SEQUENCE          2
+                                  14 STORE_FAST               1 (f)
+                                  16 STORE_FAST               2 (ln)
+                                  18 LOAD_FAST                1 (f)
+                                  20 LOAD_FAST                2 (ln)
+                                  22 COMPARE_OP               2 (==)
+                                  28 POP_JUMP_FORWARD_IF_FALSE    15 (to 60)
+                                  30 LOAD_GLOBAL              1 (NULL + str)
+                                  42 LOAD_FAST                1 (f)
+                                  44 PRECALL                  1
+                                  48 CALL                     1
+                                  58 JUMP_FORWARD             7 (to 74)
+                             >>   60 LOAD_FAST                1 (f)
+                                  62 FORMAT_VALUE             0
+                                  64 LOAD_CONST               0 (' (')
+                                  66 LOAD_FAST                2 (ln)
+                                  68 FORMAT_VALUE             0
+                                  70 LOAD_CONST               1 (')')
+                                  72 BUILD_STRING             4
+                     
+                      81     >>   74 YIELD_VALUE
+                                  76 RESUME                   1
+                                  78 POP_TOP
+                                  80 JUMP_BACKWARD           37 (to 8)
+                             >>   82 LOAD_CONST               2 (None)
+                                  84 RETURN_VALUE
+                     consts
+                        ' ('
+                        ')'
+                        None
+                     names      ('str',)
+                     varnames   ('.0', 'f', 'ln')
+                     freevars   ()
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       '<genexpr>'
+                     firstlineno 81
+                     lnotab 0x0a0140ff
+                  '(spec_id=('
+                  ', '
+                  '), features='
+                  ')'
+               names      ('tuple', 'zip', 'features', 'long_names', '__class__', '__name__', 'observation_type', 'label')
+               varnames   ('self', 'extended_feature_labels')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__repr__'
+               firstlineno 80
+               lnotab 0x0201100132ff2002
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 2
                flags     : 16777219
                code
-                  0x97007c006a0000000000000000007c006a010000000000000000660253
-                  00
-               100           0 RESUME                   0
+                  0x97007c00a0000000000000000000000000000000000000000000a60000
+                  00ab0000000000000000005300
+                85           0 RESUME                   0
                
-               102           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (type)
-                            14 LOAD_FAST                0 (self)
-                            16 LOAD_ATTR                1 (label)
-                            26 BUILD_TUPLE              2
-                            28 RETURN_VALUE
+                86           2 LOAD_FAST                0 (self)
+                             4 LOAD_METHOD              0 (__repr__)
+                            26 PRECALL                  0
+                            30 CALL                     0
+                            40 RETURN_VALUE
                consts
                   None
-               names      ('type', 'label')
+               names      ('__repr__',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'identifier'
-               firstlineno 100
-               lnotab 0x0202
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__str__'
+               firstlineno 85
+               lnotab 0x0201
             'other'
+            'TimeseriesSpecProtocol'
             'bool'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c006a0000000000000000007c016a0000000000000000006b0200
-                  0000006f1f7c006a0100000000000000007c016a0100000000000000006b
-                  02000000006f0f7c006a0200000000000000007c016a0200000000000000
-                  006b02000000005300
-               104           0 RESUME                   0
+                  0000006f0f7c006a0100000000000000007c016a0100000000000000006b
+                  02000000005300
+                88           0 RESUME                   0
                
-               105           2 LOAD_FAST                0 (self)
+                89           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (__class__)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_ATTR                0 (__class__)
                             26 COMPARE_OP               2 (==)
-                            32 JUMP_IF_FALSE_OR_POP    31 (to 96)
+                            32 JUMP_IF_FALSE_OR_POP    15 (to 64)
                             34 LOAD_FAST                0 (self)
-                            36 LOAD_ATTR                1 (type)
+                            36 LOAD_ATTR                1 (identifier)
                             46 LOAD_FAST                1 (other)
-                            48 LOAD_ATTR                1 (type)
+                            48 LOAD_ATTR                1 (identifier)
                             58 COMPARE_OP               2 (==)
-                            64 JUMP_IF_FALSE_OR_POP    15 (to 96)
-                            66 LOAD_FAST                0 (self)
-                            68 LOAD_ATTR                2 (label)
-                            78 LOAD_FAST                1 (other)
-                            80 LOAD_ATTR                2 (label)
-                            90 COMPARE_OP               2 (==)
-                       >>   96 RETURN_VALUE
+                       >>   64 RETURN_VALUE
                consts
                   None
-               names      ('__class__', 'type', 'label')
+               names      ('__class__', 'identifier')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'is_mergeable'
-               firstlineno 104
+               firstlineno 88
                lnotab 0x0201
             'list[str]'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 16777219
                code
                   0x8701970088016601640184087c006a0000000000000000004400a60000
                   00ab0000000000000000005300
                              0 MAKE_CELL                1 (other)
                
-               107           2 RESUME                   0
+                91           2 RESUME                   0
                
-               108           4 LOAD_CLOSURE             1 (other)
+                92           4 LOAD_CLOSURE             1 (other)
                              6 BUILD_TUPLE              1
-                             8 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 108>)
+                             8 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 92>)
                             10 MAKE_FUNCTION            8 (closure)
                             12 LOAD_FAST                0 (self)
                             14 LOAD_ATTR                0 (features)
                             24 GET_ITER
                             26 PRECALL                  0
                             30 CALL                     0
                             40 RETURN_VALUE
@@ -1400,15 +1234,15 @@
                      flags     : 16777235
                      code
                         0x9501970067007c005d1a7d017c0174010000000000000000000089026a
                         010000000000000000a6010000ab0100000000000000007600af187c0191
                         028c1b5300
                                    0 COPY_FREE_VARS           1
                      
-                     108           2 RESUME                   0
+                      92           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (f)
                                   12 LOAD_FAST                1 (f)
                                   14 LOAD_GLOBAL              1 (NULL + set)
                                   26 LOAD_DEREF               2 (other)
@@ -1422,53 +1256,53 @@
                                   60 JUMP_BACKWARD           27 (to 8)
                              >>   62 RETURN_VALUE
                      consts
                      names      ('set', 'features')
                      varnames   ('.0', 'f')
                      freevars   ('other',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<listcomp>'
-                     firstlineno 108
+                     firstlineno 92
                      lnotab 0x
                names      ('features',)
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ('other',)
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'feature_intersection'
-               firstlineno 107
+               firstlineno 91
                lnotab 0x0401
             'tuple[list[str], list[str]]'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 3
                flags     : 16777219
                code
                   0x870087019700880166016401840889006a0000000000000000004400a6
                   000000ab000000000000000000880066016402840889016a000000000000
                   0000004400a6000000ab00000000000000000066025300
                              0 MAKE_CELL                0 (self)
                              2 MAKE_CELL                1 (other)
                
-               110           4 RESUME                   0
+                94           4 RESUME                   0
                
-               111           6 LOAD_CLOSURE             1 (other)
+                95           6 LOAD_CLOSURE             1 (other)
                              8 BUILD_TUPLE              1
-                            10 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 111>)
+                            10 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 95>)
                             12 MAKE_FUNCTION            8 (closure)
                             14 LOAD_DEREF               0 (self)
                             16 LOAD_ATTR                0 (features)
                             26 GET_ITER
                             28 PRECALL                  0
                             32 CALL                     0
                             42 LOAD_CLOSURE             0 (self)
                             44 BUILD_TUPLE              1
-                            46 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 111>)
+                            46 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 95>)
                             48 MAKE_FUNCTION            8 (closure)
                             50 LOAD_DEREF               1 (other)
                             52 LOAD_ATTR                0 (features)
                             62 GET_ITER
                             64 PRECALL                  0
                             68 CALL                     0
                             78 BUILD_TUPLE              2
@@ -1482,15 +1316,15 @@
                      flags     : 16777235
                      code
                         0x9501970067007c005d1a7d017c0174010000000000000000000089026a
                         010000000000000000a6010000ab0100000000000000007601af187c0191
                         028c1b5300
                                    0 COPY_FREE_VARS           1
                      
-                     111           2 RESUME                   0
+                      95           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (f)
                                   12 LOAD_FAST                1 (f)
                                   14 LOAD_GLOBAL              1 (NULL + set)
                                   26 LOAD_DEREF               2 (other)
@@ -1504,145 +1338,144 @@
                                   60 JUMP_BACKWARD           27 (to 8)
                              >>   62 RETURN_VALUE
                      consts
                      names      ('set', 'features')
                      varnames   ('.0', 'f')
                      freevars   ('other',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<listcomp>'
-                     firstlineno 111
+                     firstlineno 95
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 16777235
                      code
                         0x9501970067007c005d1a7d017c0174010000000000000000000089026a
                         010000000000000000a6010000ab0100000000000000007601af187c0191
                         028c1b5300
                                    0 COPY_FREE_VARS           1
                      
-                     111           2 RESUME                   0
+                      95           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (f)
                      
-                     112          12 LOAD_FAST                1 (f)
+                      96          12 LOAD_FAST                1 (f)
                                   14 LOAD_GLOBAL              1 (NULL + set)
                                   26 LOAD_DEREF               2 (self)
                                   28 LOAD_ATTR                1 (features)
                                   38 PRECALL                  1
                                   42 CALL                     1
                                   52 CONTAINS_OP              1
                                   54 POP_JUMP_BACKWARD_IF_FALSE    24 (to 8)
                      
-                     111          56 LOAD_FAST                1 (f)
+                      95          56 LOAD_FAST                1 (f)
                      
-                     112          58 LIST_APPEND              2
+                      96          58 LIST_APPEND              2
                                   60 JUMP_BACKWARD           27 (to 8)
                              >>   62 RETURN_VALUE
                      consts
                      names      ('set', 'features')
                      varnames   ('.0', 'f')
                      freevars   ('self',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<listcomp>'
-                     firstlineno 111
+                     firstlineno 95
                      lnotab 0x0c012cff0201
                names      ('features',)
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ('self', 'other')
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'feature_symmetric_difference'
-               firstlineno 110
+               firstlineno 94
                lnotab 0x0601
-            'self'
-            'TimeseriesSpecType'
             'feature_selection'
             'bool | str | Collection[str]'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 7
                flags     : 16777219
                code
                   0x870097007401000000000000000000007402000000000000000000007c
                   0189006a020000000000000000ac01a6030000ab0300000000000000007d
                   0174070000000000000000000088006601640284087c014400a6000000ab
                   000000000000000000a6010000ab01000000000000000073024a00820189
-                  00a004000000000000000000000000000000000000000089006a05000000
-                  0000000000740d000000000000000000006a070000000000000000880066
-                  01640384087c014400a6000000ab0000000000000000008e00a6020000ab
-                  0200000000000000005300
+                  006a040000000000000000a0050000000000000000000000000000000000
+                  00000089006a060000000000000000740f000000000000000000006a0500
+                  0000000000000088006601640384087c014400a6000000ab000000000000
+                  0000008e00a6020000ab0200000000000000005300
                              0 MAKE_CELL                0 (self)
                
-               114           2 RESUME                   0
+                98           2 RESUME                   0
                
-               115           4 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
+                99           4 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
                             16 LOAD_GLOBAL              2 (mangle_arg_to_tuple)
                             28 LOAD_FAST                1 (feature_selection)
                             30 LOAD_DEREF               0 (self)
                             32 LOAD_ATTR                2 (features)
                             42 KW_NAMES                 1
                             44 PRECALL                  3
                             48 CALL                     3
                             58 STORE_FAST               1 (feature_selection)
                
-               116          60 LOAD_GLOBAL              7 (NULL + all)
+               100          60 LOAD_GLOBAL              7 (NULL + all)
                             72 LOAD_CLOSURE             0 (self)
                             74 BUILD_TUPLE              1
-                            76 LOAD_CONST               2 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 116>)
+                            76 LOAD_CONST               2 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 100>)
                             78 MAKE_FUNCTION            8 (closure)
                             80 LOAD_FAST                1 (feature_selection)
                             82 GET_ITER
                             84 PRECALL                  0
                             88 CALL                     0
                             98 PRECALL                  1
                            102 CALL                     1
                            112 POP_JUMP_FORWARD_IF_TRUE     2 (to 118)
                            114 LOAD_ASSERTION_ERROR
                            116 RAISE_VARARGS            1
                
-               117     >>  118 LOAD_DEREF               0 (self)
-                           120 LOAD_METHOD              4 (__class__)
-                           142 LOAD_DEREF               0 (self)
-                           144 LOAD_ATTR                5 (label)
-                           154 LOAD_GLOBAL             13 (NULL + ObservationSpec)
-                           166 LOAD_ATTR                7 (of)
-                           176 LOAD_CLOSURE             0 (self)
-                           178 BUILD_TUPLE              1
-                           180 LOAD_CONST               3 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 117>)
-                           182 MAKE_FUNCTION            8 (closure)
-                           184 LOAD_FAST                1 (feature_selection)
-                           186 GET_ITER
-                           188 PRECALL                  0
-                           192 CALL                     0
-                           202 CALL_FUNCTION_EX         0
-                           204 PRECALL                  2
-                           208 CALL                     2
-                           218 RETURN_VALUE
+               101     >>  118 LOAD_DEREF               0 (self)
+                           120 LOAD_ATTR                4 (__class__)
+                           130 LOAD_METHOD              5 (of)
+                           152 LOAD_DEREF               0 (self)
+                           154 LOAD_ATTR                6 (label)
+                           164 LOAD_GLOBAL             15 (NULL + ObservationSpec)
+                           176 LOAD_ATTR                5 (of)
+                           186 LOAD_CLOSURE             0 (self)
+                           188 BUILD_TUPLE              1
+                           190 LOAD_CONST               3 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 101>)
+                           192 MAKE_FUNCTION            8 (closure)
+                           194 LOAD_FAST                1 (feature_selection)
+                           196 GET_ITER
+                           198 PRECALL                  0
+                           202 CALL                     0
+                           212 CALL_FUNCTION_EX         0
+                           214 PRECALL                  2
+                           218 CALL                     2
+                           228 RETURN_VALUE
                consts
                   None
                   ('if_true',)
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 3
                      flags     : 16777267
                      code
                         0x95014b00010097007c005d0d7d017c0189026a00000000000000000076
                         005600970101008c0e64005300
                                    0 COPY_FREE_VARS           1
                      
-                     116           2 RETURN_GENERATOR
+                     100           2 RETURN_GENERATOR
                                    4 POP_TOP
                                    6 RESUME                   0
                                    8 LOAD_FAST                0 (.0)
                              >>   10 FOR_ITER                13 (to 38)
                                   12 STORE_FAST               1 (f)
                                   14 LOAD_FAST                1 (f)
                                   16 LOAD_DEREF               2 (self)
@@ -1656,29 +1489,29 @@
                                   40 RETURN_VALUE
                      consts
                         None
                      names      ('features',)
                      varnames   ('.0', 'f')
                      freevars   ('self',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<genexpr>'
-                     firstlineno 116
+                     firstlineno 100
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 3
                      flags     : 16777267
                      code
                         0x95014b00010097007c005d117d0189026a0000000000000000007c0119
                         0000000000000000005600970101008c1264005300
                                    0 COPY_FREE_VARS           1
                      
-                     117           2 RETURN_GENERATOR
+                     101           2 RETURN_GENERATOR
                                    4 POP_TOP
                                    6 RESUME                   0
                                    8 LOAD_FAST                0 (.0)
                              >>   10 FOR_ITER                17 (to 46)
                                   12 STORE_FAST               1 (f)
                                   14 LOAD_DEREF               2 (self)
                                   16 LOAD_ATTR                0 (base)
@@ -1692,25 +1525,25 @@
                                   48 RETURN_VALUE
                      consts
                         None
                      names      ('base',)
                      varnames   ('.0', 'f')
                      freevars   ('self',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<genexpr>'
-                     firstlineno 117
+                     firstlineno 101
                      lnotab 0x
-               names      ('mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'features', 'all', '__class__', 'label', 'ObservationSpec', 'of')
+               names      ('mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'features', 'all', '__class__', 'of', 'label', 'ObservationSpec')
                varnames   ('self', 'feature_selection')
                freevars   ()
                cellvars   ('self',)
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'project'
-               firstlineno 114
+               firstlineno 98
                lnotab 0x040138013a01
             code
                argcount  : 2
                nlocals   : 4
                stacksize : 7
                flags     : 16777219
                code
@@ -1720,885 +1553,2116 @@
                   000000000000007d027c016a02000000000000000044005d6a7d037c037c
                   006a020000000000000000760172167c02a0040000000000000000000000
                   0000000000000000007c03a6010000ab01000000000000000001008c217c
                   006a0200000000000000007c036a05000000000000000019000000000000
                   0000007c036b03000000007233740d0000000000000000000064017c006a
                   0200000000000000007c006a0200000000000000007c036a050000000000
                   000000190000000000000000007c036a050000000000000000a6040000ab
-                  0400000000000000000100740e0000000000000000000082018c6b7c00a0
-                  0800000000000000000000000000000000000000007c006a090000000000
-                  0000007415000000000000000000006a0b00000000000000007c028e00a6
-                  020000ab0200000000000000005300
-               119           0 RESUME                   0
+                  0400000000000000000100740e0000000000000000000082018c6b7c006a
+                  080000000000000000a00900000000000000000000000000000000000000
+                  007c006a0a00000000000000007417000000000000000000006a09000000
+                  00000000007c028e00a6020000ab0200000000000000005300
+               103           0 RESUME                   0
                
-               120           2 LOAD_FAST                0 (self)
+               104           2 LOAD_FAST                0 (self)
                              4 LOAD_METHOD              0 (is_mergeable)
                             26 LOAD_FAST                1 (other)
                             28 PRECALL                  1
                             32 CALL                     1
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-               121     >>   48 LOAD_GLOBAL              3 (NULL + list)
+               105     >>   48 LOAD_GLOBAL              3 (NULL + list)
                             60 LOAD_FAST                0 (self)
                             62 LOAD_ATTR                2 (base)
                             72 LOAD_ATTR                3 (features)
                             82 PRECALL                  1
                             86 CALL                     1
                             96 STORE_FAST               2 (specs)
                
-               122          98 LOAD_FAST                1 (other)
+               106          98 LOAD_FAST                1 (other)
                            100 LOAD_ATTR                2 (base)
                            110 GET_ITER
                        >>  112 FOR_ITER               106 (to 326)
                            114 STORE_FAST               3 (fspec)
                
-               123         116 LOAD_FAST                3 (fspec)
+               107         116 LOAD_FAST                3 (fspec)
                            118 LOAD_FAST                0 (self)
                            120 LOAD_ATTR                2 (base)
                            130 CONTAINS_OP              1
                            132 POP_JUMP_FORWARD_IF_FALSE    22 (to 178)
                
-               124         134 LOAD_FAST                2 (specs)
+               108         134 LOAD_FAST                2 (specs)
                            136 LOAD_METHOD              4 (append)
                            158 LOAD_FAST                3 (fspec)
                            160 PRECALL                  1
                            164 CALL                     1
                            174 POP_TOP
                            176 JUMP_BACKWARD           33 (to 112)
                
-               125     >>  178 LOAD_FAST                0 (self)
+               109     >>  178 LOAD_FAST                0 (self)
                            180 LOAD_ATTR                2 (base)
                            190 LOAD_FAST                3 (fspec)
                            192 LOAD_ATTR                5 (name)
                            202 BINARY_SUBSCR
                            212 LOAD_FAST                3 (fspec)
                            214 COMPARE_OP               3 (!=)
                            220 POP_JUMP_FORWARD_IF_FALSE    51 (to 324)
                
-               126         222 LOAD_GLOBAL             13 (NULL + print)
+               110         222 LOAD_GLOBAL             13 (NULL + print)
                            234 LOAD_CONST               1 ('redefined')
                            236 LOAD_FAST                0 (self)
                            238 LOAD_ATTR                2 (base)
                            248 LOAD_FAST                0 (self)
                            250 LOAD_ATTR                2 (base)
                            260 LOAD_FAST                3 (fspec)
                            262 LOAD_ATTR                5 (name)
                            272 BINARY_SUBSCR
                            282 LOAD_FAST                3 (fspec)
                            284 LOAD_ATTR                5 (name)
                            294 PRECALL                  4
                            298 CALL                     4
                            308 POP_TOP
                
-               127         310 LOAD_GLOBAL             14 (TimeseriesTypeMergeException)
+               111         310 LOAD_GLOBAL             14 (TimeseriesTypeMergeException)
                            322 RAISE_VARARGS            1
                
-               125     >>  324 JUMP_BACKWARD          107 (to 112)
+               109     >>  324 JUMP_BACKWARD          107 (to 112)
                
-               128     >>  326 LOAD_FAST                0 (self)
-                           328 LOAD_METHOD              8 (__class__)
-                           350 LOAD_FAST                0 (self)
-                           352 LOAD_ATTR                9 (label)
-                           362 LOAD_GLOBAL             21 (NULL + ObservationSpec)
-                           374 LOAD_ATTR               11 (of)
-                           384 LOAD_FAST                2 (specs)
-                           386 CALL_FUNCTION_EX         0
-                           388 PRECALL                  2
-                           392 CALL                     2
-                           402 RETURN_VALUE
+               112     >>  326 LOAD_FAST                0 (self)
+                           328 LOAD_ATTR                8 (__class__)
+                           338 LOAD_METHOD              9 (of)
+                           360 LOAD_FAST                0 (self)
+                           362 LOAD_ATTR               10 (label)
+                           372 LOAD_GLOBAL             23 (NULL + ObservationSpec)
+                           384 LOAD_ATTR                9 (of)
+                           394 LOAD_FAST                2 (specs)
+                           396 CALL_FUNCTION_EX         0
+                           398 PRECALL                  2
+                           402 CALL                     2
+                           412 RETURN_VALUE
                consts
                   None
                   'redefined'
-               names      ('is_mergeable', 'list', 'base', 'features', 'append', 'name', 'print', 'TimeseriesTypeMergeException', '__class__', 'label', 'ObservationSpec', 'of')
+               names      ('is_mergeable', 'list', 'base', 'features', 'append', 'name', 'print', 'TimeseriesTypeMergeException', '__class__', 'of', 'label', 'ObservationSpec')
                varnames   ('self', 'other', 'specs', 'fspec')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'merge'
-               firstlineno 119
+               firstlineno 103
                lnotab 0x02012e013201120112012c012c0158010efe0203
-            ('label', 'ObservationTypeLabel', 'spec', 'ObservationSpec', 'return', 'None')
+            None
+            ('label', 'ObservationSpecLabel', 'base_spec', 'ObservationSpec', 'return', 'typing.Self')
+            ('return', 'ObservationTypeValue')
+            ('return', 'ObservationSpecLabel')
             ('return', 'ObservationSpecIdentifier')
-            ('other', 'TimeseriesSpec', 'return', 'bool')
-            ('other', 'TimeseriesSpec', 'return', 'list[str]')
-            ('other', 'TimeseriesSpec', 'return', 'tuple[list[str], list[str]]')
-            ('self', 'TimeseriesSpecType', 'feature_selection', 'bool | str | Collection[str]', 'return', 'TimeseriesSpecType')
-            ('self', 'TimeseriesSpecType', 'other', 'TimeseriesSpecType', 'return', 'TimeseriesSpecType')
-         names      ('__name__', '__module__', '__qualname__', '__annotations__', 'field', 'features', 'display_names', '__init__', '__iter__', '__len__', 'property', 'identifier', 'is_mergeable', 'feature_intersection', 'feature_symmetric_difference', 'project', 'merge', '__classcell__')
+            ('return', 'ObservationSpec')
+            ('return', 'TimeseriesFeatureLabels')
+            ('return', 'Iterator[str]')
+            ('return', 'int')
+            ('other', 'TimeseriesSpecProtocol', 'return', 'bool')
+            ('other', 'TimeseriesSpecProtocol', 'return', 'list[str]')
+            ('other', 'TimeseriesSpecProtocol', 'return', 'tuple[list[str], list[str]]')
+            ('feature_selection', 'bool | str | Collection[str]', 'return', 'typing.Self')
+            ('other', 'typing.Self', 'return', 'typing.Self')
+         names      ('__name__', '__module__', '__qualname__', '__annotations__', 'classmethod', 'of', 'property', 'type', 'label', 'identifier', 'base', 'features', 'long_names', '__iter__', '__len__', '__repr__', '__str__', 'is_mergeable', 'feature_intersection', 'feature_symmetric_difference', 'project', 'merge')
          varnames   ()
          freevars   ()
-         cellvars   ('__class__',)
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         cellvars   ()
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'TimeseriesSpec'
-         firstlineno 79
+         firstlineno 39
          lnotab
-            0x0e020a010a010a01220122020c0706030603020106ff0e010203080308
-            0308040805
-      ('frozen', 'init')
+            0x0c020a010a010a010a02020106ff0e010203020106ff0e010203020106
+            ff0e010203020106ff0e010203020106ff0e010203020106ff0e01020302
+            0106ff0e01020308030803060506030803080308040805
+      'TimeseriesSpec'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0265036a0400000000000000005a0564015300
-         131           0 RESUME                   0
+         116           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('EventTimeseriesSpec')
                        8 STORE_NAME               2 (__qualname__)
          
-         133          10 LOAD_NAME                3 (ObservationTypes)
+         117          10 LOAD_NAME                3 (ObservationType)
                       12 LOAD_ATTR                4 (E)
-                      22 STORE_NAME               5 (type)
+                      22 STORE_NAME               5 (observation_type)
                       24 LOAD_CONST               1 (None)
                       26 RETURN_VALUE
          consts
             'EventTimeseriesSpec'
             None
-         names      ('__name__', '__module__', '__qualname__', 'ObservationTypes', 'E', 'type')
+         names      ('__name__', '__module__', '__qualname__', 'ObservationType', 'E', 'observation_type')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'EventTimeseriesSpec'
-         firstlineno 131
-         lnotab 0x0a02
+         firstlineno 116
+         lnotab 0x0a01
       'EventTimeseriesSpec'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0265036a0400000000000000005a0564015300
-         136           0 RESUME                   0
+         121           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('MeasurementTimeseriesSpec')
                        8 STORE_NAME               2 (__qualname__)
          
-         138          10 LOAD_NAME                3 (ObservationTypes)
+         122          10 LOAD_NAME                3 (ObservationType)
                       12 LOAD_ATTR                4 (M)
-                      22 STORE_NAME               5 (type)
+                      22 STORE_NAME               5 (observation_type)
                       24 LOAD_CONST               1 (None)
                       26 RETURN_VALUE
          consts
             'MeasurementTimeseriesSpec'
             None
-         names      ('__name__', '__module__', '__qualname__', 'ObservationTypes', 'M', 'type')
+         names      ('__name__', '__module__', '__qualname__', 'ObservationType', 'M', 'observation_type')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'MeasurementTimeseriesSpec'
-         firstlineno 136
-         lnotab 0x0a02
+         firstlineno 121
+         lnotab 0x0a01
       'MeasurementTimeseriesSpec'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 4
          flags     : 16777216
          code
-            0x970065005a0164005a0265036a040000000000000000650565036a0600
-            00000000000000650769025a086509640764058404a6000000ab00000000
-            00000000005a0a64065300
-         141           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('TimeseriesSpecFactory')
-                       8 STORE_NAME               2 (__qualname__)
+            0x8700970065005a0164005a026418641988006601640a840d5a03650464
+            1a640c8404a6000000ab0000000000000000005a056504641b640d8404a6
+            000000ab0000000000000000005a066504641c640e8404a6000000ab0000
+            000000000000005a0709000900641d641c641184055a0865096418641e64
+            138405a6000000ab0000000000000000005a0a6504641f64158404a60000
+            00ab0000000000000000005a0b641684005a0c641784005a0d880078015a
+            0e5300
+                       0 MAKE_CELL                0 (__class__)
          
-         142          10 LOAD_NAME                3 (ObservationTypes)
-                      12 LOAD_ATTR                4 (E)
-                      22 LOAD_NAME                5 (EventTimeseriesSpec)
-                      24 LOAD_NAME                3 (ObservationTypes)
-                      26 LOAD_ATTR                6 (M)
-                      36 LOAD_NAME                7 (MeasurementTimeseriesSpec)
-                      38 BUILD_MAP                2
-                      40 STORE_NAME               8 (types)
-         
-         144          42 LOAD_NAME                9 (classmethod)
-         
-         145          44 LOAD_CONST               7 (('arg', 'str', 'return', 'Callable[[ObservationTypeLabel, ObservationSpec], TimeseriesSpec]'))
-                      46 LOAD_CONST               5 (<code object for_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 144>)
-                      48 MAKE_FUNCTION            4 (annotations)
-         
-         144          50 PRECALL                  0
-                      54 CALL                     0
-         
-         145          64 STORE_NAME              10 (for_type)
-                      66 LOAD_CONST               6 (None)
-                      68 RETURN_VALUE
+         125           2 RESUME                   0
+                       4 LOAD_NAME                0 (__name__)
+                       6 STORE_NAME               1 (__module__)
+                       8 LOAD_CONST               0 ('TimeseriesView')
+                      10 STORE_NAME               2 (__qualname__)
+         
+         127          12 LOAD_CONST              24 ((None,))
+                      14 LOAD_CONST              25 (('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None'))
+                      16 LOAD_CLOSURE             0 (__class__)
+                      18 BUILD_TUPLE              1
+                      20 LOAD_CONST              10 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 127>)
+                      22 MAKE_FUNCTION           13 (defaults, annotations, closure)
+                      24 STORE_NAME               3 (__init__)
+         
+         133          26 LOAD_NAME                4 (property)
+         
+         134          28 LOAD_CONST              26 (('return', 'ObservationTypeValue'))
+                      30 LOAD_CONST              12 (<code object observation_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 133>)
+                      32 MAKE_FUNCTION            4 (annotations)
+         
+         133          34 PRECALL                  0
+                      38 CALL                     0
+         
+         134          48 STORE_NAME               5 (observation_type)
+         
+         137          50 LOAD_NAME                4 (property)
+         
+         138          52 LOAD_CONST              27 (('return', 'TSSpec'))
+                      54 LOAD_CONST              13 (<code object timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 137>)
+                      56 MAKE_FUNCTION            4 (annotations)
+         
+         137          58 PRECALL                  0
+                      62 CALL                     0
+         
+         138          72 STORE_NAME               6 (timeseries_spec)
+         
+         141          74 LOAD_NAME                4 (property)
+         
+         142          76 LOAD_CONST              28 (('return', 'pd.DataFrame'))
+                      78 LOAD_CONST              14 (<code object df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 141>)
+                      80 MAKE_FUNCTION            4 (annotations)
+         
+         141          82 PRECALL                  0
+                      86 CALL                     0
+         
+         142          96 STORE_NAME               7 (df)
+         
+         145          98 NOP
+         
+         146         100 NOP
+         
+         145         102 LOAD_CONST              29 ((True, False, False, False))
+                     104 LOAD_CONST              28 (('return', 'pd.DataFrame'))
+                     106 LOAD_CONST              17 (<code object feature_column_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 145>)
+                     108 MAKE_FUNCTION            5 (defaults, annotations)
+                     110 STORE_NAME               8 (feature_column_view)
+         
+         151         112 LOAD_NAME                9 (classmethod)
+         
+         152         114 LOAD_CONST              24 ((None,))
+                     116 LOAD_CONST              30 (('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'typing.Self'))
+                     118 LOAD_CONST              19 (<code object of, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 151>)
+                     120 MAKE_FUNCTION            5 (defaults, annotations)
+         
+         151         122 PRECALL                  0
+                     126 CALL                     0
+         
+         152         136 STORE_NAME              10 (of)
+         
+         157         138 LOAD_NAME                4 (property)
+         
+         158         140 LOAD_CONST              31 (('return', 'Set[str]'))
+                     142 LOAD_CONST              21 (<code object objects, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 157>)
+                     144 MAKE_FUNCTION            4 (annotations)
+         
+         157         146 PRECALL                  0
+                     150 CALL                     0
+         
+         158         160 STORE_NAME              11 (objects)
+         
+         161         162 LOAD_CONST              22 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 161>)
+                     164 MAKE_FUNCTION            0
+                     166 STORE_NAME              12 (__repr__)
+         
+         164         168 LOAD_CONST              23 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 164>)
+                     170 MAKE_FUNCTION            0
+                     172 STORE_NAME              13 (__str__)
+                     174 LOAD_CLOSURE             0 (__class__)
+                     176 COPY                     1
+                     178 STORE_NAME              14 (__classcell__)
+                     180 RETURN_VALUE
          consts
-            'TimeseriesSpecFactory'
-            'arg'
-            'str'
+            'TimeseriesView'
+            None
+            'timeseries_spec'
+            'TSSpec'
+            'df'
+            'pd.DataFrame'
+            'objects'
+            'Collection[str]'
             'return'
-            'Callable[[ObservationTypeLabel, ObservationSpec], TimeseriesSpec]'
+            'None'
             code
-               argcount  : 2
-               nlocals   : 2
-               stacksize : 2
+               argcount  : 4
+               nlocals   : 4
+               stacksize : 3
                flags     : 16777219
-               code 0x97007c006a0000000000000000007c01190000000000000000005300
-               144           0 RESUME                   0
+               code
+                  0x95019700740100000000000000000000a6000000ab0000000000000000
+                  00a0010000000000000000000000000000000000000000a6000000ab0000
+                  0000000000000001007c017c005f0200000000000000007c027c005f0300
+                  000000000000007c03810f7409000000000000000000007c03a6010000ab
+                  0100000000000000006e0d740900000000000000000000a6000000ab0000
+                  000000000000007c005f05000000000000000064005300
+                             0 COPY_FREE_VARS           1
                
-               146           2 LOAD_FAST                0 (cls)
-                             4 LOAD_ATTR                0 (types)
-                            14 LOAD_FAST                1 (arg)
-                            16 BINARY_SUBSCR
-                            26 RETURN_VALUE
+               127           2 RESUME                   0
+               
+               128           4 LOAD_GLOBAL              1 (NULL + super)
+                            16 PRECALL                  0
+                            20 CALL                     0
+                            30 LOAD_METHOD              1 (__init__)
+                            52 PRECALL                  0
+                            56 CALL                     0
+                            66 POP_TOP
+               
+               129          68 LOAD_FAST                1 (timeseries_spec)
+                            70 LOAD_FAST                0 (self)
+                            72 STORE_ATTR               2 (_timeseries_spec)
+               
+               130          82 LOAD_FAST                2 (df)
+                            84 LOAD_FAST                0 (self)
+                            86 STORE_ATTR               3 (_df)
+               
+               131          96 LOAD_FAST                3 (objects)
+                            98 POP_JUMP_FORWARD_IF_NONE    15 (to 130)
+                           100 LOAD_GLOBAL              9 (NULL + frozenset)
+                           112 LOAD_FAST                3 (objects)
+                           114 PRECALL                  1
+                           118 CALL                     1
+                           128 JUMP_FORWARD            13 (to 156)
+                       >>  130 LOAD_GLOBAL              9 (NULL + frozenset)
+                           142 PRECALL                  0
+                           146 CALL                     0
+                       >>  156 LOAD_FAST                0 (self)
+                           158 STORE_ATTR               5 (_objects)
+                           168 LOAD_CONST               0 (None)
+                           170 RETURN_VALUE
                consts
                   None
-               names      ('types',)
-               varnames   ('cls', 'arg')
+               names      ('super', '__init__', '_timeseries_spec', '_df', 'frozenset', '_objects')
+               varnames   ('self', 'timeseries_spec', 'df', 'objects')
+               freevars   ('__class__',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__init__'
+               firstlineno 127
+               lnotab 0x040140010e010e01
+            'ObservationTypeValue'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000006a0100000000000000005300
+               133           0 RESUME                   0
+               
+               135           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (timeseries_spec)
+                            14 LOAD_ATTR                1 (observation_type)
+                            24 RETURN_VALUE
+               consts
+                  None
+               names      ('timeseries_spec', 'observation_type')
+               varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'for_type'
-               firstlineno 144
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'observation_type'
+               firstlineno 133
                lnotab 0x0202
-            None
-            ('arg', 'str', 'return', 'Callable[[ObservationTypeLabel, ObservationSpec], TimeseriesSpec]')
-         names      ('__name__', '__module__', '__qualname__', 'ObservationTypes', 'E', 'EventTimeseriesSpec', 'M', 'MeasurementTimeseriesSpec', 'types', 'classmethod', 'for_type')
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+               137           0 RESUME                   0
+               
+               139           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_timeseries_spec)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_timeseries_spec',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'timeseries_spec'
+               firstlineno 137
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+               141           0 RESUME                   0
+               
+               143           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_df)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_df',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'df'
+               firstlineno 141
+               lnotab 0x0202
+            True
+            False
+            code
+               argcount  : 5
+               nlocals   : 5
+               stacksize : 8
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c006a0100000000000000007c006a
+                  0200000000000000007c017c027c037c04ac01a6060000ab060000000000
+                  0000005300
+               145           0 RESUME                   0
+               
+               147           2 LOAD_GLOBAL              1 (NULL + _feature_column_view)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (timeseries_spec)
+                            26 LOAD_FAST                0 (self)
+                            28 LOAD_ATTR                2 (df)
+                            38 LOAD_FAST                1 (include_time_col)
+               
+               148          40 LOAD_FAST                2 (include_object_col)
+                            42 LOAD_FAST                3 (add_spec_id_prefix)
+               
+               149          44 LOAD_FAST                4 (use_long_names)
+               
+               147          46 KW_NAMES                 1
+                            48 PRECALL                  6
+                            52 CALL                     6
+                            62 RETURN_VALUE
+               consts
+                  None
+                  ('include_time_col', 'include_object_col', 'add_spec_id_prefix', 'use_long_names')
+               names      ('_feature_column_view', 'timeseries_spec', 'df')
+               varnames   ('self', 'include_time_col', 'include_object_col', 'add_spec_id_prefix', 'use_long_names')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'feature_column_view'
+               firstlineno 145
+               lnotab 0x02022601040102fe
+            'typing.Self'
+            code
+               argcount  : 4
+               nlocals   : 7
+               stacksize : 5
+               flags     : 16777231
+               code
+                  0x970002007c007c017c027c03a6030000ab0300000000000000007d067c
+                  065300
+               151           0 RESUME                   0
+               
+               154           2 PUSH_NULL
+                             4 LOAD_FAST                0 (cls)
+                             6 LOAD_FAST                1 (timeseries_spec)
+                             8 LOAD_FAST                2 (df)
+                            10 LOAD_FAST                3 (objects)
+                            12 PRECALL                  3
+                            16 CALL                     3
+                            26 STORE_FAST               6 (c)
+               
+               155          28 LOAD_FAST                6 (c)
+                            30 RETURN_VALUE
+               consts
+                  None
+               names      ()
+               varnames   ('cls', 'timeseries_spec', 'df', 'objects', 'args', 'kwargs', 'c')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'of'
+               firstlineno 151
+               lnotab 0x02031a01
+            'Set[str]'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+               157           0 RESUME                   0
+               
+               159           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_objects)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_objects',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'objects'
+               firstlineno 157
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 9
+               flags     : 16777219
+               code
+                  0x97007c006a0000000000000000006a0100000000000000009b0064017c
+                  006a0200000000000000009b0064027407000000000000000000007c006a
+                  040000000000000000a6010000ab0100000000000000009b006403740b00
+                  0000000000000000007c006a060000000000000000a6010000ab01000000
+                  00000000009b0064049d085300
+               161           0 RESUME                   0
+               
+               162           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (__class__)
+                            14 LOAD_ATTR                1 (__name__)
+                            24 FORMAT_VALUE             0
+                            26 LOAD_CONST               1 ('(spec=')
+                            28 LOAD_FAST                0 (self)
+                            30 LOAD_ATTR                2 (timeseries_spec)
+                            40 FORMAT_VALUE             0
+                            42 LOAD_CONST               2 (', #observations=')
+                            44 LOAD_GLOBAL              7 (NULL + len)
+                            56 LOAD_FAST                0 (self)
+                            58 LOAD_ATTR                4 (df)
+                            68 PRECALL                  1
+                            72 CALL                     1
+                            82 FORMAT_VALUE             0
+                            84 LOAD_CONST               3 (', objects=')
+                            86 LOAD_GLOBAL             11 (NULL + str)
+                            98 LOAD_FAST                0 (self)
+                           100 LOAD_ATTR                6 (objects)
+                           110 PRECALL                  1
+                           114 CALL                     1
+                           124 FORMAT_VALUE             0
+                           126 LOAD_CONST               4 (')')
+                           128 BUILD_STRING             8
+                           130 RETURN_VALUE
+               consts
+                  None
+                  '(spec='
+                  ', #observations='
+                  ', objects='
+                  ')'
+               names      ('__class__', '__name__', 'timeseries_spec', 'len', 'df', 'str', 'objects')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__repr__'
+               firstlineno 161
+               lnotab 0x0201
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 3
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c00a6010000ab0100000000000000
+                  005300
+               164           0 RESUME                   0
+               
+               165           2 LOAD_GLOBAL              1 (NULL + repr)
+                            14 LOAD_FAST                0 (self)
+                            16 PRECALL                  1
+                            20 CALL                     1
+                            30 RETURN_VALUE
+               consts
+                  None
+               names      ('repr',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__str__'
+               firstlineno 164
+               lnotab 0x0201
+            (None,)
+            ('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None')
+            ('return', 'ObservationTypeValue')
+            ('return', 'TSSpec')
+            ('return', 'pd.DataFrame')
+            (True, False, False, False)
+            ('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'typing.Self')
+            ('return', 'Set[str]')
+         names      ('__name__', '__module__', '__qualname__', '__init__', 'property', 'observation_type', 'timeseries_spec', 'df', 'feature_column_view', 'classmethod', 'of', 'objects', '__repr__', '__str__', '__classcell__')
          varnames   ()
          freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'TimeseriesSpecFactory'
-         firstlineno 141
-         lnotab 0x0a012002020106ff0e01
-      'TimeseriesSpecFactory'
-      'TSSpec'
+         cellvars   ('__class__',)
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'TimeseriesView'
+         firstlineno 125
+         lnotab
+            0x0c020e06020106ff0e010203020106ff0e010203020106ff0e01020302
+            0102ff0a06020108ff0e010205020106ff0e0102030603
+      'TimeseriesView'
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 3
+         stacksize : 4
          flags     : 16777216
          code
-            0x970065005a0164005a0255006401650364023c0000006403650364043c
-            00000064055300
-         152           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('AbstractMachineDataTimeseries')
-                       8 STORE_NAME               2 (__qualname__)
-                      10 SETUP_ANNOTATIONS
+            0x8700970065005a0164005a02640b640c88006601640a840d5a03880078
+            015a045300
+                       0 MAKE_CELL                0 (__class__)
          
-         154          12 LOAD_CONST               1 ('TSSpec')
-                      14 LOAD_NAME                3 (__annotations__)
-                      16 LOAD_CONST               2 ('timeseries_spec')
-                      18 STORE_SUBSCR
+         171           2 RESUME                   0
+                       4 LOAD_NAME                0 (__name__)
+                       6 STORE_NAME               1 (__module__)
+                       8 LOAD_CONST               0 ('EventTimeseriesView')
+                      10 STORE_NAME               2 (__qualname__)
          
-         155          22 LOAD_CONST               3 ('pd.DataFrame')
-                      24 LOAD_NAME                3 (__annotations__)
-                      26 LOAD_CONST               4 ('df')
-                      28 STORE_SUBSCR
-                      32 LOAD_CONST               5 (None)
-                      34 RETURN_VALUE
+         173          12 LOAD_CONST              11 ((None,))
+                      14 LOAD_CONST              12 (('timeseries_spec', 'EventTimeseriesSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None'))
+                      16 LOAD_CLOSURE             0 (__class__)
+                      18 BUILD_TUPLE              1
+                      20 LOAD_CONST              10 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 173>)
+                      22 MAKE_FUNCTION           13 (defaults, annotations, closure)
+                      24 STORE_NAME               3 (__init__)
+                      26 LOAD_CLOSURE             0 (__class__)
+                      28 COPY                     1
+                      30 STORE_NAME               4 (__classcell__)
+                      32 RETURN_VALUE
          consts
-            'AbstractMachineDataTimeseries'
-            'TSSpec'
+            'EventTimeseriesView'
+            None
             'timeseries_spec'
-            'pd.DataFrame'
+            'EventTimeseriesSpec'
             'df'
-            None
-         names      ('__name__', '__module__', '__qualname__', '__annotations__')
-         varnames   ()
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'AbstractMachineDataTimeseries'
-         firstlineno 152
-         lnotab 0x0c020a01
-      'AbstractMachineDataTimeseries'
-      code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 3
-         flags     : 16777216
-         code 0x970065005a0164005a0255006401650364023c00000064035300
-         158           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MachineDataTimeseries')
-                       8 STORE_NAME               2 (__qualname__)
-                      10 SETUP_ANNOTATIONS
-         
-         160          12 LOAD_CONST               1 ('Collection[str]')
-                      14 LOAD_NAME                3 (__annotations__)
-                      16 LOAD_CONST               2 ('objects')
-                      18 STORE_SUBSCR
-                      22 LOAD_CONST               3 (None)
-                      24 RETURN_VALUE
-         consts
-            'MachineDataTimeseries'
-            'Collection[str]'
+            'pd.DataFrame'
             'objects'
-            None
-         names      ('__name__', '__module__', '__qualname__', '__annotations__')
+            'Collection[str]'
+            'return'
+            'None'
+            code
+               argcount  : 4
+               nlocals   : 4
+               stacksize : 5
+               flags     : 16777219
+               code
+                  0x95019700740100000000000000000000a6000000ab0000000000000000
+                  00a00100000000000000000000000000000000000000007c017c027c03a6
+                  030000ab030000000000000000010064005300
+                             0 COPY_FREE_VARS           1
+               
+               173           2 RESUME                   0
+               
+               174           4 LOAD_GLOBAL              1 (NULL + super)
+                            16 PRECALL                  0
+                            20 CALL                     0
+                            30 LOAD_METHOD              1 (__init__)
+                            52 LOAD_FAST                1 (timeseries_spec)
+                            54 LOAD_FAST                2 (df)
+                            56 LOAD_FAST                3 (objects)
+                            58 PRECALL                  3
+                            62 CALL                     3
+                            72 POP_TOP
+                            74 LOAD_CONST               0 (None)
+                            76 RETURN_VALUE
+               consts
+                  None
+               names      ('super', '__init__')
+               varnames   ('self', 'timeseries_spec', 'df', 'objects')
+               freevars   ('__class__',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__init__'
+               firstlineno 173
+               lnotab 0x0401
+            (None,)
+            ('timeseries_spec', 'EventTimeseriesSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None')
+         names      ('__name__', '__module__', '__qualname__', '__init__', '__classcell__')
          varnames   ()
          freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MachineDataTimeseries'
-         firstlineno 158
+         cellvars   ('__class__',)
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'EventTimeseriesView'
+         firstlineno 171
          lnotab 0x0c02
-      'MachineDataTimeseries'
+      'EventTimeseriesView'
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 1
+         stacksize : 4
          flags     : 16777216
-         code 0x970065005a0164005a0264015300
-         163           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('EventSeries')
-                       8 STORE_NAME               2 (__qualname__)
+         code
+            0x8700970065005a0164005a020900640b640c88006601640a840d5a0388
+            0078015a045300
+                       0 MAKE_CELL                0 (__class__)
          
-         165          10 LOAD_CONST               1 (None)
-                      12 RETURN_VALUE
+         177           2 RESUME                   0
+                       4 LOAD_NAME                0 (__name__)
+                       6 STORE_NAME               1 (__module__)
+                       8 LOAD_CONST               0 ('MeasurementTimeseriesView')
+                      10 STORE_NAME               2 (__qualname__)
+         
+         180          12 NOP
+         
+         179          14 LOAD_CONST              11 ((None,))
+                      16 LOAD_CONST              12 (('timeseries_spec', 'MeasurementTimeseriesSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None'))
+                      18 LOAD_CLOSURE             0 (__class__)
+                      20 BUILD_TUPLE              1
+                      22 LOAD_CONST              10 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 179>)
+                      24 MAKE_FUNCTION           13 (defaults, annotations, closure)
+                      26 STORE_NAME               3 (__init__)
+                      28 LOAD_CLOSURE             0 (__class__)
+                      30 COPY                     1
+                      32 STORE_NAME               4 (__classcell__)
+                      34 RETURN_VALUE
          consts
-            'EventSeries'
+            'MeasurementTimeseriesView'
             None
-         names      ('__name__', '__module__', '__qualname__')
+            'timeseries_spec'
+            'MeasurementTimeseriesSpec'
+            'df'
+            'pd.DataFrame'
+            'objects'
+            'Collection[str]'
+            'return'
+            'None'
+            code
+               argcount  : 4
+               nlocals   : 4
+               stacksize : 5
+               flags     : 16777219
+               code
+                  0x95019700740100000000000000000000a6000000ab0000000000000000
+                  00a00100000000000000000000000000000000000000007c017c027c03a6
+                  030000ab030000000000000000010064005300
+                             0 COPY_FREE_VARS           1
+               
+               179           2 RESUME                   0
+               
+               181           4 LOAD_GLOBAL              1 (NULL + super)
+                            16 PRECALL                  0
+                            20 CALL                     0
+                            30 LOAD_METHOD              1 (__init__)
+                            52 LOAD_FAST                1 (timeseries_spec)
+                            54 LOAD_FAST                2 (df)
+                            56 LOAD_FAST                3 (objects)
+                            58 PRECALL                  3
+                            62 CALL                     3
+                            72 POP_TOP
+                            74 LOAD_CONST               0 (None)
+                            76 RETURN_VALUE
+               consts
+                  None
+               names      ('super', '__init__')
+               varnames   ('self', 'timeseries_spec', 'df', 'objects')
+               freevars   ('__class__',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__init__'
+               firstlineno 179
+               lnotab 0x0402
+            (None,)
+            ('timeseries_spec', 'MeasurementTimeseriesSpec', 'df', 'pd.DataFrame', 'objects', 'Collection[str]', 'return', 'None')
+         names      ('__name__', '__module__', '__qualname__', '__init__', '__classcell__')
          varnames   ()
          freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'EventSeries'
-         firstlineno 163
-         lnotab 0x0a02
-      'EventSeries'
+         cellvars   ('__class__',)
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'MeasurementTimeseriesView'
+         firstlineno 177
+         lnotab 0x0c0302ff
+      'MeasurementTimeseriesView'
       code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 1
-         flags     : 16777216
-         code 0x970065005a0164005a0264015300
-         168           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MeasurementSeries')
-                       8 STORE_NAME               2 (__qualname__)
-         
-         170          10 LOAD_CONST               1 (None)
-                      12 RETURN_VALUE
+         argcount  : 6
+         nlocals   : 9
+         stacksize : 5
+         flags     : 16777219
+         code
+            0x870087048709970074010000000000000000000089006a010000000000
+            000000a6010000ab0100000000000000007d067c03721074040000000000
+            00000000006a03000000000000000067017c067a0000007d067c02721074
+            04000000000000000000006a04000000000000000067017c067a0000007d
+            067c016a0500000000000000006400640085027c06660219000000000000
+            0000007d0769007d08880488006602640184088a097c0589047a07000072
+            3c7c0572278809660164028408740d0000000000000000000089006a0100
+            0000000000000089006a070000000000000000a6020000ab020000000000
+            0000004400a6000000ab0000000000000000007d086e1388096601640384
+            0889006a0100000000000000004400a6000000ab0000000000000000007d
+            087c0872187c07a00800000000000000000000000000000000000000007c
+            0864046405ac06a6030000ab0300000000000000006e017c075300
+                       0 MAKE_CELL                0 (spec)
+                       2 MAKE_CELL                4 (add_spec_id_prefix)
+                       4 MAKE_CELL                9 (maybe_prefix)
+         
+         184           6 RESUME                   0
+         
+         186           8 LOAD_GLOBAL              1 (NULL + list)
+                      20 LOAD_DEREF               0 (spec)
+                      22 LOAD_ATTR                1 (features)
+                      32 PRECALL                  1
+                      36 CALL                     1
+                      46 STORE_FAST               6 (cols)
+         
+         187          48 LOAD_FAST                3 (include_object_col)
+                      50 POP_JUMP_FORWARD_IF_FALSE    16 (to 84)
+         
+         188          52 LOAD_GLOBAL              4 (MDConcepts)
+                      64 LOAD_ATTR                3 (Object)
+                      74 BUILD_LIST               1
+                      76 LOAD_FAST                6 (cols)
+                      78 BINARY_OP                0 (+)
+                      82 STORE_FAST               6 (cols)
+         
+         189     >>   84 LOAD_FAST                2 (include_time_col)
+                      86 POP_JUMP_FORWARD_IF_FALSE    16 (to 120)
+         
+         190          88 LOAD_GLOBAL              4 (MDConcepts)
+                     100 LOAD_ATTR                4 (Time)
+                     110 BUILD_LIST               1
+                     112 LOAD_FAST                6 (cols)
+                     114 BINARY_OP                0 (+)
+                     118 STORE_FAST               6 (cols)
+         
+         192     >>  120 LOAD_FAST                1 (df)
+                     122 LOAD_ATTR                5 (loc)
+                     132 LOAD_CONST               0 (None)
+                     134 LOAD_CONST               0 (None)
+                     136 BUILD_SLICE              2
+                     138 LOAD_FAST                6 (cols)
+                     140 BUILD_TUPLE              2
+                     142 BINARY_SUBSCR
+                     152 STORE_FAST               7 (view)
+         
+         194         154 BUILD_MAP                0
+                     156 STORE_FAST               8 (renaming)
+         
+         196         158 LOAD_CLOSURE             4 (add_spec_id_prefix)
+                     160 LOAD_CLOSURE             0 (spec)
+                     162 BUILD_TUPLE              2
+                     164 LOAD_CONST               1 (<code object maybe_prefix, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 196>)
+                     166 MAKE_FUNCTION            8 (closure)
+                     168 STORE_DEREF              9 (maybe_prefix)
+         
+         202         170 LOAD_FAST                5 (use_long_names)
+                     172 LOAD_DEREF               4 (add_spec_id_prefix)
+                     174 BINARY_OP                7 (|)
+                     178 POP_JUMP_FORWARD_IF_FALSE    60 (to 300)
+         
+         203         180 LOAD_FAST                5 (use_long_names)
+                     182 POP_JUMP_FORWARD_IF_FALSE    39 (to 262)
+         
+         204         184 LOAD_CLOSURE             9 (maybe_prefix)
+                     186 BUILD_TUPLE              1
+                     188 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 204>)
+                     190 MAKE_FUNCTION            8 (closure)
+         
+         205         192 LOAD_GLOBAL             13 (NULL + zip)
+                     204 LOAD_DEREF               0 (spec)
+                     206 LOAD_ATTR                1 (features)
+                     216 LOAD_DEREF               0 (spec)
+                     218 LOAD_ATTR                7 (long_names)
+                     228 PRECALL                  2
+                     232 CALL                     2
+         
+         204         242 GET_ITER
+                     244 PRECALL                  0
+                     248 CALL                     0
+                     258 STORE_FAST               8 (renaming)
+                     260 JUMP_FORWARD            19 (to 300)
+         
+         207     >>  262 LOAD_CLOSURE             9 (maybe_prefix)
+                     264 BUILD_TUPLE              1
+                     266 LOAD_CONST               3 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 207>)
+                     268 MAKE_FUNCTION            8 (closure)
+                     270 LOAD_DEREF               0 (spec)
+                     272 LOAD_ATTR                1 (features)
+                     282 GET_ITER
+                     284 PRECALL                  0
+                     288 CALL                     0
+                     298 STORE_FAST               8 (renaming)
+         
+         209     >>  300 LOAD_FAST                8 (renaming)
+                     302 POP_JUMP_FORWARD_IF_FALSE    24 (to 352)
+                     304 LOAD_FAST                7 (view)
+                     306 LOAD_METHOD              8 (rename)
+                     328 LOAD_FAST                8 (renaming)
+                     330 LOAD_CONST               4 (False)
+                     332 LOAD_CONST               5 ('columns')
+                     334 KW_NAMES                 6
+                     336 PRECALL                  3
+                     340 CALL                     3
+                     350 JUMP_FORWARD             1 (to 354)
+                 >>  352 LOAD_FAST                7 (view)
+                 >>  354 RETURN_VALUE
          consts
-            'MeasurementSeries'
             None
-         names      ('__name__', '__module__', '__qualname__')
-         varnames   ()
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 2
+               flags     : 16777235
+               code
+                  0x950297008901721889026a00000000000000000064017a00000089026a
+                  0100000000000000007a00000064017a0000007c007a00000053007c0053
+                  00
+                             0 COPY_FREE_VARS           2
+               
+               196           2 RESUME                   0
+               
+               197           4 LOAD_DEREF               1 (add_spec_id_prefix)
+                             6 POP_JUMP_FORWARD_IF_FALSE    24 (to 56)
+               
+               198           8 LOAD_DEREF               2 (spec)
+                            10 LOAD_ATTR                0 (type)
+                            20 LOAD_CONST               1 ('_')
+                            22 BINARY_OP                0 (+)
+                            26 LOAD_DEREF               2 (spec)
+                            28 LOAD_ATTR                1 (label)
+                            38 BINARY_OP                0 (+)
+                            42 LOAD_CONST               1 ('_')
+                            44 BINARY_OP                0 (+)
+                            48 LOAD_FAST                0 (c)
+                            50 BINARY_OP                0 (+)
+                            54 RETURN_VALUE
+               
+               200     >>   56 LOAD_FAST                0 (c)
+                            58 RETURN_VALUE
+               consts
+                  None
+                  '_'
+               names      ('type', 'label')
+               varnames   ('c',)
+               freevars   ('add_spec_id_prefix', 'spec')
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'maybe_prefix'
+               firstlineno 196
+               lnotab 0x040104013002
+            code
+               argcount  : 1
+               nlocals   : 3
+               stacksize : 6
+               flags     : 16777235
+               code
+                  0x9501970069007c005d115c0200007d017d027c01020089037c02a60100
+                  00ab01000000000000000093028c125300
+                             0 COPY_FREE_VARS           1
+               
+               204           2 RESUME                   0
+                             4 BUILD_MAP                0
+                             6 LOAD_FAST                0 (.0)
+                       >>    8 FOR_ITER                17 (to 44)
+                            10 UNPACK_SEQUENCE          2
+                            14 STORE_FAST               1 (f)
+                            16 STORE_FAST               2 (ln)
+                            18 LOAD_FAST                1 (f)
+                            20 PUSH_NULL
+                            22 LOAD_DEREF               3 (maybe_prefix)
+                            24 LOAD_FAST                2 (ln)
+                            26 PRECALL                  1
+                            30 CALL                     1
+                            40 MAP_ADD                  2
+                            42 JUMP_BACKWARD           18 (to 8)
+                       >>   44 RETURN_VALUE
+               consts
+               names      ()
+               varnames   ('.0', 'f', 'ln')
+               freevars   ('maybe_prefix',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '<dictcomp>'
+               firstlineno 204
+               lnotab 0x
+            code
+               argcount  : 1
+               nlocals   : 2
+               stacksize : 6
+               flags     : 16777235
+               code
+                  0x9501970069007c005d0e7d017c01020089027c01a6010000ab01000000
+                  000000000093028c0f5300
+                             0 COPY_FREE_VARS           1
+               
+               207           2 RESUME                   0
+                             4 BUILD_MAP                0
+                             6 LOAD_FAST                0 (.0)
+                       >>    8 FOR_ITER                14 (to 38)
+                            10 STORE_FAST               1 (f)
+                            12 LOAD_FAST                1 (f)
+                            14 PUSH_NULL
+                            16 LOAD_DEREF               2 (maybe_prefix)
+                            18 LOAD_FAST                1 (f)
+                            20 PRECALL                  1
+                            24 CALL                     1
+                            34 MAP_ADD                  2
+                            36 JUMP_BACKWARD           15 (to 8)
+                       >>   38 RETURN_VALUE
+               consts
+               names      ()
+               varnames   ('.0', 'f')
+               freevars   ('maybe_prefix',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '<dictcomp>'
+               firstlineno 207
+               lnotab 0x
+            False
+            'columns'
+            ('inplace', 'axis')
+         names      ('list', 'features', 'MDConcepts', 'Object', 'Time', 'loc', 'zip', 'long_names', 'rename')
+         varnames   ('spec', 'df', 'include_time_col', 'include_object_col', 'add_spec_id_prefix', 'use_long_names', 'cols', 'view', 'renaming')
          freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MeasurementSeries'
-         firstlineno 168
-         lnotab 0x0a02
-      'MeasurementSeries'
-      'TS'
-      'TTC'
-      'TypedTimeseriesCollection'
+         cellvars   ('spec', 'add_spec_id_prefix', 'maybe_prefix')
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       '_feature_column_view'
+         firstlineno 184
+         lnotab
+            0x080228010401200104012002220204020c060a010401080132ff140326
+            02
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 4
+         stacksize : 3
          flags     : 16777216
          code
             0x8700970065005a0164005a02550064015a036402650464033c00000064
-            015a056404650464053c000000643188006601640c840c5a066507643264
-            0e8404a6000000ab0000000000000000005a086507643364108404a60000
-            00ab0000000000000000005a096507643264118404a6000000ab00000000
-            00000000005a0a6507643464138404a6000000ab0000000000000000005a
-            0b650764148400a6000000ab0000000000000000005a0c650764158400a6
-            000000ab0000000000000000005a0d641684005a0e641784005a0f643564
-            1984045a1064366437641a84055a116438641b84045a12641c84005a1364
-            39641d84045a14643a642084045a15642184005a16643b642384045a1709
-            00643c643d642a84055a1865190900643c643e64308405a6000000ab0000
-            000000000000005a1a880078015a1b5300
+            015a056404650464053c000000643888006601640c840c5a066507643964
+            0e8404a6000000ab0000000000000000005a086507643a640f8404a60000
+            00ab0000000000000000005a0965096a0a0000000000000000643b641184
+            04a6000000ab0000000000000000005a096507643c64128404a6000000ab
+            0000000000000000005a0b650b6a0a0000000000000000643d64138404a6
+            000000ab0000000000000000005a0b650c643e64158404a6000000ab0000
+            000000000000005a0d6507643f64178404a6000000ab0000000000000000
+            005a0e6507644064198404a6000000ab0000000000000000005a0f650764
+            40641a8404a6000000ab0000000000000000005a106441641c84045a1164
+            42642084045a126440642184045a136443642384045a14642484005a1564
+            44642584045a16090009006445643c642884055a176446642b84045a1809
+            0064476448643084055a19643184005a1a643284005a1b6449643384045a
+            1c644a644b643484055a1d643a643584045a1e643684005a1f644c643784
+            045a20880078015a215300
                        0 MAKE_CELL                0 (__class__)
          
-         178           2 RESUME                   0
+         212           2 RESUME                   0
                        4 LOAD_NAME                0 (__name__)
                        6 STORE_NAME               1 (__module__)
-                       8 LOAD_CONST               0 ('TypedTimeseriesCollection')
+                       8 LOAD_CONST               0 ('AbstractTimeseriesContainer')
                       10 STORE_NAME               2 (__qualname__)
                       12 SETUP_ANNOTATIONS
          
-         179          14 LOAD_CONST               1 (None)
+         213          14 LOAD_CONST               1 (None)
                       16 STORE_NAME               3 (_ts_spec_cls)
                       18 LOAD_CONST               2 ('type[TSSpec]')
                       20 LOAD_NAME                4 (__annotations__)
                       22 LOAD_CONST               3 ('_ts_spec_cls')
                       24 STORE_SUBSCR
          
-         180          28 LOAD_CONST               1 (None)
-                      30 STORE_NAME               5 (_ts_cls)
-                      32 LOAD_CONST               4 ('type[TS]')
+         214          28 LOAD_CONST               1 (None)
+                      30 STORE_NAME               5 (_ts_view_cls)
+                      32 LOAD_CONST               4 ('type[TSView]')
                       34 LOAD_NAME                4 (__annotations__)
-                      36 LOAD_CONST               5 ('_ts_cls')
+                      36 LOAD_CONST               5 ('_ts_view_cls')
                       38 STORE_SUBSCR
          
-         182          42 LOAD_CONST              49 (('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'return', 'None'))
+         216          42 LOAD_CONST              56 (('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'return', 'None'))
                       44 LOAD_CLOSURE             0 (__class__)
                       46 BUILD_TUPLE              1
-                      48 LOAD_CONST              12 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 182>)
+                      48 LOAD_CONST              12 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 216>)
                       50 MAKE_FUNCTION           12 (annotations, closure)
                       52 STORE_NAME               6 (__init__)
          
-         189          54 LOAD_NAME                7 (property)
+         226          54 LOAD_NAME                7 (property)
          
-         190          56 LOAD_CONST              50 (('return', 'int'))
-                      58 LOAD_CONST              14 (<code object observation_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 189>)
+         227          56 LOAD_CONST              57 (('return', 'ObservationType'))
+                      58 LOAD_CONST              14 (<code object observation_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 226>)
                       60 MAKE_FUNCTION            4 (annotations)
          
-         189          62 PRECALL                  0
+         226          62 PRECALL                  0
                       66 CALL                     0
          
-         190          76 STORE_NAME               8 (observation_count)
+         227          76 STORE_NAME               8 (observation_type)
          
-         193          78 LOAD_NAME                7 (property)
+         230          78 LOAD_NAME                7 (property)
          
-         194          80 LOAD_CONST              51 (('return', 'set[str]'))
-                      82 LOAD_CONST              16 (<code object occurring_objects, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 193>)
+         231          80 LOAD_CONST              58 (('return', 'TSSpec'))
+                      82 LOAD_CONST              15 (<code object timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 230>)
                       84 MAKE_FUNCTION            4 (annotations)
          
-         193          86 PRECALL                  0
+         230          86 PRECALL                  0
                       90 CALL                     0
          
-         194         100 STORE_NAME               9 (occurring_objects)
+         231         100 STORE_NAME               9 (timeseries_spec)
          
-         197         102 LOAD_NAME                7 (property)
+         234         102 LOAD_NAME                9 (timeseries_spec)
+                     104 LOAD_ATTR               10 (setter)
          
-         198         104 LOAD_CONST              50 (('return', 'int'))
-                     106 LOAD_CONST              17 (<code object time_series_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 197>)
-                     108 MAKE_FUNCTION            4 (annotations)
+         235         114 LOAD_CONST              59 (('value', 'TSSpec'))
+                     116 LOAD_CONST              17 (<code object timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 234>)
+                     118 MAKE_FUNCTION            4 (annotations)
          
-         197         110 PRECALL                  0
-                     114 CALL                     0
+         234         120 PRECALL                  0
+                     124 CALL                     0
          
-         198         124 STORE_NAME              10 (time_series_count)
+         235         134 STORE_NAME               9 (timeseries_spec)
          
-         201         126 LOAD_NAME                7 (property)
+         238         136 LOAD_NAME                7 (property)
          
-         202         128 LOAD_CONST              52 (('return', 'dict[str, TS]'))
-                     130 LOAD_CONST              19 (<code object object_map, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 201>)
-                     132 MAKE_FUNCTION            4 (annotations)
+         239         138 LOAD_CONST              60 (('return', 'pd.DataFrame'))
+                     140 LOAD_CONST              18 (<code object df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 238>)
+                     142 MAKE_FUNCTION            4 (annotations)
          
-         201         134 PRECALL                  0
-                     138 CALL                     0
+         238         144 PRECALL                  0
+                     148 CALL                     0
          
-         202         148 STORE_NAME              11 (object_map)
+         239         158 STORE_NAME              11 (df)
          
-         205         150 LOAD_NAME                7 (property)
+         242         160 LOAD_NAME               11 (df)
+                     162 LOAD_ATTR               10 (setter)
          
-         206         152 LOAD_CONST              20 (<code object feature_column_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 205>)
-                     154 MAKE_FUNCTION            0
+         243         172 LOAD_CONST              61 (('value', 'pd.DataFrame'))
+                     174 LOAD_CONST              19 (<code object df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 242>)
+                     176 MAKE_FUNCTION            4 (annotations)
          
-         205         156 PRECALL                  0
-                     160 CALL                     0
+         242         178 PRECALL                  0
+                     182 CALL                     0
          
-         206         170 STORE_NAME              12 (feature_column_view)
+         243         192 STORE_NAME              11 (df)
          
-         209         172 LOAD_NAME                7 (property)
+         246         194 LOAD_NAME               12 (classmethod)
          
-         210         174 LOAD_CONST              21 (<code object prefixed_feature_column_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 209>)
-                     176 MAKE_FUNCTION            0
+         247         196 LOAD_CONST              62 (('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'return', 'typing.Self'))
+                     198 LOAD_CONST              21 (<code object of, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 246>)
+                     200 MAKE_FUNCTION            4 (annotations)
          
-         209         178 PRECALL                  0
-                     182 CALL                     0
+         246         202 PRECALL                  0
+                     206 CALL                     0
          
-         210         192 STORE_NAME              13 (prefixed_feature_column_view)
+         247         216 STORE_NAME              13 (of)
          
-         216         194 LOAD_CONST              22 (<code object _repopulate_internal_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 216>)
-                     196 MAKE_FUNCTION            0
-                     198 STORE_NAME              14 (_repopulate_internal_index)
-         
-         221         200 LOAD_CONST              23 (<code object _check_ts_features, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 221>)
-                     202 MAKE_FUNCTION            0
-                     204 STORE_NAME              15 (_check_ts_features)
-         
-         224         206 LOAD_CONST              53 (('return', 'TS'))
-                     208 LOAD_CONST              25 (<code object _mk_timeseries_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 224>)
-                     210 MAKE_FUNCTION            4 (annotations)
-                     212 STORE_NAME              16 (_mk_timeseries_view)
-         
-         228         214 LOAD_CONST              54 ((None,))
-                     216 LOAD_CONST              55 (('timeseries_spec', 'TSSpec', 'return', 'None'))
-                     218 LOAD_CONST              26 (<code object _update_timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 228>)
-                     220 MAKE_FUNCTION            5 (defaults, annotations)
-                     222 STORE_NAME              17 (_update_timeseries_spec)
-         
-         232         224 LOAD_CONST              56 (('return', 'TSSpec'))
-                     226 LOAD_CONST              27 (<code object _derive_timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 232>)
-                     228 MAKE_FUNCTION            4 (annotations)
-                     230 STORE_NAME              18 (_derive_timeseries_spec)
-         
-         247         232 LOAD_CONST              28 (<code object update_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 247>)
-                     234 MAKE_FUNCTION            0
-                     236 STORE_NAME              19 (update_index)
-         
-         250         238 LOAD_CONST              57 (('return', 'None'))
-                     240 LOAD_CONST              29 (<code object fit_to_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 250>)
-                     242 MAKE_FUNCTION            4 (annotations)
-                     244 STORE_NAME              20 (fit_to_data)
-         
-         254         246 LOAD_CONST              58 (('objs', 'str | list[str] | slice', 'return', 'TS'))
-                     248 LOAD_CONST              32 (<code object view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 254>)
-                     250 MAKE_FUNCTION            4 (annotations)
-                     252 STORE_NAME              21 (view)
-         
-         258         254 LOAD_CONST              33 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 258>)
-                     256 MAKE_FUNCTION            0
-                     258 STORE_NAME              22 (__str__)
+         250         218 LOAD_NAME                7 (property)
          
-         261         260 LOAD_CONST              59 (('return', 'str'))
-                     262 LOAD_CONST              35 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 261>)
-                     264 MAKE_FUNCTION            4 (annotations)
-                     266 STORE_NAME              23 (__repr__)
+         251         220 LOAD_CONST              63 (('return', 'Set[str]'))
+                     222 LOAD_CONST              23 (<code object objects, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 250>)
+                     224 MAKE_FUNCTION            4 (annotations)
+         
+         250         226 PRECALL                  0
+                     230 CALL                     0
+         
+         251         240 STORE_NAME              14 (objects)
+         
+         254         242 LOAD_NAME                7 (property)
+         
+         255         244 LOAD_CONST              64 (('return', 'int'))
+                     246 LOAD_CONST              25 (<code object observation_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 254>)
+                     248 MAKE_FUNCTION            4 (annotations)
+         
+         254         250 PRECALL                  0
+                     254 CALL                     0
+         
+         255         264 STORE_NAME              15 (observation_count)
+         
+         258         266 LOAD_NAME                7 (property)
+         
+         259         268 LOAD_CONST              64 (('return', 'int'))
+                     270 LOAD_CONST              26 (<code object time_series_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 258>)
+                     272 MAKE_FUNCTION            4 (annotations)
          
-         265         268 NOP
+         258         274 PRECALL                  0
+                     278 CALL                     0
          
-         264         270 LOAD_CONST              60 (('vertical',))
-                     272 LOAD_CONST              61 (('self', 'TTC', 'other', 'TTC', 'axis', "Literal['horizontal', 'vertical']", 'return', 'TTC'))
-                     274 LOAD_CONST              42 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 264>)
-                     276 MAKE_FUNCTION            5 (defaults, annotations)
-                     278 STORE_NAME              24 (merge)
+         259         288 STORE_NAME              16 (time_series_count)
          
-         285         280 LOAD_NAME               25 (classmethod)
+         262         290 LOAD_CONST              65 (('return', 'bool'))
+                     292 LOAD_CONST              28 (<code object __contains__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 262>)
+                     294 MAKE_FUNCTION            4 (annotations)
+                     296 STORE_NAME              17 (__contains__)
          
-         287         282 NOP
+         265         298 LOAD_CONST              66 (('item', 'str', 'return', 'TSView'))
+                     300 LOAD_CONST              32 (<code object __getitem__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 265>)
+                     302 MAKE_FUNCTION            4 (annotations)
+                     304 STORE_NAME              18 (__getitem__)
          
-         286         284 LOAD_CONST              60 (('vertical',))
-                     286 LOAD_CONST              62 (('cls', 'type[TTC]', 'tscs', 'dict[str, TTC]', 'o_tscs', 'dict[str, TTC]', 'axis', "Literal['horizontal', 'vertical']", 'return', 'dict[str, TTC]'))
-                     288 LOAD_CONST              48 (<code object lifted_merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 285>)
-                     290 MAKE_FUNCTION            5 (defaults, annotations)
+         268         306 LOAD_CONST              64 (('return', 'int'))
+                     308 LOAD_CONST              33 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 268>)
+                     310 MAKE_FUNCTION            4 (annotations)
+                     312 STORE_NAME              19 (__len__)
          
-         285         292 PRECALL                  0
-                     296 CALL                     0
+         271         314 LOAD_CONST              67 (('return', 'Iterator[TSView]'))
+                     316 LOAD_CONST              35 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 271>)
+                     318 MAKE_FUNCTION            4 (annotations)
+                     320 STORE_NAME              20 (__iter__)
          
-         286         306 STORE_NAME              26 (lifted_merge)
-                     308 LOAD_CLOSURE             0 (__class__)
-                     310 COPY                     1
-                     312 STORE_NAME              27 (__classcell__)
-                     314 RETURN_VALUE
+         274         322 LOAD_CONST              36 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 274>)
+                     324 MAKE_FUNCTION            0
+                     326 STORE_NAME              21 (__str__)
+         
+         277         328 LOAD_CONST              68 (('return', 'str'))
+                     330 LOAD_CONST              37 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 277>)
+                     332 MAKE_FUNCTION            4 (annotations)
+                     334 STORE_NAME              22 (__repr__)
+         
+         280         336 NOP
+         
+         281         338 NOP
+         
+         280         340 LOAD_CONST              69 ((True, False, False, False))
+                     342 LOAD_CONST              60 (('return', 'pd.DataFrame'))
+                     344 LOAD_CONST              40 (<code object feature_column_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 280>)
+                     346 MAKE_FUNCTION            5 (defaults, annotations)
+                     348 STORE_NAME              23 (feature_column_view)
+         
+         286         350 LOAD_CONST              70 (('objs', 'StrIndexer', 'return', 'TSView'))
+                     352 LOAD_CONST              43 (<code object view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 286>)
+                     354 MAKE_FUNCTION            4 (annotations)
+                     356 STORE_NAME              24 (view)
+         
+         294         358 NOP
+         
+         293         360 LOAD_CONST              71 (('vertical',))
+                     362 LOAD_CONST              72 (('other', 'typing.Self', 'axis', "Literal['horizontal', 'vertical']", 'return', 'typing.Self'))
+                     364 LOAD_CONST              48 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 293>)
+                     366 MAKE_FUNCTION            5 (defaults, annotations)
+                     368 STORE_NAME              25 (merge)
+         
+         314         370 LOAD_CONST              49 (<code object _repopulate_internal_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 314>)
+                     372 MAKE_FUNCTION            0
+                     374 STORE_NAME              26 (_repopulate_internal_index)
+         
+         318         376 LOAD_CONST              50 (<code object _check_ts_features, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 318>)
+                     378 MAKE_FUNCTION            0
+                     380 STORE_NAME              27 (_check_ts_features)
+         
+         321         382 LOAD_CONST              73 (('return', 'TSView'))
+                     384 LOAD_CONST              51 (<code object _mk_timeseries_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 321>)
+                     386 MAKE_FUNCTION            4 (annotations)
+                     388 STORE_NAME              28 (_mk_timeseries_view)
+         
+         325         390 LOAD_CONST              74 ((None,))
+                     392 LOAD_CONST              75 (('timeseries_spec', 'TSSpec', 'return', 'None'))
+                     394 LOAD_CONST              52 (<code object _update_timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 325>)
+                     396 MAKE_FUNCTION            5 (defaults, annotations)
+                     398 STORE_NAME              29 (_update_timeseries_spec)
+         
+         329         400 LOAD_CONST              58 (('return', 'TSSpec'))
+                     402 LOAD_CONST              53 (<code object _derive_timeseries_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 329>)
+                     404 MAKE_FUNCTION            4 (annotations)
+                     406 STORE_NAME              30 (_derive_timeseries_spec)
+         
+         344         408 LOAD_CONST              54 (<code object update_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 344>)
+                     410 MAKE_FUNCTION            0
+                     412 STORE_NAME              31 (update_index)
+         
+         347         414 LOAD_CONST              76 (('return', 'None'))
+                     416 LOAD_CONST              55 (<code object fit_to_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 347>)
+                     418 MAKE_FUNCTION            4 (annotations)
+                     420 STORE_NAME              32 (fit_to_data)
+                     422 LOAD_CLOSURE             0 (__class__)
+                     424 COPY                     1
+                     426 STORE_NAME              33 (__classcell__)
+                     428 RETURN_VALUE
          consts
-            'TypedTimeseriesCollection'
+            'AbstractTimeseriesContainer'
             None
             'type[TSSpec]'
             '_ts_spec_cls'
-            'type[TS]'
-            '_ts_cls'
+            'type[TSView]'
+            '_ts_view_cls'
             'timeseries_spec'
             'TSSpec'
             'df'
             'pd.DataFrame'
             'return'
             'None'
             code
                argcount  : 3
                nlocals   : 3
-               stacksize : 2
+               stacksize : 4
                flags     : 16777219
                code
                   0x95019700740100000000000000000000a6000000ab0000000000000000
                   00a0010000000000000000000000000000000000000000a6000000ab0000
-                  0000000000000001007c017c005f0200000000000000007c027c005f0300
-                  0000000000000069007c005f0400000000000000007c00a0050000000000
+                  0000000000000001007405000000000000000000007c017c006a03000000
+                  0000000000a6020000ab02000000000000000073024a0082017c017c005f
+                  0400000000000000007c027c005f05000000000000000064007c005f0600
+                  0000000000000069007c005f0700000000000000007c00a0080000000000
                   000000000000000000000000000000a6000000ab00000000000000000001
                   0064005300
                              0 COPY_FREE_VARS           1
                
-               182           2 RESUME                   0
+               216           2 RESUME                   0
                
-               183           4 LOAD_GLOBAL              1 (NULL + super)
+               217           4 LOAD_GLOBAL              1 (NULL + super)
                             16 PRECALL                  0
                             20 CALL                     0
                             30 LOAD_METHOD              1 (__init__)
                             52 PRECALL                  0
                             56 CALL                     0
                             66 POP_TOP
                
-               184          68 LOAD_FAST                1 (timeseries_spec)
-                            70 LOAD_FAST                0 (self)
-                            72 STORE_ATTR               2 (timeseries_spec)
+               218          68 LOAD_GLOBAL              5 (NULL + isinstance)
+                            80 LOAD_FAST                1 (timeseries_spec)
+                            82 LOAD_FAST                0 (self)
+                            84 LOAD_ATTR                3 (_ts_spec_cls)
+                            94 PRECALL                  2
+                            98 CALL                     2
+                           108 POP_JUMP_FORWARD_IF_TRUE     2 (to 114)
+                           110 LOAD_ASSERTION_ERROR
+                           112 RAISE_VARARGS            1
+               
+               219     >>  114 LOAD_FAST                1 (timeseries_spec)
+                           116 LOAD_FAST                0 (self)
+                           118 STORE_ATTR               4 (timeseries_spec)
+               
+               220         128 LOAD_FAST                2 (df)
+                           130 LOAD_FAST                0 (self)
+                           132 STORE_ATTR               5 (df)
                
-               185          82 LOAD_FAST                2 (df)
-                            84 LOAD_FAST                0 (self)
-                            86 STORE_ATTR               3 (df)
+               222         142 LOAD_CONST               0 (None)
+                           144 LOAD_FAST                0 (self)
+                           146 STORE_ATTR               6 (_internal_index)
                
-               186          96 BUILD_MAP                0
-                            98 LOAD_FAST                0 (self)
-                           100 STORE_ATTR               4 (_object_map)
+               223         156 BUILD_MAP                0
+                           158 LOAD_FAST                0 (self)
+                           160 STORE_ATTR               7 (_object_map)
                
-               187         110 LOAD_FAST                0 (self)
-                           112 LOAD_METHOD              5 (_repopulate_internal_index)
-                           134 PRECALL                  0
-                           138 CALL                     0
-                           148 POP_TOP
-                           150 LOAD_CONST               0 (None)
-                           152 RETURN_VALUE
+               224         170 LOAD_FAST                0 (self)
+                           172 LOAD_METHOD              8 (_repopulate_internal_index)
+                           194 PRECALL                  0
+                           198 CALL                     0
+                           208 POP_TOP
+                           210 LOAD_CONST               0 (None)
+                           212 RETURN_VALUE
                consts
                   None
-               names      ('super', '__init__', 'timeseries_spec', 'df', '_object_map', '_repopulate_internal_index')
+               names      ('super', '__init__', 'isinstance', '_ts_spec_cls', 'timeseries_spec', 'df', '_internal_index', '_object_map', '_repopulate_internal_index')
                varnames   ('self', 'timeseries_spec', 'df')
                freevars   ('__class__',)
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__init__'
-               firstlineno 182
-               lnotab 0x040140010e010e010e01
+               firstlineno 216
+               lnotab 0x040140012e010e010e020e010e01
+            'ObservationType'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000006a0100000000000000005300
+               226           0 RESUME                   0
+               
+               228           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (timeseries_spec)
+                            14 LOAD_ATTR                1 (observation_type)
+                            24 RETURN_VALUE
+               consts
+                  None
+               names      ('timeseries_spec', 'observation_type')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'observation_type'
+               firstlineno 226
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+               230           0 RESUME                   0
+               
+               232           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_timeseries_spec)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_timeseries_spec',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'timeseries_spec'
+               firstlineno 230
+               lnotab 0x0202
+            'value'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c017c005f00000000000000000064005300
+               234           0 RESUME                   0
+               
+               236           2 LOAD_FAST                1 (value)
+                             4 LOAD_FAST                0 (self)
+                             6 STORE_ATTR               0 (_timeseries_spec)
+                            16 LOAD_CONST               0 (None)
+                            18 RETURN_VALUE
+               consts
+                  None
+               names      ('_timeseries_spec',)
+               varnames   ('self', 'value')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'timeseries_spec'
+               firstlineno 234
+               lnotab 0x0202
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 1
+               flags     : 16777219
+               code 0x97007c006a0000000000000000005300
+               238           0 RESUME                   0
+               
+               240           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_df)
+                            14 RETURN_VALUE
+               consts
+                  None
+               names      ('_df',)
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'df'
+               firstlineno 238
+               lnotab 0x0202
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c017c005f00000000000000000064005300
+               242           0 RESUME                   0
+               
+               244           2 LOAD_FAST                1 (value)
+                             4 LOAD_FAST                0 (self)
+                             6 STORE_ATTR               0 (_df)
+                            16 LOAD_CONST               0 (None)
+                            18 RETURN_VALUE
+               consts
+                  None
+               names      ('_df',)
+               varnames   ('self', 'value')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'df'
+               firstlineno 242
+               lnotab 0x0202
+            'typing.Self'
+            code
+               argcount  : 3
+               nlocals   : 5
+               stacksize : 4
+               flags     : 16777231
+               code 0x970002007c007c017c02a6020000ab0200000000000000005300
+               246           0 RESUME                   0
+               
+               248           2 PUSH_NULL
+                             4 LOAD_FAST                0 (cls)
+                             6 LOAD_FAST                1 (timeseries_spec)
+                             8 LOAD_FAST                2 (df)
+                            10 PRECALL                  2
+                            14 CALL                     2
+                            24 RETURN_VALUE
+               consts
+                  None
+               names      ()
+               varnames   ('cls', 'timeseries_spec', 'df', 'args', 'kwargs')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'of'
+               firstlineno 246
+               lnotab 0x0202
+            'Set[str]'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 2
+               flags     : 16777219
+               code
+                  0x97007c006a000000000000000000a00100000000000000000000000000
+                  00000000000000a6000000ab0000000000000000005300
+               250           0 RESUME                   0
+               
+               252           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_object_map)
+                            14 LOAD_METHOD              1 (keys)
+                            36 PRECALL                  0
+                            40 CALL                     0
+                            50 RETURN_VALUE
+               consts
+                  None
+               names      ('_object_map', 'keys')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'objects'
+               firstlineno 250
+               lnotab 0x0202
             'int'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               189           0 RESUME                   0
+               254           0 RESUME                   0
                
-               191           2 LOAD_GLOBAL              1 (NULL + len)
+               256           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (df)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'df')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'observation_count'
-               firstlineno 189
+               firstlineno 254
                lnotab 0x0202
-            'set[str]'
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 1
+               stacksize : 3
                flags     : 16777219
-               code 0x97007c006a0000000000000000005300
-               193           0 RESUME                   0
+               code
+                  0x97007401000000000000000000007c006a010000000000000000a60100
+                  00ab0100000000000000005300
+               258           0 RESUME                   0
                
-               195           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (_occurring_objects)
-                            14 RETURN_VALUE
+               260           2 LOAD_GLOBAL              1 (NULL + len)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (objects)
+                            26 PRECALL                  1
+                            30 CALL                     1
+                            40 RETURN_VALUE
                consts
                   None
-               names      ('_occurring_objects',)
+               names      ('len', 'objects')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'occurring_objects'
-               firstlineno 193
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'time_series_count'
+               firstlineno 258
                lnotab 0x0202
+            'bool'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c017c006a00000000000000000076005300
+               262           0 RESUME                   0
+               
+               263           2 LOAD_FAST                1 (item)
+                             4 LOAD_FAST                0 (self)
+                             6 LOAD_ATTR                0 (_object_map)
+                            16 CONTAINS_OP              0
+                            18 RETURN_VALUE
+               consts
+                  None
+               names      ('_object_map',)
+               varnames   ('self', 'item')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__contains__'
+               firstlineno 262
+               lnotab 0x0201
+            'item'
+            'str'
+            'TSView'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c006a0000000000000000007c01190000000000000000005300
+               265           0 RESUME                   0
+               
+               266           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_object_map)
+                            14 LOAD_FAST                1 (item)
+                            16 BINARY_SUBSCR
+                            26 RETURN_VALUE
+               consts
+                  None
+               names      ('_object_map',)
+               varnames   ('self', 'item')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__getitem__'
+               firstlineno 265
+               lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               197           0 RESUME                   0
+               268           0 RESUME                   0
                
-               199           2 LOAD_GLOBAL              1 (NULL + len)
+               269           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
-                            16 LOAD_ATTR                1 (_occurring_objects)
+                            16 LOAD_ATTR                1 (objects)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
-               names      ('len', '_occurring_objects')
+               names      ('len', 'objects')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'time_series_count'
-               firstlineno 197
-               lnotab 0x0202
-            'dict[str, TS]'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__len__'
+               firstlineno 268
+               lnotab 0x0201
+            'Iterator[TSView]'
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 1
+               stacksize : 4
                flags     : 16777219
-               code 0x97007c006a0000000000000000005300
-               201           0 RESUME                   0
+               code
+                  0x97007401000000000000000000007c006a010000000000000000a00200
+                  00000000000000000000000000000000000000a6000000ab000000000000
+                  000000a6010000ab0100000000000000005300
+               271           0 RESUME                   0
                
-               203           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (_object_map)
-                            14 RETURN_VALUE
+               272           2 LOAD_GLOBAL              1 (NULL + iter)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (_object_map)
+                            26 LOAD_METHOD              2 (values)
+                            48 PRECALL                  0
+                            52 CALL                     0
+                            62 PRECALL                  1
+                            66 CALL                     1
+                            76 RETURN_VALUE
                consts
                   None
-               names      ('_object_map',)
+               names      ('iter', '_object_map', 'values')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'object_map'
-               firstlineno 201
-               lnotab 0x0202
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__iter__'
+               firstlineno 271
+               lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 5
+               stacksize : 9
+               flags     : 16777219
+               code
+                  0x97007c006a0000000000000000006a0100000000000000009b0064017c
+                  006a0200000000000000009b0064027c006a0300000000000000009b0064
+                  037409000000000000000000007c006a050000000000000000a6010000ab
+                  0100000000000000009b0064049d085300
+               274           0 RESUME                   0
+               
+               275           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (__class__)
+                            14 LOAD_ATTR                1 (__name__)
+                            24 FORMAT_VALUE             0
+                            26 LOAD_CONST               1 ('(spec=')
+                            28 LOAD_FAST                0 (self)
+                            30 LOAD_ATTR                2 (timeseries_spec)
+                            40 FORMAT_VALUE             0
+                            42 LOAD_CONST               2 (', #obs=')
+                            44 LOAD_FAST                0 (self)
+                            46 LOAD_ATTR                3 (observation_count)
+                            56 FORMAT_VALUE             0
+                            58 LOAD_CONST               3 (', #objects=')
+                            60 LOAD_GLOBAL              9 (NULL + len)
+                            72 LOAD_FAST                0 (self)
+                            74 LOAD_ATTR                5 (objects)
+                            84 PRECALL                  1
+                            88 CALL                     1
+                            98 FORMAT_VALUE             0
+                           100 LOAD_CONST               4 (')')
+                           102 BUILD_STRING             8
+                           104 RETURN_VALUE
+               consts
+                  None
+                  '(spec='
+                  ', #obs='
+                  ', #objects='
+                  ')'
+               names      ('__class__', '__name__', 'timeseries_spec', 'observation_count', 'len', 'objects')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__str__'
+               firstlineno 274
+               lnotab 0x0201
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 3
                flags     : 16777219
                code
-                  0x97007c006a0000000000000000006a0100000000000000006400640085
-                  027405000000000000000000007c006a0300000000000000006a04000000
-                  0000000000a6010000ab0100000000000000006602190000000000000000
+                  0x97007401000000000000000000007c00a6010000ab0100000000000000
                   005300
-               205           0 RESUME                   0
+               277           0 RESUME                   0
                
-               207           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (df)
-                            14 LOAD_ATTR                1 (loc)
-                            24 LOAD_CONST               0 (None)
-                            26 LOAD_CONST               0 (None)
-                            28 BUILD_SLICE              2
-                            30 LOAD_GLOBAL              5 (NULL + list)
-                            42 LOAD_FAST                0 (self)
-                            44 LOAD_ATTR                3 (timeseries_spec)
-                            54 LOAD_ATTR                4 (features)
-                            64 PRECALL                  1
-                            68 CALL                     1
-                            78 BUILD_TUPLE              2
-                            80 BINARY_SUBSCR
-                            90 RETURN_VALUE
+               278           2 LOAD_GLOBAL              1 (NULL + str)
+                            14 LOAD_FAST                0 (self)
+                            16 PRECALL                  1
+                            20 CALL                     1
+                            30 RETURN_VALUE
                consts
                   None
-               names      ('df', 'loc', 'list', 'timeseries_spec', 'features')
+               names      ('str',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__repr__'
+               firstlineno 277
+               lnotab 0x0201
+            True
+            False
+            code
+               argcount  : 5
+               nlocals   : 5
+               stacksize : 8
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c006a0100000000000000007c006a
+                  0200000000000000007c017c027c037c04ac01a6060000ab060000000000
+                  0000005300
+               280           0 RESUME                   0
+               
+               282           2 LOAD_GLOBAL              1 (NULL + _feature_column_view)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (timeseries_spec)
+                            26 LOAD_FAST                0 (self)
+                            28 LOAD_ATTR                2 (df)
+                            38 LOAD_FAST                1 (include_time_col)
+               
+               283          40 LOAD_FAST                2 (include_object_col)
+                            42 LOAD_FAST                3 (add_spec_id_prefix)
+               
+               284          44 LOAD_FAST                4 (use_long_names)
+               
+               282          46 KW_NAMES                 1
+                            48 PRECALL                  6
+                            52 CALL                     6
+                            62 RETURN_VALUE
+               consts
+                  None
+                  ('include_time_col', 'include_object_col', 'add_spec_id_prefix', 'use_long_names')
+               names      ('_feature_column_view', 'timeseries_spec', 'df')
+               varnames   ('self', 'include_time_col', 'include_object_col', 'add_spec_id_prefix', 'use_long_names')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'feature_column_view'
-               firstlineno 205
-               lnotab 0x0202
+               firstlineno 280
+               lnotab 0x02022601040102fe
+            'objs'
+            'StrIndexer'
             code
-               argcount  : 1
+               argcount  : 2
                nlocals   : 2
                stacksize : 4
                flags     : 16777219
                code
-                  0x8700970089006a0000000000000000007d017c01a00100000000000000
-                  0000000000000000000000000088006601640184087c016a020000000000
-                  0000004400a6000000ab0000000000000000006402ac03a6020000ab0200
-                  000000000000005300
-                             0 MAKE_CELL                0 (self)
+                  0x97007c01730367007d016e137c0164017500720f740100000000000000
+                  0000006400a6010000ab0100000000000000007d017c00a0010000000000
+                  0000000000000000000000000000007c006a0200000000000000007c01a6
+                  020000ab0200000000000000005300
+               286           0 RESUME                   0
                
-               209           2 RESUME                   0
+               287           2 LOAD_FAST                1 (objs)
+                             4 POP_JUMP_FORWARD_IF_TRUE     3 (to 12)
                
-               211           4 LOAD_DEREF               0 (self)
-                             6 LOAD_ATTR                0 (feature_column_view)
-                            16 STORE_FAST               1 (df)
+               288           6 BUILD_LIST               0
+                             8 STORE_FAST               1 (objs)
+                            10 JUMP_FORWARD            19 (to 50)
+               
+               289     >>   12 LOAD_FAST                1 (objs)
+                            14 LOAD_CONST               1 (True)
+                            16 IS_OP                    0
+                            18 POP_JUMP_FORWARD_IF_FALSE    15 (to 50)
                
-               212          18 LOAD_FAST                1 (df)
-                            20 LOAD_METHOD              1 (rename)
+               290          20 LOAD_GLOBAL              1 (NULL + slice)
+                            32 LOAD_CONST               0 (None)
+                            34 PRECALL                  1
+                            38 CALL                     1
+                            48 STORE_FAST               1 (objs)
                
-               213          42 LOAD_CLOSURE             0 (self)
-                            44 BUILD_TUPLE              1
-                            46 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 213>)
-                            48 MAKE_FUNCTION            8 (closure)
-                            50 LOAD_FAST                1 (df)
-                            52 LOAD_ATTR                2 (columns)
-                            62 GET_ITER
-                            64 PRECALL                  0
-                            68 CALL                     0
+               291     >>   50 LOAD_FAST                0 (self)
+                            52 LOAD_METHOD              1 (_mk_timeseries_view)
+                            74 LOAD_FAST                0 (self)
+                            76 LOAD_ATTR                2 (timeseries_spec)
+                            86 LOAD_FAST                1 (objs)
+                            88 PRECALL                  2
+                            92 CALL                     2
+                           102 RETURN_VALUE
+               consts
+                  None
+                  True
+               names      ('slice', '_mk_timeseries_view', 'timeseries_spec')
+               varnames   ('self', 'objs')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'view'
+               firstlineno 286
+               lnotab 0x02010401060108011e01
+            'vertical'
+            'other'
+            'axis'
+            "Literal['horizontal', 'vertical']"
+            code
+               argcount  : 3
+               nlocals   : 7
+               stacksize : 6
+               flags     : 16777219
+               code
+                  0x97007c026401760073024a0082017c0264026b02000000009001724d7c
+                  006a000000000000000000a0010000000000000000000000000000000000
+                  0000007c016a000000000000000000a6010000ab01000000000000000073
+                  024a0082017c006a000000000000000000a0020000000000000000000000
+                  0000000000000000007c016a000000000000000000a6010000ab01000000
+                  00000000007d037c03723f7c006a0300000000000000006a040000000000
+                  0000006400640085027c03660219000000000000000000a0050000000000
+                  0000000000000000000000000000007c016a0300000000000000006a0400
+                  000000000000006400640085027c03660219000000000000000000a60100
+                  00ab01000000000000000073024a0082017c006a000000000000000000a0
+                  0600000000000000000000000000000000000000007c016a000000000000
+                  000000a6010000ab0100000000000000005c0200007d047d057c0572a67c
+                  006a030000000000000000740e000000000000000000006a080000000000
+                  00000019000000000000000000a005000000000000000000000000000000
+                  00000000007c016a030000000000000000740e000000000000000000006a
+                  08000000000000000019000000000000000000a6010000ab010000000000
+                  00000073024a0082017413000000000000000000006a0a00000000000000
+                  007c006a0300000000000000007c016a0300000000000000006a04000000
+                  00000000006400640085027c056602190000000000000000006702640364
+                  04ac05a6030000ab0300000000000000007d067c00a00b00000000000000
+                  000000000000000000000000007c006a000000000000000000a00c000000
+                  00000000000000000000000000000000007c016a000000000000000000a6
+                  010000ab0100000000000000007c06a6020000ab02000000000000000053
+                  007c0053007c0264066b020000000072737c006a0000000000000000007c
+                  016a0000000000000000006b020000000073024a00820174130000000000
+                  00000000006a0a00000000000000007c006a0300000000000000007c016a
+                  0300000000000000006702640764046404ac08a6040000ab040000000000
+                  0000007d067c06a00d000000000000000000000000000000000000000074
+                  0e000000000000000000006a08000000000000000064046404ac09a60300
+                  00ab03000000000000000001007c00a00b00000000000000000000000000
+                  000000000000007c006a0000000000000000007c06a6020000ab02000000
+                  0000000000530064005300
+               293           0 RESUME                   0
+               
+               295           2 LOAD_FAST                2 (axis)
+                             4 LOAD_CONST               1 (frozenset({'horizontal', 'vertical'}))
+                             6 CONTAINS_OP              0
+                             8 POP_JUMP_FORWARD_IF_TRUE     2 (to 14)
+                            10 LOAD_ASSERTION_ERROR
+                            12 RAISE_VARARGS            1
+               
+               296     >>   14 LOAD_FAST                2 (axis)
+                            16 LOAD_CONST               2 ('horizontal')
+                            18 COMPARE_OP               2 (==)
+                            24 EXTENDED_ARG             1
+                            26 POP_JUMP_FORWARD_IF_FALSE   333 (to 694)
+               
+               297          28 LOAD_FAST                0 (self)
+                            30 LOAD_ATTR                0 (timeseries_spec)
+                            40 LOAD_METHOD              1 (is_mergeable)
+                            62 LOAD_FAST                1 (other)
+                            64 LOAD_ATTR                0 (timeseries_spec)
+                            74 PRECALL                  1
+                            78 CALL                     1
+                            88 POP_JUMP_FORWARD_IF_TRUE     2 (to 94)
+                            90 LOAD_ASSERTION_ERROR
+                            92 RAISE_VARARGS            1
+               
+               298     >>   94 LOAD_FAST                0 (self)
+                            96 LOAD_ATTR                0 (timeseries_spec)
+                           106 LOAD_METHOD              2 (feature_intersection)
+                           128 LOAD_FAST                1 (other)
+                           130 LOAD_ATTR                0 (timeseries_spec)
+                           140 PRECALL                  1
+                           144 CALL                     1
+                           154 STORE_FAST               3 (ov)
+               
+               299         156 LOAD_FAST                3 (ov)
+                           158 POP_JUMP_FORWARD_IF_FALSE    63 (to 286)
+               
+               300         160 LOAD_FAST                0 (self)
+                           162 LOAD_ATTR                3 (df)
+                           172 LOAD_ATTR                4 (loc)
+                           182 LOAD_CONST               0 (None)
+                           184 LOAD_CONST               0 (None)
+                           186 BUILD_SLICE              2
+                           188 LOAD_FAST                3 (ov)
+                           190 BUILD_TUPLE              2
+                           192 BINARY_SUBSCR
+                           202 LOAD_METHOD              5 (equals)
+               
+               301         224 LOAD_FAST                1 (other)
+                           226 LOAD_ATTR                3 (df)
+                           236 LOAD_ATTR                4 (loc)
+                           246 LOAD_CONST               0 (None)
+                           248 LOAD_CONST               0 (None)
+                           250 BUILD_SLICE              2
+                           252 LOAD_FAST                3 (ov)
+                           254 BUILD_TUPLE              2
+                           256 BINARY_SUBSCR
+               
+               300         266 PRECALL                  1
+                           270 CALL                     1
+                           280 POP_JUMP_FORWARD_IF_TRUE     2 (to 286)
+                           282 LOAD_ASSERTION_ERROR
+                           284 RAISE_VARARGS            1
+               
+               302     >>  286 LOAD_FAST                0 (self)
+                           288 LOAD_ATTR                0 (timeseries_spec)
+                           298 LOAD_METHOD              6 (feature_symmetric_difference)
+                           320 LOAD_FAST                1 (other)
+                           322 LOAD_ATTR                0 (timeseries_spec)
+                           332 PRECALL                  1
+                           336 CALL                     1
+                           346 UNPACK_SEQUENCE          2
+                           350 STORE_FAST               4 (_)
+                           352 STORE_FAST               5 (new_fs)
+               
+               303         354 LOAD_FAST                5 (new_fs)
+                           356 POP_JUMP_FORWARD_IF_FALSE   166 (to 690)
+               
+               304         358 LOAD_FAST                0 (self)
+                           360 LOAD_ATTR                3 (df)
+                           370 LOAD_GLOBAL             14 (MDConcepts)
+                           382 LOAD_ATTR                8 (Time)
+                           392 BINARY_SUBSCR
+                           402 LOAD_METHOD              5 (equals)
+                           424 LOAD_FAST                1 (other)
+                           426 LOAD_ATTR                3 (df)
+                           436 LOAD_GLOBAL             14 (MDConcepts)
+                           448 LOAD_ATTR                8 (Time)
+                           458 BINARY_SUBSCR
+                           468 PRECALL                  1
+                           472 CALL                     1
+                           482 POP_JUMP_FORWARD_IF_TRUE     2 (to 488)
+                           484 LOAD_ASSERTION_ERROR
+                           486 RAISE_VARARGS            1
+               
+               305     >>  488 LOAD_GLOBAL             19 (NULL + pd)
+                           500 LOAD_ATTR               10 (concat)
+                           510 LOAD_FAST                0 (self)
+                           512 LOAD_ATTR                3 (df)
+                           522 LOAD_FAST                1 (other)
+                           524 LOAD_ATTR                3 (df)
+                           534 LOAD_ATTR                4 (loc)
+                           544 LOAD_CONST               0 (None)
+                           546 LOAD_CONST               0 (None)
+                           548 BUILD_SLICE              2
+                           550 LOAD_FAST                5 (new_fs)
+                           552 BUILD_TUPLE              2
+                           554 BINARY_SUBSCR
+                           564 BUILD_LIST               2
+                           566 LOAD_CONST               3 ('columns')
+                           568 LOAD_CONST               4 (True)
+                           570 KW_NAMES                 5
+                           572 PRECALL                  3
+                           576 CALL                     3
+                           586 STORE_FAST               6 (df)
+               
+               306         588 LOAD_FAST                0 (self)
+                           590 LOAD_METHOD             11 (__class__)
+                           612 LOAD_FAST                0 (self)
+                           614 LOAD_ATTR                0 (timeseries_spec)
+                           624 LOAD_METHOD             12 (merge)
+                           646 LOAD_FAST                1 (other)
+                           648 LOAD_ATTR                0 (timeseries_spec)
+                           658 PRECALL                  1
+                           662 CALL                     1
+                           672 LOAD_FAST                6 (df)
+                           674 PRECALL                  2
+                           678 CALL                     2
+                           688 RETURN_VALUE
                
-               214          78 LOAD_CONST               2 (False)
+               307     >>  690 LOAD_FAST                0 (self)
+                           692 RETURN_VALUE
+               
+               308     >>  694 LOAD_FAST                2 (axis)
+                           696 LOAD_CONST               6 ('vertical')
+                           698 COMPARE_OP               2 (==)
+                           704 POP_JUMP_FORWARD_IF_FALSE   115 (to 936)
                
-               212          80 KW_NAMES                 3
-                            82 PRECALL                  2
-                            86 CALL                     2
-                            96 RETURN_VALUE
+               309         706 LOAD_FAST                0 (self)
+                           708 LOAD_ATTR                0 (timeseries_spec)
+                           718 LOAD_FAST                1 (other)
+                           720 LOAD_ATTR                0 (timeseries_spec)
+                           730 COMPARE_OP               2 (==)
+                           736 POP_JUMP_FORWARD_IF_TRUE     2 (to 742)
+                           738 LOAD_ASSERTION_ERROR
+                           740 RAISE_VARARGS            1
+               
+               310     >>  742 LOAD_GLOBAL             19 (NULL + pd)
+                           754 LOAD_ATTR               10 (concat)
+                           764 LOAD_FAST                0 (self)
+                           766 LOAD_ATTR                3 (df)
+                           776 LOAD_FAST                1 (other)
+                           778 LOAD_ATTR                3 (df)
+                           788 BUILD_LIST               2
+                           790 LOAD_CONST               7 ('index')
+                           792 LOAD_CONST               4 (True)
+                           794 LOAD_CONST               4 (True)
+                           796 KW_NAMES                 8
+                           798 PRECALL                  4
+                           802 CALL                     4
+                           812 STORE_FAST               6 (df)
+               
+               311         814 LOAD_FAST                6 (df)
+                           816 LOAD_METHOD             13 (sort_values)
+                           838 LOAD_GLOBAL             14 (MDConcepts)
+                           850 LOAD_ATTR                8 (Time)
+                           860 LOAD_CONST               4 (True)
+                           862 LOAD_CONST               4 (True)
+                           864 KW_NAMES                 9
+                           866 PRECALL                  3
+                           870 CALL                     3
+                           880 POP_TOP
+               
+               312         882 LOAD_FAST                0 (self)
+                           884 LOAD_METHOD             11 (__class__)
+                           906 LOAD_FAST                0 (self)
+                           908 LOAD_ATTR                0 (timeseries_spec)
+                           918 LOAD_FAST                6 (df)
+                           920 PRECALL                  2
+                           924 CALL                     2
+                           934 RETURN_VALUE
+               
+               308     >>  936 LOAD_CONST               0 (None)
+                           938 RETURN_VALUE
                consts
                   None
-                  code
-                     argcount  : 1
-                     nlocals   : 2
-                     stacksize : 5
-                     flags     : 16777235
-                     code
-                        0x9501970069007c005d257d017c0189026a0000000000000000006a0100
-                        0000000000000064007a00000089026a0000000000000000006a02000000
-                        00000000007a00000064007a0000007c017a00000093028c265300
-                                   0 COPY_FREE_VARS           1
-                     
-                     213           2 RESUME                   0
-                                   4 BUILD_MAP                0
-                                   6 LOAD_FAST                0 (.0)
-                             >>    8 FOR_ITER                37 (to 84)
-                                  10 STORE_FAST               1 (c)
-                                  12 LOAD_FAST                1 (c)
-                                  14 LOAD_DEREF               2 (self)
-                                  16 LOAD_ATTR                0 (timeseries_spec)
-                                  26 LOAD_ATTR                1 (type)
-                                  36 LOAD_CONST               0 ('_')
-                                  38 BINARY_OP                0 (+)
-                                  42 LOAD_DEREF               2 (self)
-                                  44 LOAD_ATTR                0 (timeseries_spec)
-                                  54 LOAD_ATTR                2 (label)
-                                  64 BINARY_OP                0 (+)
-                                  68 LOAD_CONST               0 ('_')
-                                  70 BINARY_OP                0 (+)
-                                  74 LOAD_FAST                1 (c)
-                                  76 BINARY_OP                0 (+)
-                                  80 MAP_ADD                  2
-                                  82 JUMP_BACKWARD           38 (to 8)
-                             >>   84 RETURN_VALUE
-                     consts
-                        '_'
-                     names      ('timeseries_spec', 'type', 'label')
-                     varnames   ('.0', 'c')
-                     freevars   ('self',)
-                     cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-                     name       '<dictcomp>'
-                     firstlineno 213
-                     lnotab 0x
-                  False
-                  ('inplace',)
-               names      ('feature_column_view', 'rename', 'columns')
-               varnames   ('self', 'df')
+                  frozenset({'horizontal', 'vertical'})
+                  'horizontal'
+                  'columns'
+                  True
+                  ('axis', 'copy')
+                  'vertical'
+                  'index'
+                  ('axis', 'ignore_index', 'copy')
+                  ('ignore_index', 'inplace')
+               names      ('timeseries_spec', 'is_mergeable', 'feature_intersection', 'df', 'loc', 'equals', 'feature_symmetric_difference', 'MDConcepts', 'Time', 'pd', 'concat', '__class__', 'merge', 'sort_values')
+               varnames   ('self', 'other', 'axis', 'ov', '_', 'new_fs', 'df')
                freevars   ()
-               cellvars   ('self',)
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'prefixed_feature_column_view'
-               firstlineno 209
-               lnotab 0x04020e011801240102fe
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'merge'
+               firstlineno 293
+               lnotab
+                  0x02020c010e0142013e01040140012aff14024401040182016401660104
+                  010c0124014801440136fc
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 5
                flags     : 16777219
                code
                   0x870097007401000000000000000000006a01000000000000000089006a
                   0200000000000000006a03000000000000000089006a0200000000000000
                   007408000000000000000000006a05000000000000000019000000000000
                   000000ac01a6020000ab02000000000000000089005f0600000000000000
-                  00740f0000000000000000000089006a0600000000000000006a03000000
-                  0000000000a6010000ab01000000000000000089005f0800000000000000
-                  00880066016402840889006a0800000000000000004400a6000000ab0000
-                  0000000000000089005f09000000000000000064005300
+                  00880066016402840889006a0600000000000000006a0300000000000000
+                  00a0070000000000000000000000000000000000000000a6000000ab0000
+                  000000000000004400a6000000ab00000000000000000089005f08000000
+                  000000000064005300
                              0 MAKE_CELL                0 (self)
                
-               216           2 RESUME                   0
+               314           2 RESUME                   0
                
-               217           4 LOAD_GLOBAL              1 (NULL + pd)
+               315           4 LOAD_GLOBAL              1 (NULL + pd)
                             16 LOAD_ATTR                1 (Series)
                             26 LOAD_DEREF               0 (self)
                             28 LOAD_ATTR                2 (df)
                             38 LOAD_ATTR                3 (index)
                             48 LOAD_DEREF               0 (self)
                             50 LOAD_ATTR                2 (df)
                             60 LOAD_GLOBAL              8 (MDConcepts)
@@ -2606,51 +3670,46 @@
                             82 BINARY_SUBSCR
                             92 KW_NAMES                 1
                             94 PRECALL                  2
                             98 CALL                     2
                            108 LOAD_DEREF               0 (self)
                            110 STORE_ATTR               6 (_internal_index)
                
-               218         120 LOAD_GLOBAL             15 (NULL + set)
-                           132 LOAD_DEREF               0 (self)
-                           134 LOAD_ATTR                6 (_internal_index)
-                           144 LOAD_ATTR                3 (index)
-                           154 PRECALL                  1
-                           158 CALL                     1
-                           168 LOAD_DEREF               0 (self)
-                           170 STORE_ATTR               8 (_occurring_objects)
-               
-               219         180 LOAD_CLOSURE             0 (self)
-                           182 BUILD_TUPLE              1
-                           184 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 219>)
-                           186 MAKE_FUNCTION            8 (closure)
-                           188 LOAD_DEREF               0 (self)
-                           190 LOAD_ATTR                8 (_occurring_objects)
-                           200 GET_ITER
-                           202 PRECALL                  0
-                           206 CALL                     0
-                           216 LOAD_DEREF               0 (self)
-                           218 STORE_ATTR               9 (_object_map)
-                           228 LOAD_CONST               0 (None)
-                           230 RETURN_VALUE
+               316         120 LOAD_CLOSURE             0 (self)
+                           122 BUILD_TUPLE              1
+                           124 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 316>)
+                           126 MAKE_FUNCTION            8 (closure)
+                           128 LOAD_DEREF               0 (self)
+                           130 LOAD_ATTR                6 (_internal_index)
+                           140 LOAD_ATTR                3 (index)
+                           150 LOAD_METHOD              7 (unique)
+                           172 PRECALL                  0
+                           176 CALL                     0
+                           186 GET_ITER
+                           188 PRECALL                  0
+                           192 CALL                     0
+                           202 LOAD_DEREF               0 (self)
+                           204 STORE_ATTR               8 (_object_map)
+                           214 LOAD_CONST               0 (None)
+                           216 RETURN_VALUE
                consts
                   None
                   ('index',)
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 16777235
                      code
                         0x9501970069007c005d187d017c018902a0000000000000000000000000
                         0000000000000000007c01a6010000ab01000000000000000093028c1953
                         00
                                    0 COPY_FREE_VARS           1
                      
-                     219           2 RESUME                   0
+                     316           2 RESUME                   0
                                    4 BUILD_MAP                0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                24 (to 58)
                                   10 STORE_FAST               1 (obj)
                                   12 LOAD_FAST                1 (obj)
                                   14 LOAD_DEREF               2 (self)
                                   16 LOAD_METHOD              0 (view)
@@ -2661,39 +3720,39 @@
                                   56 JUMP_BACKWARD           25 (to 8)
                              >>   58 RETURN_VALUE
                      consts
                      names      ('view',)
                      varnames   ('.0', 'obj')
                      freevars   ('self',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 219
+                     firstlineno 316
                      lnotab 0x
-               names      ('pd', 'Series', 'df', 'index', 'MDConcepts', 'Object', '_internal_index', 'set', '_occurring_objects', '_object_map')
+               names      ('pd', 'Series', 'df', 'index', 'MDConcepts', 'Object', '_internal_index', 'unique', '_object_map')
                varnames   ('self',)
                freevars   ()
                cellvars   ('self',)
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_repopulate_internal_index'
-               firstlineno 216
-               lnotab 0x040174013c01
+               firstlineno 314
+               lnotab 0x04017401
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 4
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a0100000000000000006a0200
                   00000000000000a6010000ab010000000000000000740100000000000000
                   0000007c006a0300000000000000006a040000000000000000a6010000ab
                   0100000000000000006b01000000005300
-               221           0 RESUME                   0
+               318           0 RESUME                   0
                
-               222           2 LOAD_GLOBAL              1 (NULL + set)
+               319           2 LOAD_GLOBAL              1 (NULL + set)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (timeseries_spec)
                             26 LOAD_ATTR                2 (features)
                             36 PRECALL                  1
                             40 CALL                     1
                             50 LOAD_GLOBAL              1 (NULL + set)
                             62 LOAD_FAST                0 (self)
@@ -2705,109 +3764,110 @@
                            104 RETURN_VALUE
                consts
                   None
                names      ('set', 'timeseries_spec', 'features', 'df', 'columns')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_check_ts_features'
-               firstlineno 221
+               firstlineno 318
                lnotab 0x0201
-            'TS'
             code
                argcount  : 3
                nlocals   : 4
                stacksize : 8
                flags     : 16777219
                code
                   0x97007c006a0000000000000000006a0100000000000000007c006a0200
                   000000000000006a0100000000000000007c021900000000000000000019
                   0000000000000000007d037c00a003000000000000000000000000000000
                   00000000007c017c037409000000000000000000007c03740a0000000000
                   00000000006a06000000000000000019000000000000000000a6010000ab
-                  010000000000000000a6030000ab0300000000000000005300
-               224           0 RESUME                   0
+                  010000000000000000ac01a6030000ab0300000000000000005300
+               321           0 RESUME                   0
                
-               225           2 LOAD_FAST                0 (self)
+               322           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (df)
                             14 LOAD_ATTR                1 (loc)
                             24 LOAD_FAST                0 (self)
                             26 LOAD_ATTR                2 (_internal_index)
                             36 LOAD_ATTR                1 (loc)
                             46 LOAD_FAST                2 (objs)
                             48 BINARY_SUBSCR
                             58 BINARY_SUBSCR
                             68 STORE_FAST               3 (df)
                
-               226          70 LOAD_FAST                0 (self)
-                            72 LOAD_METHOD              3 (_ts_cls)
+               323          70 LOAD_FAST                0 (self)
+                            72 LOAD_METHOD              3 (_ts_view_cls)
                             94 LOAD_FAST                1 (timeseries_spec)
                             96 LOAD_FAST                3 (df)
                             98 LOAD_GLOBAL              9 (NULL + set)
                            110 LOAD_FAST                3 (df)
                            112 LOAD_GLOBAL             10 (MDConcepts)
                            124 LOAD_ATTR                6 (Object)
                            134 BINARY_SUBSCR
                            144 PRECALL                  1
                            148 CALL                     1
-                           158 PRECALL                  3
-                           162 CALL                     3
-                           172 RETURN_VALUE
+                           158 KW_NAMES                 1
+                           160 PRECALL                  3
+                           164 CALL                     3
+                           174 RETURN_VALUE
                consts
                   None
-               names      ('df', 'loc', '_internal_index', '_ts_cls', 'set', 'MDConcepts', 'Object')
+                  ('objects',)
+               names      ('df', 'loc', '_internal_index', '_ts_view_cls', 'set', 'MDConcepts', 'Object')
                varnames   ('self', 'timeseries_spec', 'objs', 'df')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_mk_timeseries_view'
-               firstlineno 224
+               firstlineno 321
                lnotab 0x02014401
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c0180147c00a00000000000000000000000000000000000000000
                   00a6000000ab0000000000000000006e017c017c005f0100000000000000
                   007c00a0020000000000000000000000000000000000000000a6000000ab
                   00000000000000000073024a00820164005300
-               228           0 RESUME                   0
+               325           0 RESUME                   0
                
-               229           2 LOAD_FAST                1 (timeseries_spec)
+               326           2 LOAD_FAST                1 (timeseries_spec)
                              4 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 46)
                              6 LOAD_FAST                0 (self)
                              8 LOAD_METHOD              0 (_derive_timeseries_spec)
                             30 PRECALL                  0
                             34 CALL                     0
                             44 JUMP_FORWARD             1 (to 48)
                        >>   46 LOAD_FAST                1 (timeseries_spec)
                        >>   48 LOAD_FAST                0 (self)
                             50 STORE_ATTR               1 (timeseries_spec)
                
-               230          60 LOAD_FAST                0 (self)
+               327          60 LOAD_FAST                0 (self)
                             62 LOAD_METHOD              2 (_check_ts_features)
                             84 PRECALL                  0
                             88 CALL                     0
                             98 POP_JUMP_FORWARD_IF_TRUE     2 (to 104)
                            100 LOAD_ASSERTION_ERROR
                            102 RAISE_VARARGS            1
                        >>  104 LOAD_CONST               0 (None)
                            106 RETURN_VALUE
                consts
                   None
                names      ('_derive_timeseries_spec', 'timeseries_spec', '_check_ts_features')
                varnames   ('self', 'timeseries_spec')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_update_timeseries_spec'
-               firstlineno 228
+               firstlineno 325
                lnotab 0x02013a01
             code
                argcount  : 1
                nlocals   : 8
                stacksize : 8
                flags     : 16777219
                code
@@ -2821,89 +3881,89 @@
                   0000007c04190000000000000000007d077c076a0900000000000000007d
                   067c03a00a00000000000000000000000000000000000000007417000000
                   000000000000007c047c067c05a6030000ab030000000000000000a60100
                   00ab01000000000000000001008c797c00a00c0000000000000000000000
                   0000000000000000007c006a0700000000000000006a0d00000000000000
                   00741d000000000000000000007c038e00a6020000ab0200000000000000
                   005300
-               232           0 RESUME                   0
+               329           0 RESUME                   0
                
-               233           2 LOAD_GLOBAL              1 (NULL + only_feature_columns)
+               330           2 LOAD_GLOBAL              1 (NULL + only_feature_columns)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (df)
                             26 LOAD_ATTR                2 (columns)
                             36 PRECALL                  1
                             40 CALL                     1
                             50 STORE_FAST               1 (current_features)
                
-               234          52 LOAD_CONST               1 (1)
+               331          52 LOAD_CONST               1 (1)
                             54 LOAD_CONST               2 (('metadata',))
                             56 IMPORT_NAME              3 (extensions)
                             58 IMPORT_FROM              4 (metadata)
                             60 STORE_FAST               2 (metadata)
                             62 POP_TOP
                
-               236          64 BUILD_LIST               0
+               333          64 BUILD_LIST               0
                             66 STORE_FAST               3 (specs)
                
-               237          68 LOAD_FAST                1 (current_features)
+               334          68 LOAD_FAST                1 (current_features)
                             70 GET_ITER
                        >>   72 FOR_ITER               120 (to 314)
                             74 STORE_FAST               4 (f)
                
-               238          76 LOAD_FAST                2 (metadata)
+               335          76 LOAD_FAST                2 (metadata)
                             78 LOAD_METHOD              5 (get_type)
                            100 LOAD_FAST                0 (self)
                            102 LOAD_ATTR                1 (df)
                            112 LOAD_ATTR                6 (loc)
                            122 LOAD_CONST               0 (None)
                            124 LOAD_CONST               0 (None)
                            126 BUILD_SLICE              2
                            128 LOAD_FAST                4 (f)
                            130 BUILD_TUPLE              2
                            132 BINARY_SUBSCR
                            142 PRECALL                  1
                            146 CALL                     1
                            156 STORE_FAST               5 (fdt)
                
-               239         158 LOAD_FAST                4 (f)
+               336         158 LOAD_FAST                4 (f)
                            160 STORE_FAST               6 (long_name)
                
-               240         162 LOAD_FAST                4 (f)
+               337         162 LOAD_FAST                4 (f)
                            164 LOAD_FAST                0 (self)
                            166 LOAD_ATTR                7 (timeseries_spec)
                            176 LOAD_ATTR                8 (base)
                            186 CONTAINS_OP              0
                            188 POP_JUMP_FORWARD_IF_FALSE    25 (to 240)
                
-               241         190 LOAD_FAST                0 (self)
+               338         190 LOAD_FAST                0 (self)
                            192 LOAD_ATTR                7 (timeseries_spec)
                            202 LOAD_ATTR                8 (base)
                            212 LOAD_FAST                4 (f)
                            214 BINARY_SUBSCR
                            224 STORE_FAST               7 (fspec)
                
-               242         226 LOAD_FAST                7 (fspec)
+               339         226 LOAD_FAST                7 (fspec)
                            228 LOAD_ATTR                9 (print_name)
                            238 STORE_FAST               6 (long_name)
                
-               243     >>  240 LOAD_FAST                3 (specs)
+               340     >>  240 LOAD_FAST                3 (specs)
                            242 LOAD_METHOD             10 (append)
                            264 LOAD_GLOBAL             23 (NULL + FeatureSpec)
                            276 LOAD_FAST                4 (f)
                            278 LOAD_FAST                6 (long_name)
                            280 LOAD_FAST                5 (fdt)
                            282 PRECALL                  3
                            286 CALL                     3
                            296 PRECALL                  1
                            300 CALL                     1
                            310 POP_TOP
                            312 JUMP_BACKWARD          121 (to 72)
                
-               245     >>  314 LOAD_FAST                0 (self)
+               342     >>  314 LOAD_FAST                0 (self)
                            316 LOAD_METHOD             12 (_ts_spec_cls)
                            338 LOAD_FAST                0 (self)
                            340 LOAD_ATTR                7 (timeseries_spec)
                            350 LOAD_ATTR               13 (label)
                            360 LOAD_GLOBAL             29 (NULL + ObservationSpec)
                            372 LOAD_FAST                3 (specs)
                            374 CALL_FUNCTION_EX         0
@@ -2914,1139 +3974,484 @@
                   None
                   1
                   ('metadata',)
                names      ('only_feature_columns', 'df', 'columns', 'extensions', 'metadata', 'get_type', 'loc', 'timeseries_spec', 'base', 'print_name', 'append', 'FeatureSpec', '_ts_spec_cls', 'label', 'ObservationSpec')
                varnames   ('self', 'current_features', 'metadata', 'specs', 'f', 'fdt', 'long_name', 'fspec')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_derive_timeseries_spec'
-               firstlineno 232
+               firstlineno 329
                lnotab 0x020132010c0204010801520104011c0124010e014a02
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c00a0000000000000000000000000000000000000000000a60000
                   00ab000000000000000000010064005300
-               247           0 RESUME                   0
+               344           0 RESUME                   0
                
-               248           2 LOAD_FAST                0 (self)
+               345           2 LOAD_FAST                0 (self)
                              4 LOAD_METHOD              0 (_repopulate_internal_index)
                             26 PRECALL                  0
                             30 CALL                     0
                             40 POP_TOP
                             42 LOAD_CONST               0 (None)
                             44 RETURN_VALUE
                consts
                   None
                names      ('_repopulate_internal_index',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'update_index'
-               firstlineno 247
+               firstlineno 344
                lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c00a0000000000000000000000000000000000000000000a60000
                   00ab00000000000000000001007c00a00100000000000000000000000000
                   00000000000000a6000000ab000000000000000000010064005300
-               250           0 RESUME                   0
+               347           0 RESUME                   0
                
-               251           2 LOAD_FAST                0 (self)
+               348           2 LOAD_FAST                0 (self)
                              4 LOAD_METHOD              0 (_update_timeseries_spec)
                             26 PRECALL                  0
                             30 CALL                     0
                             40 POP_TOP
                
-               252          42 LOAD_FAST                0 (self)
+               349          42 LOAD_FAST                0 (self)
                             44 LOAD_METHOD              1 (update_index)
                             66 PRECALL                  0
                             70 CALL                     0
                             80 POP_TOP
                             82 LOAD_CONST               0 (None)
                             84 RETURN_VALUE
                consts
                   None
                names      ('_update_timeseries_spec', 'update_index')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'fit_to_data'
-               firstlineno 250
+               firstlineno 347
                lnotab 0x02012801
-            'objs'
-            'str | list[str] | slice'
-            code
-               argcount  : 2
-               nlocals   : 2
-               stacksize : 4
-               flags     : 16777219
-               code
-                  0x97007c01800f7401000000000000000000006400a6010000ab01000000
-                  00000000006e017c017d017c00a001000000000000000000000000000000
-                  00000000007c006a0200000000000000007c01a6020000ab020000000000
-                  0000005300
-               254           0 RESUME                   0
-               
-               255           2 LOAD_FAST                1 (objs)
-                             4 POP_JUMP_FORWARD_IF_NOT_NONE    15 (to 36)
-                             6 LOAD_GLOBAL              1 (NULL + slice)
-                            18 LOAD_CONST               0 (None)
-                            20 PRECALL                  1
-                            24 CALL                     1
-                            34 JUMP_FORWARD             1 (to 38)
-                       >>   36 LOAD_FAST                1 (objs)
-                       >>   38 STORE_FAST               1 (objs)
-               
-               256          40 LOAD_FAST                0 (self)
-                            42 LOAD_METHOD              1 (_mk_timeseries_view)
-                            64 LOAD_FAST                0 (self)
-                            66 LOAD_ATTR                2 (timeseries_spec)
-                            76 LOAD_FAST                1 (objs)
-                            78 PRECALL                  2
-                            82 CALL                     2
-                            92 RETURN_VALUE
-               consts
-                  None
-               names      ('slice', '_mk_timeseries_view', 'timeseries_spec')
-               varnames   ('self', 'objs')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'view'
-               firstlineno 254
-               lnotab 0x02012601
-            code
-               argcount  : 1
-               nlocals   : 1
-               stacksize : 8
-               flags     : 16777219
-               code
-                  0x970064017c006a0000000000000000009b0064027c006a010000000000
-                  0000009b0064037405000000000000000000007c006a0300000000000000
-                  00a6010000ab0100000000000000009b0064049d075300
-               258           0 RESUME                   0
-               
-               259           2 LOAD_CONST               1 ('TimeseriesCollection(spec=')
-                             4 LOAD_FAST                0 (self)
-                             6 LOAD_ATTR                0 (timeseries_spec)
-                            16 FORMAT_VALUE             0
-                            18 LOAD_CONST               2 (', #obs=')
-                            20 LOAD_FAST                0 (self)
-                            22 LOAD_ATTR                1 (observation_count)
-                            32 FORMAT_VALUE             0
-                            34 LOAD_CONST               3 (', #objects=')
-                            36 LOAD_GLOBAL              5 (NULL + len)
-                            48 LOAD_FAST                0 (self)
-                            50 LOAD_ATTR                3 (occurring_objects)
-                            60 PRECALL                  1
-                            64 CALL                     1
-                            74 FORMAT_VALUE             0
-                            76 LOAD_CONST               4 (')')
-                            78 BUILD_STRING             7
-                            80 RETURN_VALUE
-               consts
-                  None
-                  'TimeseriesCollection(spec='
-                  ', #obs='
-                  ', #objects='
-                  ')'
-               names      ('timeseries_spec', 'observation_count', 'len', 'occurring_objects')
-               varnames   ('self',)
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       '__str__'
-               firstlineno 258
-               lnotab 0x0201
-            'str'
-            code
-               argcount  : 1
-               nlocals   : 1
-               stacksize : 3
-               flags     : 16777219
-               code
-                  0x97007401000000000000000000007c00a6010000ab0100000000000000
-                  005300
-               261           0 RESUME                   0
-               
-               262           2 LOAD_GLOBAL              1 (NULL + str)
-                            14 LOAD_FAST                0 (self)
-                            16 PRECALL                  1
-                            20 CALL                     1
-                            30 RETURN_VALUE
-               consts
-                  None
-               names      ('str',)
-               varnames   ('self',)
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       '__repr__'
-               firstlineno 261
-               lnotab 0x0201
-            'vertical'
-            'self'
-            'TTC'
-            'other'
-            'axis'
-            "Literal['horizontal', 'vertical']"
-            code
-               argcount  : 3
-               nlocals   : 7
-               stacksize : 6
-               flags     : 16777219
-               code
-                  0x97007c026401760073024a0082017c0264026b02000000009001724d7c
-                  006a000000000000000000a0010000000000000000000000000000000000
-                  0000007c016a000000000000000000a6010000ab01000000000000000073
-                  024a0082017c006a000000000000000000a0020000000000000000000000
-                  0000000000000000007c016a000000000000000000a6010000ab01000000
-                  00000000007d037c03723f7c006a0300000000000000006a040000000000
-                  0000006400640085027c03660219000000000000000000a0050000000000
-                  0000000000000000000000000000007c016a0300000000000000006a0400
-                  000000000000006400640085027c03660219000000000000000000a60100
-                  00ab01000000000000000073024a0082017c006a000000000000000000a0
-                  0600000000000000000000000000000000000000007c016a000000000000
-                  000000a6010000ab0100000000000000005c0200007d047d057c0572a67c
-                  006a030000000000000000740e000000000000000000006a080000000000
-                  00000019000000000000000000a005000000000000000000000000000000
-                  00000000007c016a030000000000000000740e000000000000000000006a
-                  08000000000000000019000000000000000000a6010000ab010000000000
-                  00000073024a0082017413000000000000000000006a0a00000000000000
-                  007c006a0300000000000000007c016a0300000000000000006a04000000
-                  00000000006400640085027c056602190000000000000000006702640364
-                  04ac05a6030000ab0300000000000000007d067c00a00b00000000000000
-                  000000000000000000000000007c006a000000000000000000a00c000000
-                  00000000000000000000000000000000007c016a000000000000000000a6
-                  010000ab0100000000000000007c06a6020000ab02000000000000000053
-                  007c0053007c0264066b020000000072737c006a0000000000000000007c
-                  016a0000000000000000006b020000000073024a00820174130000000000
-                  00000000006a0a00000000000000007c006a0300000000000000007c016a
-                  0300000000000000006702640764046404ac08a6040000ab040000000000
-                  0000007d067c06a00d000000000000000000000000000000000000000074
-                  0e000000000000000000006a08000000000000000064046404ac09a60300
-                  00ab03000000000000000001007c00a00b00000000000000000000000000
-                  000000000000007c006a0000000000000000007c06a6020000ab02000000
-                  0000000000530064005300
-               264           0 RESUME                   0
-               
-               266           2 LOAD_FAST                2 (axis)
-                             4 LOAD_CONST               1 (frozenset({'horizontal', 'vertical'}))
-                             6 CONTAINS_OP              0
-                             8 POP_JUMP_FORWARD_IF_TRUE     2 (to 14)
-                            10 LOAD_ASSERTION_ERROR
-                            12 RAISE_VARARGS            1
-               
-               267     >>   14 LOAD_FAST                2 (axis)
-                            16 LOAD_CONST               2 ('horizontal')
-                            18 COMPARE_OP               2 (==)
-                            24 EXTENDED_ARG             1
-                            26 POP_JUMP_FORWARD_IF_FALSE   333 (to 694)
-               
-               268          28 LOAD_FAST                0 (self)
-                            30 LOAD_ATTR                0 (timeseries_spec)
-                            40 LOAD_METHOD              1 (is_mergeable)
-                            62 LOAD_FAST                1 (other)
-                            64 LOAD_ATTR                0 (timeseries_spec)
-                            74 PRECALL                  1
-                            78 CALL                     1
-                            88 POP_JUMP_FORWARD_IF_TRUE     2 (to 94)
-                            90 LOAD_ASSERTION_ERROR
-                            92 RAISE_VARARGS            1
-               
-               269     >>   94 LOAD_FAST                0 (self)
-                            96 LOAD_ATTR                0 (timeseries_spec)
-                           106 LOAD_METHOD              2 (feature_intersection)
-                           128 LOAD_FAST                1 (other)
-                           130 LOAD_ATTR                0 (timeseries_spec)
-                           140 PRECALL                  1
-                           144 CALL                     1
-                           154 STORE_FAST               3 (ov)
-               
-               270         156 LOAD_FAST                3 (ov)
-                           158 POP_JUMP_FORWARD_IF_FALSE    63 (to 286)
-               
-               271         160 LOAD_FAST                0 (self)
-                           162 LOAD_ATTR                3 (df)
-                           172 LOAD_ATTR                4 (loc)
-                           182 LOAD_CONST               0 (None)
-                           184 LOAD_CONST               0 (None)
-                           186 BUILD_SLICE              2
-                           188 LOAD_FAST                3 (ov)
-                           190 BUILD_TUPLE              2
-                           192 BINARY_SUBSCR
-                           202 LOAD_METHOD              5 (equals)
-               
-               272         224 LOAD_FAST                1 (other)
-                           226 LOAD_ATTR                3 (df)
-                           236 LOAD_ATTR                4 (loc)
-                           246 LOAD_CONST               0 (None)
-                           248 LOAD_CONST               0 (None)
-                           250 BUILD_SLICE              2
-                           252 LOAD_FAST                3 (ov)
-                           254 BUILD_TUPLE              2
-                           256 BINARY_SUBSCR
-               
-               271         266 PRECALL                  1
-                           270 CALL                     1
-                           280 POP_JUMP_FORWARD_IF_TRUE     2 (to 286)
-                           282 LOAD_ASSERTION_ERROR
-                           284 RAISE_VARARGS            1
-               
-               273     >>  286 LOAD_FAST                0 (self)
-                           288 LOAD_ATTR                0 (timeseries_spec)
-                           298 LOAD_METHOD              6 (feature_symmetric_difference)
-                           320 LOAD_FAST                1 (other)
-                           322 LOAD_ATTR                0 (timeseries_spec)
-                           332 PRECALL                  1
-                           336 CALL                     1
-                           346 UNPACK_SEQUENCE          2
-                           350 STORE_FAST               4 (_)
-                           352 STORE_FAST               5 (new_fs)
-               
-               274         354 LOAD_FAST                5 (new_fs)
-                           356 POP_JUMP_FORWARD_IF_FALSE   166 (to 690)
-               
-               275         358 LOAD_FAST                0 (self)
-                           360 LOAD_ATTR                3 (df)
-                           370 LOAD_GLOBAL             14 (MDConcepts)
-                           382 LOAD_ATTR                8 (Time)
-                           392 BINARY_SUBSCR
-                           402 LOAD_METHOD              5 (equals)
-                           424 LOAD_FAST                1 (other)
-                           426 LOAD_ATTR                3 (df)
-                           436 LOAD_GLOBAL             14 (MDConcepts)
-                           448 LOAD_ATTR                8 (Time)
-                           458 BINARY_SUBSCR
-                           468 PRECALL                  1
-                           472 CALL                     1
-                           482 POP_JUMP_FORWARD_IF_TRUE     2 (to 488)
-                           484 LOAD_ASSERTION_ERROR
-                           486 RAISE_VARARGS            1
-               
-               276     >>  488 LOAD_GLOBAL             19 (NULL + pd)
-                           500 LOAD_ATTR               10 (concat)
-                           510 LOAD_FAST                0 (self)
-                           512 LOAD_ATTR                3 (df)
-                           522 LOAD_FAST                1 (other)
-                           524 LOAD_ATTR                3 (df)
-                           534 LOAD_ATTR                4 (loc)
-                           544 LOAD_CONST               0 (None)
-                           546 LOAD_CONST               0 (None)
-                           548 BUILD_SLICE              2
-                           550 LOAD_FAST                5 (new_fs)
-                           552 BUILD_TUPLE              2
-                           554 BINARY_SUBSCR
-                           564 BUILD_LIST               2
-                           566 LOAD_CONST               3 ('columns')
-                           568 LOAD_CONST               4 (True)
-                           570 KW_NAMES                 5
-                           572 PRECALL                  3
-                           576 CALL                     3
-                           586 STORE_FAST               6 (df)
-               
-               277         588 LOAD_FAST                0 (self)
-                           590 LOAD_METHOD             11 (__class__)
-                           612 LOAD_FAST                0 (self)
-                           614 LOAD_ATTR                0 (timeseries_spec)
-                           624 LOAD_METHOD             12 (merge)
-                           646 LOAD_FAST                1 (other)
-                           648 LOAD_ATTR                0 (timeseries_spec)
-                           658 PRECALL                  1
-                           662 CALL                     1
-                           672 LOAD_FAST                6 (df)
-                           674 PRECALL                  2
-                           678 CALL                     2
-                           688 RETURN_VALUE
-               
-               278     >>  690 LOAD_FAST                0 (self)
-                           692 RETURN_VALUE
-               
-               279     >>  694 LOAD_FAST                2 (axis)
-                           696 LOAD_CONST               6 ('vertical')
-                           698 COMPARE_OP               2 (==)
-                           704 POP_JUMP_FORWARD_IF_FALSE   115 (to 936)
-               
-               280         706 LOAD_FAST                0 (self)
-                           708 LOAD_ATTR                0 (timeseries_spec)
-                           718 LOAD_FAST                1 (other)
-                           720 LOAD_ATTR                0 (timeseries_spec)
-                           730 COMPARE_OP               2 (==)
-                           736 POP_JUMP_FORWARD_IF_TRUE     2 (to 742)
-                           738 LOAD_ASSERTION_ERROR
-                           740 RAISE_VARARGS            1
-               
-               281     >>  742 LOAD_GLOBAL             19 (NULL + pd)
-                           754 LOAD_ATTR               10 (concat)
-                           764 LOAD_FAST                0 (self)
-                           766 LOAD_ATTR                3 (df)
-                           776 LOAD_FAST                1 (other)
-                           778 LOAD_ATTR                3 (df)
-                           788 BUILD_LIST               2
-                           790 LOAD_CONST               7 ('index')
-                           792 LOAD_CONST               4 (True)
-                           794 LOAD_CONST               4 (True)
-                           796 KW_NAMES                 8
-                           798 PRECALL                  4
-                           802 CALL                     4
-                           812 STORE_FAST               6 (df)
-               
-               282         814 LOAD_FAST                6 (df)
-                           816 LOAD_METHOD             13 (sort_values)
-                           838 LOAD_GLOBAL             14 (MDConcepts)
-                           850 LOAD_ATTR                8 (Time)
-                           860 LOAD_CONST               4 (True)
-                           862 LOAD_CONST               4 (True)
-                           864 KW_NAMES                 9
-                           866 PRECALL                  3
-                           870 CALL                     3
-                           880 POP_TOP
-               
-               283         882 LOAD_FAST                0 (self)
-                           884 LOAD_METHOD             11 (__class__)
-                           906 LOAD_FAST                0 (self)
-                           908 LOAD_ATTR                0 (timeseries_spec)
-                           918 LOAD_FAST                6 (df)
-                           920 PRECALL                  2
-                           924 CALL                     2
-                           934 RETURN_VALUE
-               
-               279     >>  936 LOAD_CONST               0 (None)
-                           938 RETURN_VALUE
-               consts
-                  None
-                  frozenset({'horizontal', 'vertical'})
-                  'horizontal'
-                  'columns'
-                  True
-                  ('axis', 'copy')
-                  'vertical'
-                  'index'
-                  ('axis', 'ignore_index', 'copy')
-                  ('ignore_index', 'inplace')
-               names      ('timeseries_spec', 'is_mergeable', 'feature_intersection', 'df', 'loc', 'equals', 'feature_symmetric_difference', 'MDConcepts', 'Time', 'pd', 'concat', '__class__', 'merge', 'sort_values')
-               varnames   ('self', 'other', 'axis', 'ov', '_', 'new_fs', 'df')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'merge'
-               firstlineno 264
-               lnotab
-                  0x02020c010e0142013e01040140012aff14024401040182016401660104
-                  010c0124014801440136fc
-            'cls'
-            'type[TTC]'
-            'tscs'
-            'dict[str, TTC]'
-            'o_tscs'
-            code
-               argcount  : 4
-               nlocals   : 8
-               stacksize : 5
-               flags     : 16777219
-               code
-                  0x870187028703970089036401760073024a008201740100000000000000
-                  0000008901a0010000000000000000000000000000000000000000a60000
-                  00ab0000000000000000008902a001000000000000000000000000000000
-                  0000000000a6000000ab000000000000000000a6020000ab020000000000
-                  0000007d047405000000000000000000008901a001000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000008902a00100
-                  00000000000000000000000000000000000000a6000000ab000000000000
-                  000000a6020000ab0200000000000000005c0200007d057d068801660164
-                  0284087c054400a6000000ab000000000000000000880388028801660364
-                  0384087c044400a6000000ab0000000000000000007a0700007d07890364
-                  046b020000000072027c075300890364056b020000000072117c07880266
-                  01640684087c064400a6000000ab0000000000000000007a070000530064
-                  005300
-                             0 MAKE_CELL                1 (tscs)
-                             2 MAKE_CELL                2 (o_tscs)
-                             4 MAKE_CELL                3 (axis)
-               
-               285           6 RESUME                   0
-               
-               288           8 LOAD_DEREF               3 (axis)
-                            10 LOAD_CONST               1 (frozenset({'horizontal', 'vertical'}))
-                            12 CONTAINS_OP              0
-                            14 POP_JUMP_FORWARD_IF_TRUE     2 (to 20)
-                            16 LOAD_ASSERTION_ERROR
-                            18 RAISE_VARARGS            1
-               
-               289     >>   20 LOAD_GLOBAL              1 (NULL + intersection)
-                            32 LOAD_DEREF               1 (tscs)
-                            34 LOAD_METHOD              1 (keys)
-                            56 PRECALL                  0
-                            60 CALL                     0
-                            70 LOAD_DEREF               2 (o_tscs)
-                            72 LOAD_METHOD              1 (keys)
-                            94 PRECALL                  0
-                            98 CALL                     0
-                           108 PRECALL                  2
-                           112 CALL                     2
-                           122 STORE_FAST               4 (ov)
-               
-               290         124 LOAD_GLOBAL              5 (NULL + symmetric_difference)
-                           136 LOAD_DEREF               1 (tscs)
-                           138 LOAD_METHOD              1 (keys)
-                           160 PRECALL                  0
-                           164 CALL                     0
-                           174 LOAD_DEREF               2 (o_tscs)
-                           176 LOAD_METHOD              1 (keys)
-                           198 PRECALL                  0
-                           202 CALL                     0
-                           212 PRECALL                  2
-                           216 CALL                     2
-                           226 UNPACK_SEQUENCE          2
-                           230 STORE_FAST               5 (s1)
-                           232 STORE_FAST               6 (s2)
-               
-               291         234 LOAD_CLOSURE             1 (tscs)
-                           236 BUILD_TUPLE              1
-                           238 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 291>)
-                           240 MAKE_FUNCTION            8 (closure)
-                           242 LOAD_FAST                5 (s1)
-                           244 GET_ITER
-                           246 PRECALL                  0
-                           250 CALL                     0
-                           260 LOAD_CLOSURE             3 (axis)
-                           262 LOAD_CLOSURE             2 (o_tscs)
-                           264 LOAD_CLOSURE             1 (tscs)
-                           266 BUILD_TUPLE              3
-                           268 LOAD_CONST               3 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 291>)
-                           270 MAKE_FUNCTION            8 (closure)
-                           272 LOAD_FAST                4 (ov)
-                           274 GET_ITER
-                           276 PRECALL                  0
-                           280 CALL                     0
-                           290 BINARY_OP                7 (|)
-                           294 STORE_FAST               7 (res)
-               
-               292         296 LOAD_DEREF               3 (axis)
-                           298 LOAD_CONST               4 ('horizontal')
-                           300 COMPARE_OP               2 (==)
-                           306 POP_JUMP_FORWARD_IF_FALSE     2 (to 312)
-               
-               293         308 LOAD_FAST                7 (res)
-                           310 RETURN_VALUE
-               
-               294     >>  312 LOAD_DEREF               3 (axis)
-                           314 LOAD_CONST               5 ('vertical')
-                           316 COMPARE_OP               2 (==)
-                           322 POP_JUMP_FORWARD_IF_FALSE    17 (to 358)
-               
-               295         324 LOAD_FAST                7 (res)
-                           326 LOAD_CLOSURE             2 (o_tscs)
-                           328 BUILD_TUPLE              1
-                           330 LOAD_CONST               6 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 295>)
-                           332 MAKE_FUNCTION            8 (closure)
-                           334 LOAD_FAST                6 (s2)
-                           336 GET_ITER
-                           338 PRECALL                  0
-                           342 CALL                     0
-                           352 BINARY_OP                7 (|)
-                           356 RETURN_VALUE
-               
-               294     >>  358 LOAD_CONST               0 (None)
-                           360 RETURN_VALUE
-               consts
-                  None
-                  frozenset({'horizontal', 'vertical'})
-                  code
-                     argcount  : 1
-                     nlocals   : 2
-                     stacksize : 5
-                     flags     : 16777235
-                     code
-                        0x9501970069007c005d0b7d017c0189027c011900000000000000000093
-                        028c0c5300
-                                   0 COPY_FREE_VARS           1
-                     
-                     291           2 RESUME                   0
-                                   4 BUILD_MAP                0
-                                   6 LOAD_FAST                0 (.0)
-                             >>    8 FOR_ITER                11 (to 32)
-                                  10 STORE_FAST               1 (e)
-                                  12 LOAD_FAST                1 (e)
-                                  14 LOAD_DEREF               2 (tscs)
-                                  16 LOAD_FAST                1 (e)
-                                  18 BINARY_SUBSCR
-                                  28 MAP_ADD                  2
-                                  30 JUMP_BACKWARD           12 (to 8)
-                             >>   32 RETURN_VALUE
-                     consts
-                     names      ()
-                     varnames   ('.0', 'e')
-                     freevars   ('tscs',)
-                     cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-                     name       '<dictcomp>'
-                     firstlineno 291
-                     lnotab 0x
-                  code
-                     argcount  : 1
-                     nlocals   : 2
-                     stacksize : 7
-                     flags     : 16777235
-                     code
-                        0x9503970069007c005d267d017c0189047c0119000000000000000000a0
-                        00000000000000000000000000000000000000000089037c011900000000
-                        00000000008902ac00a6020000ab02000000000000000093028c275300
-                                   0 COPY_FREE_VARS           3
-                     
-                     291           2 RESUME                   0
-                                   4 BUILD_MAP                0
-                                   6 LOAD_FAST                0 (.0)
-                             >>    8 FOR_ITER                38 (to 86)
-                                  10 STORE_FAST               1 (e)
-                                  12 LOAD_FAST                1 (e)
-                                  14 LOAD_DEREF               4 (tscs)
-                                  16 LOAD_FAST                1 (e)
-                                  18 BINARY_SUBSCR
-                                  28 LOAD_METHOD              0 (merge)
-                                  50 LOAD_DEREF               3 (o_tscs)
-                                  52 LOAD_FAST                1 (e)
-                                  54 BINARY_SUBSCR
-                                  64 LOAD_DEREF               2 (axis)
-                                  66 KW_NAMES                 0
-                                  68 PRECALL                  2
-                                  72 CALL                     2
-                                  82 MAP_ADD                  2
-                                  84 JUMP_BACKWARD           39 (to 8)
-                             >>   86 RETURN_VALUE
-                     consts
-                        ('axis',)
-                     names      ('merge',)
-                     varnames   ('.0', 'e')
-                     freevars   ('axis', 'o_tscs', 'tscs')
-                     cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-                     name       '<dictcomp>'
-                     firstlineno 291
-                     lnotab 0x
-                  'horizontal'
-                  'vertical'
-                  code
-                     argcount  : 1
-                     nlocals   : 2
-                     stacksize : 5
-                     flags     : 16777235
-                     code
-                        0x9501970069007c005d0b7d017c0189027c011900000000000000000093
-                        028c0c5300
-                                   0 COPY_FREE_VARS           1
-                     
-                     295           2 RESUME                   0
-                                   4 BUILD_MAP                0
-                                   6 LOAD_FAST                0 (.0)
-                             >>    8 FOR_ITER                11 (to 32)
-                                  10 STORE_FAST               1 (e)
-                                  12 LOAD_FAST                1 (e)
-                                  14 LOAD_DEREF               2 (o_tscs)
-                                  16 LOAD_FAST                1 (e)
-                                  18 BINARY_SUBSCR
-                                  28 MAP_ADD                  2
-                                  30 JUMP_BACKWARD           12 (to 8)
-                             >>   32 RETURN_VALUE
-                     consts
-                     names      ()
-                     varnames   ('.0', 'e')
-                     freevars   ('o_tscs',)
-                     cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-                     name       '<dictcomp>'
-                     firstlineno 295
-                     lnotab 0x
-               names      ('intersection', 'keys', 'symmetric_difference')
-               varnames   ('cls', 'tscs', 'o_tscs', 'axis', 'ov', 's1', 's2', 'res')
-               freevars   ()
-               cellvars   ('tscs', 'o_tscs', 'axis')
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'lifted_merge'
-               firstlineno 285
-               lnotab 0x08030c0168016e013e010c0104010c0122ff
             ('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'return', 'None')
+            ('return', 'ObservationType')
+            ('return', 'TSSpec')
+            ('value', 'TSSpec')
+            ('return', 'pd.DataFrame')
+            ('value', 'pd.DataFrame')
+            ('timeseries_spec', 'TSSpec', 'df', 'pd.DataFrame', 'return', 'typing.Self')
+            ('return', 'Set[str]')
             ('return', 'int')
-            ('return', 'set[str]')
-            ('return', 'dict[str, TS]')
-            ('return', 'TS')
+            ('return', 'bool')
+            ('item', 'str', 'return', 'TSView')
+            ('return', 'Iterator[TSView]')
+            ('return', 'str')
+            (True, False, False, False)
+            ('objs', 'StrIndexer', 'return', 'TSView')
+            ('vertical',)
+            ('other', 'typing.Self', 'axis', "Literal['horizontal', 'vertical']", 'return', 'typing.Self')
+            ('return', 'TSView')
             (None,)
             ('timeseries_spec', 'TSSpec', 'return', 'None')
-            ('return', 'TSSpec')
             ('return', 'None')
-            ('objs', 'str | list[str] | slice', 'return', 'TS')
-            ('return', 'str')
-            ('vertical',)
-            ('self', 'TTC', 'other', 'TTC', 'axis', "Literal['horizontal', 'vertical']", 'return', 'TTC')
-            ('cls', 'type[TTC]', 'tscs', 'dict[str, TTC]', 'o_tscs', 'dict[str, TTC]', 'axis', "Literal['horizontal', 'vertical']", 'return', 'dict[str, TTC]')
-         names      ('__name__', '__module__', '__qualname__', '_ts_spec_cls', '__annotations__', '_ts_cls', '__init__', 'property', 'observation_count', 'occurring_objects', 'time_series_count', 'object_map', 'feature_column_view', 'prefixed_feature_column_view', '_repopulate_internal_index', '_check_ts_features', '_mk_timeseries_view', '_update_timeseries_spec', '_derive_timeseries_spec', 'update_index', 'fit_to_data', 'view', '__str__', '__repr__', 'merge', 'classmethod', 'lifted_merge', '__classcell__')
+         names      ('__name__', '__module__', '__qualname__', '_ts_spec_cls', '__annotations__', '_ts_view_cls', '__init__', 'property', 'observation_type', 'timeseries_spec', 'setter', 'df', 'classmethod', 'of', 'objects', 'observation_count', 'time_series_count', '__contains__', '__getitem__', '__len__', '__iter__', '__str__', '__repr__', 'feature_column_view', 'view', 'merge', '_repopulate_internal_index', '_check_ts_features', '_mk_timeseries_view', '_update_timeseries_spec', '_derive_timeseries_spec', 'update_index', 'fit_to_data', '__classcell__')
          varnames   ()
          freevars   ()
          cellvars   ('__class__',)
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'TypedTimeseriesCollection'
-         firstlineno 178
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'AbstractTimeseriesContainer'
+         firstlineno 212
          lnotab
-            0x0e010e010e020c07020106ff0e010203020106ff0e010203020106ff0e
-            010203020106ff0e010203020104ff0e010203020104ff0e010206060506
-            0308040a04080f0603080408040603080402ff0a15020202ff08ff0e01
+            0x0e010e010e020c0a020106ff0e010203020106ff0e0102030c0106ff0e
+            010203020106ff0e0102030c0106ff0e010203020106ff0e010203020106
+            ff0e010203020106ff0e010203020106ff0e010203080308030803080306
+            030803020102ff0a06080802ff0a150604060308040a04080f0603
+      'AbstractTimeseriesContainer'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0265035a0465055a0664015300
-         298           0 RESUME                   0
+         352           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('EventTimeseriesCollection')
+                       6 LOAD_CONST               0 ('EventTimeseriesContainer')
                        8 STORE_NAME               2 (__qualname__)
          
-         299          10 LOAD_NAME                3 (EventTimeseriesSpec)
+         353          10 LOAD_NAME                3 (EventTimeseriesSpec)
                       12 STORE_NAME               4 (_ts_spec_cls)
          
-         300          14 LOAD_NAME                5 (EventSeries)
-                      16 STORE_NAME               6 (_ts_cls)
+         354          14 LOAD_NAME                5 (EventTimeseriesView)
+                      16 STORE_NAME               6 (_ts_view_cls)
                       18 LOAD_CONST               1 (None)
                       20 RETURN_VALUE
          consts
-            'EventTimeseriesCollection'
+            'EventTimeseriesContainer'
             None
-         names      ('__name__', '__module__', '__qualname__', 'EventTimeseriesSpec', '_ts_spec_cls', 'EventSeries', '_ts_cls')
+         names      ('__name__', '__module__', '__qualname__', 'EventTimeseriesSpec', '_ts_spec_cls', 'EventTimeseriesView', '_ts_view_cls')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'EventTimeseriesCollection'
-         firstlineno 298
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'EventTimeseriesContainer'
+         firstlineno 352
          lnotab 0x0a010401
-      'EventTimeseriesCollection'
+      'EventTimeseriesContainer'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0265035a0465055a0664015300
-         303           0 RESUME                   0
+         357           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MeasurementTimeseriesCollection')
+                       6 LOAD_CONST               0 ('MeasurementTimeseriesContainer')
                        8 STORE_NAME               2 (__qualname__)
          
-         304          10 LOAD_NAME                3 (MeasurementTimeseriesSpec)
+         358          10 LOAD_NAME                3 (MeasurementTimeseriesSpec)
                       12 STORE_NAME               4 (_ts_spec_cls)
          
-         305          14 LOAD_NAME                5 (MeasurementSeries)
-                      16 STORE_NAME               6 (_ts_cls)
+         359          14 LOAD_NAME                5 (MeasurementTimeseriesView)
+                      16 STORE_NAME               6 (_ts_view_cls)
                       18 LOAD_CONST               1 (None)
                       20 RETURN_VALUE
          consts
-            'MeasurementTimeseriesCollection'
+            'MeasurementTimeseriesContainer'
             None
-         names      ('__name__', '__module__', '__qualname__', 'MeasurementTimeseriesSpec', '_ts_spec_cls', 'MeasurementSeries', '_ts_cls')
+         names      ('__name__', '__module__', '__qualname__', 'MeasurementTimeseriesSpec', '_ts_spec_cls', 'MeasurementTimeseriesView', '_ts_view_cls')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MeasurementTimeseriesCollection'
-         firstlineno 303
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'MeasurementTimeseriesContainer'
+         firstlineno 357
          lnotab 0x0a010401
-      'MeasurementTimeseriesCollection'
-      'ETSType'
-      'MTSType'
-      'ETS'
-      'MTS'
-      'ETSC'
-      'MTSC'
-      code
-         argcount  : 0
-         nlocals   : 0
-         stacksize : 4
-         flags     : 16777216
-         code
-            0x970065005a0164005a0265036a040000000000000000650565036a0600
-            00000000000000650769025a086509640764058404a6000000ab00000000
-            00000000005a0a64065300
-         318           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('TimeseriesCollectionFactory')
-                       8 STORE_NAME               2 (__qualname__)
-         
-         319          10 LOAD_NAME                3 (ObservationTypes)
-                      12 LOAD_ATTR                4 (E)
-                      22 LOAD_NAME                5 (EventTimeseriesCollection)
-                      24 LOAD_NAME                3 (ObservationTypes)
-                      26 LOAD_ATTR                6 (M)
-                      36 LOAD_NAME                7 (MeasurementTimeseriesCollection)
-                      38 BUILD_MAP                2
-                      40 STORE_NAME               8 (types)
-         
-         321          42 LOAD_NAME                9 (classmethod)
-         
-         322          44 LOAD_CONST               7 (('timeseries_spec', 'TimeseriesSpec', 'return', 'Callable[[pd.DataFrame], TypedTimeseriesCollection]'))
-                      46 LOAD_CONST               5 (<code object for_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 321>)
-                      48 MAKE_FUNCTION            4 (annotations)
-         
-         321          50 PRECALL                  0
-                      54 CALL                     0
-         
-         322          64 STORE_NAME              10 (for_type)
-                      66 LOAD_CONST               6 (None)
-                      68 RETURN_VALUE
-         consts
-            'TimeseriesCollectionFactory'
-            'timeseries_spec'
-            'TimeseriesSpec'
-            'return'
-            'Callable[[pd.DataFrame], TypedTimeseriesCollection]'
-            code
-               argcount  : 2
-               nlocals   : 2
-               stacksize : 4
-               flags     : 16777219
-               code
-                  0x97007401000000000000000000007c01740200000000000000000000a6
-                  020000ab02000000000000000072257405000000000000000000007c006a
-                  0300000000000000007408000000000000000000006a0500000000000000
-                  00190000000000000000007c01a6020000ab020000000000000000530074
-                  01000000000000000000007c01740c00000000000000000000a6020000ab
-                  02000000000000000072257405000000000000000000007c006a03000000
-                  00000000007408000000000000000000006a070000000000000000190000
-                  000000000000007c01a6020000ab020000000000000000530064005300
-               321           0 RESUME                   0
-               
-               323           2 LOAD_GLOBAL              1 (NULL + isinstance)
-                            14 LOAD_FAST                1 (timeseries_spec)
-                            16 LOAD_GLOBAL              2 (EventTimeseriesSpec)
-                            28 PRECALL                  2
-                            32 CALL                     2
-                            42 POP_JUMP_FORWARD_IF_FALSE    37 (to 118)
-               
-               324          44 LOAD_GLOBAL              5 (NULL + partial)
-                            56 LOAD_FAST                0 (cls)
-                            58 LOAD_ATTR                3 (types)
-                            68 LOAD_GLOBAL              8 (ObservationTypes)
-                            80 LOAD_ATTR                5 (E)
-                            90 BINARY_SUBSCR
-                           100 LOAD_FAST                1 (timeseries_spec)
-                           102 PRECALL                  2
-                           106 CALL                     2
-                           116 RETURN_VALUE
-               
-               325     >>  118 LOAD_GLOBAL              1 (NULL + isinstance)
-                           130 LOAD_FAST                1 (timeseries_spec)
-                           132 LOAD_GLOBAL             12 (MeasurementTimeseriesSpec)
-                           144 PRECALL                  2
-                           148 CALL                     2
-                           158 POP_JUMP_FORWARD_IF_FALSE    37 (to 234)
-               
-               326         160 LOAD_GLOBAL              5 (NULL + partial)
-                           172 LOAD_FAST                0 (cls)
-                           174 LOAD_ATTR                3 (types)
-                           184 LOAD_GLOBAL              8 (ObservationTypes)
-                           196 LOAD_ATTR                7 (M)
-                           206 BINARY_SUBSCR
-                           216 LOAD_FAST                1 (timeseries_spec)
-                           218 PRECALL                  2
-                           222 CALL                     2
-                           232 RETURN_VALUE
-               
-               325     >>  234 LOAD_CONST               0 (None)
-                           236 RETURN_VALUE
-               consts
-                  None
-               names      ('isinstance', 'EventTimeseriesSpec', 'partial', 'types', 'ObservationTypes', 'E', 'MeasurementTimeseriesSpec', 'M')
-               varnames   ('cls', 'timeseries_spec')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'for_type'
-               firstlineno 321
-               lnotab 0x02022a014a012a014aff
-            None
-            ('timeseries_spec', 'TimeseriesSpec', 'return', 'Callable[[pd.DataFrame], TypedTimeseriesCollection]')
-         names      ('__name__', '__module__', '__qualname__', 'ObservationTypes', 'E', 'EventTimeseriesCollection', 'M', 'MeasurementTimeseriesCollection', 'types', 'classmethod', 'for_type')
-         varnames   ()
-         freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'TimeseriesCollectionFactory'
-         firstlineno 318
-         lnotab 0x0a012002020106ff0e01
-      'TimeseriesCollectionFactory'
-      'AMD'
-      'AbstractMachineData'
+      'MeasurementTimeseriesContainer'
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 4
+         stacksize : 6
          flags     : 16777216
          code
             0x970065005a0164005a02550064015a036402650464033c00000064015a
-            056404650464053c000000090064576458641084055a06650764118400a6
-            000000ab0000000000000000005a086507645964128404a6000000ab0000
-            000000000000005a0965096a0a0000000000000000645a64148404a60000
-            00ab0000000000000000005a096507645b64168404a6000000ab00000000
-            00000000005a0b6507645c64188404a6000000ab0000000000000000005a
-            0c6507645d641a8404a6000000ab0000000000000000005a0d650e641b02
-            00650fa6000000ab0000000000000000006602645e641f8405a6000000ab
-            0000000000000000005a10645f642084015a11642184005a126460642384
-            015a136461642584045a1409000900090064626463642a84055a15090009
-            000900090064646465643784055a1609000900090064666467643d84055a
-            176468643f84045a1809006469646a644384055a1909006469646b644884
-            055a1a646c644b84045a1b646d644e84045a1c0200651d6401a6010000ab
-            0100000000000000006601646e645184055a1e0200651d6401a6010000ab
-            0100000000000000006601646f645384055a1f645484005a20645584005a
-            21645684005a2264015300
-         332           0 RESUME                   0
+            056404650464053c000000090064626463641084055a06650702006508a6
+            000000ab00000000000000000064116411641264136605646464158405a6
+            000000ab0000000000000000005a09650a646564178404a6000000ab0000
+            000000000000005a0b650a646664188404a6000000ab0000000000000000
+            005a0c650c6a0d00000000000000006467641a8404a6000000ab00000000
+            00000000005a0c650a6468641c8404a6000000ab0000000000000000005a
+            0e650a6469641e8404a6000000ab0000000000000000005a0f650a646a64
+            208404a6000000ab0000000000000000005a10650a646b64228404a60000
+            00ab0000000000000000005a11650a646c64248404a6000000ab00000000
+            00000000005a12646d642884045a13646e642b84045a146469642c84045a
+            15646f642e84045a166470643184045a176471643584045a186472643884
+            045a190200651a6401a6010000ab01000000000000000066016473643c84
+            055a1b0200651a6401a6010000ab01000000000000000066016474643e84
+            055a1c6475643f84015a1d644084005a1e6476644184015a1f0900090009
+            0064776478644684055a2009000900090009006479647a645184055a2102
+            006522a6000000ab00000000000000000002006522a6000000ab00000000
+            0000000000641264126604647b645684055a23647c645984045a24090064
+            7d647e645e84055a25647f645f84045a26646084005a27646184005a2864
+            015300
+         362           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('AbstractMachineData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         333          12 LOAD_CONST               1 (None)
+         363          12 LOAD_CONST               1 (None)
                       14 STORE_NAME               3 (_etsc_cls)
                       16 LOAD_CONST               2 ('type[ETSC]')
                       18 LOAD_NAME                4 (__annotations__)
                       20 LOAD_CONST               3 ('_etsc_cls')
                       22 STORE_SUBSCR
          
-         334          26 LOAD_CONST               1 (None)
+         364          26 LOAD_CONST               1 (None)
                       28 STORE_NAME               5 (_mtsc_cls)
                       30 LOAD_CONST               4 ('type[MTSC]')
                       32 LOAD_NAME                4 (__annotations__)
                       34 LOAD_CONST               5 ('_mtsc_cls')
                       36 STORE_SUBSCR
          
-         338          40 NOP
+         368          40 NOP
          
-         336          42 LOAD_CONST              87 ((None,))
-                      44 LOAD_CONST              88 (('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'index_frame', 'pd.DataFrame', 'return', 'None'))
-                      46 LOAD_CONST              16 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 336>)
+         366          42 LOAD_CONST              98 ((None,))
+                      44 LOAD_CONST              99 (('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'index_frame', 'pd.DataFrame', 'return', 'None'))
+                      46 LOAD_CONST              16 (<code object __init__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 366>)
                       48 MAKE_FUNCTION            5 (defaults, annotations)
                       50 STORE_NAME               6 (__init__)
          
-         348          52 LOAD_NAME                7 (property)
-         
-         349          54 LOAD_CONST              17 (<code object header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 348>)
-                      56 MAKE_FUNCTION            0
+         390          52 LOAD_NAME                7 (classmethod)
          
-         348          58 PRECALL                  0
+         391          54 PUSH_NULL
+                      56 LOAD_NAME                8 (Meta)
+                      58 PRECALL                  0
                       62 CALL                     0
+                      72 LOAD_CONST              17 (())
          
-         349          72 STORE_NAME               8 (header)
+         392          74 LOAD_CONST              17 (())
+                      76 LOAD_CONST              18 (False)
+                      78 LOAD_CONST              19 (True)
          
-         353          74 LOAD_NAME                7 (property)
+         391          80 BUILD_TUPLE              5
+                      82 LOAD_CONST             100 (('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'return', 'typing.Self'))
+                      84 LOAD_CONST              21 (<code object of, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 390>)
+                      86 MAKE_FUNCTION            5 (defaults, annotations)
          
-         354          76 LOAD_CONST              89 (('return', 'pd.DataFrame'))
-                      78 LOAD_CONST              18 (<code object index_frame, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 353>)
-                      80 MAKE_FUNCTION            4 (annotations)
-         
-         353          82 PRECALL                  0
-                      86 CALL                     0
+         390          88 PRECALL                  0
+                      92 CALL                     0
          
-         354          96 STORE_NAME               9 (index_frame)
+         391         102 STORE_NAME               9 (of)
          
-         359          98 LOAD_NAME                9 (index_frame)
-                     100 LOAD_ATTR               10 (setter)
+         402         104 LOAD_NAME               10 (property)
          
-         360         110 LOAD_CONST              90 (('value', 'pd.DataFrame'))
-                     112 LOAD_CONST              20 (<code object index_frame, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 359>)
-                     114 MAKE_FUNCTION            4 (annotations)
+         403         106 LOAD_CONST             101 (('return', 'Header'))
+                     108 LOAD_CONST              23 (<code object header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 402>)
+                     110 MAKE_FUNCTION            4 (annotations)
          
-         359         116 PRECALL                  0
-                     120 CALL                     0
+         402         112 PRECALL                  0
+                     116 CALL                     0
          
-         360         130 STORE_NAME               9 (index_frame)
+         403         126 STORE_NAME              11 (header)
          
-         363         132 LOAD_NAME                7 (property)
+         407         128 LOAD_NAME               10 (property)
          
-         364         134 LOAD_CONST              91 (('return', 'set[str]'))
-                     136 LOAD_CONST              22 (<code object occurring_objects, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 363>)
-                     138 MAKE_FUNCTION            4 (annotations)
+         408         130 LOAD_CONST             102 (('return', 'pd.DataFrame'))
+                     132 LOAD_CONST              24 (<code object index_frame, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 407>)
+                     134 MAKE_FUNCTION            4 (annotations)
          
-         363         140 PRECALL                  0
-                     144 CALL                     0
+         407         136 PRECALL                  0
+                     140 CALL                     0
          
-         364         154 STORE_NAME              11 (occurring_objects)
+         408         150 STORE_NAME              12 (index_frame)
          
-         367         156 LOAD_NAME                7 (property)
+         413         152 LOAD_NAME               12 (index_frame)
+                     154 LOAD_ATTR               13 (setter)
          
-         368         158 LOAD_CONST              92 (('return', 'int'))
-                     160 LOAD_CONST              24 (<code object observation_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 367>)
-                     162 MAKE_FUNCTION            4 (annotations)
+         414         164 LOAD_CONST             103 (('value', 'pd.DataFrame'))
+                     166 LOAD_CONST              26 (<code object index_frame, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 413>)
+                     168 MAKE_FUNCTION            4 (annotations)
          
-         367         164 PRECALL                  0
-                     168 CALL                     0
+         413         170 PRECALL                  0
+                     174 CALL                     0
          
-         368         178 STORE_NAME              12 (observation_count)
+         414         184 STORE_NAME              12 (index_frame)
          
-         371         180 LOAD_NAME                7 (property)
+         417         186 LOAD_NAME               10 (property)
          
-         372         182 LOAD_CONST              93 (('return', 'list[ETSC | MTSC]'))
-                     184 LOAD_CONST              26 (<code object series_containers, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 371>)
-                     186 MAKE_FUNCTION            4 (annotations)
+         418         188 LOAD_CONST             104 (('return', 'Set[str]'))
+                     190 LOAD_CONST              28 (<code object objects, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 417>)
+                     192 MAKE_FUNCTION            4 (annotations)
          
-         371         188 PRECALL                  0
-                     192 CALL                     0
+         417         194 PRECALL                  0
+                     198 CALL                     0
          
-         372         202 STORE_NAME              13 (series_containers)
+         418         208 STORE_NAME              14 (objects)
          
-         375         204 LOAD_NAME               14 (classmethod)
+         423         210 LOAD_NAME               10 (property)
          
-         377         206 LOAD_CONST              27 (True)
-                     208 PUSH_NULL
-                     210 LOAD_NAME               15 (Meta)
-                     212 PRECALL                  0
-                     216 CALL                     0
+         424         212 LOAD_CONST             105 (('return', 'int'))
+                     214 LOAD_CONST              30 (<code object observation_count, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 423>)
+                     216 MAKE_FUNCTION            4 (annotations)
          
-         376         226 BUILD_TUPLE              2
-                     228 LOAD_CONST              94 (('cls', 'type[AMD]', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'meta', 'Meta', 'return', 'AMD'))
-                     230 LOAD_CONST              31 (<code object from_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 375>)
-                     232 MAKE_FUNCTION            5 (defaults, annotations)
+         423         218 PRECALL                  0
+                     222 CALL                     0
          
-         375         234 PRECALL                  0
-                     238 CALL                     0
+         424         232 STORE_NAME              15 (observation_count)
          
-         376         248 STORE_NAME              16 (from_series)
+         427         234 LOAD_NAME               10 (property)
          
-         383         250 LOAD_CONST              95 ((True, True))
-                     252 LOAD_CONST              32 (<code object recalculate_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 383>)
-                     254 MAKE_FUNCTION            1 (defaults)
-                     256 STORE_NAME              17 (recalculate_index)
+         428         236 LOAD_CONST             106 (('return', 'tuple[Union[ETSC | MTSC], ...]'))
+                     238 LOAD_CONST              32 (<code object series_containers, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 427>)
+                     240 MAKE_FUNCTION            4 (annotations)
          
-         388         258 LOAD_CONST              33 (<code object _repopulate_maps, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 388>)
-                     260 MAKE_FUNCTION            0
-                     262 STORE_NAME              18 (_repopulate_maps)
+         427         242 PRECALL                  0
+                     246 CALL                     0
          
-         395         264 LOAD_CONST              96 ((False,))
-                     266 LOAD_CONST              35 (<code object fit_to_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 395>)
-                     268 MAKE_FUNCTION            1 (defaults)
-                     270 STORE_NAME              19 (fit_to_data)
-         
-         412         272 LOAD_CONST              97 (('return', 'Iterable[TypedTimeseriesCollection]'))
-                     274 LOAD_CONST              37 (<code object iter_all_timeseries, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 412>)
-                     276 MAKE_FUNCTION            4 (annotations)
-                     278 STORE_NAME              20 (iter_all_timeseries)
+         428         256 STORE_NAME              16 (series_containers)
          
-         415         280 NOP
+         433         258 LOAD_NAME               10 (property)
          
-         416         282 NOP
-         
-         417         284 NOP
-         
-         415         286 LOAD_CONST              98 ((None, None, True))
-                     288 LOAD_CONST              99 (('event_series_labels', 'Iterable[EventSpecLabel] | bool', 'measurement_series_labels', 'Iterable[MeasurementSpecLabel] | bool'))
-                     290 LOAD_CONST              42 (<code object create_joined_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 415>)
-                     292 MAKE_FUNCTION            5 (defaults, annotations)
-                     294 STORE_NAME              21 (create_joined_df)
+         434         260 LOAD_CONST             107 (('return', 'Mapping[EventSpecLabel, ETSSpec]'))
+                     262 LOAD_CONST              34 (<code object event_specs, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 433>)
+                     264 MAKE_FUNCTION            4 (annotations)
          
-         432         296 NOP
+         433         266 PRECALL                  0
+                     270 CALL                     0
          
-         433         298 NOP
+         434         280 STORE_NAME              17 (event_specs)
          
-         434         300 NOP
+         439         282 LOAD_NAME               10 (property)
          
-         435         302 NOP
+         440         284 LOAD_CONST             108 (('return', 'Mapping[MeasurementSpecLabel, MTSSpec]'))
+                     286 LOAD_CONST              36 (<code object measurement_specs, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 439>)
+                     288 MAKE_FUNCTION            4 (annotations)
          
-         432         304 LOAD_CONST             100 ((None, None, None, None, None, None))
-                     306 LOAD_CONST             101 (('typ', 'ObservationTypeType', 'types', 'Collection[ObservationTypeType]', 'obj', 'str', 'objs', 'Iterable[str]', 'label', 'ObservationTypeLabel', 'labels', 'Iterable[ObservationTypeLabel]', 'return', 'pd.DataFrame'))
-                     308 LOAD_CONST              55 (<code object create_index_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 432>)
-                     310 MAKE_FUNCTION            5 (defaults, annotations)
-                     312 STORE_NAME              22 (create_index_view)
+         439         290 PRECALL                  0
+                     294 CALL                     0
          
-         458         314 NOP
+         440         304 STORE_NAME              18 (measurement_specs)
          
-         459         316 NOP
+         445         306 LOAD_CONST             109 (('item', 'ObservationSpecIdentifier', 'return', 'ETSC | MTSC'))
+                     308 LOAD_CONST              40 (<code object __getitem__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 445>)
+                     310 MAKE_FUNCTION            4 (annotations)
+                     312 STORE_NAME              19 (__getitem__)
          
-         460         318 NOP
+         455         314 LOAD_CONST             110 (('item', 'object', 'return', 'bool'))
+                     316 LOAD_CONST              43 (<code object __contains__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 455>)
+                     318 MAKE_FUNCTION            4 (annotations)
+                     320 STORE_NAME              20 (__contains__)
          
-         456         320 LOAD_CONST             102 ((None, None, False, False))
-                     322 LOAD_CONST             103 (('self', 'AMD', 'measurement_feature_selection', 'dict[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'event_feature_selection', 'dict[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'return', 'AMD'))
-                     324 LOAD_CONST              61 (<code object project, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 456>)
-                     326 MAKE_FUNCTION            5 (defaults, annotations)
-                     328 STORE_NAME              23 (project)
+         464         322 LOAD_CONST             105 (('return', 'int'))
+                     324 LOAD_CONST              44 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 464>)
+                     326 MAKE_FUNCTION            4 (annotations)
+                     328 STORE_NAME              21 (__len__)
          
-         493         330 LOAD_CONST             104 (('other', 'AbstractMachineData'))
-                     332 LOAD_CONST              63 (<code object is_mergeable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 493>)
+         467         330 LOAD_CONST             111 (('return', 'Iterator[ETSC | MTSC]'))
+                     332 LOAD_CONST              46 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 467>)
                      334 MAKE_FUNCTION            4 (annotations)
-                     336 STORE_NAME              24 (is_mergeable)
-         
-         507         338 NOP
+                     336 STORE_NAME              22 (__iter__)
          
-         506         340 LOAD_CONST             105 (('horizontal',))
-                     342 LOAD_CONST             106 (('self', 'AMD', 'other', 'AMD', 'axis', "Literal['horizontal', 'vertical']", 'return', 'AMD'))
-                     344 LOAD_CONST              67 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 506>)
-                     346 MAKE_FUNCTION            5 (defaults, annotations)
-                     348 STORE_NAME              25 (merge)
-         
-         514         350 NOP
-         
-         512         352 LOAD_CONST             105 (('horizontal',))
-                     354 LOAD_CONST             107 (('event_series', 'dict[EventSpecLabel, ETSC]', 'measurement_series', 'dict[MeasurementSpecLabel, MTSC]', 'axis', "Literal['horizontal', 'vertical']", 'return', 'AMD'))
-                     356 LOAD_CONST              72 (<code object merge_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 512>)
-                     358 MAKE_FUNCTION            5 (defaults, annotations)
-                     360 STORE_NAME              26 (merge_series)
-         
-         528         362 LOAD_CONST             108 (('label', 'EventSpecLabel', 'return', 'ETSC'))
-                     364 LOAD_CONST              75 (<code object get_event_series_collection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 528>)
-                     366 MAKE_FUNCTION            4 (annotations)
-                     368 STORE_NAME              27 (get_event_series_collection)
-         
-         531         370 LOAD_CONST             109 (('label', 'MeasurementSpecLabel', 'return', 'MTSC'))
-                     372 LOAD_CONST              78 (<code object get_measurement_series_collection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 531>)
-                     374 MAKE_FUNCTION            4 (annotations)
-                     376 STORE_NAME              28 (get_measurement_series_collection)
-         
-         534         378 PUSH_NULL
-                     380 LOAD_NAME               29 (slice)
-                     382 LOAD_CONST               1 (None)
-                     384 PRECALL                  1
-                     388 CALL                     1
-                     398 BUILD_TUPLE              1
-                     400 LOAD_CONST             110 (('label', 'MeasurementSpecLabel', 'objs', 'str | list[str] | slice', 'return', 'MTS'))
-                     402 LOAD_CONST              81 (<code object view_measurement_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 534>)
-                     404 MAKE_FUNCTION            5 (defaults, annotations)
-                     406 STORE_NAME              30 (view_measurement_series)
-         
-         538         408 PUSH_NULL
-                     410 LOAD_NAME               29 (slice)
-                     412 LOAD_CONST               1 (None)
-                     414 PRECALL                  1
-                     418 CALL                     1
-                     428 BUILD_TUPLE              1
-                     430 LOAD_CONST             111 (('label', 'EventSpecLabel', 'objs', 'str | list[str] | slice', 'return', 'ETS'))
-                     432 LOAD_CONST              83 (<code object view_event_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 538>)
-                     434 MAKE_FUNCTION            5 (defaults, annotations)
-                     436 STORE_NAME              31 (view_event_series)
-         
-         542         438 LOAD_CONST              84 (<code object summary, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 542>)
-                     440 MAKE_FUNCTION            0
-                     442 STORE_NAME              32 (summary)
-         
-         547         444 LOAD_CONST              85 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 547>)
-                     446 MAKE_FUNCTION            0
-                     448 STORE_NAME              33 (__str__)
-         
-         558         450 LOAD_CONST              86 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 558>)
-                     452 MAKE_FUNCTION            0
-                     454 STORE_NAME              34 (__repr__)
-                     456 LOAD_CONST               1 (None)
-                     458 RETURN_VALUE
+         470         338 LOAD_CONST             112 (('identifier', 'ObservationSpecIdentifier', 'return', 'ETSSpec | MTSSpec'))
+                     340 LOAD_CONST              49 (<code object get_spec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 470>)
+                     342 MAKE_FUNCTION            4 (annotations)
+                     344 STORE_NAME              23 (get_spec)
+         
+         483         346 LOAD_CONST             113 (('label', 'EventSpecLabel', 'return', 'ETSC'))
+                     348 LOAD_CONST              53 (<code object get_events, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 483>)
+                     350 MAKE_FUNCTION            4 (annotations)
+                     352 STORE_NAME              24 (get_events)
+         
+         486         354 LOAD_CONST             114 (('label', 'MeasurementSpecLabel', 'return', 'MTSC'))
+                     356 LOAD_CONST              56 (<code object get_measurements, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 486>)
+                     358 MAKE_FUNCTION            4 (annotations)
+                     360 STORE_NAME              25 (get_measurements)
+         
+         489         362 PUSH_NULL
+                     364 LOAD_NAME               26 (slice)
+                     366 LOAD_CONST               1 (None)
+                     368 PRECALL                  1
+                     372 CALL                     1
+                     382 BUILD_TUPLE              1
+                     384 LOAD_CONST             115 (('label', 'EventSpecLabel', 'objs', 'StrIndexer', 'return', 'ETSView'))
+                     386 LOAD_CONST              60 (<code object view_event_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 489>)
+                     388 MAKE_FUNCTION            5 (defaults, annotations)
+                     390 STORE_NAME              27 (view_event_series)
+         
+         493         392 PUSH_NULL
+                     394 LOAD_NAME               26 (slice)
+                     396 LOAD_CONST               1 (None)
+                     398 PRECALL                  1
+                     402 CALL                     1
+                     412 BUILD_TUPLE              1
+                     414 LOAD_CONST             116 (('label', 'MeasurementSpecLabel', 'objs', 'StrIndexer', 'return', 'MTSView'))
+                     416 LOAD_CONST              62 (<code object view_measurement_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 493>)
+                     418 MAKE_FUNCTION            5 (defaults, annotations)
+                     420 STORE_NAME              28 (view_measurement_series)
+         
+         497         422 LOAD_CONST             117 ((True, True))
+                     424 LOAD_CONST              63 (<code object recalculate_index, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 497>)
+                     426 MAKE_FUNCTION            1 (defaults)
+                     428 STORE_NAME              29 (recalculate_index)
+         
+         502         430 LOAD_CONST              64 (<code object _repopulate_maps, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 502>)
+                     432 MAKE_FUNCTION            0
+                     434 STORE_NAME              30 (_repopulate_maps)
+         
+         510         436 LOAD_CONST             118 ((False,))
+                     438 LOAD_CONST              65 (<code object fit_to_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 510>)
+                     440 MAKE_FUNCTION            1 (defaults)
+                     442 STORE_NAME              31 (fit_to_data)
+         
+         526         444 NOP
+         
+         527         446 NOP
+         
+         528         448 NOP
+         
+         526         450 LOAD_CONST             119 ((None, None, True, False))
+                     452 LOAD_CONST             120 (('event_series_labels', 'Iterable[EventSpecLabel] | bool', 'measurement_series_labels', 'Iterable[MeasurementSpecLabel] | bool'))
+                     454 LOAD_CONST              70 (<code object create_joined_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 526>)
+                     456 MAKE_FUNCTION            5 (defaults, annotations)
+                     458 STORE_NAME              32 (create_joined_df)
+         
+         546         460 NOP
+         
+         547         462 NOP
+         
+         548         464 NOP
+         
+         549         466 NOP
+         
+         546         468 LOAD_CONST             121 ((None, None, None, None, None, None))
+                     470 LOAD_CONST             122 (('typ', 'ObservationTypeValue', 'types', 'Iterable[ObservationTypeValue]', 'obj', 'str', 'objs', 'Iterable[str]', 'label', 'ObservationSpecLabel', 'labels', 'Iterable[ObservationSpecLabel]', 'return', 'pd.DataFrame'))
+                     472 LOAD_CONST              81 (<code object create_index_view, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 546>)
+                     474 MAKE_FUNCTION            5 (defaults, annotations)
+                     476 STORE_NAME              33 (create_index_view)
+         
+         572         478 PUSH_NULL
+                     480 LOAD_NAME               34 (immutabledict)
+                     482 PRECALL                  0
+                     486 CALL                     0
+         
+         574         496 PUSH_NULL
+                     498 LOAD_NAME               34 (immutabledict)
+                     500 PRECALL                  0
+                     504 CALL                     0
+         
+         575         514 LOAD_CONST              18 (False)
+                     516 LOAD_CONST              18 (False)
+         
+         570         518 BUILD_TUPLE              4
+                     520 LOAD_CONST             123 (('event_feature_selection', 'Mapping[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'measurement_feature_selection', 'Mapping[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'return', 'typing.Self'))
+                     522 LOAD_CONST              86 (<code object project, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 570>)
+                     524 MAKE_FUNCTION            5 (defaults, annotations)
+                     526 STORE_NAME              35 (project)
+         
+         596         528 LOAD_CONST             124 (('other', 'MachineDataProtocol', 'return', 'bool'))
+                     530 LOAD_CONST              89 (<code object is_mergeable, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 596>)
+                     532 MAKE_FUNCTION            4 (annotations)
+                     534 STORE_NAME              36 (is_mergeable)
+         
+         611         536 NOP
+         
+         610         538 LOAD_CONST             125 (('horizontal',))
+                     540 LOAD_CONST             126 (('other', 'MachineData', 'axis', "Literal['horizontal', 'vertical']", 'return', 'MachineData'))
+                     542 LOAD_CONST              94 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 610>)
+                     544 MAKE_FUNCTION            5 (defaults, annotations)
+                     546 STORE_NAME              37 (merge)
+         
+         621         548 LOAD_CONST             127 (('return', 'str'))
+                     550 LOAD_CONST              95 (<code object summary, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 621>)
+                     552 MAKE_FUNCTION            4 (annotations)
+                     554 STORE_NAME              38 (summary)
+         
+         626         556 LOAD_CONST              96 (<code object __str__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 626>)
+                     558 MAKE_FUNCTION            0
+                     560 STORE_NAME              39 (__str__)
+         
+         637         562 LOAD_CONST              97 (<code object __repr__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 637>)
+                     564 MAKE_FUNCTION            0
+                     566 STORE_NAME              40 (__repr__)
+                     568 LOAD_CONST               1 (None)
+                     570 RETURN_VALUE
          consts
             'AbstractMachineData'
             None
             'type[ETSC]'
             '_etsc_cls'
             'type[MTSC]'
             '_mtsc_cls'
@@ -4058,78 +4463,164 @@
             'Iterable[MTSC]'
             'index_frame'
             'pd.DataFrame'
             'return'
             'None'
             code
                argcount  : 5
-               nlocals   : 5
-               stacksize : 2
+               nlocals   : 7
+               stacksize : 7
                flags     : 16777219
                code
-                  0x97007c047c005f0000000000000000007c017c005f0100000000000000
-                  007c0001007c000100640184007c024400a6000000ab0000000000000000
-                  007c005f020000000000000000640284007c034400a6000000ab00000000
-                  00000000007c005f0300000000000000007c00a004000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000000100640053
+                  0x97007c017c005f00000000000000000074030000000000000000000064
+                  0184007c024400a6000000ab000000000000000000a6010000ab01000000
+                  00000000007c005f02000000000000000074030000000000000000000064
+                  0284007c034400a6000000ab000000000000000000a6010000ab01000000
+                  00000000007c005f0300000000000000007c006a020000000000000000a0
+                  040000000000000000000000000000000000000000a6000000ab00000000
+                  000000000044005d197d05740b000000000000000000007c057c006a0600
+                  00000000000000a6020000ab02000000000000000073024a0082018c1a7c
+                  006a030000000000000000a0040000000000000000000000000000000000
+                  000000a6000000ab00000000000000000044005d197d06740b0000000000
+                  00000000007c067c006a070000000000000000a6020000ab020000000000
+                  00000073024a0082018c1a64007c005f08000000000000000064007c005f
+                  0900000000000000007c047c005f0a000000000000000064007c005f0b00
+                  00000000000000741900000000000000000000741b000000000000000000
+                  006a0e00000000000000007c006a020000000000000000a0040000000000
+                  000000000000000000000000000000a6000000ab0000000000000000007c
+                  006a030000000000000000a0040000000000000000000000000000000000
+                  000000a6000000ab000000000000000000a6020000ab0200000000000000
+                  00a6010000ab0100000000000000007c005f0f0000000000000000640053
                   00
-               336           0 RESUME                   0
+               366           0 RESUME                   0
                
-               339           2 LOAD_FAST                4 (index_frame)
+               370           2 LOAD_FAST                1 (meta)
                              4 LOAD_FAST                0 (self)
-                             6 STORE_ATTR               0 (_index_frame)
+                             6 STORE_ATTR               0 (meta)
                
-               340          16 LOAD_FAST                1 (meta)
-                            18 LOAD_FAST                0 (self)
-                            20 STORE_ATTR               1 (meta)
+               371          16 LOAD_GLOBAL              3 (NULL + immutabledict)
                
-               341          30 LOAD_FAST                0 (self)
-                            32 POP_TOP
+               372          28 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 372>)
+                            30 MAKE_FUNCTION            0
+                            32 LOAD_FAST                2 (events)
+                            34 GET_ITER
+                            36 PRECALL                  0
+                            40 CALL                     0
                
-               342          34 LOAD_FAST                0 (self)
-                            36 POP_TOP
+               371          50 PRECALL                  1
+                            54 CALL                     1
+                            64 LOAD_FAST                0 (self)
+                            66 STORE_ATTR               2 (event_series)
                
-               343          38 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 343>)
-                            40 MAKE_FUNCTION            0
-                            42 LOAD_FAST                2 (events)
-                            44 GET_ITER
-                            46 PRECALL                  0
-                            50 CALL                     0
-                            60 LOAD_FAST                0 (self)
-                            62 STORE_ATTR               2 (event_series)
+               373          76 LOAD_GLOBAL              3 (NULL + immutabledict)
                
-               344          72 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 344>)
-                            74 MAKE_FUNCTION            0
+               374          88 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 374>)
+                            90 MAKE_FUNCTION            0
                
-               345          76 LOAD_FAST                3 (measurements)
+               375          92 LOAD_FAST                3 (measurements)
                
-               344          78 GET_ITER
-                            80 PRECALL                  0
-                            84 CALL                     0
-                            94 LOAD_FAST                0 (self)
-                            96 STORE_ATTR               3 (measurement_series)
+               374          94 GET_ITER
+                            96 PRECALL                  0
+                           100 CALL                     0
                
-               346         106 LOAD_FAST                0 (self)
-                           108 LOAD_METHOD              4 (_repopulate_maps)
-                           130 PRECALL                  0
-                           134 CALL                     0
-                           144 POP_TOP
-                           146 LOAD_CONST               0 (None)
-                           148 RETURN_VALUE
+               373         110 PRECALL                  1
+                           114 CALL                     1
+                           124 LOAD_FAST                0 (self)
+                           126 STORE_ATTR               3 (measurement_series)
+               
+               377         136 LOAD_FAST                0 (self)
+                           138 LOAD_ATTR                2 (event_series)
+                           148 LOAD_METHOD              4 (values)
+                           170 PRECALL                  0
+                           174 CALL                     0
+                           184 GET_ITER
+                       >>  186 FOR_ITER                25 (to 238)
+                           188 STORE_FAST               5 (etsc)
+               
+               378         190 LOAD_GLOBAL             11 (NULL + isinstance)
+                           202 LOAD_FAST                5 (etsc)
+                           204 LOAD_FAST                0 (self)
+                           206 LOAD_ATTR                6 (_etsc_cls)
+                           216 PRECALL                  2
+                           220 CALL                     2
+                           230 POP_JUMP_FORWARD_IF_TRUE     2 (to 236)
+                           232 LOAD_ASSERTION_ERROR
+                           234 RAISE_VARARGS            1
+                       >>  236 JUMP_BACKWARD           26 (to 186)
+               
+               379     >>  238 LOAD_FAST                0 (self)
+                           240 LOAD_ATTR                3 (measurement_series)
+                           250 LOAD_METHOD              4 (values)
+                           272 PRECALL                  0
+                           276 CALL                     0
+                           286 GET_ITER
+                       >>  288 FOR_ITER                25 (to 340)
+                           290 STORE_FAST               6 (mtsc)
+               
+               380         292 LOAD_GLOBAL             11 (NULL + isinstance)
+                           304 LOAD_FAST                6 (mtsc)
+                           306 LOAD_FAST                0 (self)
+                           308 LOAD_ATTR                7 (_mtsc_cls)
+                           318 PRECALL                  2
+                           322 CALL                     2
+                           332 POP_JUMP_FORWARD_IF_TRUE     2 (to 338)
+                           334 LOAD_ASSERTION_ERROR
+                           336 RAISE_VARARGS            1
+                       >>  338 JUMP_BACKWARD           26 (to 288)
+               
+               383     >>  340 LOAD_CONST               0 (None)
+                           342 LOAD_FAST                0 (self)
+                           344 STORE_ATTR               8 (_event_specs)
+               
+               384         354 LOAD_CONST               0 (None)
+                           356 LOAD_FAST                0 (self)
+                           358 STORE_ATTR               9 (_measurement_specs)
+               
+               385         368 LOAD_FAST                4 (index_frame)
+                           370 LOAD_FAST                0 (self)
+                           372 STORE_ATTR              10 (_index_frame)
+               
+               386         382 LOAD_CONST               0 (None)
+                           384 LOAD_FAST                0 (self)
+                           386 STORE_ATTR              11 (_objects)
+               
+               387         396 LOAD_GLOBAL             25 (NULL + tuple)
+               
+               388         408 LOAD_GLOBAL             27 (NULL + itertools)
+                           420 LOAD_ATTR               14 (chain)
+                           430 LOAD_FAST                0 (self)
+                           432 LOAD_ATTR                2 (event_series)
+                           442 LOAD_METHOD              4 (values)
+                           464 PRECALL                  0
+                           468 CALL                     0
+                           478 LOAD_FAST                0 (self)
+                           480 LOAD_ATTR                3 (measurement_series)
+                           490 LOAD_METHOD              4 (values)
+                           512 PRECALL                  0
+                           516 CALL                     0
+                           526 PRECALL                  2
+                           530 CALL                     2
+               
+               387         540 PRECALL                  1
+                           544 CALL                     1
+                           554 LOAD_FAST                0 (self)
+                           556 STORE_ATTR              15 (_series_containers)
+                           566 LOAD_CONST               0 (None)
+                           568 RETURN_VALUE
                consts
                   None
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d0f7d017c016a0000000000000000006a010000000000
                         0000007c0193028c105300
-                     343           0 RESUME                   0
+                     372           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                15 (to 38)
                                    8 STORE_FAST               1 (etc)
                                   10 LOAD_FAST                1 (etc)
                                   12 LOAD_ATTR                0 (timeseries_spec)
                                   22 LOAD_ATTR                1 (label)
@@ -4138,27 +4629,27 @@
                                   36 JUMP_BACKWARD           16 (to 6)
                              >>   38 RETURN_VALUE
                      consts
                      names      ('timeseries_spec', 'label')
                      varnames   ('.0', 'etc')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 343
+                     firstlineno 372
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d0f7d017c016a0000000000000000006a010000000000
                         0000007c0193028c105300
-                     344           0 RESUME                   0
+                     374           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                15 (to 38)
                                    8 STORE_FAST               1 (mtc)
                                   10 LOAD_FAST                1 (mtc)
                                   12 LOAD_ATTR                0 (timeseries_spec)
                                   22 LOAD_ATTR                1 (label)
@@ -4167,79 +4658,140 @@
                                   36 JUMP_BACKWARD           16 (to 6)
                              >>   38 RETURN_VALUE
                      consts
                      names      ('timeseries_spec', 'label')
                      varnames   ('.0', 'mtc')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 344
+                     firstlineno 374
                      lnotab 0x
-               names      ('_index_frame', 'meta', 'event_series', 'measurement_series', '_repopulate_maps')
-               varnames   ('self', 'meta', 'events', 'measurements', 'index_frame')
+               names      ('meta', 'immutabledict', 'event_series', 'measurement_series', 'values', 'isinstance', '_etsc_cls', '_mtsc_cls', '_event_specs', '_measurement_specs', '_index_frame', '_objects', 'tuple', 'itertools', 'chain', '_series_containers')
+               varnames   ('self', 'meta', 'events', 'measurements', 'index_frame', 'etsc', 'mtsc')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__init__'
-               firstlineno 336
-               lnotab 0x02030e010e01040104012201040102ff1c02
+               firstlineno 366
+               lnotab
+                  0x02040e010c0116ff1a020c01040102ff10ff1a0436013001360130030e
+                  010e010e010e010c0184ff
+            ()
+            False
+            True
+            'typing.Self'
+            code
+               argcount  : 6
+               nlocals   : 9
+               stacksize : 5
+               flags     : 16777231
+               code
+                  0x970002007c007c017c027c03660369007c07a4018e017d087c0473147c
+                  08a0000000000000000000000000000000000000000000a6000000ab0000
+                  0000000000000001007c0573147c08a00100000000000000000000000000
+                  00000000000000a6000000ab00000000000000000001007c085300
+               390           0 RESUME                   0
+               
+               395           2 PUSH_NULL
+                             4 LOAD_FAST                0 (cls)
+                             6 LOAD_FAST                1 (meta)
+                             8 LOAD_FAST                2 (events)
+                            10 LOAD_FAST                3 (measurements)
+                            12 BUILD_TUPLE              3
+                            14 BUILD_MAP                0
+                            16 LOAD_FAST                7 (kwargs)
+                            18 DICT_MERGE               1
+                            20 CALL_FUNCTION_EX         1
+                            22 STORE_FAST               8 (md)
+               
+               396          24 LOAD_FAST                4 (lazy_index_creation)
+                            26 POP_JUMP_FORWARD_IF_TRUE    20 (to 68)
+               
+               397          28 LOAD_FAST                8 (md)
+                            30 LOAD_METHOD              0 (recalculate_index)
+                            52 PRECALL                  0
+                            56 CALL                     0
+                            66 POP_TOP
+               
+               398     >>   68 LOAD_FAST                5 (lazy_map_creation)
+                            70 POP_JUMP_FORWARD_IF_TRUE    20 (to 112)
+               
+               399          72 LOAD_FAST                8 (md)
+                            74 LOAD_METHOD              1 (_repopulate_maps)
+                            96 PRECALL                  0
+                           100 CALL                     0
+                           110 POP_TOP
+               
+               400     >>  112 LOAD_FAST                8 (md)
+                           114 RETURN_VALUE
+               consts
+                  None
+               names      ('recalculate_index', '_repopulate_maps')
+               varnames   ('cls', 'meta', 'events', 'measurements', 'lazy_index_creation', 'lazy_map_creation', 'args', 'kwargs', 'md')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'of'
+               firstlineno 390
+               lnotab 0x020516010401280104012801
+            'Header'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 7
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000640184
                   007c006a020000000000000000a003000000000000000000000000000000
                   0000000000a6000000ab0000000000000000004400a6000000ab00000000
                   0000000000640284007c006a040000000000000000a00300000000000000
                   00000000000000000000000000a6000000ab0000000000000000004400a6
                   000000ab000000000000000000a6030000ab0300000000000000005300
-               348           0 RESUME                   0
+               402           0 RESUME                   0
                
-               350           2 LOAD_GLOBAL              1 (NULL + Header)
+               404           2 LOAD_GLOBAL              1 (NULL + Header)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (meta)
-                            26 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 350>)
+                            26 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 404>)
                             28 MAKE_FUNCTION            0
                             30 LOAD_FAST                0 (self)
                             32 LOAD_ATTR                2 (event_specs)
                             42 LOAD_METHOD              3 (items)
                             64 PRECALL                  0
                             68 CALL                     0
                             78 GET_ITER
                             80 PRECALL                  0
                             84 CALL                     0
                
-               351          94 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 351>)
+               405          94 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 405>)
                             96 MAKE_FUNCTION            0
                             98 LOAD_FAST                0 (self)
                            100 LOAD_ATTR                4 (measurement_specs)
                            110 LOAD_METHOD              3 (items)
                            132 PRECALL                  0
                            136 CALL                     0
                            146 GET_ITER
                            148 PRECALL                  0
                            152 CALL                     0
                
-               350         162 PRECALL                  3
+               404         162 PRECALL                  3
                            166 CALL                     3
                            176 RETURN_VALUE
                consts
                   None
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d0d5c0200007d017d027c017c026a0000000000000000
                         0093028c0e5300
-                     350           0 RESUME                   0
+                     404           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                13 (to 34)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (e)
                                   14 STORE_FAST               2 (tspec)
                                   16 LOAD_FAST                1 (e)
@@ -4249,27 +4801,27 @@
                                   32 JUMP_BACKWARD           14 (to 6)
                              >>   34 RETURN_VALUE
                      consts
                      names      ('base',)
                      varnames   ('.0', 'e', 'tspec')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 350
+                     firstlineno 404
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d0d5c0200007d017d027c017c026a0000000000000000
                         0093028c0e5300
-                     351           0 RESUME                   0
+                     405           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                13 (to 34)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (m)
                                   14 STORE_FAST               2 (tspec)
                                   16 LOAD_FAST                1 (m)
@@ -4279,332 +4831,780 @@
                                   32 JUMP_BACKWARD           14 (to 6)
                              >>   34 RETURN_VALUE
                      consts
                      names      ('base',)
                      varnames   ('.0', 'm', 'tspec')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 351
+                     firstlineno 405
                      lnotab 0x
                names      ('Header', 'meta', 'event_specs', 'items', 'measurement_specs')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'header'
-               firstlineno 348
+               firstlineno 402
                lnotab 0x02025c0144ff
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c006a00000000000000000080147c00a001000000000000000000
                   0000000000000000000000a6000000ab00000000000000000001007c006a
                   0000000000000000005300
-               353           0 RESUME                   0
+               407           0 RESUME                   0
                
-               355           2 LOAD_FAST                0 (self)
+               409           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (_index_frame)
                             14 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 56)
                
-               356          16 LOAD_FAST                0 (self)
+               410          16 LOAD_FAST                0 (self)
                             18 LOAD_METHOD              1 (recalculate_index)
                             40 PRECALL                  0
                             44 CALL                     0
                             54 POP_TOP
                
-               357     >>   56 LOAD_FAST                0 (self)
+               411     >>   56 LOAD_FAST                0 (self)
                             58 LOAD_ATTR                0 (_index_frame)
                             68 RETURN_VALUE
                consts
                   None
                names      ('_index_frame', 'recalculate_index')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'index_frame'
-               firstlineno 353
+               firstlineno 407
                lnotab 0x02020e012801
             'value'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 16777219
                code 0x97007c017c005f00000000000000000064005300
-               359           0 RESUME                   0
+               413           0 RESUME                   0
                
-               361           2 LOAD_FAST                1 (value)
+               415           2 LOAD_FAST                1 (value)
                              4 LOAD_FAST                0 (self)
                              6 STORE_ATTR               0 (_index_frame)
                             16 LOAD_CONST               0 (None)
                             18 RETURN_VALUE
                consts
                   None
                names      ('_index_frame',)
                varnames   ('self', 'value')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'index_frame'
-               firstlineno 359
+               firstlineno 413
                lnotab 0x0202
-            'set[str]'
+            'Set[str]'
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 1
+               stacksize : 2
                flags     : 16777219
-               code 0x97007c006a0000000000000000005300
-               363           0 RESUME                   0
+               code
+                  0x97007c006a00000000000000000080147c00a001000000000000000000
+                  0000000000000000000000a6000000ab00000000000000000001007c006a
+                  0000000000000000005300
+               417           0 RESUME                   0
                
-               365           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (_occurring_objects)
-                            14 RETURN_VALUE
+               419           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_objects)
+                            14 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 56)
+               
+               420          16 LOAD_FAST                0 (self)
+                            18 LOAD_METHOD              1 (_repopulate_maps)
+                            40 PRECALL                  0
+                            44 CALL                     0
+                            54 POP_TOP
+               
+               421     >>   56 LOAD_FAST                0 (self)
+                            58 LOAD_ATTR                0 (_objects)
+                            68 RETURN_VALUE
                consts
                   None
-               names      ('_occurring_objects',)
+               names      ('_objects', '_repopulate_maps')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'occurring_objects'
-               firstlineno 363
-               lnotab 0x0202
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'objects'
+               firstlineno 417
+               lnotab 0x02020e012801
             'int'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               367           0 RESUME                   0
+               423           0 RESUME                   0
                
-               369           2 LOAD_GLOBAL              1 (NULL + len)
+               425           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (index_frame)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'index_frame')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'observation_count'
-               firstlineno 367
+               firstlineno 423
                lnotab 0x0202
-            'list[ETSC | MTSC]'
+            'tuple[Union[ETSC | MTSC], ...]'
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 5
+               stacksize : 2
                flags     : 16777219
                code
-                  0x97007401000000000000000000007c006a010000000000000000a00200
-                  00000000000000000000000000000000000000a6000000ab000000000000
-                  000000a6010000ab0100000000000000007401000000000000000000007c
-                  006a030000000000000000a0020000000000000000000000000000000000
-                  000000a6000000ab000000000000000000a6010000ab0100000000000000
-                  007a0000005300
-               371           0 RESUME                   0
+                  0x97007c006a00000000000000000080147c00a001000000000000000000
+                  0000000000000000000000a6000000ab00000000000000000001007c006a
+                  0000000000000000005300
+               427           0 RESUME                   0
                
-               373           2 LOAD_GLOBAL              1 (NULL + list)
-                            14 LOAD_FAST                0 (self)
-                            16 LOAD_ATTR                1 (event_series)
-                            26 LOAD_METHOD              2 (values)
-                            48 PRECALL                  0
-                            52 CALL                     0
-                            62 PRECALL                  1
-                            66 CALL                     1
-                            76 LOAD_GLOBAL              1 (NULL + list)
-                            88 LOAD_FAST                0 (self)
-                            90 LOAD_ATTR                3 (measurement_series)
-                           100 LOAD_METHOD              2 (values)
-                           122 PRECALL                  0
-                           126 CALL                     0
-                           136 PRECALL                  1
-                           140 CALL                     1
-                           150 BINARY_OP                0 (+)
-                           154 RETURN_VALUE
+               429           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_series_containers)
+                            14 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 56)
+               
+               430          16 LOAD_FAST                0 (self)
+                            18 LOAD_METHOD              1 (_repopulate_maps)
+                            40 PRECALL                  0
+                            44 CALL                     0
+                            54 POP_TOP
+               
+               431     >>   56 LOAD_FAST                0 (self)
+                            58 LOAD_ATTR                0 (_series_containers)
+                            68 RETURN_VALUE
                consts
                   None
-               names      ('list', 'event_series', 'values', 'measurement_series')
+               names      ('_series_containers', '_repopulate_maps')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'series_containers'
-               firstlineno 371
-               lnotab 0x0202
-            True
-            'cls'
-            'type[AMD]'
-            'AMD'
+               firstlineno 427
+               lnotab 0x02020e012801
+            'Mapping[EventSpecLabel, ETSSpec]'
             code
-               argcount  : 5
-               nlocals   : 6
-               stacksize : 5
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 2
                flags     : 16777219
                code
-                  0x970002007c007c047c017c02a6030000ab0300000000000000007d057c
-                  0373147c05a0000000000000000000000000000000000000000000a60000
-                  00ab00000000000000000001007c055300
-               375           0 RESUME                   0
+                  0x97007c006a00000000000000000080147c00a001000000000000000000
+                  0000000000000000000000a6000000ab00000000000000000001007c006a
+                  0000000000000000005300
+               433           0 RESUME                   0
                
-               378           2 PUSH_NULL
-                             4 LOAD_FAST                0 (cls)
-                             6 LOAD_FAST                4 (meta)
-                             8 LOAD_FAST                1 (events)
-                            10 LOAD_FAST                2 (measurements)
-                            12 PRECALL                  3
-                            16 CALL                     3
-                            26 STORE_FAST               5 (md)
+               435           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_event_specs)
+                            14 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 56)
+               
+               436          16 LOAD_FAST                0 (self)
+                            18 LOAD_METHOD              1 (_repopulate_maps)
+                            40 PRECALL                  0
+                            44 CALL                     0
+                            54 POP_TOP
+               
+               437     >>   56 LOAD_FAST                0 (self)
+                            58 LOAD_ATTR                0 (_event_specs)
+                            68 RETURN_VALUE
+               consts
+                  None
+               names      ('_event_specs', '_repopulate_maps')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'event_specs'
+               firstlineno 433
+               lnotab 0x02020e012801
+            'Mapping[MeasurementSpecLabel, MTSSpec]'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 2
+               flags     : 16777219
+               code
+                  0x97007c006a00000000000000000080147c00a001000000000000000000
+                  0000000000000000000000a6000000ab00000000000000000001007c006a
+                  0000000000000000005300
+               439           0 RESUME                   0
+               
+               441           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (_measurement_specs)
+                            14 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 56)
+               
+               442          16 LOAD_FAST                0 (self)
+                            18 LOAD_METHOD              1 (_repopulate_maps)
+                            40 PRECALL                  0
+                            44 CALL                     0
+                            54 POP_TOP
+               
+               443     >>   56 LOAD_FAST                0 (self)
+                            58 LOAD_ATTR                0 (_measurement_specs)
+                            68 RETURN_VALUE
+               consts
+                  None
+               names      ('_measurement_specs', '_repopulate_maps')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'measurement_specs'
+               firstlineno 439
+               lnotab 0x02020e012801
+            'item'
+            'ObservationSpecIdentifier'
+            'ETSC | MTSC'
+            code
+               argcount  : 2
+               nlocals   : 4
+               stacksize : 3
+               flags     : 16777219
+               code
+                  0x97007c015c0200007d027d037c0278017400000000000000000000006a
+                  0100000000000000006b0200000000720e01007c006a0200000000000000
+                  007c031900000000000000000053007400000000000000000000006a0300
+                  000000000000006b0200000000720d7c006a0400000000000000007c0319
+                  00000000000000000053000900740a000000000000000000008201
+               445           0 RESUME                   0
+               
+               446           2 LOAD_FAST                1 (item)
+                             4 UNPACK_SEQUENCE          2
+                             8 STORE_FAST               2 (t)
+                            10 STORE_FAST               3 (label)
+               
+               447          12 LOAD_FAST                2 (t)
+               
+               448          14 COPY                     1
+                            16 LOAD_GLOBAL              0 (ObservationTypes)
+                            28 LOAD_ATTR                1 (E)
+                            38 COMPARE_OP               2 (==)
+                            44 POP_JUMP_FORWARD_IF_FALSE    14 (to 74)
+                            46 POP_TOP
+               
+               449          48 LOAD_FAST                0 (self)
+                            50 LOAD_ATTR                2 (event_series)
+                            60 LOAD_FAST                3 (label)
+                            62 BINARY_SUBSCR
+                            72 RETURN_VALUE
+               
+               450     >>   74 LOAD_GLOBAL              0 (ObservationTypes)
+                            86 LOAD_ATTR                3 (M)
+                            96 COMPARE_OP               2 (==)
+                           102 POP_JUMP_FORWARD_IF_FALSE    13 (to 130)
+               
+               451         104 LOAD_FAST                0 (self)
+                           106 LOAD_ATTR                4 (measurement_series)
+                           116 LOAD_FAST                3 (label)
+                           118 BINARY_SUBSCR
+                           128 RETURN_VALUE
+               
+               452     >>  130 NOP
+               
+               453         132 LOAD_GLOBAL             10 (KeyError)
+                           144 RAISE_VARARGS            1
+               consts
+                  None
+               names      ('ObservationTypes', 'E', 'event_series', 'M', 'measurement_series', 'KeyError')
+               varnames   ('self', 'item', 't', 'label')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__getitem__'
+               firstlineno 445
+               lnotab 0x02010a01020122011a011e011a010201
+            'object'
+            'bool'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 4
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c01740200000000000000000000a6
+                  020000ab02000000000000000073026401530009007c007c011900000000
+                  000000000001006e11230074040000000000000000000024007204010059
+                  0064015300770078035900770164025300
+               455           0 RESUME                   0
+               
+               456           2 LOAD_GLOBAL              1 (NULL + isinstance)
+                            14 LOAD_FAST                1 (item)
+                            16 LOAD_GLOBAL              2 (tuple)
+                            28 PRECALL                  2
+                            32 CALL                     2
+                            42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
+               
+               457          44 LOAD_CONST               1 (False)
+                            46 RETURN_VALUE
+               
+               458     >>   48 NOP
+               
+               459          50 LOAD_FAST                0 (self)
+                            52 LOAD_FAST                1 (item)
+                            54 BINARY_SUBSCR
+                            64 POP_TOP
+                            66 JUMP_FORWARD            17 (to 102)
+                       >>   68 PUSH_EXC_INFO
+               
+               460          70 LOAD_GLOBAL              4 (KeyError)
+                            82 CHECK_EXC_MATCH
+                            84 POP_JUMP_FORWARD_IF_FALSE     4 (to 94)
+                            86 POP_TOP
+               
+               461          88 POP_EXCEPT
+                            90 LOAD_CONST               1 (False)
+                            92 RETURN_VALUE
+               
+               460     >>   94 RERAISE                  0
+                       >>   96 COPY                     3
+                            98 POP_EXCEPT
+                           100 RERAISE                  1
+               
+               462     >>  102 LOAD_CONST               2 (True)
+                           104 RETURN_VALUE
+               ExceptionTable:
+                 50 to 64 -> 68 [0]
+                 68 to 86 -> 96 [1] lasti
+                 94 to 94 -> 96 [1] lasti
+               consts
+                  None
+                  False
+                  True
+               names      ('isinstance', 'tuple', 'KeyError')
+               varnames   ('self', 'item')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__contains__'
+               firstlineno 455
+               lnotab 0x02012a01040102011401120106ff0802
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 3
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c006a010000000000000000a60100
+                  00ab0100000000000000005300
+               464           0 RESUME                   0
+               
+               465           2 LOAD_GLOBAL              1 (NULL + len)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (series_containers)
+                            26 PRECALL                  1
+                            30 CALL                     1
+                            40 RETURN_VALUE
+               consts
+                  None
+               names      ('len', 'series_containers')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__len__'
+               firstlineno 464
+               lnotab 0x0201
+            'Iterator[ETSC | MTSC]'
+            code
+               argcount  : 1
+               nlocals   : 1
+               stacksize : 3
+               flags     : 16777219
+               code
+                  0x97007401000000000000000000007c006a010000000000000000a60100
+                  00ab0100000000000000005300
+               467           0 RESUME                   0
+               
+               468           2 LOAD_GLOBAL              1 (NULL + iter)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (series_containers)
+                            26 PRECALL                  1
+                            30 CALL                     1
+                            40 RETURN_VALUE
+               consts
+                  None
+               names      ('iter', 'series_containers')
+               varnames   ('self',)
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       '__iter__'
+               firstlineno 467
+               lnotab 0x0201
+            'identifier'
+            'ETSSpec | MTSSpec'
+            code
+               argcount  : 2
+               nlocals   : 5
+               stacksize : 3
+               flags     : 16777223
+               code
+                  0x97007401000000000000000000007c02a6010000ab0100000000000000
+                  0064016b0400000000720b7c017c026401190000000000000000007d047d
+                  036e057c015c0200007d037d047c0378017402000000000000000000006a
+                  0200000000000000006b0200000000720e01007c006a0300000000000000
+                  007c041900000000000000000053007402000000000000000000006a0400
+                  000000000000006b0200000000720d7c006a0500000000000000007c0419
+                  00000000000000000053000900740c000000000000000000008201
+               470           0 RESUME                   0
+               
+               471           2 LOAD_GLOBAL              1 (NULL + len)
+                            14 LOAD_FAST                2 (args)
+                            16 PRECALL                  1
+                            20 CALL                     1
+                            30 LOAD_CONST               1 (0)
+                            32 COMPARE_OP               4 (>)
+                            38 POP_JUMP_FORWARD_IF_FALSE    11 (to 62)
+               
+               472          40 LOAD_FAST                1 (identifier)
+                            42 LOAD_FAST                2 (args)
+                            44 LOAD_CONST               1 (0)
+                            46 BINARY_SUBSCR
+                            56 STORE_FAST               4 (label)
+                            58 STORE_FAST               3 (t)
+                            60 JUMP_FORWARD             5 (to 72)
+               
+               474     >>   62 LOAD_FAST                1 (identifier)
+                            64 UNPACK_SEQUENCE          2
+                            68 STORE_FAST               3 (t)
+                            70 STORE_FAST               4 (label)
+               
+               475     >>   72 LOAD_FAST                3 (t)
+               
+               476          74 COPY                     1
+                            76 LOAD_GLOBAL              2 (ObservationTypes)
+                            88 LOAD_ATTR                2 (E)
+                            98 COMPARE_OP               2 (==)
+                           104 POP_JUMP_FORWARD_IF_FALSE    14 (to 134)
+                           106 POP_TOP
+               
+               477         108 LOAD_FAST                0 (self)
+                           110 LOAD_ATTR                3 (event_specs)
+                           120 LOAD_FAST                4 (label)
+                           122 BINARY_SUBSCR
+                           132 RETURN_VALUE
+               
+               478     >>  134 LOAD_GLOBAL              2 (ObservationTypes)
+                           146 LOAD_ATTR                4 (M)
+                           156 COMPARE_OP               2 (==)
+                           162 POP_JUMP_FORWARD_IF_FALSE    13 (to 190)
+               
+               479         164 LOAD_FAST                0 (self)
+                           166 LOAD_ATTR                5 (measurement_specs)
+                           176 LOAD_FAST                4 (label)
+                           178 BINARY_SUBSCR
+                           188 RETURN_VALUE
+               
+               480     >>  190 NOP
+               
+               481         192 LOAD_GLOBAL             12 (KeyError)
+                           204 RAISE_VARARGS            1
+               consts
+                  None
+                  0
+               names      ('len', 'ObservationTypes', 'E', 'event_specs', 'M', 'measurement_specs', 'KeyError')
+               varnames   ('self', 'identifier', 'args', 't', 'label')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'get_spec'
+               firstlineno 470
+               lnotab 0x0201260116020a01020122011a011e011a010201
+            'label'
+            'EventSpecLabel'
+            'ETSC'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c006a0000000000000000007c01190000000000000000005300
+               483           0 RESUME                   0
                
-               379          28 LOAD_FAST                3 (lazy_index_creation)
-                            30 POP_JUMP_FORWARD_IF_TRUE    20 (to 72)
+               484           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (event_series)
+                            14 LOAD_FAST                1 (label)
+                            16 BINARY_SUBSCR
+                            26 RETURN_VALUE
+               consts
+                  None
+               names      ('event_series',)
+               varnames   ('self', 'label')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'get_events'
+               firstlineno 483
+               lnotab 0x0201
+            'MeasurementSpecLabel'
+            'MTSC'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 2
+               flags     : 16777219
+               code 0x97007c006a0000000000000000007c01190000000000000000005300
+               486           0 RESUME                   0
+               
+               487           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (measurement_series)
+                            14 LOAD_FAST                1 (label)
+                            16 BINARY_SUBSCR
+                            26 RETURN_VALUE
+               consts
+                  None
+               names      ('measurement_series',)
+               varnames   ('self', 'label')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'get_measurements'
+               firstlineno 486
+               lnotab 0x0201
+            'objs'
+            'StrIndexer'
+            'ETSView'
+            code
+               argcount  : 3
+               nlocals   : 5
+               stacksize : 5
+               flags     : 16777231
+               code
+                  0x970002007c006a0000000000000000007c01190000000000000000006a
+                  010000000000000000640264017c0269017c04a4018e015300
+               489           0 RESUME                   0
                
-               380          32 LOAD_FAST                5 (md)
-                            34 LOAD_METHOD              0 (recalulate_index)
-                            56 PRECALL                  0
-                            60 CALL                     0
-                            70 POP_TOP
+               491           2 PUSH_NULL
+                             4 LOAD_FAST                0 (self)
+                             6 LOAD_ATTR                0 (event_series)
+                            16 LOAD_FAST                1 (label)
+                            18 BINARY_SUBSCR
+                            28 LOAD_ATTR                1 (view)
+                            38 LOAD_CONST               2 (())
+                            40 LOAD_CONST               1 ('objs')
+                            42 LOAD_FAST                2 (objs)
+                            44 BUILD_MAP                1
+                            46 LOAD_FAST                4 (kwargs)
+                            48 DICT_MERGE               1
+                            50 CALL_FUNCTION_EX         1
+                            52 RETURN_VALUE
+               consts
+                  None
+                  'objs'
+                  ()
+               names      ('event_series', 'view')
+               varnames   ('self', 'label', 'objs', 'args', 'kwargs')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'view_event_series'
+               firstlineno 489
+               lnotab 0x0202
+            'MTSView'
+            code
+               argcount  : 3
+               nlocals   : 5
+               stacksize : 5
+               flags     : 16777231
+               code
+                  0x970002007c006a0000000000000000007c01190000000000000000006a
+                  010000000000000000640264017c0269017c04a4018e015300
+               493           0 RESUME                   0
                
-               381     >>   72 LOAD_FAST                5 (md)
-                            74 RETURN_VALUE
+               495           2 PUSH_NULL
+                             4 LOAD_FAST                0 (self)
+                             6 LOAD_ATTR                0 (measurement_series)
+                            16 LOAD_FAST                1 (label)
+                            18 BINARY_SUBSCR
+                            28 LOAD_ATTR                1 (view)
+                            38 LOAD_CONST               2 (())
+                            40 LOAD_CONST               1 ('objs')
+                            42 LOAD_FAST                2 (objs)
+                            44 BUILD_MAP                1
+                            46 LOAD_FAST                4 (kwargs)
+                            48 DICT_MERGE               1
+                            50 CALL_FUNCTION_EX         1
+                            52 RETURN_VALUE
                consts
                   None
-               names      ('recalulate_index',)
-               varnames   ('cls', 'events', 'measurements', 'lazy_index_creation', 'meta', 'md')
+                  'objs'
+                  ()
+               names      ('measurement_series', 'view')
+               varnames   ('self', 'label', 'objs', 'args', 'kwargs')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'from_series'
-               firstlineno 375
-               lnotab 0x02031a0104012801
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'view_measurement_series'
+               firstlineno 493
+               lnotab 0x0202
             code
                argcount  : 3
                nlocals   : 4
                stacksize : 6
                flags     : 16777227
                code
                   0x97007401000000000000000000007c006a01000000000000000066017c
                   017c0264019c027c03a4018e017c005f02000000000000000064005300
-               383           0 RESUME                   0
+               497           0 RESUME                   0
                
-               384           2 LOAD_GLOBAL              1 (NULL + build_shared_index)
+               498           2 LOAD_GLOBAL              1 (NULL + build_shared_index)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (series_containers)
                             26 BUILD_TUPLE              1
                
-               385          28 LOAD_FAST                1 (override_categorical_types)
+               499          28 LOAD_FAST                1 (override_categorical_types)
                
-               386          30 LOAD_FAST                2 (sort_by_time)
+               500          30 LOAD_FAST                2 (sort_by_time)
                
-               384          32 LOAD_CONST               1 (('override_categorical_types', 'sort_by_time'))
+               498          32 LOAD_CONST               1 (('override_categorical_types', 'sort_by_time'))
                             34 BUILD_CONST_KEY_MAP      2
                
-               386          36 LOAD_FAST                3 (kwargs)
+               500          36 LOAD_FAST                3 (kwargs)
                
-               384          38 DICT_MERGE               1
+               498          38 DICT_MERGE               1
                             40 CALL_FUNCTION_EX         1
                             42 LOAD_FAST                0 (self)
                             44 STORE_ATTR               2 (_index_frame)
                             54 LOAD_CONST               0 (None)
                             56 RETURN_VALUE
                consts
                   None
                   ('override_categorical_types', 'sort_by_time')
                names      ('build_shared_index', 'series_containers', '_index_frame')
                varnames   ('self', 'override_categorical_types', 'sort_by_time', 'kwargs')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'recalculate_index'
-               firstlineno 383
+               firstlineno 497
                lnotab 0x02011a01020102fe040202fe
             code
                argcount  : 1
                nlocals   : 1
-               stacksize : 4
+               stacksize : 5
                flags     : 16777219
                code
-                  0x9700640184007c006a000000000000000000a001000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000004400a60000
-                  00ab0000000000000000007c005f020000000000000000640284007c006a
-                  030000000000000000a00100000000000000000000000000000000000000
-                  00a6000000ab0000000000000000004400a6000000ab0000000000000000
-                  007c005f040000000000000000740b000000000000000000007c006a0600
-                  00000000000000740e000000000000000000006a08000000000000000019
-                  000000000000000000a6010000ab0100000000000000007c005f09000000
-                  000000000064005300
-               388           0 RESUME                   0
-               
-               389           2 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 389>)
-                             4 MAKE_FUNCTION            0
-               
-               390           6 LOAD_FAST                0 (self)
-                             8 LOAD_ATTR                0 (event_series)
-                            18 LOAD_METHOD              1 (values)
-                            40 PRECALL                  0
-                            44 CALL                     0
-               
-               389          54 GET_ITER
-                            56 PRECALL                  0
-                            60 CALL                     0
-                            70 LOAD_FAST                0 (self)
-                            72 STORE_ATTR               2 (event_specs)
+                  0x97007401000000000000000000007c006a010000000000000000a00200
+                  00000000000000000000000000000000000000a6000000ab000000000000
+                  000000a6010000ab0100000000000000007401000000000000000000007c
+                  006a030000000000000000a0020000000000000000000000000000000000
+                  000000a6000000ab000000000000000000a6010000ab0100000000000000
+                  007a0000007c005f040000000000000000740b0000000000000000000064
+                  0184007c006a010000000000000000a00200000000000000000000000000
+                  00000000000000a6000000ab0000000000000000004400a6000000ab0000
+                  00000000000000a6010000ab0100000000000000007c005f060000000000
+                  000000740b00000000000000000000640284007c006a0300000000000000
+                  00a0020000000000000000000000000000000000000000a6000000ab0000
+                  000000000000004400a6000000ab000000000000000000a6010000ab0100
+                  000000000000007c005f0700000000000000007411000000000000000000
+                  007c006a0900000000000000007414000000000000000000006a0b000000
+                  000000000019000000000000000000a6010000ab0100000000000000007c
+                  005f0c000000000000000064005300
+               502           0 RESUME                   0
                
-               391          82 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 391>)
-                            84 MAKE_FUNCTION            0
+               503           2 LOAD_GLOBAL              1 (NULL + tuple)
+                            14 LOAD_FAST                0 (self)
+                            16 LOAD_ATTR                1 (event_series)
+                            26 LOAD_METHOD              2 (values)
+                            48 PRECALL                  0
+                            52 CALL                     0
+                            62 PRECALL                  1
+                            66 CALL                     1
+                            76 LOAD_GLOBAL              1 (NULL + tuple)
+                            88 LOAD_FAST                0 (self)
+                            90 LOAD_ATTR                3 (measurement_series)
+                           100 LOAD_METHOD              2 (values)
+                           122 PRECALL                  0
+                           126 CALL                     0
+                           136 PRECALL                  1
+                           140 CALL                     1
+                           150 BINARY_OP                0 (+)
+                           154 LOAD_FAST                0 (self)
+                           156 STORE_ATTR               4 (_series_containers)
                
-               392          86 LOAD_FAST                0 (self)
-                            88 LOAD_ATTR                3 (measurement_series)
-                            98 LOAD_METHOD              1 (values)
-                           120 PRECALL                  0
-                           124 CALL                     0
-               
-               391         134 GET_ITER
-                           136 PRECALL                  0
-                           140 CALL                     0
-                           150 LOAD_FAST                0 (self)
-                           152 STORE_ATTR               4 (measurement_specs)
+               504         166 LOAD_GLOBAL             11 (NULL + immutabledict)
+                           178 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 504>)
+                           180 MAKE_FUNCTION            0
+               
+               505         182 LOAD_FAST                0 (self)
+                           184 LOAD_ATTR                1 (event_series)
+                           194 LOAD_METHOD              2 (values)
+                           216 PRECALL                  0
+                           220 CALL                     0
+               
+               504         230 GET_ITER
+                           232 PRECALL                  0
+                           236 CALL                     0
+                           246 PRECALL                  1
+                           250 CALL                     1
+                           260 LOAD_FAST                0 (self)
+                           262 STORE_ATTR               6 (_event_specs)
+               
+               506         272 LOAD_GLOBAL             11 (NULL + immutabledict)
+                           284 LOAD_CONST               2 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 506>)
+                           286 MAKE_FUNCTION            0
+               
+               507         288 LOAD_FAST                0 (self)
+                           290 LOAD_ATTR                3 (measurement_series)
+                           300 LOAD_METHOD              2 (values)
+                           322 PRECALL                  0
+                           326 CALL                     0
                
-               393         162 LOAD_GLOBAL             11 (NULL + set)
-                           174 LOAD_FAST                0 (self)
-                           176 LOAD_ATTR                6 (index_frame)
-                           186 LOAD_GLOBAL             14 (MDConcepts)
-                           198 LOAD_ATTR                8 (Object)
-                           208 BINARY_SUBSCR
-                           218 PRECALL                  1
-                           222 CALL                     1
-                           232 LOAD_FAST                0 (self)
-                           234 STORE_ATTR               9 (_occurring_objects)
-                           244 LOAD_CONST               0 (None)
-                           246 RETURN_VALUE
+               506         336 GET_ITER
+                           338 PRECALL                  0
+                           342 CALL                     0
+                           352 PRECALL                  1
+                           356 CALL                     1
+                           366 LOAD_FAST                0 (self)
+                           368 STORE_ATTR               7 (_measurement_specs)
+               
+               508         378 LOAD_GLOBAL             17 (NULL + frozenset)
+                           390 LOAD_FAST                0 (self)
+                           392 LOAD_ATTR                9 (index_frame)
+                           402 LOAD_GLOBAL             20 (MDConcepts)
+                           414 LOAD_ATTR               11 (Object)
+                           424 BINARY_SUBSCR
+                           434 PRECALL                  1
+                           438 CALL                     1
+                           448 LOAD_FAST                0 (self)
+                           450 STORE_ATTR              12 (_objects)
+                           460 LOAD_CONST               0 (None)
+                           462 RETURN_VALUE
                consts
                   None
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d147d017c016a0000000000000000006a010000000000
                         0000007c016a00000000000000000093028c155300
-                     389           0 RESUME                   0
+                     504           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                20 (to 48)
                                    8 STORE_FAST               1 (es)
                                   10 LOAD_FAST                1 (es)
                                   12 LOAD_ATTR                0 (timeseries_spec)
                                   22 LOAD_ATTR                1 (label)
@@ -4614,27 +5614,27 @@
                                   46 JUMP_BACKWARD           21 (to 6)
                              >>   48 RETURN_VALUE
                      consts
                      names      ('timeseries_spec', 'label')
                      varnames   ('.0', 'es')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 389
+                     firstlineno 504
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 16777235
                      code
                         0x970069007c005d147d017c016a0000000000000000006a010000000000
                         0000007c016a00000000000000000093028c155300
-                     391           0 RESUME                   0
+                     506           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                20 (to 48)
                                    8 STORE_FAST               1 (ms)
                                   10 LOAD_FAST                1 (ms)
                                   12 LOAD_ATTR                0 (timeseries_spec)
                                   22 LOAD_ATTR                1 (label)
@@ -4644,369 +5644,417 @@
                                   46 JUMP_BACKWARD           21 (to 6)
                              >>   48 RETURN_VALUE
                      consts
                      names      ('timeseries_spec', 'label')
                      varnames   ('.0', 'ms')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<dictcomp>'
-                     firstlineno 391
+                     firstlineno 506
                      lnotab 0x
-               names      ('event_series', 'values', 'event_specs', 'measurement_series', 'measurement_specs', 'set', 'index_frame', 'MDConcepts', 'Object', '_occurring_objects')
+               names      ('tuple', 'event_series', 'values', 'measurement_series', '_series_containers', 'immutabledict', '_event_specs', '_measurement_specs', 'frozenset', 'index_frame', 'MDConcepts', 'Object', '_objects')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '_repopulate_maps'
-               firstlineno 388
-               lnotab 0x0201040130ff1c02040130ff1c02
-            False
+               firstlineno 502
+               lnotab 0x0201a401100130ff2a02100130ff2a02
             code
                argcount  : 2
-               nlocals   : 4
+               nlocals   : 5
                stacksize : 5
                flags     : 16777219
                code
-                  0x97007c00a0000000000000000000000000000000000000000000a60000
-                  00ab00000000000000000044005d437d027c01732b7c026a010000000000
-                  000000a00200000000000000000000000000000000000000007c006a0300
-                  000000000000006a0400000000000000006401ac02a6020000ab02000000
-                  00000000007c025f0100000000000000007c02a005000000000000000000
-                  0000000000000000000000a6000000ab00000000000000000001008c447c
-                  0172157c00a0060000000000000000000000000000000000000000a60000
-                  00ab00000000000000000001006e7a740f000000000000000000006a0800
-                  0000000000000064037c006a0300000000000000006a0400000000000000
-                  00ac04a6020000ab0200000000000000007d037c00a00000000000000000
-                  00000000000000000000000000a6000000ab00000000000000000044005d
-                  2e7d027c037c006a0300000000000000006a040000000000000000a00900
-                  000000000000000000000000000000000000007c026a0100000000000000
-                  006a040000000000000000a6010000ab0100000000000000007a1400007d
-                  038c2f7c006a0300000000000000006a0a00000000000000007c03190000
-                  000000000000007c005f0300000000000000007c00a00b00000000000000
-                  00000000000000000000000000a6000000ab000000000000000000010064
-                  005300
-               395           0 RESUME                   0
+                  0x97007c006a00000000000000000044005d437d027c01732b7c026a0100
+                  00000000000000a00200000000000000000000000000000000000000007c
+                  006a0300000000000000006a0400000000000000006401ac02a6020000ab
+                  0200000000000000007c025f0100000000000000007c02a0050000000000
+                  000000000000000000000000000000a6000000ab00000000000000000001
+                  008c447c0172167c00a00600000000000000000000000000000000000000
+                  00a6000000ab0000000000000000000100640053007c006a030000000000
+                  0000006a0400000000000000007d03740f000000000000000000006a0800
+                  0000000000000064037c03ac04a6020000ab0200000000000000007d047c
+                  006a00000000000000000044005d247d027c047c03a00900000000000000
+                  000000000000000000000000007c026a0100000000000000006a04000000
+                  0000000000a6010000ab0100000000000000007a1400007d048c257c006a
+                  0300000000000000007c04190000000000000000007c005f0a0000000000
+                  00000064005300
+               510           0 RESUME                   0
+               
+               511           2 LOAD_FAST                0 (self)
+                             4 LOAD_ATTR                0 (series_containers)
+                            14 GET_ITER
+                       >>   16 FOR_ITER                67 (to 152)
+                            18 STORE_FAST               2 (tsc)
+               
+               513          20 LOAD_FAST                1 (ignore_index)
+                            22 POP_JUMP_FORWARD_IF_TRUE    43 (to 110)
+               
+               514          24 LOAD_FAST                2 (tsc)
+                            26 LOAD_ATTR                1 (df)
+                            36 LOAD_METHOD              2 (filter)
+                            58 LOAD_FAST                0 (self)
+                            60 LOAD_ATTR                3 (index_frame)
+                            70 LOAD_ATTR                4 (index)
+                            80 LOAD_CONST               1 (0)
+                            82 KW_NAMES                 2
+                            84 PRECALL                  2
+                            88 CALL                     2
+                            98 LOAD_FAST                2 (tsc)
+                           100 STORE_ATTR               1 (df)
                
-               396           2 LOAD_FAST                0 (self)
-                             4 LOAD_METHOD              0 (iter_all_timeseries)
-                            26 PRECALL                  0
-                            30 CALL                     0
-                            40 GET_ITER
-                       >>   42 FOR_ITER                67 (to 178)
-                            44 STORE_FAST               2 (tsc)
-               
-               398          46 LOAD_FAST                1 (recreate_index)
-                            48 POP_JUMP_FORWARD_IF_TRUE    43 (to 136)
-               
-               399          50 LOAD_FAST                2 (tsc)
-                            52 LOAD_ATTR                1 (df)
-                            62 LOAD_METHOD              2 (filter)
-                            84 LOAD_FAST                0 (self)
-                            86 LOAD_ATTR                3 (index_frame)
-                            96 LOAD_ATTR                4 (index)
-                           106 LOAD_CONST               1 (0)
-                           108 KW_NAMES                 2
-                           110 PRECALL                  2
-                           114 CALL                     2
-                           124 LOAD_FAST                2 (tsc)
-                           126 STORE_ATTR               1 (df)
-               
-               400     >>  136 LOAD_FAST                2 (tsc)
-                           138 LOAD_METHOD              5 (fit_to_data)
-                           160 PRECALL                  0
-                           164 CALL                     0
-                           174 POP_TOP
-                           176 JUMP_BACKWARD           68 (to 42)
+               515     >>  110 LOAD_FAST                2 (tsc)
+                           112 LOAD_METHOD              5 (fit_to_data)
+                           134 PRECALL                  0
+                           138 CALL                     0
+                           148 POP_TOP
+                           150 JUMP_BACKWARD           68 (to 16)
                
-               402     >>  178 LOAD_FAST                1 (recreate_index)
-                           180 POP_JUMP_FORWARD_IF_FALSE    21 (to 224)
+               517     >>  152 LOAD_FAST                1 (ignore_index)
+                           154 POP_JUMP_FORWARD_IF_FALSE    22 (to 200)
                
-               403         182 LOAD_FAST                0 (self)
-                           184 LOAD_METHOD              6 (recalculate_index)
-                           206 PRECALL                  0
-                           210 CALL                     0
-                           220 POP_TOP
-                           222 JUMP_FORWARD           122 (to 468)
+               518         156 LOAD_FAST                0 (self)
+                           158 LOAD_METHOD              6 (recalculate_index)
+                           180 PRECALL                  0
+                           184 CALL                     0
+                           194 POP_TOP
+                           196 LOAD_CONST               0 (None)
+                           198 RETURN_VALUE
+               
+               520     >>  200 LOAD_FAST                0 (self)
+                           202 LOAD_ATTR                3 (index_frame)
+                           212 LOAD_ATTR                4 (index)
+                           222 STORE_FAST               3 (old_index)
                
-               405     >>  224 LOAD_GLOBAL             15 (NULL + pd)
+               521         224 LOAD_GLOBAL             15 (NULL + pd)
                            236 LOAD_ATTR                8 (Series)
                            246 LOAD_CONST               3 (False)
-                           248 LOAD_FAST                0 (self)
-                           250 LOAD_ATTR                3 (index_frame)
-                           260 LOAD_ATTR                4 (index)
-                           270 KW_NAMES                 4
-                           272 PRECALL                  2
-                           276 CALL                     2
-                           286 STORE_FAST               3 (mask)
-               
-               406         288 LOAD_FAST                0 (self)
-                           290 LOAD_METHOD              0 (iter_all_timeseries)
-                           312 PRECALL                  0
-                           316 CALL                     0
-                           326 GET_ITER
-                       >>  328 FOR_ITER                46 (to 422)
-                           330 STORE_FAST               2 (tsc)
-               
-               407         332 LOAD_FAST                3 (mask)
-                           334 LOAD_FAST                0 (self)
-                           336 LOAD_ATTR                3 (index_frame)
-                           346 LOAD_ATTR                4 (index)
-                           356 LOAD_METHOD              9 (isin)
-                           378 LOAD_FAST                2 (tsc)
-                           380 LOAD_ATTR                1 (df)
-                           390 LOAD_ATTR                4 (index)
-                           400 PRECALL                  1
-                           404 CALL                     1
-                           414 BINARY_OP               20 (|=)
-                           418 STORE_FAST               3 (mask)
-                           420 JUMP_BACKWARD           47 (to 328)
-               
-               408     >>  422 LOAD_FAST                0 (self)
-                           424 LOAD_ATTR                3 (index_frame)
-                           434 LOAD_ATTR               10 (loc)
-                           444 LOAD_FAST                3 (mask)
-                           446 BINARY_SUBSCR
-                           456 LOAD_FAST                0 (self)
-                           458 STORE_ATTR               3 (index_frame)
-               
-               410     >>  468 LOAD_FAST                0 (self)
-                           470 LOAD_METHOD             11 (_repopulate_maps)
-                           492 PRECALL                  0
-                           496 CALL                     0
-                           506 POP_TOP
-                           508 LOAD_CONST               0 (None)
-                           510 RETURN_VALUE
+                           248 LOAD_FAST                3 (old_index)
+                           250 KW_NAMES                 4
+                           252 PRECALL                  2
+                           256 CALL                     2
+                           266 STORE_FAST               4 (mask)
+               
+               522         268 LOAD_FAST                0 (self)
+                           270 LOAD_ATTR                0 (series_containers)
+                           280 GET_ITER
+                       >>  282 FOR_ITER                36 (to 356)
+                           284 STORE_FAST               2 (tsc)
+               
+               523         286 LOAD_FAST                4 (mask)
+                           288 LOAD_FAST                3 (old_index)
+                           290 LOAD_METHOD              9 (isin)
+                           312 LOAD_FAST                2 (tsc)
+                           314 LOAD_ATTR                1 (df)
+                           324 LOAD_ATTR                4 (index)
+                           334 PRECALL                  1
+                           338 CALL                     1
+                           348 BINARY_OP               20 (|=)
+                           352 STORE_FAST               4 (mask)
+                           354 JUMP_BACKWARD           37 (to 282)
+               
+               524     >>  356 LOAD_FAST                0 (self)
+                           358 LOAD_ATTR                3 (index_frame)
+                           368 LOAD_FAST                4 (mask)
+                           370 BINARY_SUBSCR
+                           380 LOAD_FAST                0 (self)
+                           382 STORE_ATTR              10 (_index_frame)
+                           392 LOAD_CONST               0 (None)
+                           394 RETURN_VALUE
                consts
                   None
                   0
                   ('items', 'axis')
                   False
                   ('index',)
-               names      ('iter_all_timeseries', 'df', 'filter', 'index_frame', 'index', 'fit_to_data', 'recalculate_index', 'pd', 'Series', 'isin', 'loc', '_repopulate_maps')
-               varnames   ('self', 'recreate_index', 'tsc', 'mask')
+               names      ('series_containers', 'df', 'filter', 'index_frame', 'index', 'fit_to_data', 'recalculate_index', 'pd', 'Series', 'isin', '_index_frame')
+               varnames   ('self', 'ignore_index', 'tsc', 'old_index', 'mask')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'fit_to_data'
-               firstlineno 395
-               lnotab 0x02012c02040156012a0204012a0240012c015a012e02
-            'Iterable[TypedTimeseriesCollection]'
-            code
-               argcount  : 1
-               nlocals   : 1
-               stacksize : 5
-               flags     : 16777219
-               code
-                  0x97007401000000000000000000006a0100000000000000007c006a0200
-                  00000000000000a0030000000000000000000000000000000000000000a6
-                  000000ab0000000000000000007c006a040000000000000000a003000000
-                  0000000000000000000000000000000000a6000000ab0000000000000000
-                  00a6020000ab0200000000000000005300
-               412           0 RESUME                   0
-               
-               413           2 LOAD_GLOBAL              1 (NULL + itertools)
-                            14 LOAD_ATTR                1 (chain)
-                            24 LOAD_FAST                0 (self)
-                            26 LOAD_ATTR                2 (event_series)
-                            36 LOAD_METHOD              3 (values)
-                            58 PRECALL                  0
-                            62 CALL                     0
-                            72 LOAD_FAST                0 (self)
-                            74 LOAD_ATTR                4 (measurement_series)
-                            84 LOAD_METHOD              3 (values)
-                           106 PRECALL                  0
-                           110 CALL                     0
-                           120 PRECALL                  2
-                           124 CALL                     2
-                           134 RETURN_VALUE
-               consts
-                  None
-               names      ('itertools', 'chain', 'event_series', 'values', 'measurement_series')
-               varnames   ('self',)
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'iter_all_timeseries'
-               firstlineno 412
-               lnotab 0x0201
+               firstlineno 510
+               lnotab 0x02011202040156012a0204012c0218012c0112014601
             'event_series_labels'
             'Iterable[EventSpecLabel] | bool'
             'measurement_series_labels'
             'Iterable[MeasurementSpecLabel] | bool'
             code
-               argcount  : 4
-               nlocals   : 8
+               argcount  : 5
+               nlocals   : 10
                stacksize : 7
                flags     : 16777219
                code
-                  0x870397007c006a000000000000000000a0010000000000000000000000
-                  000000000000000000a6000000ab0000000000000000007d047405000000
-                  000000000000007406000000000000000000007c017c0464016401ac02a6
-                  050000ab0500000000000000007d057409000000000000000000007c057c
-                  04a6020000ab02000000000000000001007c006a050000000000000000a0
-                  010000000000000000000000000000000000000000a6000000ab00000000
-                  00000000007d067405000000000000000000007406000000000000000000
-                  007c027c0664016401ac02a6050000ab0500000000000000007d07740900
-                  0000000000000000007c077c06a6020000ab020000000000000000010074
-                  0d000000000000000000006a0700000000000000007c006a080000000000
-                  000000670188036601640384087c006a0900000000000000004400a60000
-                  00ab0000000000000000007a00000064046405ac06a6030000ab03000000
-                  00000000005300
-                             0 MAKE_CELL                3 (prefix_columns_to_avoid_collisions)
-               
-               415           2 RESUME                   0
+                  0x87008703970089006a000000000000000000a001000000000000000000
+                  0000000000000000000000a6000000ab0000000000000000007d05740500
+                  0000000000000000007406000000000000000000007c017c0564016401ac
+                  02a6050000ab0500000000000000007d067409000000000000000000007c
+                  067c05a6020000ab020000000000000000010089006a0500000000000000
+                  00a0010000000000000000000000000000000000000000a6000000ab0000
+                  000000000000007d07740500000000000000000000740600000000000000
+                  0000007c027c0764016401ac02a6050000ab0500000000000000007d0874
+                  09000000000000000000007c087c07a6020000ab02000000000000000001
+                  00740d000000000000000000006a07000000000000000088006601640384
+                  087c064400a6000000ab00000000000000000088006601640484087c0844
+                  00a6000000ab000000000000000000a6020000ab0200000000000000007d
+                  097411000000000000000000006a09000000000000000089006a0a000000
+                  0000000000670188036601640584087c094400a6000000ab000000000000
+                  0000007a00000064067c04ac07a6030000ab0300000000000000005300
+                             0 MAKE_CELL                0 (self)
+                             2 MAKE_CELL                3 (prefix_columns_to_avoid_collisions)
                
-               418           4 LOAD_FAST                0 (self)
-                             6 LOAD_ATTR                0 (event_specs)
-                            16 LOAD_METHOD              1 (keys)
-                            38 PRECALL                  0
-                            42 CALL                     0
-                            52 STORE_FAST               4 (event_keys)
-               
-               419          54 LOAD_GLOBAL              5 (NULL + mangle_arg_with_bool_fallback)
-                            66 LOAD_GLOBAL              6 (mangle_arg_to_tuple)
-                            78 LOAD_FAST                1 (event_series_labels)
-               
-               420          80 LOAD_FAST                4 (event_keys)
-               
-               421          82 LOAD_CONST               1 (True)
-                            84 LOAD_CONST               1 (True)
-               
-               419          86 KW_NAMES                 2
-                            88 PRECALL                  5
-                            92 CALL                     5
-                           102 STORE_FAST               5 (esl)
-               
-               422         104 LOAD_GLOBAL              9 (NULL + assert_in)
-                           116 LOAD_FAST                5 (esl)
-                           118 LOAD_FAST                4 (event_keys)
-                           120 PRECALL                  2
-                           124 CALL                     2
-                           134 POP_TOP
-               
-               423         136 LOAD_FAST                0 (self)
-                           138 LOAD_ATTR                5 (measurement_specs)
-                           148 LOAD_METHOD              1 (keys)
-                           170 PRECALL                  0
-                           174 CALL                     0
-                           184 STORE_FAST               6 (measurement_keys)
+               526           4 RESUME                   0
                
-               424         186 LOAD_GLOBAL              5 (NULL + mangle_arg_with_bool_fallback)
-                           198 LOAD_GLOBAL              6 (mangle_arg_to_tuple)
-                           210 LOAD_FAST                2 (measurement_series_labels)
+               529           6 LOAD_DEREF               0 (self)
+                             8 LOAD_ATTR                0 (event_specs)
+                            18 LOAD_METHOD              1 (keys)
+                            40 PRECALL                  0
+                            44 CALL                     0
+                            54 STORE_FAST               5 (event_keys)
                
-               425         212 LOAD_FAST                6 (measurement_keys)
+               530          56 LOAD_GLOBAL              5 (NULL + mangle_arg_with_bool_fallback)
+                            68 LOAD_GLOBAL              6 (mangle_arg_to_tuple)
+                            80 LOAD_FAST                1 (event_series_labels)
+               
+               531          82 LOAD_FAST                5 (event_keys)
+               
+               532          84 LOAD_CONST               1 (True)
+                            86 LOAD_CONST               1 (True)
+               
+               530          88 KW_NAMES                 2
+                            90 PRECALL                  5
+                            94 CALL                     5
+                           104 STORE_FAST               6 (esl)
+               
+               533         106 LOAD_GLOBAL              9 (NULL + assert_in)
+                           118 LOAD_FAST                6 (esl)
+                           120 LOAD_FAST                5 (event_keys)
+                           122 PRECALL                  2
+                           126 CALL                     2
+                           136 POP_TOP
+               
+               534         138 LOAD_DEREF               0 (self)
+                           140 LOAD_ATTR                5 (measurement_specs)
+                           150 LOAD_METHOD              1 (keys)
+                           172 PRECALL                  0
+                           176 CALL                     0
+                           186 STORE_FAST               7 (measurement_keys)
+               
+               535         188 LOAD_GLOBAL              5 (NULL + mangle_arg_with_bool_fallback)
+                           200 LOAD_GLOBAL              6 (mangle_arg_to_tuple)
+                           212 LOAD_FAST                2 (measurement_series_labels)
+               
+               536         214 LOAD_FAST                7 (measurement_keys)
+               
+               537         216 LOAD_CONST               1 (True)
+                           218 LOAD_CONST               1 (True)
+               
+               535         220 KW_NAMES                 2
+                           222 PRECALL                  5
+                           226 CALL                     5
+                           236 STORE_FAST               8 (msl)
+               
+               538         238 LOAD_GLOBAL              9 (NULL + assert_in)
+                           250 LOAD_FAST                8 (msl)
+                           252 LOAD_FAST                7 (measurement_keys)
+                           254 PRECALL                  2
+                           258 CALL                     2
+                           268 POP_TOP
+               
+               539         270 LOAD_GLOBAL             13 (NULL + itertools)
+                           282 LOAD_ATTR                7 (chain)
+                           292 LOAD_CLOSURE             0 (self)
+                           294 BUILD_TUPLE              1
+                           296 LOAD_CONST               3 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 539>)
+                           298 MAKE_FUNCTION            8 (closure)
+                           300 LOAD_FAST                6 (esl)
+                           302 GET_ITER
+                           304 PRECALL                  0
+                           308 CALL                     0
+               
+               540         318 LOAD_CLOSURE             0 (self)
+                           320 BUILD_TUPLE              1
+                           322 LOAD_CONST               4 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 540>)
+                           324 MAKE_FUNCTION            8 (closure)
+                           326 LOAD_FAST                8 (msl)
+                           328 GET_ITER
+                           330 PRECALL                  0
+                           334 CALL                     0
+               
+               539         344 PRECALL                  2
+                           348 CALL                     2
+                           358 STORE_FAST               9 (it)
+               
+               541         360 LOAD_GLOBAL             17 (NULL + pd)
+                           372 LOAD_ATTR                9 (concat)
+                           382 LOAD_DEREF               0 (self)
+                           384 LOAD_ATTR               10 (index_frame)
+                           394 BUILD_LIST               1
+                           396 LOAD_CLOSURE             3 (prefix_columns_to_avoid_collisions)
+                           398 BUILD_TUPLE              1
+                           400 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 541>)
+                           402 MAKE_FUNCTION            8 (closure)
                
-               426         214 LOAD_CONST               1 (True)
-                           216 LOAD_CONST               1 (True)
+               544         404 LOAD_FAST                9 (it)
                
-               424         218 KW_NAMES                 2
-                           220 PRECALL                  5
-                           224 CALL                     5
-                           234 STORE_FAST               7 (msl)
+               541         406 GET_ITER
+                           408 PRECALL                  0
+                           412 CALL                     0
+                           422 BINARY_OP                0 (+)
                
-               427         236 LOAD_GLOBAL              9 (NULL + assert_in)
-                           248 LOAD_FAST                7 (msl)
-                           250 LOAD_FAST                6 (measurement_keys)
-                           252 PRECALL                  2
-                           256 CALL                     2
-                           266 POP_TOP
+               544         426 LOAD_CONST               6 ('columns')
+                           428 LOAD_FAST                4 (copy)
                
-               428         268 LOAD_GLOBAL             13 (NULL + pd)
-                           280 LOAD_ATTR                7 (concat)
-                           290 LOAD_FAST                0 (self)
-                           292 LOAD_ATTR                8 (index_frame)
-                           302 BUILD_LIST               1
-                           304 LOAD_CLOSURE             3 (prefix_columns_to_avoid_collisions)
-                           306 BUILD_TUPLE              1
-                           308 LOAD_CONST               3 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 428>)
-                           310 MAKE_FUNCTION            8 (closure)
-               
-               430         312 LOAD_FAST                0 (self)
-                           314 LOAD_ATTR                9 (series_containers)
-               
-               428         324 GET_ITER
-                           326 PRECALL                  0
-                           330 CALL                     0
-                           340 BINARY_OP                0 (+)
-               
-               430         344 LOAD_CONST               4 ('columns')
-                           346 LOAD_CONST               5 (False)
-               
-               428         348 KW_NAMES                 6
-                           350 PRECALL                  3
-                           354 CALL                     3
-                           364 RETURN_VALUE
+               541         430 KW_NAMES                 7
+                           432 PRECALL                  3
+                           436 CALL                     3
+                           446 RETURN_VALUE
                consts
                   None
                   True
                   ('if_true', 'rm_duplicates', 'preserve_order')
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 3
+                     flags     : 16777267
+                     code
+                        0x95014b00010097007c005d117d0189026a0000000000000000007c0119
+                        0000000000000000005600970101008c1264005300
+                                   0 COPY_FREE_VARS           1
+                     
+                     539           2 RETURN_GENERATOR
+                                   4 POP_TOP
+                                   6 RESUME                   0
+                                   8 LOAD_FAST                0 (.0)
+                             >>   10 FOR_ITER                17 (to 46)
+                                  12 STORE_FAST               1 (e)
+                                  14 LOAD_DEREF               2 (self)
+                                  16 LOAD_ATTR                0 (event_series)
+                                  26 LOAD_FAST                1 (e)
+                                  28 BINARY_SUBSCR
+                                  38 YIELD_VALUE
+                                  40 RESUME                   1
+                                  42 POP_TOP
+                                  44 JUMP_BACKWARD           18 (to 10)
+                             >>   46 LOAD_CONST               0 (None)
+                                  48 RETURN_VALUE
+                     consts
+                        None
+                     names      ('event_series',)
+                     varnames   ('.0', 'e')
+                     freevars   ('self',)
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       '<genexpr>'
+                     firstlineno 539
+                     lnotab 0x
+                  code
+                     argcount  : 1
+                     nlocals   : 2
+                     stacksize : 3
+                     flags     : 16777267
+                     code
+                        0x95014b00010097007c005d117d0189026a0000000000000000007c0119
+                        0000000000000000005600970101008c1264005300
+                                   0 COPY_FREE_VARS           1
+                     
+                     540           2 RETURN_GENERATOR
+                                   4 POP_TOP
+                                   6 RESUME                   0
+                                   8 LOAD_FAST                0 (.0)
+                             >>   10 FOR_ITER                17 (to 46)
+                                  12 STORE_FAST               1 (m)
+                                  14 LOAD_DEREF               2 (self)
+                                  16 LOAD_ATTR                0 (measurement_series)
+                                  26 LOAD_FAST                1 (m)
+                                  28 BINARY_SUBSCR
+                                  38 YIELD_VALUE
+                                  40 RESUME                   1
+                                  42 POP_TOP
+                                  44 JUMP_BACKWARD           18 (to 10)
+                             >>   46 LOAD_CONST               0 (None)
+                                  48 RETURN_VALUE
+                     consts
+                        None
+                     names      ('measurement_series',)
+                     varnames   ('.0', 'm')
+                     freevars   ('self',)
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       '<genexpr>'
+                     firstlineno 540
+                     lnotab 0x
+                  code
+                     argcount  : 1
+                     nlocals   : 2
+                     stacksize : 7
                      flags     : 16777235
                      code
-                        0x9501970067007c005d127d01890272077c016a0000000000000000006e
-                        067c016a01000000000000000091028c135300
+                        0x9501970067007c005d1a7d017c01a00000000000000000000000000000
+                        00000000000000890264006400ac01a6030000ab03000000000000000091
+                        028c1b5300
                                    0 COPY_FREE_VARS           1
                      
-                     428           2 RESUME                   0
+                     541           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
-                             >>    8 FOR_ITER                18 (to 46)
+                             >>    8 FOR_ITER                26 (to 62)
+                     
+                     544          10 STORE_FAST               1 (tsc)
+                     
+                     542          12 LOAD_FAST                1 (tsc)
+                                  14 LOAD_METHOD              0 (feature_column_view)
+                                  36 LOAD_DEREF               2 (prefix_columns_to_avoid_collisions)
+                                  38 LOAD_CONST               0 (False)
                      
-                     430          10 STORE_FAST               1 (tsc)
+                     543          40 LOAD_CONST               0 (False)
                      
-                     429          12 LOAD_DEREF               2 (prefix_columns_to_avoid_collisions)
-                                  14 POP_JUMP_FORWARD_IF_FALSE     7 (to 30)
-                                  16 LOAD_FAST                1 (tsc)
-                                  18 LOAD_ATTR                0 (prefixed_feature_column_view)
-                                  28 JUMP_FORWARD             6 (to 42)
-                             >>   30 LOAD_FAST                1 (tsc)
-                                  32 LOAD_ATTR                1 (feature_column_view)
+                     542          42 KW_NAMES                 1
+                                  44 PRECALL                  3
+                                  48 CALL                     3
                      
-                     428     >>   42 LIST_APPEND              2
-                                  44 JUMP_BACKWARD           19 (to 8)
-                             >>   46 RETURN_VALUE
+                     541          58 LIST_APPEND              2
+                                  60 JUMP_BACKWARD           27 (to 8)
+                             >>   62 RETURN_VALUE
                      consts
-                     names      ('prefixed_feature_column_view', 'feature_column_view')
+                        False
+                        ('add_spec_id_prefix', 'include_time_col', 'include_object_col')
+                     names      ('feature_column_view',)
                      varnames   ('.0', 'tsc')
                      freevars   ('prefix_columns_to_avoid_collisions',)
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       '<listcomp>'
-                     firstlineno 428
-                     lnotab 0x0a0202ff1eff
+                     firstlineno 541
+                     lnotab 0x0a0302fe1c0102ff10ff
                   'columns'
-                  False
                   ('axis', 'copy')
-               names      ('event_specs', 'keys', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'assert_in', 'measurement_specs', 'pd', 'concat', 'index_frame', 'series_containers')
-               varnames   ('self', 'event_series_labels', 'measurement_series_labels', 'prefix_columns_to_avoid_collisions', 'event_keys', 'esl', 'measurement_keys', 'msl')
+               names      ('event_specs', 'keys', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'assert_in', 'measurement_specs', 'itertools', 'chain', 'pd', 'concat', 'index_frame')
+               varnames   ('self', 'event_series_labels', 'measurement_series_labels', 'prefix_columns_to_avoid_collisions', 'copy', 'event_keys', 'esl', 'measurement_keys', 'msl', 'it')
                freevars   ()
-               cellvars   ('prefix_columns_to_avoid_collisions',)
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               cellvars   ('self', 'prefix_columns_to_avoid_collisions')
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'create_joined_df'
-               firstlineno 415
+               firstlineno 526
                lnotab
-                  0x040332011a01020104fe1203200132011a01020104fe120320012c020c
-                  fe140204fe
+                  0x060332011a01020104fe1203200132011a01020104fe1203200130011a
+                  ff10022c0302fd140304fd
             'typ'
-            'ObservationTypeType'
+            'ObservationTypeValue'
             'types'
-            'Collection[ObservationTypeType]'
+            'Iterable[ObservationTypeValue]'
             'obj'
             'str'
-            'objs'
             'Iterable[str]'
-            'label'
-            'ObservationTypeLabel'
+            'ObservationSpecLabel'
             'labels'
-            'Iterable[ObservationTypeLabel]'
+            'Iterable[ObservationSpecLabel]'
             code
                argcount  : 7
                nlocals   : 8
                stacksize : 6
                flags     : 16777219
                code
                   0x97007c0181047c0281024a0082017c0381047c0481024a0082017c0581
@@ -5029,67 +6077,67 @@
                   0000000000190000000000000000007c016b02000000007a0e00007d076e
                   3c7c02813a7c077c006a0200000000000000007408000000000000000000
                   006a09000000000000000019000000000000000000a00600000000000000
                   00000000000000000000000000740f000000000000000000007c01a60100
                   00ab010000000000000000a6010000ab0100000000000000007a0e00007d
                   077c006a0200000000000000006a0a00000000000000007c071900000000
                   00000000005300
-               432           0 RESUME                   0
+               546           0 RESUME                   0
                
-               436           2 LOAD_FAST                1 (typ)
+               550           2 LOAD_FAST                1 (typ)
                              4 POP_JUMP_FORWARD_IF_NONE     4 (to 14)
                              6 LOAD_FAST                2 (types)
                              8 POP_JUMP_FORWARD_IF_NONE     2 (to 14)
                             10 LOAD_ASSERTION_ERROR
                             12 RAISE_VARARGS            1
                
-               437     >>   14 LOAD_FAST                3 (obj)
+               551     >>   14 LOAD_FAST                3 (obj)
                             16 POP_JUMP_FORWARD_IF_NONE     4 (to 26)
                             18 LOAD_FAST                4 (objs)
                             20 POP_JUMP_FORWARD_IF_NONE     2 (to 26)
                             22 LOAD_ASSERTION_ERROR
                             24 RAISE_VARARGS            1
                
-               438     >>   26 LOAD_FAST                5 (label)
+               552     >>   26 LOAD_FAST                5 (label)
                             28 POP_JUMP_FORWARD_IF_NONE     4 (to 38)
                             30 LOAD_FAST                6 (labels)
                             32 POP_JUMP_FORWARD_IF_NONE     2 (to 38)
                             34 LOAD_ASSERTION_ERROR
                             36 RAISE_VARARGS            1
                
-               440     >>   38 LOAD_GLOBAL              1 (NULL + pd)
+               554     >>   38 LOAD_GLOBAL              1 (NULL + pd)
                             50 LOAD_ATTR                1 (Series)
                             60 LOAD_CONST               1 (True)
                             62 LOAD_FAST                0 (self)
                             64 LOAD_ATTR                2 (index_frame)
                             74 LOAD_ATTR                3 (index)
                             84 KW_NAMES                 2
                             86 PRECALL                  2
                             90 CALL                     2
                            100 STORE_FAST               7 (mask)
                
-               441         102 LOAD_FAST                3 (obj)
+               555         102 LOAD_FAST                3 (obj)
                            104 POP_JUMP_FORWARD_IF_NONE    31 (to 168)
                
-               442         106 LOAD_FAST                7 (mask)
+               556         106 LOAD_FAST                7 (mask)
                            108 LOAD_FAST                0 (self)
                            110 LOAD_ATTR                2 (index_frame)
                            120 LOAD_GLOBAL              8 (MDConcepts)
                            132 LOAD_ATTR                5 (Object)
                            142 BINARY_SUBSCR
                            152 LOAD_FAST                3 (obj)
                            154 COMPARE_OP               2 (==)
                            160 BINARY_OP               14 (&=)
                            164 STORE_FAST               7 (mask)
                            166 JUMP_FORWARD            60 (to 288)
                
-               443     >>  168 LOAD_FAST                4 (objs)
+               557     >>  168 LOAD_FAST                4 (objs)
                            170 POP_JUMP_FORWARD_IF_NONE    58 (to 288)
                
-               444         172 LOAD_FAST                7 (mask)
+               558         172 LOAD_FAST                7 (mask)
                            174 LOAD_FAST                0 (self)
                            176 LOAD_ATTR                2 (index_frame)
                            186 LOAD_GLOBAL              8 (MDConcepts)
                            198 LOAD_ATTR                5 (Object)
                            208 BINARY_SUBSCR
                            218 LOAD_METHOD              6 (isin)
                            240 LOAD_GLOBAL             15 (NULL + mangle_arg_to_set)
@@ -5097,33 +6145,33 @@
                            254 PRECALL                  1
                            258 CALL                     1
                            268 PRECALL                  1
                            272 CALL                     1
                            282 BINARY_OP               14 (&=)
                            286 STORE_FAST               7 (mask)
                
-               445     >>  288 LOAD_FAST                5 (label)
+               559     >>  288 LOAD_FAST                5 (label)
                            290 POP_JUMP_FORWARD_IF_NONE    31 (to 354)
                
-               446         292 LOAD_FAST                7 (mask)
+               560         292 LOAD_FAST                7 (mask)
                            294 LOAD_FAST                0 (self)
                            296 LOAD_ATTR                2 (index_frame)
                            306 LOAD_GLOBAL              8 (MDConcepts)
                            318 LOAD_ATTR                8 (Label)
                            328 BINARY_SUBSCR
                            338 LOAD_FAST                5 (label)
                            340 COMPARE_OP               2 (==)
                            346 BINARY_OP               14 (&=)
                            350 STORE_FAST               7 (mask)
                            352 JUMP_FORWARD            60 (to 474)
                
-               447     >>  354 LOAD_FAST                6 (labels)
+               561     >>  354 LOAD_FAST                6 (labels)
                            356 POP_JUMP_FORWARD_IF_NONE    58 (to 474)
                
-               448         358 LOAD_FAST                7 (mask)
+               562         358 LOAD_FAST                7 (mask)
                            360 LOAD_FAST                0 (self)
                            362 LOAD_ATTR                2 (index_frame)
                            372 LOAD_GLOBAL              8 (MDConcepts)
                            384 LOAD_ATTR                8 (Label)
                            394 BINARY_SUBSCR
                            404 LOAD_METHOD              6 (isin)
                            426 LOAD_GLOBAL             15 (NULL + mangle_arg_to_set)
@@ -5131,33 +6179,33 @@
                            440 PRECALL                  1
                            444 CALL                     1
                            454 PRECALL                  1
                            458 CALL                     1
                            468 BINARY_OP               14 (&=)
                            472 STORE_FAST               7 (mask)
                
-               449     >>  474 LOAD_FAST                1 (typ)
+               563     >>  474 LOAD_FAST                1 (typ)
                            476 POP_JUMP_FORWARD_IF_NONE    31 (to 540)
                
-               450         478 LOAD_FAST                7 (mask)
+               564         478 LOAD_FAST                7 (mask)
                            480 LOAD_FAST                0 (self)
                            482 LOAD_ATTR                2 (index_frame)
                            492 LOAD_GLOBAL              8 (MDConcepts)
                            504 LOAD_ATTR                9 (Type)
                            514 BINARY_SUBSCR
                            524 LOAD_FAST                1 (typ)
                            526 COMPARE_OP               2 (==)
                            532 BINARY_OP               14 (&=)
                            536 STORE_FAST               7 (mask)
                            538 JUMP_FORWARD            60 (to 660)
                
-               451     >>  540 LOAD_FAST                2 (types)
+               565     >>  540 LOAD_FAST                2 (types)
                            542 POP_JUMP_FORWARD_IF_NONE    58 (to 660)
                
-               452         544 LOAD_FAST                7 (mask)
+               566         544 LOAD_FAST                7 (mask)
                            546 LOAD_FAST                0 (self)
                            548 LOAD_ATTR                2 (index_frame)
                            558 LOAD_GLOBAL              8 (MDConcepts)
                            570 LOAD_ATTR                9 (Type)
                            580 BINARY_SUBSCR
                            590 LOAD_METHOD              6 (isin)
                            612 LOAD_GLOBAL             15 (NULL + mangle_arg_to_set)
@@ -5165,740 +6213,588 @@
                            626 PRECALL                  1
                            630 CALL                     1
                            640 PRECALL                  1
                            644 CALL                     1
                            654 BINARY_OP               14 (&=)
                            658 STORE_FAST               7 (mask)
                
-               454     >>  660 LOAD_FAST                0 (self)
+               568     >>  660 LOAD_FAST                0 (self)
                            662 LOAD_ATTR                2 (index_frame)
                            672 LOAD_ATTR               10 (loc)
                            682 LOAD_FAST                7 (mask)
                            684 BINARY_SUBSCR
                            694 RETURN_VALUE
                consts
                   None
                   True
                   ('index',)
                names      ('pd', 'Series', 'index_frame', 'index', 'MDConcepts', 'Object', 'isin', 'mangle_arg_to_set', 'Label', 'Type', 'loc')
                varnames   ('self', 'typ', 'types', 'obj', 'objs', 'label', 'labels', 'mask')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'create_index_view'
-               firstlineno 432
+               firstlineno 546
                lnotab
                   0x02040c010c010c02400104013e010401740104013e010401740104013e
                   0104017402
-            'self'
-            'measurement_feature_selection'
-            'dict[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]'
             'event_feature_selection'
-            'dict[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]'
+            'Mapping[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]'
+            'measurement_feature_selection'
+            'Mapping[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]'
             code
                argcount  : 5
-               nlocals   : 14
-               stacksize : 7
+               nlocals   : 8
+               stacksize : 8
                flags     : 16777219
                code
-                  0x97007c01800269007d017c02800269007d0267007d057c01a000000000
+                  0x8700870387048708970064098804880366026403840c8a088808880066
+                  02640484087c01a0000000000000000000000000000000000000000000a6
+                  000000ab0000000000000000004400a6000000ab0000000000000000007d
+                  05880888006602640584087c02a000000000000000000000000000000000
+                  0000000000a6000000ab0000000000000000004400a6000000ab00000000
+                  00000000007d068900a00100000000000000000000000000000000000000
+                  007405000000000000000000006a0300000000000000007c01a004000000
                   0000000000000000000000000000000000a6000000ab0000000000000000
-                  0044005dd15c0200007d067d077403000000000000000000007404000000
-                  000000000000007c077c006a0300000000000000007c0619000000000000
-                  0000006a0400000000000000006401ac02a6040000ab0400000000000000
-                  007d077c006a0500000000000000007c06190000000000000000007d087c
-                  086a060000000000000000a0070000000000000000000000000000000000
-                  0000007c07a6010000ab0100000000000000007d097c0372357c086a0800
-                  000000000000006a09000000000000000064006400850274140000000000
-                  00000000006a0b00000000000000007419000000000000000000007c096a
-                  040000000000000000a6010000ab0100000000000000007a000000660219
-                  0000000000000000006e067c086a0800000000000000007d0a7c0472147c
-                  0aa00d0000000000000000000000000000000000000000a6000000ab0000
-                  000000000000007d0a7c05a00e0000000000000000000000000000000000
-                  0000007c00a00f00000000000000000000000000000000000000007c097c
-                  0aa6020000ab020000000000000000a6010000ab01000000000000000001
-                  008cd267007d0b7c02a00000000000000000000000000000000000000000
-                  00a6000000ab00000000000000000044005dd85c0200007d067d07740300
-                  0000000000000000007420000000000000000000007c027c006a11000000
-                  0000000000a0120000000000000000000000000000000000000000a60000
-                  00ab0000000000000000006401ac02a6040000ab0400000000000000007d
-                  077c006a1300000000000000007c06190000000000000000007d0c7c0c6a
-                  060000000000000000a00700000000000000000000000000000000000000
-                  007c07a6010000ab0100000000000000007d097c0372357c0c6a08000000
-                  00000000006a090000000000000000640064008502741400000000000000
-                  0000006a0b00000000000000007419000000000000000000007c096a0400
-                  00000000000000a6010000ab0100000000000000007a0000006602190000
-                  000000000000006e067c0c6a0800000000000000007d0a7c0472147c0aa0
-                  0d0000000000000000000000000000000000000000a6000000ab00000000
-                  00000000007d0a7c0ba00e00000000000000000000000000000000000000
-                  007c00a01400000000000000000000000000000000000000007c097c0aa6
-                  020000ab020000000000000000a6010000ab01000000000000000001008c
-                  d97c00a0150000000000000000000000000000000000000000742d000000
-                  000000000000006a1700000000000000007c01a012000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000007c02a01200
-                  00000000000000000000000000000000000000a6000000ab000000000000
-                  000000a6020000ab020000000000000000ac03a6010000ab010000000000
-                  0000007d0d7c0472147c0da00d0000000000000000000000000000000000
-                  000000a6000000ab0000000000000000007d0d7c00a01800000000000000
-                  000000000000000000000000007c006a1900000000000000007c0b7c057c
-                  0dac04a6040000ab0400000000000000005300
-               456           0 RESUME                   0
-               
-               461           2 LOAD_FAST                1 (measurement_feature_selection)
-                             4 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 10)
-               
-               462           6 BUILD_MAP                0
-                             8 STORE_FAST               1 (measurement_feature_selection)
-               
-               463     >>   10 LOAD_FAST                2 (event_feature_selection)
-                            12 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 18)
-               
-               464          14 BUILD_MAP                0
-                            16 STORE_FAST               2 (event_feature_selection)
-               
-               465     >>   18 BUILD_LIST               0
-                            20 STORE_FAST               5 (ms)
-               
-               466          22 LOAD_FAST                1 (measurement_feature_selection)
-                            24 LOAD_METHOD              0 (items)
-                            46 PRECALL                  0
-                            50 CALL                     0
-                            60 GET_ITER
-                       >>   62 FOR_ITER               209 (to 482)
-                            64 UNPACK_SEQUENCE          2
-                            68 STORE_FAST               6 (m)
-                            70 STORE_FAST               7 (fs)
+                  007c02a0040000000000000000000000000000000000000000a6000000ab
+                  000000000000000000a6020000ab020000000000000000ac06a6010000ab
+                  0100000000000000007d07890472147c07a0050000000000000000000000
+                  000000000000000000a6000000ab0000000000000000007d0789006a0600
+                  00000000000000a007000000000000000000000000000000000000000089
+                  006a0800000000000000007c057c067c0764076407ac08a6060000ab0600
+                  000000000000005300
+                             0 MAKE_CELL                0 (self)
+                             2 MAKE_CELL                3 (project_underlying_dfs)
+                             4 MAKE_CELL                4 (copy_underlying_dfs)
+                             6 MAKE_CELL                8 (proj)
+               
+               570           8 RESUME                   0
+               
+               576          10 LOAD_CONST               9 (('tsc', 'TimeseriesContainerProtocol'))
+                            12 LOAD_CLOSURE             4 (copy_underlying_dfs)
+                            14 LOAD_CLOSURE             3 (project_underlying_dfs)
+                            16 BUILD_TUPLE              2
+                            18 LOAD_CONST               3 (<code object proj, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 576>)
+                            20 MAKE_FUNCTION           12 (annotations, closure)
+                            22 STORE_DEREF              8 (proj)
+               
+               584          24 LOAD_CLOSURE             8 (proj)
+                            26 LOAD_CLOSURE             0 (self)
+                            28 BUILD_TUPLE              2
+                            30 LOAD_CONST               4 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 584>)
+                            32 MAKE_FUNCTION            8 (closure)
+                            34 LOAD_FAST                1 (event_feature_selection)
+                            36 LOAD_METHOD              0 (items)
+                            58 PRECALL                  0
+                            62 CALL                     0
+                            72 GET_ITER
+                            74 PRECALL                  0
+                            78 CALL                     0
+                            88 STORE_FAST               5 (es)
+               
+               585          90 LOAD_CLOSURE             8 (proj)
+                            92 LOAD_CLOSURE             0 (self)
+                            94 BUILD_TUPLE              2
+                            96 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 585>)
+                            98 MAKE_FUNCTION            8 (closure)
+               
+               586         100 LOAD_FAST                2 (measurement_feature_selection)
+                           102 LOAD_METHOD              0 (items)
+                           124 PRECALL                  0
+                           128 CALL                     0
+               
+               585         138 GET_ITER
+                           140 PRECALL                  0
+                           144 CALL                     0
+                           154 STORE_FAST               6 (ms)
+               
+               588         156 LOAD_DEREF               0 (self)
+                           158 LOAD_METHOD              1 (create_index_view)
+               
+               589         180 LOAD_GLOBAL              5 (NULL + itertools)
+                           192 LOAD_ATTR                3 (chain)
+                           202 LOAD_FAST                1 (event_feature_selection)
+                           204 LOAD_METHOD              4 (keys)
+                           226 PRECALL                  0
+                           230 CALL                     0
+                           240 LOAD_FAST                2 (measurement_feature_selection)
+                           242 LOAD_METHOD              4 (keys)
+                           264 PRECALL                  0
+                           268 CALL                     0
+                           278 PRECALL                  2
+                           282 CALL                     2
+               
+               588         292 KW_NAMES                 6
+                           294 PRECALL                  1
+                           298 CALL                     1
+                           308 STORE_FAST               7 (index_view)
                
-               467          72 LOAD_GLOBAL              3 (NULL + mangle_arg_with_bool_fallback)
-                            84 LOAD_GLOBAL              4 (mangle_arg_to_list)
-                            96 LOAD_FAST                7 (fs)
-               
-               468          98 LOAD_FAST                0 (self)
-                           100 LOAD_ATTR                3 (measurement_specs)
-                           110 LOAD_FAST                6 (m)
-                           112 BINARY_SUBSCR
-                           122 LOAD_ATTR                4 (features)
-               
-               469         132 LOAD_CONST               1 (True)
-               
-               467         134 KW_NAMES                 2
-                           136 PRECALL                  4
-                           140 CALL                     4
-                           150 STORE_FAST               7 (fs)
-               
-               470         152 LOAD_FAST                0 (self)
-                           154 LOAD_ATTR                5 (measurement_series)
-                           164 LOAD_FAST                6 (m)
-                           166 BINARY_SUBSCR
-                           176 STORE_FAST               8 (mtc)
-               
-               471         178 LOAD_FAST                8 (mtc)
-                           180 LOAD_ATTR                6 (timeseries_spec)
-                           190 LOAD_METHOD              7 (project)
-                           212 LOAD_FAST                7 (fs)
-                           214 PRECALL                  1
-                           218 CALL                     1
-                           228 STORE_FAST               9 (tspec)
-               
-               472         230 LOAD_FAST                3 (project_underlying_dfs)
-                           232 POP_JUMP_FORWARD_IF_FALSE    53 (to 340)
-                           234 LOAD_FAST                8 (mtc)
-                           236 LOAD_ATTR                8 (df)
-                           246 LOAD_ATTR                9 (loc)
-                           256 LOAD_CONST               0 (None)
-                           258 LOAD_CONST               0 (None)
-                           260 BUILD_SLICE              2
-                           262 LOAD_GLOBAL             20 (MDConcepts)
-                           274 LOAD_ATTR               11 (base_columns)
-                           284 LOAD_GLOBAL             25 (NULL + list)
-                           296 LOAD_FAST                9 (tspec)
-                           298 LOAD_ATTR                4 (features)
-                           308 PRECALL                  1
-                           312 CALL                     1
-                           322 BINARY_OP                0 (+)
-                           326 BUILD_TUPLE              2
-                           328 BINARY_SUBSCR
-                           338 JUMP_FORWARD             6 (to 352)
-                       >>  340 LOAD_FAST                8 (mtc)
-                           342 LOAD_ATTR                8 (df)
-                       >>  352 STORE_FAST              10 (df)
-               
-               473         354 LOAD_FAST                4 (copy_underlying_dfs)
-                           356 POP_JUMP_FORWARD_IF_FALSE    20 (to 398)
-               
-               474         358 LOAD_FAST               10 (df)
-                           360 LOAD_METHOD             13 (copy)
-                           382 PRECALL                  0
-                           386 CALL                     0
-                           396 STORE_FAST              10 (df)
-               
-               475     >>  398 LOAD_FAST                5 (ms)
-                           400 LOAD_METHOD             14 (append)
-                           422 LOAD_FAST                0 (self)
-                           424 LOAD_METHOD             15 (_mtsc_cls)
-                           446 LOAD_FAST                9 (tspec)
-                           448 LOAD_FAST               10 (df)
-                           450 PRECALL                  2
-                           454 CALL                     2
-                           464 PRECALL                  1
-                           468 CALL                     1
-                           478 POP_TOP
-                           480 JUMP_BACKWARD          210 (to 62)
-               
-               476     >>  482 BUILD_LIST               0
-                           484 STORE_FAST              11 (es)
-               
-               477         486 LOAD_FAST                2 (event_feature_selection)
-                           488 LOAD_METHOD              0 (items)
-                           510 PRECALL                  0
-                           514 CALL                     0
-                           524 GET_ITER
-                       >>  526 FOR_ITER               216 (to 960)
-                           528 UNPACK_SEQUENCE          2
-                           532 STORE_FAST               6 (m)
-                           534 STORE_FAST               7 (fs)
-               
-               478         536 LOAD_GLOBAL              3 (NULL + mangle_arg_with_bool_fallback)
-                           548 LOAD_GLOBAL             32 (mangle_arg_to_tuple)
-                           560 LOAD_FAST                2 (event_feature_selection)
-               
-               479         562 LOAD_FAST                0 (self)
-                           564 LOAD_ATTR               17 (event_specs)
-                           574 LOAD_METHOD             18 (keys)
-                           596 PRECALL                  0
-                           600 CALL                     0
-                           610 LOAD_CONST               1 (True)
-               
-               478         612 KW_NAMES                 2
-                           614 PRECALL                  4
-                           618 CALL                     4
-                           628 STORE_FAST               7 (fs)
-               
-               480         630 LOAD_FAST                0 (self)
-                           632 LOAD_ATTR               19 (event_series)
-                           642 LOAD_FAST                6 (m)
-                           644 BINARY_SUBSCR
-                           654 STORE_FAST              12 (etc)
-               
-               481         656 LOAD_FAST               12 (etc)
-                           658 LOAD_ATTR                6 (timeseries_spec)
-                           668 LOAD_METHOD              7 (project)
-                           690 LOAD_FAST                7 (fs)
-                           692 PRECALL                  1
-                           696 CALL                     1
-                           706 STORE_FAST               9 (tspec)
-               
-               482         708 LOAD_FAST                3 (project_underlying_dfs)
-                           710 POP_JUMP_FORWARD_IF_FALSE    53 (to 818)
-                           712 LOAD_FAST               12 (etc)
-                           714 LOAD_ATTR                8 (df)
-                           724 LOAD_ATTR                9 (loc)
-                           734 LOAD_CONST               0 (None)
-                           736 LOAD_CONST               0 (None)
-                           738 BUILD_SLICE              2
-                           740 LOAD_GLOBAL             20 (MDConcepts)
-                           752 LOAD_ATTR               11 (base_columns)
-                           762 LOAD_GLOBAL             25 (NULL + list)
-                           774 LOAD_FAST                9 (tspec)
-                           776 LOAD_ATTR                4 (features)
-                           786 PRECALL                  1
-                           790 CALL                     1
-                           800 BINARY_OP                0 (+)
-                           804 BUILD_TUPLE              2
-                           806 BINARY_SUBSCR
-                           816 JUMP_FORWARD             6 (to 830)
-                       >>  818 LOAD_FAST               12 (etc)
-                           820 LOAD_ATTR                8 (df)
-                       >>  830 STORE_FAST              10 (df)
-               
-               483         832 LOAD_FAST                4 (copy_underlying_dfs)
-                           834 POP_JUMP_FORWARD_IF_FALSE    20 (to 876)
-               
-               484         836 LOAD_FAST               10 (df)
-                           838 LOAD_METHOD             13 (copy)
-                           860 PRECALL                  0
-                           864 CALL                     0
-                           874 STORE_FAST              10 (df)
-               
-               485     >>  876 LOAD_FAST               11 (es)
-                           878 LOAD_METHOD             14 (append)
-                           900 LOAD_FAST                0 (self)
-                           902 LOAD_METHOD             20 (_etsc_cls)
-                           924 LOAD_FAST                9 (tspec)
-                           926 LOAD_FAST               10 (df)
-                           928 PRECALL                  2
-                           932 CALL                     2
-                           942 PRECALL                  1
-                           946 CALL                     1
-                           956 POP_TOP
-                           958 JUMP_BACKWARD          217 (to 526)
-               
-               487     >>  960 LOAD_FAST                0 (self)
-                           962 LOAD_METHOD             21 (create_index_view)
-               
-               488         984 LOAD_GLOBAL             45 (NULL + itertools)
-                           996 LOAD_ATTR               23 (chain)
-                          1006 LOAD_FAST                1 (measurement_feature_selection)
-                          1008 LOAD_METHOD             18 (keys)
-                          1030 PRECALL                  0
-                          1034 CALL                     0
-                          1044 LOAD_FAST                2 (event_feature_selection)
-                          1046 LOAD_METHOD             18 (keys)
-                          1068 PRECALL                  0
-                          1072 CALL                     0
-                          1082 PRECALL                  2
-                          1086 CALL                     2
-               
-               487        1096 KW_NAMES                 3
-                          1098 PRECALL                  1
-                          1102 CALL                     1
-                          1112 STORE_FAST              13 (index_view)
-               
-               489        1114 LOAD_FAST                4 (copy_underlying_dfs)
-                          1116 POP_JUMP_FORWARD_IF_FALSE    20 (to 1158)
-               
-               490        1118 LOAD_FAST               13 (index_view)
-                          1120 LOAD_METHOD             13 (copy)
-                          1142 PRECALL                  0
-                          1146 CALL                     0
-                          1156 STORE_FAST              13 (index_view)
-               
-               491     >> 1158 LOAD_FAST                0 (self)
-                          1160 LOAD_METHOD             24 (__class__)
-                          1182 LOAD_FAST                0 (self)
-                          1184 LOAD_ATTR               25 (meta)
-                          1194 LOAD_FAST               11 (es)
-                          1196 LOAD_FAST                5 (ms)
-                          1198 LOAD_FAST               13 (index_view)
-                          1200 KW_NAMES                 4
-                          1202 PRECALL                  4
-                          1206 CALL                     4
-                          1216 RETURN_VALUE
+               590         310 LOAD_DEREF               4 (copy_underlying_dfs)
+                           312 POP_JUMP_FORWARD_IF_FALSE    20 (to 354)
+               
+               591         314 LOAD_FAST                7 (index_view)
+                           316 LOAD_METHOD              5 (copy)
+                           338 PRECALL                  0
+                           342 CALL                     0
+                           352 STORE_FAST               7 (index_view)
+               
+               592     >>  354 LOAD_DEREF               0 (self)
+                           356 LOAD_ATTR                6 (__class__)
+                           366 LOAD_METHOD              7 (of)
+                           388 LOAD_DEREF               0 (self)
+                           390 LOAD_ATTR                8 (meta)
+                           400 LOAD_FAST                5 (es)
+                           402 LOAD_FAST                6 (ms)
+                           404 LOAD_FAST                7 (index_view)
+               
+               593         406 LOAD_CONST               7 (True)
+               
+               594         408 LOAD_CONST               7 (True)
+               
+               592         410 KW_NAMES                 8
+                           412 PRECALL                  6
+                           416 CALL                     6
+                           426 RETURN_VALUE
                consts
                   None
-                  True
-                  ('if_true', 'preserve_order')
+                  'tsc'
+                  'TimeseriesContainerProtocol'
+                  code
+                     argcount  : 2
+                     nlocals   : 5
+                     stacksize : 6
+                     flags     : 16777235
+                     code
+                        0x950297007c006a0000000000000000007d027403000000000000000000
+                        007404000000000000000000007c017c026a0300000000000000006401ac
+                        02a6040000ab0400000000000000007d017c02a004000000000000000000
+                        00000000000000000000007c01a6010000ab0100000000000000007d0389
+                        0672357c006a0500000000000000006a0600000000000000006400640085
+                        02740e000000000000000000006a08000000000000000074130000000000
+                        00000000007c036a030000000000000000a6010000ab0100000000000000
+                        007a0000006602190000000000000000006e067c006a0500000000000000
+                        007d047c03890572147c04a00a0000000000000000000000000000000000
+                        000000a6000000ab0000000000000000006e017c0466025300
+                                   0 COPY_FREE_VARS           2
+                     
+                     576           2 RESUME                   0
+                     
+                     577           4 LOAD_FAST                0 (tsc)
+                                   6 LOAD_ATTR                0 (timeseries_spec)
+                                  16 STORE_FAST               2 (tspec)
+                     
+                     578          18 LOAD_GLOBAL              3 (NULL + mangle_arg_with_bool_fallback)
+                                  30 LOAD_GLOBAL              4 (mangle_arg_to_tuple)
+                                  42 LOAD_FAST                1 (fs)
+                                  44 LOAD_FAST                2 (tspec)
+                                  46 LOAD_ATTR                3 (features)
+                                  56 LOAD_CONST               1 (True)
+                                  58 KW_NAMES                 2
+                                  60 PRECALL                  4
+                                  64 CALL                     4
+                                  74 STORE_FAST               1 (fs)
+                     
+                     579          76 LOAD_FAST                2 (tspec)
+                                  78 LOAD_METHOD              4 (project)
+                                 100 LOAD_FAST                1 (fs)
+                                 102 PRECALL                  1
+                                 106 CALL                     1
+                                 116 STORE_FAST               3 (spec_proj)
+                     
+                     581         118 LOAD_DEREF               6 (project_underlying_dfs)
+                     
+                     580         120 POP_JUMP_FORWARD_IF_FALSE    53 (to 228)
+                                 122 LOAD_FAST                0 (tsc)
+                                 124 LOAD_ATTR                5 (df)
+                                 134 LOAD_ATTR                6 (loc)
+                                 144 LOAD_CONST               0 (None)
+                                 146 LOAD_CONST               0 (None)
+                                 148 BUILD_SLICE              2
+                     
+                     581         150 LOAD_GLOBAL             14 (MDConcepts)
+                                 162 LOAD_ATTR                8 (base_columns)
+                                 172 LOAD_GLOBAL             19 (NULL + list)
+                                 184 LOAD_FAST                3 (spec_proj)
+                                 186 LOAD_ATTR                3 (features)
+                                 196 PRECALL                  1
+                                 200 CALL                     1
+                                 210 BINARY_OP                0 (+)
+                     
+                     580         214 BUILD_TUPLE              2
+                                 216 BINARY_SUBSCR
+                                 226 JUMP_FORWARD             6 (to 240)
+                     
+                     581     >>  228 LOAD_FAST                0 (tsc)
+                                 230 LOAD_ATTR                5 (df)
+                     
+                     580     >>  240 STORE_FAST               4 (df_proj)
+                     
+                     582         242 LOAD_FAST                3 (spec_proj)
+                                 244 LOAD_DEREF               5 (copy_underlying_dfs)
+                                 246 POP_JUMP_FORWARD_IF_FALSE    20 (to 288)
+                                 248 LOAD_FAST                4 (df_proj)
+                                 250 LOAD_METHOD             10 (copy)
+                                 272 PRECALL                  0
+                                 276 CALL                     0
+                                 286 JUMP_FORWARD             1 (to 290)
+                             >>  288 LOAD_FAST                4 (df_proj)
+                             >>  290 BUILD_TUPLE              2
+                                 292 RETURN_VALUE
+                     consts
+                        None
+                        True
+                        ('if_true', 'preserve_order')
+                     names      ('timeseries_spec', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'features', 'project', 'df', 'loc', 'MDConcepts', 'base_columns', 'list', 'copy')
+                     varnames   ('tsc', 'fs', 'tspec', 'spec_proj', 'df_proj')
+                     freevars   ('copy_underlying_dfs', 'project_underlying_dfs')
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       'proj'
+                     firstlineno 576
+                     lnotab 0x04010e013a012a0202ff1e0140ff0e010cff0202
+                  code
+                     argcount  : 1
+                     nlocals   : 3
+                     stacksize : 8
+                     flags     : 16777235
+                     code
+                        0x9502970067007c005d245c0200007d017d02020089046a000000000000
+                        0000000200890389046a0100000000000000007c01190000000000000000
+                        007c02a6020000ab0200000000000000008e0091028c255300
+                                   0 COPY_FREE_VARS           2
+                     
+                     584           2 RESUME                   0
+                                   4 BUILD_LIST               0
+                                   6 LOAD_FAST                0 (.0)
+                             >>    8 FOR_ITER                36 (to 82)
+                                  10 UNPACK_SEQUENCE          2
+                                  14 STORE_FAST               1 (e)
+                                  16 STORE_FAST               2 (fs)
+                                  18 PUSH_NULL
+                                  20 LOAD_DEREF               4 (self)
+                                  22 LOAD_ATTR                0 (_etsc_cls)
+                                  32 PUSH_NULL
+                                  34 LOAD_DEREF               3 (proj)
+                                  36 LOAD_DEREF               4 (self)
+                                  38 LOAD_ATTR                1 (event_series)
+                                  48 LOAD_FAST                1 (e)
+                                  50 BINARY_SUBSCR
+                                  60 LOAD_FAST                2 (fs)
+                                  62 PRECALL                  2
+                                  66 CALL                     2
+                                  76 CALL_FUNCTION_EX         0
+                                  78 LIST_APPEND              2
+                                  80 JUMP_BACKWARD           37 (to 8)
+                             >>   82 RETURN_VALUE
+                     consts
+                     names      ('_etsc_cls', 'event_series')
+                     varnames   ('.0', 'e', 'fs')
+                     freevars   ('proj', 'self')
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       '<listcomp>'
+                     firstlineno 584
+                     lnotab 0x
+                  code
+                     argcount  : 1
+                     nlocals   : 3
+                     stacksize : 8
+                     flags     : 16777235
+                     code
+                        0x9502970067007c005d245c0200007d017d02020089046a000000000000
+                        0000000200890389046a0100000000000000007c01190000000000000000
+                        007c02a6020000ab0200000000000000008e0091028c255300
+                                   0 COPY_FREE_VARS           2
+                     
+                     585           2 RESUME                   0
+                                   4 BUILD_LIST               0
+                                   6 LOAD_FAST                0 (.0)
+                             >>    8 FOR_ITER                36 (to 82)
+                                  10 UNPACK_SEQUENCE          2
+                                  14 STORE_FAST               1 (m)
+                                  16 STORE_FAST               2 (fs)
+                                  18 PUSH_NULL
+                                  20 LOAD_DEREF               4 (self)
+                                  22 LOAD_ATTR                0 (_mtsc_cls)
+                                  32 PUSH_NULL
+                                  34 LOAD_DEREF               3 (proj)
+                                  36 LOAD_DEREF               4 (self)
+                                  38 LOAD_ATTR                1 (measurement_series)
+                                  48 LOAD_FAST                1 (m)
+                                  50 BINARY_SUBSCR
+                                  60 LOAD_FAST                2 (fs)
+                                  62 PRECALL                  2
+                                  66 CALL                     2
+                                  76 CALL_FUNCTION_EX         0
+                                  78 LIST_APPEND              2
+                                  80 JUMP_BACKWARD           37 (to 8)
+                             >>   82 RETURN_VALUE
+                     consts
+                     names      ('_mtsc_cls', 'measurement_series')
+                     varnames   ('.0', 'm', 'fs')
+                     freevars   ('proj', 'self')
+                     cellvars   ()
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+                     name       '<listcomp>'
+                     firstlineno 585
+                     lnotab 0x
                   ('labels',)
-                  ('index_frame',)
-               names      ('items', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'measurement_specs', 'features', 'measurement_series', 'timeseries_spec', 'project', 'df', 'loc', 'MDConcepts', 'base_columns', 'list', 'copy', 'append', '_mtsc_cls', 'mangle_arg_to_tuple', 'event_specs', 'keys', 'event_series', '_etsc_cls', 'create_index_view', 'itertools', 'chain', '__class__', 'meta')
-               varnames   ('self', 'measurement_feature_selection', 'event_feature_selection', 'project_underlying_dfs', 'copy_underlying_dfs', 'ms', 'm', 'fs', 'mtc', 'tspec', 'df', 'es', 'etc', 'index_view')
+                  True
+                  ('meta', 'events', 'measurements', 'index_frame', 'lazy_index_creation', 'lazy_map_creation')
+                  ('tsc', 'TimeseriesContainerProtocol')
+               names      ('items', 'create_index_view', 'itertools', 'chain', 'keys', 'copy', '__class__', 'of', 'meta')
+               varnames   ('self', 'event_feature_selection', 'measurement_feature_selection', 'project_underlying_dfs', 'copy_underlying_dfs', 'es', 'ms', 'index_view')
                freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               cellvars   ('self', 'project_underlying_dfs', 'copy_underlying_dfs', 'proj')
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'project'
-               firstlineno 456
-               lnotab
-                  0x02050401040104010401040132011a01220102fe12031a0134017c0104
-                  0128015401040132011a0132ff12021a0134017c01040128015402180170
-                  ff120204012801
+               firstlineno 570
+               lnotab 0x0a060e0842010a0126ff1203180170ff1202040128013401020102fe
             'other'
+            'MachineDataProtocol'
             code
                argcount  : 2
                nlocals   : 8
                stacksize : 4
                flags     : 16777219
                code
                   0x97007c006a0000000000000000007c016a0000000000000000006b0300
-                  0000007202640153007c006a010000000000000000a00200000000000000
-                  00000000000000000000000000a6000000ab00000000000000000044005d
-                  395c0200007d027d037c016a010000000000000000a00300000000000000
-                  000000000000000000000000007c02a6010000ab01000000000000000078
-                  017d0472187c03a00400000000000000000000000000000000000000007c
-                  04a6010000ab01000000000000000073030100640153008c3a7c006a0500
-                  00000000000000a0020000000000000000000000000000000000000000a6
-                  000000ab00000000000000000044005d395c0200007d057d067c016a0500
-                  00000000000000a00300000000000000000000000000000000000000007c
-                  05a6010000ab01000000000000000078017d0772187c06a0040000000000
-                  0000000000000000000000000000007c07a6010000ab0100000000000000
-                  0073030100640153008c3a64025300
-               493           0 RESUME                   0
+                  0000007202640153007c017d017c006a010000000000000000a002000000
+                  0000000000000000000000000000000000a6000000ab0000000000000000
+                  0044005d395c0200007d027d037c016a010000000000000000a003000000
+                  00000000000000000000000000000000007c02a6010000ab010000000000
+                  00000078017d0472187c03a0040000000000000000000000000000000000
+                  0000007c04a6010000ab01000000000000000073030100640153008c3a7c
+                  006a050000000000000000a0020000000000000000000000000000000000
+                  000000a6000000ab00000000000000000044005d395c0200007d057d067c
+                  016a050000000000000000a0030000000000000000000000000000000000
+                  0000007c05a6010000ab01000000000000000078017d0772187c06a00400
+                  000000000000000000000000000000000000007c07a6010000ab01000000
+                  000000000073030100640153008c3a64025300
+               596           0 RESUME                   0
                
-               494           2 LOAD_FAST                0 (self)
+               597           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (__class__)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_ATTR                0 (__class__)
                             26 COMPARE_OP               3 (!=)
                             32 POP_JUMP_FORWARD_IF_FALSE     2 (to 38)
                
-               495          34 LOAD_CONST               1 (False)
+               598          34 LOAD_CONST               1 (False)
                             36 RETURN_VALUE
                
-               496     >>   38 LOAD_FAST                0 (self)
-                            40 LOAD_ATTR                1 (event_specs)
-                            50 LOAD_METHOD              2 (items)
-                            72 PRECALL                  0
-                            76 CALL                     0
-                            86 GET_ITER
-                       >>   88 FOR_ITER                57 (to 204)
-                            90 UNPACK_SEQUENCE          2
-                            94 STORE_FAST               2 (e)
-                            96 STORE_FAST               3 (et)
-               
-               497          98 LOAD_FAST                1 (other)
-                           100 LOAD_ATTR                1 (event_specs)
-                           110 LOAD_METHOD              3 (get)
-                           132 LOAD_FAST                2 (e)
-                           134 PRECALL                  1
-                           138 CALL                     1
-                           148 COPY                     1
-                           150 STORE_FAST               4 (o_et)
-                           152 POP_JUMP_FORWARD_IF_FALSE    24 (to 202)
-               
-               498         154 LOAD_FAST                3 (et)
-                           156 LOAD_METHOD              4 (is_mergeable)
-                           178 LOAD_FAST                4 (o_et)
-                           180 PRECALL                  1
-                           184 CALL                     1
-                           194 POP_JUMP_FORWARD_IF_TRUE     3 (to 202)
-               
-               499         196 POP_TOP
-                           198 LOAD_CONST               1 (False)
-                           200 RETURN_VALUE
-                       >>  202 JUMP_BACKWARD           58 (to 88)
-               
-               500     >>  204 LOAD_FAST                0 (self)
-                           206 LOAD_ATTR                5 (measurement_specs)
-                           216 LOAD_METHOD              2 (items)
-                           238 PRECALL                  0
-                           242 CALL                     0
-                           252 GET_ITER
-                       >>  254 FOR_ITER                57 (to 370)
-                           256 UNPACK_SEQUENCE          2
-                           260 STORE_FAST               5 (m)
-                           262 STORE_FAST               6 (mt)
-               
-               501         264 LOAD_FAST                1 (other)
-                           266 LOAD_ATTR                5 (measurement_specs)
-                           276 LOAD_METHOD              3 (get)
-                           298 LOAD_FAST                5 (m)
-                           300 PRECALL                  1
-                           304 CALL                     1
-                           314 COPY                     1
-                           316 STORE_FAST               7 (o_mt)
-                           318 POP_JUMP_FORWARD_IF_FALSE    24 (to 368)
-               
-               502         320 LOAD_FAST                6 (mt)
-                           322 LOAD_METHOD              4 (is_mergeable)
-                           344 LOAD_FAST                7 (o_mt)
-                           346 PRECALL                  1
-                           350 CALL                     1
-                           360 POP_JUMP_FORWARD_IF_TRUE     3 (to 368)
-               
-               503         362 POP_TOP
-                           364 LOAD_CONST               1 (False)
-                           366 RETURN_VALUE
-                       >>  368 JUMP_BACKWARD           58 (to 254)
+               599     >>   38 LOAD_FAST                1 (other)
+                            40 STORE_FAST               1 (other)
+               
+               600          42 LOAD_FAST                0 (self)
+                            44 LOAD_ATTR                1 (event_specs)
+                            54 LOAD_METHOD              2 (items)
+                            76 PRECALL                  0
+                            80 CALL                     0
+                            90 GET_ITER
+                       >>   92 FOR_ITER                57 (to 208)
+                            94 UNPACK_SEQUENCE          2
+                            98 STORE_FAST               2 (e)
+                           100 STORE_FAST               3 (et)
+               
+               601         102 LOAD_FAST                1 (other)
+                           104 LOAD_ATTR                1 (event_specs)
+                           114 LOAD_METHOD              3 (get)
+                           136 LOAD_FAST                2 (e)
+                           138 PRECALL                  1
+                           142 CALL                     1
+                           152 COPY                     1
+                           154 STORE_FAST               4 (o_et)
+                           156 POP_JUMP_FORWARD_IF_FALSE    24 (to 206)
+               
+               602         158 LOAD_FAST                3 (et)
+                           160 LOAD_METHOD              4 (is_mergeable)
+                           182 LOAD_FAST                4 (o_et)
+                           184 PRECALL                  1
+                           188 CALL                     1
+                           198 POP_JUMP_FORWARD_IF_TRUE     3 (to 206)
+               
+               603         200 POP_TOP
+                           202 LOAD_CONST               1 (False)
+                           204 RETURN_VALUE
+                       >>  206 JUMP_BACKWARD           58 (to 92)
+               
+               604     >>  208 LOAD_FAST                0 (self)
+                           210 LOAD_ATTR                5 (measurement_specs)
+                           220 LOAD_METHOD              2 (items)
+                           242 PRECALL                  0
+                           246 CALL                     0
+                           256 GET_ITER
+                       >>  258 FOR_ITER                57 (to 374)
+                           260 UNPACK_SEQUENCE          2
+                           264 STORE_FAST               5 (m)
+                           266 STORE_FAST               6 (mt)
+               
+               605         268 LOAD_FAST                1 (other)
+                           270 LOAD_ATTR                5 (measurement_specs)
+                           280 LOAD_METHOD              3 (get)
+                           302 LOAD_FAST                5 (m)
+                           304 PRECALL                  1
+                           308 CALL                     1
+                           318 COPY                     1
+                           320 STORE_FAST               7 (o_mt)
+                           322 POP_JUMP_FORWARD_IF_FALSE    24 (to 372)
+               
+               606         324 LOAD_FAST                6 (mt)
+                           326 LOAD_METHOD              4 (is_mergeable)
+                           348 LOAD_FAST                7 (o_mt)
+                           350 PRECALL                  1
+                           354 CALL                     1
+                           364 POP_JUMP_FORWARD_IF_TRUE     3 (to 372)
+               
+               607         366 POP_TOP
+                           368 LOAD_CONST               1 (False)
+                           370 RETURN_VALUE
+                       >>  372 JUMP_BACKWARD           58 (to 258)
                
-               504     >>  370 LOAD_CONST               2 (True)
-                           372 RETURN_VALUE
+               608     >>  374 LOAD_CONST               2 (True)
+                           376 RETURN_VALUE
                consts
                   None
                   False
                   True
                names      ('__class__', 'event_specs', 'items', 'get', 'is_mergeable', 'measurement_specs')
                varnames   ('self', 'other', 'e', 'et', 'o_et', 'm', 'mt', 'o_mt')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'is_mergeable'
-               firstlineno 493
-               lnotab 0x0201200104013c0138012a0108013c0138012a010801
+               firstlineno 596
+               lnotab 0x02012001040104013c0138012a0108013c0138012a010801
             'horizontal'
+            'MachineData'
             'axis'
             "Literal['horizontal', 'vertical']"
             code
                argcount  : 3
-               nlocals   : 4
-               stacksize : 5
-               flags     : 16777219
-               code
-                  0x97007c00a00000000000000000000000000000000000000000007c016a
-                  0100000000000000007c016a0200000000000000007c02ac01a6030000ab
-                  0300000000000000007d037c006a030000000000000000a0040000000000
-                  0000000000000000000000000000007c016a030000000000000000a60100
-                  00ab0100000000000000007c035f0300000000000000007c035300
-               506           0 RESUME                   0
-               
-               508           2 LOAD_FAST                0 (self)
-                             4 LOAD_METHOD              0 (merge_series)
-                            26 LOAD_FAST                1 (other)
-                            28 LOAD_ATTR                1 (event_series)
-                            38 LOAD_FAST                1 (other)
-                            40 LOAD_ATTR                2 (measurement_series)
-                            50 LOAD_FAST                2 (axis)
-                            52 KW_NAMES                 1
-                            54 PRECALL                  3
-                            58 CALL                     3
-                            68 STORE_FAST               3 (result)
-               
-               509          70 LOAD_FAST                0 (self)
-                            72 LOAD_ATTR                3 (meta)
-                            82 LOAD_METHOD              4 (merge)
-                           104 LOAD_FAST                1 (other)
-                           106 LOAD_ATTR                3 (meta)
-                           116 PRECALL                  1
-                           120 CALL                     1
-                           130 LOAD_FAST                3 (result)
-                           132 STORE_ATTR               3 (meta)
-               
-               510         142 LOAD_FAST                3 (result)
-                           144 RETURN_VALUE
-               consts
-                  None
-                  ('axis',)
-               names      ('merge_series', 'event_series', 'measurement_series', 'meta', 'merge')
-               varnames   ('self', 'other', 'axis', 'result')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'merge'
-               firstlineno 506
-               lnotab 0x020244014801
-            'event_series'
-            'dict[EventSpecLabel, ETSC]'
-            'measurement_series'
-            'dict[MeasurementSpecLabel, MTSC]'
-            code
-               argcount  : 4
-               nlocals   : 7
-               stacksize : 6
+               nlocals   : 8
+               stacksize : 9
                flags     : 16777219
                code
-                  0x97007c036401760073024a0082017c0364026b02000000007d047c0180
-                  0269007d017c02800269007d027c006a000000000000000000a001000000
-                  00000000000000000000000000000000007c006a0200000000000000007c
-                  017c03ac03a6030000ab0300000000000000007d057c006a030000000000
-                  000000a00100000000000000000000000000000000000000007c006a0400
-                  000000000000007c027c03ac03a6030000ab0300000000000000007d067c
-                  0472407c00a00500000000000000000000000000000000000000007c006a
-                  0600000000000000007c05a0070000000000000000000000000000000000
-                  000000a6000000ab0000000000000000007c06a007000000000000000000
-                  0000000000000000000000a6000000ab000000000000000000a6030000ab
-                  03000000000000000053007c00a005000000000000000000000000000000
-                  00000000007c006a0600000000000000007c05a007000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000007c06a00700
-                  00000000000000000000000000000000000000a6000000ab000000000000
-                  0000007c006a080000000000000000a6040000ab04000000000000000053
+                  0x97007c026401760073024a0082017c00a0000000000000000000000000
+                  0000000000000000007c01a6010000ab01000000000000000073024a0082
+                  017c006a010000000000000000a002000000000000000000000000000000
+                  00000000007c006a0300000000000000007c016a0300000000000000007c
+                  02ac02a6030000ab0300000000000000005c0200007d037d047c006a0400
+                  00000000000000a00200000000000000000000000000000000000000007c
+                  006a0500000000000000007c016a0500000000000000007c02ac02a60300
+                  00ab0300000000000000005c0200007d057d067c006a0600000000000000
+                  00a00700000000000000000000000000000000000000007c016a06000000
+                  0000000000a6010000ab0100000000000000007d077c006a080000000000
+                  000000a00900000000000000000000000000000000000000007c077c03a0
+                  0a0000000000000000000000000000000000000000a6000000ab00000000
+                  00000000007c05a00a0000000000000000000000000000000000000000a6
+                  000000ab000000000000000000640364037c047c067a070000720264006e
+                  067c006a0b0000000000000000ac04a6060000ab06000000000000000053
                   00
-               512           0 RESUME                   0
+               610           0 RESUME                   0
                
-               515           2 LOAD_FAST                3 (axis)
+               612           2 LOAD_FAST                2 (axis)
                              4 LOAD_CONST               1 (frozenset({'horizontal', 'vertical'}))
                              6 CONTAINS_OP              0
                              8 POP_JUMP_FORWARD_IF_TRUE     2 (to 14)
                             10 LOAD_ASSERTION_ERROR
                             12 RAISE_VARARGS            1
                
-               516     >>   14 LOAD_FAST                3 (axis)
-                            16 LOAD_CONST               2 ('vertical')
-                            18 COMPARE_OP               2 (==)
-                            24 STORE_FAST               4 (recalc_index)
-               
-               517          26 LOAD_FAST                1 (event_series)
-                            28 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 34)
-               
-               518          30 BUILD_MAP                0
-                            32 STORE_FAST               1 (event_series)
-               
-               519     >>   34 LOAD_FAST                2 (measurement_series)
-                            36 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 42)
-               
-               520          38 BUILD_MAP                0
-                            40 STORE_FAST               2 (measurement_series)
-               
-               521     >>   42 LOAD_FAST                0 (self)
-                            44 LOAD_ATTR                0 (_etsc_cls)
-                            54 LOAD_METHOD              1 (lifted_merge)
-                            76 LOAD_FAST                0 (self)
-                            78 LOAD_ATTR                2 (event_series)
-                            88 LOAD_FAST                1 (event_series)
-                            90 LOAD_FAST                3 (axis)
-                            92 KW_NAMES                 3
-                            94 PRECALL                  3
-                            98 CALL                     3
-                           108 STORE_FAST               5 (es)
-               
-               522         110 LOAD_FAST                0 (self)
-                           112 LOAD_ATTR                3 (_mtsc_cls)
-                           122 LOAD_METHOD              1 (lifted_merge)
-                           144 LOAD_FAST                0 (self)
-                           146 LOAD_ATTR                4 (measurement_series)
-                           156 LOAD_FAST                2 (measurement_series)
-                           158 LOAD_FAST                3 (axis)
-                           160 KW_NAMES                 3
-                           162 PRECALL                  3
-                           166 CALL                     3
-                           176 STORE_FAST               6 (ms)
-               
-               523         178 LOAD_FAST                4 (recalc_index)
-                           180 POP_JUMP_FORWARD_IF_FALSE    64 (to 310)
-               
-               524         182 LOAD_FAST                0 (self)
-                           184 LOAD_METHOD              5 (__class__)
-                           206 LOAD_FAST                0 (self)
-                           208 LOAD_ATTR                6 (meta)
-                           218 LOAD_FAST                5 (es)
-                           220 LOAD_METHOD              7 (values)
-                           242 PRECALL                  0
-                           246 CALL                     0
-                           256 LOAD_FAST                6 (ms)
-                           258 LOAD_METHOD              7 (values)
-                           280 PRECALL                  0
-                           284 CALL                     0
-                           294 PRECALL                  3
-                           298 CALL                     3
-                           308 RETURN_VALUE
-               
-               526     >>  310 LOAD_FAST                0 (self)
-                           312 LOAD_METHOD              5 (__class__)
-                           334 LOAD_FAST                0 (self)
-                           336 LOAD_ATTR                6 (meta)
-                           346 LOAD_FAST                5 (es)
-                           348 LOAD_METHOD              7 (values)
-                           370 PRECALL                  0
-                           374 CALL                     0
-                           384 LOAD_FAST                6 (ms)
-                           386 LOAD_METHOD              7 (values)
-                           408 PRECALL                  0
-                           412 CALL                     0
-                           422 LOAD_FAST                0 (self)
-                           424 LOAD_ATTR                8 (index_frame)
-                           434 PRECALL                  4
-                           438 CALL                     4
+               613     >>   14 LOAD_FAST                0 (self)
+                            16 LOAD_METHOD              0 (is_mergeable)
+                            38 LOAD_FAST                1 (other)
+                            40 PRECALL                  1
+                            44 CALL                     1
+                            54 POP_JUMP_FORWARD_IF_TRUE     2 (to 60)
+                            56 LOAD_ASSERTION_ERROR
+                            58 RAISE_VARARGS            1
+               
+               614     >>   60 LOAD_FAST                0 (self)
+                            62 LOAD_ATTR                1 (_etsc_cls)
+                            72 LOAD_METHOD              2 (lifted_merge)
+                            94 LOAD_FAST                0 (self)
+                            96 LOAD_ATTR                3 (event_series)
+                           106 LOAD_FAST                1 (other)
+                           108 LOAD_ATTR                3 (event_series)
+                           118 LOAD_FAST                2 (axis)
+                           120 KW_NAMES                 2
+                           122 PRECALL                  3
+                           126 CALL                     3
+                           136 UNPACK_SEQUENCE          2
+                           140 STORE_FAST               3 (es)
+                           142 STORE_FAST               4 (e_index_change)
+               
+               615         144 LOAD_FAST                0 (self)
+                           146 LOAD_ATTR                4 (_mtsc_cls)
+                           156 LOAD_METHOD              2 (lifted_merge)
+                           178 LOAD_FAST                0 (self)
+                           180 LOAD_ATTR                5 (measurement_series)
+                           190 LOAD_FAST                1 (other)
+                           192 LOAD_ATTR                5 (measurement_series)
+                           202 LOAD_FAST                2 (axis)
+                           204 KW_NAMES                 2
+                           206 PRECALL                  3
+                           210 CALL                     3
+                           220 UNPACK_SEQUENCE          2
+                           224 STORE_FAST               5 (ms)
+                           226 STORE_FAST               6 (m_index_change)
+               
+               616         228 LOAD_FAST                0 (self)
+                           230 LOAD_ATTR                6 (meta)
+                           240 LOAD_METHOD              7 (merge)
+                           262 LOAD_FAST                1 (other)
+                           264 LOAD_ATTR                6 (meta)
+                           274 PRECALL                  1
+                           278 CALL                     1
+                           288 STORE_FAST               7 (meta)
+               
+               617         290 LOAD_FAST                0 (self)
+                           292 LOAD_ATTR                8 (__class__)
+                           302 LOAD_METHOD              9 (of)
+                           324 LOAD_FAST                7 (meta)
+                           326 LOAD_FAST                3 (es)
+                           328 LOAD_METHOD             10 (values)
+                           350 PRECALL                  0
+                           354 CALL                     0
+                           364 LOAD_FAST                5 (ms)
+                           366 LOAD_METHOD             10 (values)
+                           388 PRECALL                  0
+                           392 CALL                     0
+                           402 LOAD_CONST               3 (True)
+               
+               618         404 LOAD_CONST               3 (True)
+               
+               619         406 LOAD_FAST                4 (e_index_change)
+                           408 LOAD_FAST                6 (m_index_change)
+                           410 BINARY_OP                7 (|)
+                           414 POP_JUMP_FORWARD_IF_FALSE     2 (to 420)
+                           416 LOAD_CONST               0 (None)
+                           418 JUMP_FORWARD             6 (to 432)
+                       >>  420 LOAD_FAST                0 (self)
+                           422 LOAD_ATTR               11 (index_frame)
+               
+               617     >>  432 KW_NAMES                 4
+                           434 PRECALL                  6
+                           438 CALL                     6
                            448 RETURN_VALUE
                consts
                   None
                   frozenset({'horizontal', 'vertical'})
-                  'vertical'
                   ('axis',)
-               names      ('_etsc_cls', 'lifted_merge', 'event_series', '_mtsc_cls', 'measurement_series', '__class__', 'meta', 'values', 'index_frame')
-               varnames   ('self', 'event_series', 'measurement_series', 'axis', 'recalc_index', 'es', 'ms')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'merge_series'
-               firstlineno 512
-               lnotab 0x02030c010c0104010401040104014401440104018002
-            'EventSpecLabel'
-            'ETSC'
-            code
-               argcount  : 2
-               nlocals   : 2
-               stacksize : 2
-               flags     : 16777219
-               code 0x97007c006a0000000000000000007c01190000000000000000005300
-               528           0 RESUME                   0
-               
-               529           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (event_series)
-                            14 LOAD_FAST                1 (label)
-                            16 BINARY_SUBSCR
-                            26 RETURN_VALUE
-               consts
-                  None
-               names      ('event_series',)
-               varnames   ('self', 'label')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'get_event_series_collection'
-               firstlineno 528
-               lnotab 0x0201
-            'MeasurementSpecLabel'
-            'MTSC'
-            code
-               argcount  : 2
-               nlocals   : 2
-               stacksize : 2
-               flags     : 16777219
-               code 0x97007c006a0000000000000000007c01190000000000000000005300
-               531           0 RESUME                   0
-               
-               532           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (measurement_series)
-                            14 LOAD_FAST                1 (label)
-                            16 BINARY_SUBSCR
-                            26 RETURN_VALUE
-               consts
-                  None
-               names      ('measurement_series',)
-               varnames   ('self', 'label')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'get_measurement_series_collection'
-               firstlineno 531
-               lnotab 0x0201
-            'str | list[str] | slice'
-            'MTS'
-            code
-               argcount  : 3
-               nlocals   : 4
-               stacksize : 3
-               flags     : 16777227
-               code
-                  0x97007c006a0000000000000000007c0119000000000000000000a00100
-                  000000000000000000000000000000000000007c02ac01a6010000ab0100
-                  000000000000005300
-               534           0 RESUME                   0
-               
-               536           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (measurement_series)
-                            14 LOAD_FAST                1 (label)
-                            16 BINARY_SUBSCR
-                            26 LOAD_METHOD              1 (view)
-                            48 LOAD_FAST                2 (objs)
-                            50 KW_NAMES                 1
-                            52 PRECALL                  1
-                            56 CALL                     1
-                            66 RETURN_VALUE
-               consts
-                  None
-                  ('objs',)
-               names      ('measurement_series', 'view')
-               varnames   ('self', 'label', 'objs', 'kwargs')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'view_measurement_series'
-               firstlineno 534
-               lnotab 0x0202
-            'ETS'
-            code
-               argcount  : 3
-               nlocals   : 4
-               stacksize : 3
-               flags     : 16777227
-               code
-                  0x97007c006a0000000000000000007c0119000000000000000000a00100
-                  000000000000000000000000000000000000007c02ac01a6010000ab0100
-                  000000000000005300
-               538           0 RESUME                   0
-               
-               540           2 LOAD_FAST                0 (self)
-                             4 LOAD_ATTR                0 (event_series)
-                            14 LOAD_FAST                1 (label)
-                            16 BINARY_SUBSCR
-                            26 LOAD_METHOD              1 (view)
-                            48 LOAD_FAST                2 (objs)
-                            50 KW_NAMES                 1
-                            52 PRECALL                  1
-                            56 CALL                     1
-                            66 RETURN_VALUE
-               consts
-                  None
-                  ('objs',)
-               names      ('event_series', 'view')
-               varnames   ('self', 'label', 'objs', 'kwargs')
+                  True
+                  ('meta', 'events', 'measurements', 'lazy_index_creation', 'lazy_map_creation', 'index_frame')
+               names      ('is_mergeable', '_etsc_cls', 'lifted_merge', 'event_series', '_mtsc_cls', 'measurement_series', 'meta', 'merge', '__class__', 'of', 'values', 'index_frame')
+               varnames   ('self', 'other', 'axis', 'es', 'e_index_change', 'ms', 'm_index_change', 'meta')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-               name       'view_event_series'
-               firstlineno 538
-               lnotab 0x0202
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'merge'
+               firstlineno 610
+               lnotab 0x02020c012e01540154013e01720102011afe
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 7
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000740400
@@ -5909,37 +6805,37 @@
                   006a0500000000000000009b0064027c019b0064037c029b0064049d0764
                   057a0000006406740d000000000000000000007c006a0700000000000000
                   00a6010000ab0100000000000000009b009d027a00000064057a00000064
                   07740d000000000000000000007c006a080000000000000000a6010000ab
                   0100000000000000009b009d027a00000064057a0000006408740d000000
                   000000000000007c006a090000000000000000a6010000ab010000000000
                   0000009b009d027a0000005300
-               542           0 RESUME                   0
+               621           0 RESUME                   0
                
-               543           2 LOAD_GLOBAL              1 (NULL + min)
+               622           2 LOAD_GLOBAL              1 (NULL + min)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (index_frame)
                             26 LOAD_GLOBAL              4 (MDConcepts)
                             38 LOAD_ATTR                3 (Time)
                             48 BINARY_SUBSCR
                             58 PRECALL                  1
                             62 CALL                     1
                             72 STORE_FAST               1 (first)
                
-               544          74 LOAD_GLOBAL              9 (NULL + max)
+               623          74 LOAD_GLOBAL              9 (NULL + max)
                             86 LOAD_FAST                0 (self)
                             88 LOAD_ATTR                1 (index_frame)
                             98 LOAD_GLOBAL              4 (MDConcepts)
                            110 LOAD_ATTR                3 (Time)
                            120 BINARY_SUBSCR
                            130 PRECALL                  1
                            134 CALL                     1
                            144 STORE_FAST               2 (last)
                
-               545         146 LOAD_CONST               1 ('#Observations: ')
+               624         146 LOAD_CONST               1 ('#Observations: ')
                            148 LOAD_FAST                0 (self)
                            150 LOAD_ATTR                5 (observation_count)
                            160 FORMAT_VALUE             0
                            162 LOAD_CONST               2 (' between ')
                            164 LOAD_FAST                1 (first)
                            166 FORMAT_VALUE             0
                            168 LOAD_CONST               3 (' and ')
@@ -5948,15 +6844,15 @@
                            174 LOAD_CONST               4 ('.')
                            176 BUILD_STRING             7
                            178 LOAD_CONST               5 ('\n')
                            180 BINARY_OP                0 (+)
                            184 LOAD_CONST               6 ('#Objects: ')
                            186 LOAD_GLOBAL             13 (NULL + len)
                            198 LOAD_FAST                0 (self)
-                           200 LOAD_ATTR                7 (occurring_objects)
+                           200 LOAD_ATTR                7 (objects)
                            210 PRECALL                  1
                            214 CALL                     1
                            224 FORMAT_VALUE             0
                            226 BUILD_STRING             2
                            228 BINARY_OP                0 (+)
                            232 LOAD_CONST               5 ('\n')
                            234 BINARY_OP                0 (+)
@@ -5987,21 +6883,21 @@
                   ' between '
                   ' and '
                   '.'
                   '\n'
                   '#Objects: '
                   '#Event Specs: '
                   '#Measurement Specs: '
-               names      ('min', 'index_frame', 'MDConcepts', 'Time', 'max', 'observation_count', 'len', 'occurring_objects', 'event_specs', 'measurement_specs')
+               names      ('min', 'index_frame', 'MDConcepts', 'Time', 'max', 'observation_count', 'len', 'objects', 'event_specs', 'measurement_specs')
                varnames   ('self', 'first', 'last')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       'summary'
-               firstlineno 542
+               firstlineno 621
                lnotab 0x020148014801
             code
                argcount  : 1
                nlocals   : 5
                stacksize : 4
                flags     : 16777219
                code
@@ -6010,129 +6906,129 @@
                   00ab0100000000000000007d0364026403a0020000000000000000000000
                   0000000000000000007c006a030000000000000000a6010000ab01000000
                   00000000007a0000007d0464047c0264056b0300000000720564067c027a
                   0000006e0164077a00000064067a00000064087a0000007c0364056b0300
                   000000720564067c037a0000006e0164077a00000064067a00000064097a
                   0000007c047a00000064067a000000640a7c006a0400000000000000009b
                   009d027a00000064067a000000640b7a0000005300
-               547           0 RESUME                   0
+               626           0 RESUME                   0
                
-               548           2 LOAD_CONST               1 (<code object spec_strings, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 548>)
+               627           2 LOAD_CONST               1 (<code object spec_strings, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 627>)
                              4 MAKE_FUNCTION            0
                              6 STORE_FAST               1 (spec_strings)
                
-               551           8 PUSH_NULL
+               630           8 PUSH_NULL
                             10 LOAD_FAST                1 (spec_strings)
                             12 LOAD_FAST                0 (self)
                             14 LOAD_ATTR                0 (event_specs)
                             24 PRECALL                  1
                             28 CALL                     1
-                            38 STORE_FAST               2 (especs)
+                            38 STORE_FAST               2 (e_specs)
                
-               552          40 PUSH_NULL
+               631          40 PUSH_NULL
                             42 LOAD_FAST                1 (spec_strings)
                             44 LOAD_FAST                0 (self)
                             46 LOAD_ATTR                1 (measurement_specs)
                             56 PRECALL                  1
                             60 CALL                     1
-                            70 STORE_FAST               3 (mspecs)
+                            70 STORE_FAST               3 (m_specs)
                
-               553          72 LOAD_CONST               2 (' ')
+               632          72 LOAD_CONST               2 (' ')
                             74 LOAD_CONST               3 (', ')
                             76 LOAD_METHOD              2 (join)
                             98 LOAD_FAST                0 (self)
-                           100 LOAD_ATTR                3 (occurring_objects)
+                           100 LOAD_ATTR                3 (objects)
                            110 PRECALL                  1
                            114 CALL                     1
                            124 BINARY_OP                0 (+)
                            128 STORE_FAST               4 (objs)
                
-               554         130 LOAD_CONST               4 ('MachineData {\nEvent Specs:')
+               633         130 LOAD_CONST               4 ('MachineData {\nEvent Specs:')
                
-               555         132 LOAD_FAST                2 (especs)
+               634         132 LOAD_FAST                2 (e_specs)
                            134 LOAD_CONST               5 ('')
                            136 COMPARE_OP               3 (!=)
                            142 POP_JUMP_FORWARD_IF_FALSE     5 (to 154)
                            144 LOAD_CONST               6 ('\n')
-                           146 LOAD_FAST                2 (especs)
+                           146 LOAD_FAST                2 (e_specs)
                            148 BINARY_OP                0 (+)
                            152 JUMP_FORWARD             1 (to 156)
                        >>  154 LOAD_CONST               7 ('[]')
                
-               554     >>  156 BINARY_OP                0 (+)
+               633     >>  156 BINARY_OP                0 (+)
                
-               555         160 LOAD_CONST               6 ('\n')
+               634         160 LOAD_CONST               6 ('\n')
                
-               554         162 BINARY_OP                0 (+)
+               633         162 BINARY_OP                0 (+)
                
-               555         166 LOAD_CONST               8 ('Measurement Specs:')
+               634         166 LOAD_CONST               8 ('Measurement Specs:')
                
-               554         168 BINARY_OP                0 (+)
+               633         168 BINARY_OP                0 (+)
                
-               556         172 LOAD_FAST                3 (mspecs)
+               635         172 LOAD_FAST                3 (m_specs)
                            174 LOAD_CONST               5 ('')
                            176 COMPARE_OP               3 (!=)
                            182 POP_JUMP_FORWARD_IF_FALSE     5 (to 194)
                            184 LOAD_CONST               6 ('\n')
-                           186 LOAD_FAST                3 (mspecs)
+                           186 LOAD_FAST                3 (m_specs)
                            188 BINARY_OP                0 (+)
                            192 JUMP_FORWARD             1 (to 196)
                        >>  194 LOAD_CONST               7 ('[]')
                
-               554     >>  196 BINARY_OP                0 (+)
+               633     >>  196 BINARY_OP                0 (+)
                
-               556         200 LOAD_CONST               6 ('\n')
+               635         200 LOAD_CONST               6 ('\n')
                
-               554         202 BINARY_OP                0 (+)
+               633         202 BINARY_OP                0 (+)
                
-               556         206 LOAD_CONST               9 ('Objects:')
+               635         206 LOAD_CONST               9 ('Objects:')
                
-               554         208 BINARY_OP                0 (+)
+               633         208 BINARY_OP                0 (+)
                
-               556         212 LOAD_FAST                4 (objs)
+               635         212 LOAD_FAST                4 (objs)
                
-               554         214 BINARY_OP                0 (+)
+               633         214 BINARY_OP                0 (+)
                
-               556         218 LOAD_CONST               6 ('\n')
+               635         218 LOAD_CONST               6 ('\n')
                
-               554         220 BINARY_OP                0 (+)
+               633         220 BINARY_OP                0 (+)
                
-               556         224 LOAD_CONST              10 ('Observations: ')
+               635         224 LOAD_CONST              10 ('Observations: ')
                            226 LOAD_FAST                0 (self)
                            228 LOAD_ATTR                4 (observation_count)
                            238 FORMAT_VALUE             0
                            240 BUILD_STRING             2
                
-               554         242 BINARY_OP                0 (+)
+               633         242 BINARY_OP                0 (+)
                
-               556         246 LOAD_CONST               6 ('\n')
+               635         246 LOAD_CONST               6 ('\n')
                
-               554         248 BINARY_OP                0 (+)
+               633         248 BINARY_OP                0 (+)
                
-               556         252 LOAD_CONST              11 ('}')
+               635         252 LOAD_CONST              11 ('}')
                
-               554         254 BINARY_OP                0 (+)
+               633         254 BINARY_OP                0 (+)
                            258 RETURN_VALUE
                consts
                   None
                   code
                      argcount  : 1
                      nlocals   : 1
                      stacksize : 5
                      flags     : 16777235
                      code
                         0x97006401a0000000000000000000000000000000000000000000640284
                         007c00a0010000000000000000000000000000000000000000a6000000ab
                         0000000000000000004400a6000000ab000000000000000000a6010000ab
                         0100000000000000005300
-                     548           0 RESUME                   0
+                     627           0 RESUME                   0
                      
-                     549           2 LOAD_CONST               1 ('\n')
+                     628           2 LOAD_CONST               1 ('\n')
                                    4 LOAD_METHOD              0 (join)
-                                  26 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 549>)
+                                  26 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 628>)
                                   28 MAKE_FUNCTION            0
                                   30 LOAD_FAST                0 (specs_dict)
                                   32 LOAD_METHOD              1 (items)
                                   54 PRECALL                  0
                                   58 CALL                     0
                                   68 GET_ITER
                                   70 PRECALL                  0
@@ -6148,23 +7044,23 @@
                            nlocals   : 3
                            stacksize : 8
                            flags     : 16777235
                            code
                               0x970067007c005d255c0200007d017d0264007c019b0064016402a00000
                               000000000000000000000000000000000000007c026a0100000000000000
                               00a6010000ab0100000000000000009b009d0491028c265300
-                           549           0 RESUME                   0
+                           628           0 RESUME                   0
                                          2 BUILD_LIST               0
                                          4 LOAD_FAST                0 (.0)
                                    >>    6 FOR_ITER                37 (to 82)
                                          8 UNPACK_SEQUENCE          2
-                                        12 STORE_FAST               1 (l)
+                                        12 STORE_FAST               1 (label)
                                         14 STORE_FAST               2 (tspec)
                                         16 LOAD_CONST               0 ('\t')
-                                        18 LOAD_FAST                1 (l)
+                                        18 LOAD_FAST                1 (label)
                                         20 FORMAT_VALUE             0
                                         22 LOAD_CONST               1 (': ')
                                         24 LOAD_CONST               2 (', ')
                                         26 LOAD_METHOD              0 (join)
                                         48 LOAD_FAST                2 (tspec)
                                         50 LOAD_ATTR                1 (features)
                                         60 PRECALL                  1
@@ -6175,145 +7071,289 @@
                                         80 JUMP_BACKWARD           38 (to 6)
                                    >>   82 RETURN_VALUE
                            consts
                               '\t'
                               ': '
                               ', '
                            names      ('join', 'features')
-                           varnames   ('.0', 'l', 'tspec')
+                           varnames   ('.0', 'label', 'tspec')
                            freevars   ()
                            cellvars   ()
-                           filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                           filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                            name       '<listcomp>'
-                           firstlineno 549
+                           firstlineno 628
                            lnotab 0x
                      names      ('join', 'items')
                      varnames   ('specs_dict',)
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+                     filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                      name       'spec_strings'
-                     firstlineno 548
+                     firstlineno 627
                      lnotab 0x0201
                   ' '
                   ', '
                   'MachineData {\nEvent Specs:'
                   ''
                   '\n'
                   '[]'
                   'Measurement Specs:'
                   'Objects:'
                   'Observations: '
                   '}'
-               names      ('event_specs', 'measurement_specs', 'join', 'occurring_objects', 'observation_count')
-               varnames   ('self', 'spec_strings', 'especs', 'mspecs', 'objs')
+               names      ('event_specs', 'measurement_specs', 'join', 'objects', 'observation_count')
+               varnames   ('self', 'spec_strings', 'e_specs', 'm_specs', 'objs')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__str__'
-               firstlineno 547
+               firstlineno 626
                lnotab
                   0x02010603200120013a01020118ff040102ff040102ff040218fe040202
                   fe040202fe040202fe040202fe040212fe040202fe040202fe
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c00a6010000ab0100000000000000
                   005300
-               558           0 RESUME                   0
+               637           0 RESUME                   0
                
-               559           2 LOAD_GLOBAL              1 (NULL + str)
+               638           2 LOAD_GLOBAL              1 (NULL + str)
                             14 LOAD_FAST                0 (self)
                             16 PRECALL                  1
                             20 CALL                     1
                             30 RETURN_VALUE
                consts
                   None
                names      ('str',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '__repr__'
-               firstlineno 558
+               firstlineno 637
                lnotab 0x0201
             (None,)
             ('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'index_frame', 'pd.DataFrame', 'return', 'None')
+            ('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'return', 'typing.Self')
+            ('return', 'Header')
             ('return', 'pd.DataFrame')
             ('value', 'pd.DataFrame')
-            ('return', 'set[str]')
+            ('return', 'Set[str]')
             ('return', 'int')
-            ('return', 'list[ETSC | MTSC]')
-            ('cls', 'type[AMD]', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'meta', 'Meta', 'return', 'AMD')
+            ('return', 'tuple[Union[ETSC | MTSC], ...]')
+            ('return', 'Mapping[EventSpecLabel, ETSSpec]')
+            ('return', 'Mapping[MeasurementSpecLabel, MTSSpec]')
+            ('item', 'ObservationSpecIdentifier', 'return', 'ETSC | MTSC')
+            ('item', 'object', 'return', 'bool')
+            ('return', 'Iterator[ETSC | MTSC]')
+            ('identifier', 'ObservationSpecIdentifier', 'return', 'ETSSpec | MTSSpec')
+            ('label', 'EventSpecLabel', 'return', 'ETSC')
+            ('label', 'MeasurementSpecLabel', 'return', 'MTSC')
+            ('label', 'EventSpecLabel', 'objs', 'StrIndexer', 'return', 'ETSView')
+            ('label', 'MeasurementSpecLabel', 'objs', 'StrIndexer', 'return', 'MTSView')
             (True, True)
             (False,)
-            ('return', 'Iterable[TypedTimeseriesCollection]')
-            (None, None, True)
+            (None, None, True, False)
             ('event_series_labels', 'Iterable[EventSpecLabel] | bool', 'measurement_series_labels', 'Iterable[MeasurementSpecLabel] | bool')
             (None, None, None, None, None, None)
-            ('typ', 'ObservationTypeType', 'types', 'Collection[ObservationTypeType]', 'obj', 'str', 'objs', 'Iterable[str]', 'label', 'ObservationTypeLabel', 'labels', 'Iterable[ObservationTypeLabel]', 'return', 'pd.DataFrame')
-            (None, None, False, False)
-            ('self', 'AMD', 'measurement_feature_selection', 'dict[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'event_feature_selection', 'dict[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'return', 'AMD')
-            ('other', 'AbstractMachineData')
+            ('typ', 'ObservationTypeValue', 'types', 'Iterable[ObservationTypeValue]', 'obj', 'str', 'objs', 'Iterable[str]', 'label', 'ObservationSpecLabel', 'labels', 'Iterable[ObservationSpecLabel]', 'return', 'pd.DataFrame')
+            ('event_feature_selection', 'Mapping[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'measurement_feature_selection', 'Mapping[MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]]', 'return', 'typing.Self')
+            ('other', 'MachineDataProtocol', 'return', 'bool')
             ('horizontal',)
-            ('self', 'AMD', 'other', 'AMD', 'axis', "Literal['horizontal', 'vertical']", 'return', 'AMD')
-            ('event_series', 'dict[EventSpecLabel, ETSC]', 'measurement_series', 'dict[MeasurementSpecLabel, MTSC]', 'axis', "Literal['horizontal', 'vertical']", 'return', 'AMD')
-            ('label', 'EventSpecLabel', 'return', 'ETSC')
-            ('label', 'MeasurementSpecLabel', 'return', 'MTSC')
-            ('label', 'MeasurementSpecLabel', 'objs', 'str | list[str] | slice', 'return', 'MTS')
-            ('label', 'EventSpecLabel', 'objs', 'str | list[str] | slice', 'return', 'ETS')
-         names      ('__name__', '__module__', '__qualname__', '_etsc_cls', '__annotations__', '_mtsc_cls', '__init__', 'property', 'header', 'index_frame', 'setter', 'occurring_objects', 'observation_count', 'series_containers', 'classmethod', 'Meta', 'from_series', 'recalculate_index', '_repopulate_maps', 'fit_to_data', 'iter_all_timeseries', 'create_joined_df', 'create_index_view', 'project', 'is_mergeable', 'merge', 'merge_series', 'get_event_series_collection', 'get_measurement_series_collection', 'slice', 'view_measurement_series', 'view_event_series', 'summary', '__str__', '__repr__')
+            ('other', 'MachineData', 'axis', "Literal['horizontal', 'vertical']", 'return', 'MachineData')
+            ('return', 'str')
+         names      ('__name__', '__module__', '__qualname__', '_etsc_cls', '__annotations__', '_mtsc_cls', '__init__', 'classmethod', 'Meta', 'of', 'property', 'header', 'index_frame', 'setter', 'objects', 'observation_count', 'series_containers', 'event_specs', 'measurement_specs', '__getitem__', '__contains__', '__len__', '__iter__', 'get_spec', 'get_events', 'get_measurements', 'slice', 'view_event_series', 'view_measurement_series', 'recalculate_index', '_repopulate_maps', 'fit_to_data', 'create_joined_df', 'create_index_view', 'immutabledict', 'project', 'is_mergeable', 'merge', 'summary', '__str__', '__repr__')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'AbstractMachineData'
-         firstlineno 332
+         firstlineno 362
          lnotab
-            0x0c010e010e0402fe0a0c020104ff0e010204020106ff0e0102050c0106
-            ff0e010203020106ff0e010203020106ff0e010203020106ff0e01020302
-            0214ff08ff0e01020708050607081108030201020102fe0a110201020102
-            0102fd0a1a0201020102fc0a25080e02ff0a0802fe0a10080308031e041e
-            040605060b
+            0x0c010e010e0402fe0a180201140106ff08ff0e01020b020106ff0e0102
+            04020106ff0e0102050c0106ff0e010203020106ff0e010205020106ff0e
+            010203020106ff0e010205020106ff0e010205020106ff0e010205080a08
+            0908030803080d080308031e041e040805060808100201020102fe0a1402
+            010201020102fd0a1a1202120104fb0a1a080f02ff0a0b0805060b
+      'AbstractMachineData'
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 1
+         stacksize : 6
          flags     : 16777216
-         code 0x970065005a0164005a0265035a0465055a0664015300
-         562           0 RESUME                   0
-                       2 LOAD_NAME                0 (__name__)
-                       4 STORE_NAME               1 (__module__)
-                       6 LOAD_CONST               0 ('MachineData')
-                       8 STORE_NAME               2 (__qualname__)
+         code
+            0x8700970065005a0164005a0265035a0465055a06650702006508a60000
+            00ab00000000000000000064016401640264026605641088006601640a84
+            0da6000000ab0000000000000000005a096411641288006601640f840d5a
+            0a880078015a0b5300
+                       0 MAKE_CELL                0 (__class__)
          
-         564          10 LOAD_NAME                3 (EventTimeseriesCollection)
-                      12 STORE_NAME               4 (_etsc_cls)
+         641           2 RESUME                   0
+                       4 LOAD_NAME                0 (__name__)
+                       6 STORE_NAME               1 (__module__)
+                       8 LOAD_CONST               0 ('BaseMachineData')
+                      10 STORE_NAME               2 (__qualname__)
          
-         565          14 LOAD_NAME                5 (MeasurementTimeseriesCollection)
-                      16 STORE_NAME               6 (_mtsc_cls)
-                      18 LOAD_CONST               1 (None)
-                      20 RETURN_VALUE
+         643          12 LOAD_NAME                3 (EventTimeseriesContainer)
+                      14 STORE_NAME               4 (_etsc_cls)
+         
+         644          16 LOAD_NAME                5 (MeasurementTimeseriesContainer)
+                      18 STORE_NAME               6 (_mtsc_cls)
+         
+         646          20 LOAD_NAME                7 (classmethod)
+         
+         647          22 PUSH_NULL
+                      24 LOAD_NAME                8 (Meta)
+                      26 PRECALL                  0
+                      30 CALL                     0
+                      40 LOAD_CONST               1 (())
+                      42 LOAD_CONST               1 (())
+         
+         648          44 LOAD_CONST               2 (True)
+         
+         649          46 LOAD_CONST               2 (True)
+         
+         647          48 BUILD_TUPLE              5
+                      50 LOAD_CONST              16 (('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'return', 'BaseMachineData'))
+                      52 LOAD_CLOSURE             0 (__class__)
+                      54 BUILD_TUPLE              1
+                      56 LOAD_CONST              10 (<code object of, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 646>)
+                      58 MAKE_FUNCTION           13 (defaults, annotations, closure)
+         
+         646          60 PRECALL                  0
+                      64 CALL                     0
+         
+         647          74 STORE_NAME               9 (of)
+         
+         653          76 LOAD_CONST              17 (('horizontal',))
+                      78 LOAD_CONST              18 (('other', 'BaseMachineData', 'axis', "Literal['horizontal', 'vertical']", 'return', 'BaseMachineData'))
+                      80 LOAD_CLOSURE             0 (__class__)
+                      82 BUILD_TUPLE              1
+                      84 LOAD_CONST              15 (<code object merge, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 653>)
+                      86 MAKE_FUNCTION           13 (defaults, annotations, closure)
+                      88 STORE_NAME              10 (merge)
+                      90 LOAD_CLOSURE             0 (__class__)
+                      92 COPY                     1
+                      94 STORE_NAME              11 (__classcell__)
+                      96 RETURN_VALUE
          consts
-            'MachineData'
-            None
-         names      ('__name__', '__module__', '__qualname__', 'EventTimeseriesCollection', '_etsc_cls', 'MeasurementTimeseriesCollection', '_mtsc_cls')
+            'BaseMachineData'
+            ()
+            True
+            'meta'
+            'Meta'
+            'events'
+            'Iterable[ETSC]'
+            'measurements'
+            'Iterable[MTSC]'
+            'return'
+            code
+               argcount  : 6
+               nlocals   : 8
+               stacksize : 6
+               flags     : 16777231
+               code
+                  0x950197000200740100000000000000000000a6000000ab000000000000
+                  0000006a0100000000000000007c017c027c0367037c06a20152007c047c
+                  0564019c027c07a4018e015300
+                             0 COPY_FREE_VARS           1
+               
+               646           2 RESUME                   0
+               
+               650           4 PUSH_NULL
+                             6 LOAD_GLOBAL              1 (NULL + super)
+                            18 PRECALL                  0
+                            22 CALL                     0
+                            32 LOAD_ATTR                1 (of)
+                            42 LOAD_FAST                1 (meta)
+                            44 LOAD_FAST                2 (events)
+                            46 LOAD_FAST                3 (measurements)
+                            48 BUILD_LIST               3
+                            50 LOAD_FAST                6 (args)
+                            52 LIST_EXTEND              1
+                            54 LIST_TO_TUPLE
+                            56 LOAD_FAST                4 (lazy_index_creation)
+               
+               651          58 LOAD_FAST                5 (lazy_map_creation)
+               
+               650          60 LOAD_CONST               1 (('lazy_index_creation', 'lazy_map_creation'))
+                            62 BUILD_CONST_KEY_MAP      2
+               
+               651          64 LOAD_FAST                7 (kwargs)
+               
+               650          66 DICT_MERGE               1
+                            68 CALL_FUNCTION_EX         1
+                            70 RETURN_VALUE
+               consts
+                  None
+                  ('lazy_index_creation', 'lazy_map_creation')
+               names      ('super', 'of')
+               varnames   ('cls', 'meta', 'events', 'measurements', 'lazy_index_creation', 'lazy_map_creation', 'args', 'kwargs')
+               freevars   ('__class__',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'of'
+               firstlineno 646
+               lnotab 0x0404360102ff040102ff
+            'horizontal'
+            'other'
+            'axis'
+            "Literal['horizontal', 'vertical']"
+            code
+               argcount  : 3
+               nlocals   : 3
+               stacksize : 4
+               flags     : 16777219
+               code
+                  0x95019700740100000000000000000000a6000000ab0000000000000000
+                  00a00100000000000000000000000000000000000000007c017c02a60200
+                  00ab0200000000000000005300
+                             0 COPY_FREE_VARS           1
+               
+               653           2 RESUME                   0
+               
+               654           4 LOAD_GLOBAL              1 (NULL + super)
+                            16 PRECALL                  0
+                            20 CALL                     0
+                            30 LOAD_METHOD              1 (merge)
+                            52 LOAD_FAST                1 (other)
+                            54 LOAD_FAST                2 (axis)
+                            56 PRECALL                  2
+                            60 CALL                     2
+                            70 RETURN_VALUE
+               consts
+                  None
+               names      ('super', 'merge')
+               varnames   ('self', 'other', 'axis')
+               freevars   ('__class__',)
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+               name       'merge'
+               firstlineno 653
+               lnotab 0x0401
+            ('meta', 'Meta', 'events', 'Iterable[ETSC]', 'measurements', 'Iterable[MTSC]', 'return', 'BaseMachineData')
+            ('horizontal',)
+            ('other', 'BaseMachineData', 'axis', "Literal['horizontal', 'vertical']", 'return', 'BaseMachineData')
+         names      ('__name__', '__module__', '__qualname__', 'EventTimeseriesContainer', '_etsc_cls', 'MeasurementTimeseriesContainer', '_mtsc_cls', 'classmethod', 'Meta', 'of', 'merge', '__classcell__')
          varnames   ()
          freevars   ()
-         cellvars   ()
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
-         name       'MachineData'
-         firstlineno 562
-         lnotab 0x0a020401
-      'MachineData'
+         cellvars   ('__class__',)
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
+         name       'BaseMachineData'
+         firstlineno 641
+         lnotab 0x0c020401040202011601020102fe0cff0e010206
+      'BaseMachineData'
       'series'
-      'Iterable[TypedTimeseriesCollection]'
+      'Iterable[TSContainer]'
+      'return'
+      'pd.DataFrame'
       code
          argcount  : 4
          nlocals   : 13
          stacksize : 7
          flags     : 16777219
          code
             0x870197008901800c7400000000000000000000006a0100000000000000
@@ -6321,175 +7361,177 @@
             007d00640184007c004400a6000000ab0000000000000000007d04740700
             0000000000000000006a040000000000000000740b000000000000000000
             007c04a6010000ab01000000000000000064027a000000740c0000000000
             0000000000ac03a6020000ab0200000000000000007d0574070000000000
             00000000006a0700000000000000007c047c056402640085021900000000
             0000000000ac04a6020000ab020000000000000000010064057c0564053c
             0000007411000000000000000000006a0900000000000000008801660164
-            0684087c004400a6000000ab000000000000000000640764086409ac0aa6
+            0684087c004400a6000000ab000000000000000000640764086407ac09a6
             040000ab0400000000000000007d067c0372e87407000000000000000000
             006a0a00000000000000007c067400000000000000000000006a0b000000
             0000000000190000000000000000006a0c0000000000000000a6010000ab
             0100000000000000007d077c066a0d00000000000000007c071900000000
             00000000007d067c06a00e00000000000000000000000000000000000000
-            0064076407ac0ba6020000ab020000000000000000010074070000000000
+            0064076407ac0aa6020000ab020000000000000000010074070000000000
             00000000006a0f00000000000000007c07a6010000ab0100000000000000
             007d087407000000000000000000006a100000000000000000740b000000
             000000000000007c07a6010000ab010000000000000000a6010000ab0100
             000000000000007c087c073c0000007423000000000000000000007c007c
-            056400640c8502190000000000000000007c056402640085021900000000
+            056400640b8502190000000000000000007c056402640085021900000000
             0000000000a6030000ab03000000000000000044005d405c0300007d097d
             0a7d0b7411000000000000000000006a1200000000000000007c087c0a7c
             0b850219000000000000000000a6010000ab0100000000000000007c096a
             1300000000000000005f1400000000000000007c09a01500000000000000
             00000000000000000000000000a6000000ab00000000000000000001008c
-            416e5b7423000000000000000000007c007c056400640c85021900000000
-            00000000007c0564026400850219000000000000000000a6030000ab0300
-            0000000000000044005d395c0300007d097d0a7d0b741100000000000000
-            0000006a1600000000000000007c0a7c0ba6020000ab0200000000000000
-            007c096a1300000000000000005f1400000000000000007c09a015000000
-            0000000000000000000000000000000000a6000000ab0000000000000000
-            0001008c3a742f000000000000000000007c067400000000000000000000
-            006a1800000000000000007400000000000000000000006a190000000000
-            0000007400000000000000000000006a1a00000000000000006703a60200
-            00ab0200000000000000007d0c7c06a01b00000000000000000000000000
-            000000000000007c0c6409ac0da6020000ab0200000000000000007d067c
-            0272267c0044005d237d097c096a130000000000000000a01b0000000000
-            0000000000000000000000000000007c0c6409ac0da6020000ab02000000
-            00000000007c095f1300000000000000008c247c065300
+            416e7a742d000000000000000000006a170000000000000000742c000000
+            000000000000006a180000000000000000640ca6020000ab020000000000
+            00000001007423000000000000000000007c007c056400640b8502190000
+            000000000000007c0564026400850219000000000000000000a6030000ab
+            03000000000000000044005d395c0300007d097d0a7d0b74110000000000
+            00000000006a1900000000000000007c0a7c0ba6020000ab020000000000
+            0000007c096a1300000000000000005f1400000000000000007c09a01500
+            00000000000000000000000000000000000000a6000000ab000000000000
+            00000001008c3a7435000000000000000000007c06740000000000000000
+            0000006a1b00000000000000007400000000000000000000006a1c000000
+            00000000007400000000000000000000006a1d00000000000000006703a6
+            020000ab0200000000000000007d0c7c06a01e0000000000000000000000
+            0000000000000000007c0c640dac0ea6020000ab0200000000000000007d
+            067c0272267c0044005d237d097c096a130000000000000000a01e000000
+            00000000000000000000000000000000007c0c640dac0ea6020000ab0200
+            000000000000007c095f1300000000000000008c247c065300
                        0 MAKE_CELL                1 (index_cols)
          
-         568           2 RESUME                   0
+         657           2 RESUME                   0
          
-         571           4 LOAD_DEREF               1 (index_cols)
+         660           4 LOAD_DEREF               1 (index_cols)
                        6 POP_JUMP_FORWARD_IF_NOT_NONE    12 (to 32)
          
-         572           8 LOAD_GLOBAL              0 (MDConcepts)
+         661           8 LOAD_GLOBAL              0 (MDConcepts)
                       20 LOAD_ATTR                1 (base_columns)
                       30 STORE_DEREF              1 (index_cols)
          
-         573     >>   32 LOAD_GLOBAL              5 (NULL + list)
+         662     >>   32 LOAD_GLOBAL              5 (NULL + list)
                       44 LOAD_FAST                0 (series)
                       46 PRECALL                  1
                       50 CALL                     1
                       60 STORE_FAST               0 (series)
          
-         574          62 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 574>)
+         663          62 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 663>)
                       64 MAKE_FUNCTION            0
                       66 LOAD_FAST                0 (series)
                       68 GET_ITER
                       70 PRECALL                  0
                       74 CALL                     0
                       84 STORE_FAST               4 (lengths)
          
-         575          86 LOAD_GLOBAL              7 (NULL + np)
+         664          86 LOAD_GLOBAL              7 (NULL + np)
                       98 LOAD_ATTR                4 (empty)
                      108 LOAD_GLOBAL             11 (NULL + len)
                      120 LOAD_FAST                4 (lengths)
                      122 PRECALL                  1
                      126 CALL                     1
                      136 LOAD_CONST               2 (1)
                      138 BINARY_OP                0 (+)
                      142 LOAD_GLOBAL             12 (int)
                      154 KW_NAMES                 3
                      156 PRECALL                  2
                      160 CALL                     2
                      170 STORE_FAST               5 (orig_idx_ranges)
          
-         576         172 LOAD_GLOBAL              7 (NULL + np)
+         665         172 LOAD_GLOBAL              7 (NULL + np)
                      184 LOAD_ATTR                7 (cumsum)
                      194 LOAD_FAST                4 (lengths)
                      196 LOAD_FAST                5 (orig_idx_ranges)
                      198 LOAD_CONST               2 (1)
                      200 LOAD_CONST               0 (None)
                      202 BUILD_SLICE              2
                      204 BINARY_SUBSCR
                      214 KW_NAMES                 4
                      216 PRECALL                  2
                      220 CALL                     2
                      230 POP_TOP
          
-         577         232 LOAD_CONST               5 (0)
+         666         232 LOAD_CONST               5 (0)
                      234 LOAD_FAST                5 (orig_idx_ranges)
                      236 LOAD_CONST               5 (0)
                      238 STORE_SUBSCR
          
-         579         242 LOAD_GLOBAL             17 (NULL + pd)
+         668         242 LOAD_GLOBAL             17 (NULL + pd)
                      254 LOAD_ATTR                9 (concat)
                      264 LOAD_CLOSURE             1 (index_cols)
                      266 BUILD_TUPLE              1
-                     268 LOAD_CONST               6 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\machine_data_def.py", line 579>)
+                     268 LOAD_CONST               6 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\base_machine_data.py", line 668>)
                      270 MAKE_FUNCTION            8 (closure)
                      272 LOAD_FAST                0 (series)
                      274 GET_ITER
                      276 PRECALL                  0
                      280 CALL                     0
                      290 LOAD_CONST               7 (True)
                      292 LOAD_CONST               8 ('inner')
          
-         580         294 LOAD_CONST               9 (False)
+         669         294 LOAD_CONST               7 (True)
          
-         579         296 KW_NAMES                10
+         668         296 KW_NAMES                 9
                      298 PRECALL                  4
                      302 CALL                     4
                      312 STORE_FAST               6 (frame)
          
-         582         314 LOAD_FAST                3 (sort_by_time)
+         671         314 LOAD_FAST                3 (sort_by_time)
                      316 POP_JUMP_FORWARD_IF_FALSE   232 (to 782)
          
-         583         318 LOAD_GLOBAL              7 (NULL + np)
+         672         318 LOAD_GLOBAL              7 (NULL + np)
                      330 LOAD_ATTR               10 (argsort)
                      340 LOAD_FAST                6 (frame)
                      342 LOAD_GLOBAL              0 (MDConcepts)
                      354 LOAD_ATTR               11 (Time)
                      364 BINARY_SUBSCR
                      374 LOAD_ATTR               12 (values)
                      384 PRECALL                  1
                      388 CALL                     1
                      398 STORE_FAST               7 (sorted_idx)
          
-         584         400 LOAD_FAST                6 (frame)
+         673         400 LOAD_FAST                6 (frame)
                      402 LOAD_ATTR               13 (iloc)
                      412 LOAD_FAST                7 (sorted_idx)
                      414 BINARY_SUBSCR
                      424 STORE_FAST               6 (frame)
          
-         585         426 LOAD_FAST                6 (frame)
+         674         426 LOAD_FAST                6 (frame)
                      428 LOAD_METHOD             14 (reset_index)
                      450 LOAD_CONST               7 (True)
                      452 LOAD_CONST               7 (True)
-                     454 KW_NAMES                11
+                     454 KW_NAMES                10
                      456 PRECALL                  2
                      460 CALL                     2
                      470 POP_TOP
          
-         586         472 LOAD_GLOBAL              7 (NULL + np)
+         675         472 LOAD_GLOBAL              7 (NULL + np)
                      484 LOAD_ATTR               15 (empty_like)
                      494 LOAD_FAST                7 (sorted_idx)
                      496 PRECALL                  1
                      500 CALL                     1
                      510 STORE_FAST               8 (rev)
          
-         587         512 LOAD_GLOBAL              7 (NULL + np)
+         676         512 LOAD_GLOBAL              7 (NULL + np)
                      524 LOAD_ATTR               16 (arange)
                      534 LOAD_GLOBAL             11 (NULL + len)
                      546 LOAD_FAST                7 (sorted_idx)
                      548 PRECALL                  1
                      552 CALL                     1
                      562 PRECALL                  1
                      566 CALL                     1
                      576 LOAD_FAST                8 (rev)
                      578 LOAD_FAST                7 (sorted_idx)
                      580 STORE_SUBSCR
          
-         588         584 LOAD_GLOBAL             35 (NULL + zip)
+         677         584 LOAD_GLOBAL             35 (NULL + zip)
                      596 LOAD_FAST                0 (series)
                      598 LOAD_FAST                5 (orig_idx_ranges)
                      600 LOAD_CONST               0 (None)
-                     602 LOAD_CONST              12 (-1)
+                     602 LOAD_CONST              11 (-1)
                      604 BUILD_SLICE              2
                      606 BINARY_SUBSCR
                      616 LOAD_FAST                5 (orig_idx_ranges)
                      618 LOAD_CONST               2 (1)
                      620 LOAD_CONST               0 (None)
                      622 BUILD_SLICE              2
                      624 BINARY_SUBSCR
@@ -6498,129 +7540,138 @@
                      648 GET_ITER
                  >>  650 FOR_ITER                64 (to 780)
                      652 UNPACK_SEQUENCE          3
                      656 STORE_FAST               9 (tsc)
                      658 STORE_FAST              10 (start)
                      660 STORE_FAST              11 (end)
          
-         589         662 LOAD_GLOBAL             17 (NULL + pd)
+         678         662 LOAD_GLOBAL             17 (NULL + pd)
                      674 LOAD_ATTR               18 (Index)
                      684 LOAD_FAST                8 (rev)
                      686 LOAD_FAST               10 (start)
                      688 LOAD_FAST               11 (end)
                      690 BUILD_SLICE              2
                      692 BINARY_SUBSCR
                      702 PRECALL                  1
                      706 CALL                     1
                      716 LOAD_FAST                9 (tsc)
                      718 LOAD_ATTR               19 (df)
                      728 STORE_ATTR              20 (index)
          
-         590         738 LOAD_FAST                9 (tsc)
+         679         738 LOAD_FAST                9 (tsc)
                      740 LOAD_METHOD             21 (update_index)
                      762 PRECALL                  0
                      766 CALL                     0
                      776 POP_TOP
                      778 JUMP_BACKWARD           65 (to 650)
          
-         588     >>  780 JUMP_FORWARD            91 (to 964)
+         677     >>  780 JUMP_FORWARD           122 (to 1026)
          
-         592     >>  782 LOAD_GLOBAL             35 (NULL + zip)
-                     794 LOAD_FAST                0 (series)
-                     796 LOAD_FAST                5 (orig_idx_ranges)
-                     798 LOAD_CONST               0 (None)
-                     800 LOAD_CONST              12 (-1)
-                     802 BUILD_SLICE              2
-                     804 BINARY_SUBSCR
-                     814 LOAD_FAST                5 (orig_idx_ranges)
-                     816 LOAD_CONST               2 (1)
-                     818 LOAD_CONST               0 (None)
-                     820 BUILD_SLICE              2
-                     822 BINARY_SUBSCR
-                     832 PRECALL                  3
-                     836 CALL                     3
-                     846 GET_ITER
-                 >>  848 FOR_ITER                57 (to 964)
-                     850 UNPACK_SEQUENCE          3
-                     854 STORE_FAST               9 (tsc)
-                     856 STORE_FAST              10 (start)
-                     858 STORE_FAST              11 (end)
-         
-         593         860 LOAD_GLOBAL             17 (NULL + pd)
-                     872 LOAD_ATTR               22 (RangeIndex)
-                     882 LOAD_FAST               10 (start)
-                     884 LOAD_FAST               11 (end)
-                     886 PRECALL                  2
-                     890 CALL                     2
-                     900 LOAD_FAST                9 (tsc)
-                     902 LOAD_ATTR               19 (df)
-                     912 STORE_ATTR              20 (index)
-         
-         594         922 LOAD_FAST                9 (tsc)
-                     924 LOAD_METHOD             21 (update_index)
-                     946 PRECALL                  0
-                     950 CALL                     0
-                     960 POP_TOP
-                     962 JUMP_BACKWARD           58 (to 848)
-         
-         596     >>  964 LOAD_GLOBAL             47 (NULL + derive_categoricals)
-                     976 LOAD_FAST                6 (frame)
-                     978 LOAD_GLOBAL              0 (MDConcepts)
-                     990 LOAD_ATTR               24 (Object)
-                    1000 LOAD_GLOBAL              0 (MDConcepts)
-                    1012 LOAD_ATTR               25 (Type)
-                    1022 LOAD_GLOBAL              0 (MDConcepts)
-                    1034 LOAD_ATTR               26 (Label)
-                    1044 BUILD_LIST               3
-                    1046 PRECALL                  2
-                    1050 CALL                     2
-                    1060 STORE_FAST              12 (cats)
-         
-         597        1062 LOAD_FAST                6 (frame)
-                    1064 LOAD_METHOD             27 (astype)
-                    1086 LOAD_FAST               12 (cats)
-                    1088 LOAD_CONST               9 (False)
-                    1090 KW_NAMES                13
-                    1092 PRECALL                  2
-                    1096 CALL                     2
-                    1106 STORE_FAST               6 (frame)
-         
-         598        1108 LOAD_FAST                2 (override_categorical_types)
-                    1110 POP_JUMP_FORWARD_IF_FALSE    38 (to 1188)
-         
-         599        1112 LOAD_FAST                0 (series)
-                    1114 GET_ITER
-                 >> 1116 FOR_ITER                35 (to 1188)
-                    1118 STORE_FAST               9 (tsc)
-         
-         600        1120 LOAD_FAST                9 (tsc)
-                    1122 LOAD_ATTR               19 (df)
-                    1132 LOAD_METHOD             27 (astype)
-                    1154 LOAD_FAST               12 (cats)
-                    1156 LOAD_CONST               9 (False)
-                    1158 KW_NAMES                13
-                    1160 PRECALL                  2
-                    1164 CALL                     2
-                    1174 LOAD_FAST                9 (tsc)
-                    1176 STORE_ATTR              19 (df)
-                    1186 JUMP_BACKWARD           36 (to 1116)
+         681     >>  782 LOAD_GLOBAL             45 (NULL + logging)
+                     794 LOAD_ATTR               23 (log)
+                     804 LOAD_GLOBAL             44 (logging)
+                     816 LOAD_ATTR               24 (WARN)
+                     826 LOAD_CONST              12 ('machine data index was not sorted')
+                     828 PRECALL                  2
+                     832 CALL                     2
+                     842 POP_TOP
+         
+         682         844 LOAD_GLOBAL             35 (NULL + zip)
+                     856 LOAD_FAST                0 (series)
+                     858 LOAD_FAST                5 (orig_idx_ranges)
+                     860 LOAD_CONST               0 (None)
+                     862 LOAD_CONST              11 (-1)
+                     864 BUILD_SLICE              2
+                     866 BINARY_SUBSCR
+                     876 LOAD_FAST                5 (orig_idx_ranges)
+                     878 LOAD_CONST               2 (1)
+                     880 LOAD_CONST               0 (None)
+                     882 BUILD_SLICE              2
+                     884 BINARY_SUBSCR
+                     894 PRECALL                  3
+                     898 CALL                     3
+                     908 GET_ITER
+                 >>  910 FOR_ITER                57 (to 1026)
+                     912 UNPACK_SEQUENCE          3
+                     916 STORE_FAST               9 (tsc)
+                     918 STORE_FAST              10 (start)
+                     920 STORE_FAST              11 (end)
+         
+         683         922 LOAD_GLOBAL             17 (NULL + pd)
+                     934 LOAD_ATTR               25 (RangeIndex)
+                     944 LOAD_FAST               10 (start)
+                     946 LOAD_FAST               11 (end)
+                     948 PRECALL                  2
+                     952 CALL                     2
+                     962 LOAD_FAST                9 (tsc)
+                     964 LOAD_ATTR               19 (df)
+                     974 STORE_ATTR              20 (index)
+         
+         684         984 LOAD_FAST                9 (tsc)
+                     986 LOAD_METHOD             21 (update_index)
+                    1008 PRECALL                  0
+                    1012 CALL                     0
+                    1022 POP_TOP
+                    1024 JUMP_BACKWARD           58 (to 910)
+         
+         686     >> 1026 LOAD_GLOBAL             53 (NULL + derive_categoricals)
+                    1038 LOAD_FAST                6 (frame)
+                    1040 LOAD_GLOBAL              0 (MDConcepts)
+                    1052 LOAD_ATTR               27 (Object)
+                    1062 LOAD_GLOBAL              0 (MDConcepts)
+                    1074 LOAD_ATTR               28 (Type)
+                    1084 LOAD_GLOBAL              0 (MDConcepts)
+                    1096 LOAD_ATTR               29 (Label)
+                    1106 BUILD_LIST               3
+                    1108 PRECALL                  2
+                    1112 CALL                     2
+                    1122 STORE_FAST              12 (cats)
+         
+         687        1124 LOAD_FAST                6 (frame)
+                    1126 LOAD_METHOD             30 (astype)
+                    1148 LOAD_FAST               12 (cats)
+                    1150 LOAD_CONST              13 (False)
+                    1152 KW_NAMES                14
+                    1154 PRECALL                  2
+                    1158 CALL                     2
+                    1168 STORE_FAST               6 (frame)
+         
+         688        1170 LOAD_FAST                2 (override_categorical_types)
+                    1172 POP_JUMP_FORWARD_IF_FALSE    38 (to 1250)
+         
+         689        1174 LOAD_FAST                0 (series)
+                    1176 GET_ITER
+                 >> 1178 FOR_ITER                35 (to 1250)
+                    1180 STORE_FAST               9 (tsc)
+         
+         690        1182 LOAD_FAST                9 (tsc)
+                    1184 LOAD_ATTR               19 (df)
+                    1194 LOAD_METHOD             30 (astype)
+                    1216 LOAD_FAST               12 (cats)
+                    1218 LOAD_CONST              13 (False)
+                    1220 KW_NAMES                14
+                    1222 PRECALL                  2
+                    1226 CALL                     2
+                    1236 LOAD_FAST                9 (tsc)
+                    1238 STORE_ATTR              19 (df)
+                    1248 JUMP_BACKWARD           36 (to 1178)
          
-         601     >> 1188 LOAD_FAST                6 (frame)
-                    1190 RETURN_VALUE
+         691     >> 1250 LOAD_FAST                6 (frame)
+                    1252 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 5
                flags     : 16777235
                code
                   0x970067007c005d167d017401000000000000000000007c016a01000000
                   0000000000a6010000ab01000000000000000091028c175300
-               574           0 RESUME                   0
+               663           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                22 (to 52)
                              8 STORE_FAST               1 (tsc)
                             10 LOAD_GLOBAL              1 (NULL + len)
                             22 LOAD_FAST                1 (tsc)
                             24 LOAD_ATTR                1 (df)
@@ -6630,85 +7681,91 @@
                             50 JUMP_BACKWARD           23 (to 6)
                        >>   52 RETURN_VALUE
                consts
                names      ('len', 'df')
                varnames   ('.0', 'tsc')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '<listcomp>'
-               firstlineno 574
+               firstlineno 663
                lnotab 0x
             1
             ('dtype',)
             ('out',)
             0
             code
                argcount  : 1
                nlocals   : 2
-               stacksize : 3
+               stacksize : 4
                flags     : 16777267
                code
-                  0x95014b00010097007c005d117d017c016a000000000000000000890219
-                  0000000000000000005600970101008c1264005300
+                  0x95014b00010097007c005d1a7d017c016a0000000000000000006a0100
+                  000000000000006400640085028902660219000000000000000000560097
+                  0101008c1b64005300
                              0 COPY_FREE_VARS           1
                
-               579           2 RETURN_GENERATOR
+               668           2 RETURN_GENERATOR
                              4 POP_TOP
                              6 RESUME                   0
                              8 LOAD_FAST                0 (.0)
-                       >>   10 FOR_ITER                17 (to 46)
+                       >>   10 FOR_ITER                26 (to 64)
                             12 STORE_FAST               1 (tsc)
                             14 LOAD_FAST                1 (tsc)
                             16 LOAD_ATTR                0 (df)
-                            26 LOAD_DEREF               2 (index_cols)
-                            28 BINARY_SUBSCR
-                            38 YIELD_VALUE
-                            40 RESUME                   1
-                            42 POP_TOP
-                            44 JUMP_BACKWARD           18 (to 10)
-                       >>   46 LOAD_CONST               0 (None)
-                            48 RETURN_VALUE
+                            26 LOAD_ATTR                1 (loc)
+                            36 LOAD_CONST               0 (None)
+                            38 LOAD_CONST               0 (None)
+                            40 BUILD_SLICE              2
+                            42 LOAD_DEREF               2 (index_cols)
+                            44 BUILD_TUPLE              2
+                            46 BINARY_SUBSCR
+                            56 YIELD_VALUE
+                            58 RESUME                   1
+                            60 POP_TOP
+                            62 JUMP_BACKWARD           27 (to 10)
+                       >>   64 LOAD_CONST               0 (None)
+                            66 RETURN_VALUE
                consts
                   None
-               names      ('df',)
+               names      ('df', 'loc')
                varnames   ('.0', 'tsc')
                freevars   ('index_cols',)
                cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
                name       '<genexpr>'
-               firstlineno 579
+               firstlineno 668
                lnotab 0x
             True
             'inner'
-            False
             ('ignore_index', 'join', 'copy')
             ('drop', 'inplace')
             -1
+            'machine data index was not sorted'
+            False
             ('copy',)
-         names      ('MDConcepts', 'base_columns', 'list', 'np', 'empty', 'len', 'int', 'cumsum', 'pd', 'concat', 'argsort', 'Time', 'values', 'iloc', 'reset_index', 'empty_like', 'arange', 'zip', 'Index', 'df', 'index', 'update_index', 'RangeIndex', 'derive_categoricals', 'Object', 'Type', 'Label', 'astype')
+         names      ('MDConcepts', 'base_columns', 'list', 'np', 'empty', 'len', 'int', 'cumsum', 'pd', 'concat', 'argsort', 'Time', 'values', 'iloc', 'reset_index', 'empty_like', 'arange', 'zip', 'Index', 'df', 'index', 'update_index', 'logging', 'log', 'WARN', 'RangeIndex', 'derive_categoricals', 'Object', 'Type', 'Label', 'astype')
          varnames   ('series', 'index_cols', 'override_categorical_types', 'sort_by_time', 'lengths', 'orig_idx_ranges', 'frame', 'sorted_idx', 'rev', 'tsc', 'start', 'end', 'cats')
          freevars   ()
          cellvars   ('index_cols',)
-         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
          name       'build_shared_index'
-         firstlineno 568
+         firstlineno 657
          lnotab
             0x0403040118011e01180156013c010a02340102ff1203040152011a012e
-            01280148014e014c012afe02044e013e012a0262012e01040108014401
-      ('df', 'pd.DataFrame')
+            01280148014e014c012afe02043e014e013e012a0262012e010401080144
+            01
+      (True, False, False, False)
       (None, True, False)
-      ('series', 'Iterable[TypedTimeseriesCollection]')
-   names      ('__future__', 'annotations', 'itertools', 'abc', 'ABC', 'dataclasses', 'dataclass', 'field', 'functools', 'partial', 'typing', 'Iterable', 'Generic', 'TypeVar', 'Sized', 'TYPE_CHECKING', 'Collection', 'Literal', 'ClassVar', 'Callable', 'numpy', 'np', 'pandas', 'pd', 'df_utils', 'derive_categoricals', 'header', 'Header', 'ObservationSpec', 'Meta', 'FeatureSpec', 'util', 'mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'mangle_arg_to_tuple', 'symmetric_difference', 'intersection', 'assert_in', 'StringEnumeration', 'str', 'MDConcept', 'MDConcepts', 'MDExtensionConcepts', 'only_feature_columns', 'project_on_feature_columns', 'TimeseriesFeatureLabel', 'tuple', 'TimeseriesFeatureLabels', 'ObservationTypeType', 'ObservationTypes', 'ObservationTypeLabel', 'ObservationSpecIdentifier', 'EventSpecLabel', 'MeasurementSpecLabel', 'TimeseriesSpecType', 'Exception', 'TimeseriesTypeMergeException', 'TimeseriesCollectionMergeException', 'MachineDataMergeException', 'TimeseriesSpec', 'EventTimeseriesSpec', 'MeasurementTimeseriesSpec', 'TimeseriesSpecFactory', 'TSSpec', 'AbstractMachineDataTimeseries', 'MachineDataTimeseries', 'EventSeries', 'MeasurementSeries', 'TS', 'TTC', 'TypedTimeseriesCollection', 'EventTimeseriesCollection', 'MeasurementTimeseriesCollection', 'ETSType', 'MTSType', 'ETS', 'MTS', 'ETSC', 'MTSC', 'TimeseriesCollectionFactory', 'AMD', 'AbstractMachineData', 'MachineData', 'build_shared_index')
+      ('series', 'Iterable[TSContainer]', 'return', 'pd.DataFrame')
+   names      ('__future__', 'annotations', 'itertools', 'logging', 'typing', 'abc', 'ABC', 'collections.abc', 'Iterable', 'Collection', 'Mapping', 'Set', 'Iterator', 'dataclasses', 'dataclass', 'Generic', 'Literal', 'Union', 'numpy', 'np', 'pandas', 'pd', 'immutabledict', 'shared_defs', 'StrIndexer', 'TimeseriesFeatureLabel', 'TimeseriesFeatureLabels', 'ObservationTypeValue', 'ObservationType', 'ObservationSpecLabel', 'ObservationSpecIdentifier', 'EventSpecLabel', 'MeasurementSpecLabel', 'ObservationTypes', 'MDConcepts', 'only_feature_columns', 'df_utils', 'derive_categoricals', 'header', 'Header', 'ObservationSpec', 'Meta', 'FeatureSpec', 'protocols', 'EventSpecific', 'MeasurementSpecific', 'TimeseriesSpecProtocol', 'TimeseriesViewProtocol', 'TimeseriesContainerProtocol', 'MachineDataProtocol', 'TSSpec', 'TSView', 'ETSC', 'MTSC', 'ETSView', 'ETSSpec', 'MTSView', 'MTSSpec', 'TSContainer', 'MachineData', 'util', 'mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_tuple', 'assert_in', 'Exception', 'TimeseriesTypeMergeException', 'TimeseriesCollectionMergeException', 'MachineDataMergeException', 'TimeseriesSpec', 'EventTimeseriesSpec', 'MeasurementTimeseriesSpec', 'TimeseriesView', 'cl', 'EventTimeseriesView', 'MeasurementTimeseriesView', '_feature_column_view', 'AbstractTimeseriesContainer', 'EventTimeseriesContainer', 'MeasurementTimeseriesContainer', 'AbstractMachineData', 'BaseMachineData', 'build_shared_index')
    varnames   ()
    freevars   ()
    cellvars   ()
-   filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\machine_data_def.py'
+   filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\base_machine_data.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c0208010c0110010c012c02080108020c0118012803040102
-      0204031c091c07060408040401140204031c0504011402040104021a031c
-      041c041c041e011cff0e01023318011aff0e01020418011aff0e0102041a
-      081a03020128ff0e010205020126ff0e010204020126ff0e010204020126
-      ff0e0102041a021a032e782c052c051a011a021a011a021a011a031a0b1a
-      03367f00670c010eff1a060201020102fe
+      0x00ff02010c020801080108010c011c010c011402080108010c0238030c
+      011801480318041c041c041c041c011aff0e01024c1e051e04362b100328
+      062807020102ff081c407f000d2c052c05367f007f00190c010eff1a1002
+      01020102fe
```

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/raw.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/raw.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/raw.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/raw.cpython-311.pyc`

 * *Files 14% similar despite different names*

#### Python bytecode

```diff
@@ -1,28 +1,27 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
-files sz: 5637
+moddate:  0xefe9d064 (Mon Aug  7 12:56:15 2023 UTC)
+files sz: 5224
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 6
    flags     : 16777216
    code
       0x9700640064016c006d015a010100640064026c026d035a036d045a0401
       00640064036c055a06640064036c075a08640464056c096d0a5a0a010064
-      0464066c0b6d0c5a0c0100640464076c0d6d0e5a0e6d0f5a0f6d105a1001
-      00640464086c116d125a126d135a136d145a146d155a156d165a166d175a
-      170100640984005a1802004700640a8400640b6503640cac0da6040000ab
-      0400000000000000005a19651a5a1b651c651a6519660219000000000000
-      0000005a1d651c651a651e651b651d7a0700001900000000000000000066
-      02190000000000000000005a1f02004700640e8400640f65036410ac0da6
-      040000ab0400000000000000005a20020047006411840064126503640cac
-      0da6040000ab0400000000000000005a2165086a2200000000000000005a
-      23641d641684045a24641e641884045a25641e641984045a26641f641c84
-      045a2764035300
+      0464066c0b6d0c5a0c6d0d5a0d6d0e5a0e0100640464076c0f6d105a1001
+      00640464086c116d125a120100640984005a1302004700640a8400640b65
+      03640cac0da6040000ab0400000000000000005a1465155a166517651565
+      146602190000000000000000005a18651765156519651665187a07000019
+      0000000000000000006602190000000000000000005a1a02004700640e84
+      00640f65036410ac0da6040000ab0400000000000000005a1b0200470064
+      11840064126503640cac0da6040000ab0400000000000000005a1c641d64
+      1684045a1d641e641884045a1e641e641984045a1f641f641c84045a2064
+      035300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('annotations',))
                  6 IMPORT_NAME              0 (__future__)
                  8 IMPORT_FROM              1 (annotations)
                 10 STORE_NAME               1 (annotations)
@@ -51,156 +50,142 @@
                 48 LOAD_CONST               5 (('derive_categoricals',))
                 50 IMPORT_NAME              9 (df_utils)
                 52 IMPORT_FROM             10 (derive_categoricals)
                 54 STORE_NAME              10 (derive_categoricals)
                 56 POP_TOP
    
      9          58 LOAD_CONST               4 (1)
-                60 LOAD_CONST               6 (('metadata',))
-                62 IMPORT_NAME             11 (extensions)
-                64 IMPORT_FROM             12 (metadata)
-                66 STORE_NAME              12 (metadata)
-                68 POP_TOP
+                60 LOAD_CONST               6 (('create_header_from_raw', 'ObservationSpec', 'convert_header_to_raw'))
+                62 IMPORT_NAME             11 (header)
+                64 IMPORT_FROM             12 (create_header_from_raw)
+                66 STORE_NAME              12 (create_header_from_raw)
+                68 IMPORT_FROM             13 (ObservationSpec)
+                70 STORE_NAME              13 (ObservationSpec)
+                72 IMPORT_FROM             14 (convert_header_to_raw)
+                74 STORE_NAME              14 (convert_header_to_raw)
+                76 POP_TOP
    
-    10          70 LOAD_CONST               4 (1)
-                72 LOAD_CONST               7 (('create_header_from_raw', 'ObservationSpec', 'convert_header_to_raw'))
-                74 IMPORT_NAME             13 (header)
-                76 IMPORT_FROM             14 (create_header_from_raw)
-                78 STORE_NAME              14 (create_header_from_raw)
-                80 IMPORT_FROM             15 (ObservationSpec)
-                82 STORE_NAME              15 (ObservationSpec)
-                84 IMPORT_FROM             16 (convert_header_to_raw)
-                86 STORE_NAME              16 (convert_header_to_raw)
+    10          78 LOAD_CONST               4 (1)
+                80 LOAD_CONST               7 (('MDConcepts',))
+                82 IMPORT_NAME             15 (shared_defs)
+                84 IMPORT_FROM             16 (MDConcepts)
+                86 STORE_NAME              16 (MDConcepts)
                 88 POP_TOP
    
     11          90 LOAD_CONST               4 (1)
-                92 LOAD_CONST               8 (('MDConcepts', 'EventTimeseriesCollection', 'MeasurementTimeseriesCollection', 'MachineData', 'TimeseriesCollectionFactory', 'TimeseriesSpecFactory'))
-                94 IMPORT_NAME             17 (machine_data_def)
-                96 IMPORT_FROM             18 (MDConcepts)
-                98 STORE_NAME              18 (MDConcepts)
-               100 IMPORT_FROM             19 (EventTimeseriesCollection)
-               102 STORE_NAME              19 (EventTimeseriesCollection)
-               104 IMPORT_FROM             20 (MeasurementTimeseriesCollection)
-               106 STORE_NAME              20 (MeasurementTimeseriesCollection)
-               108 IMPORT_FROM             21 (MachineData)
-               110 STORE_NAME              21 (MachineData)
-               112 IMPORT_FROM             22 (TimeseriesCollectionFactory)
-               114 STORE_NAME              22 (TimeseriesCollectionFactory)
-               116 IMPORT_FROM             23 (TimeseriesSpecFactory)
-               118 STORE_NAME              23 (TimeseriesSpecFactory)
-               120 POP_TOP
+                92 LOAD_CONST               8 (('MachineData',))
+                94 IMPORT_NAME             17 (protocols)
+                96 IMPORT_FROM             18 (MachineData)
+                98 STORE_NAME              18 (MachineData)
+               100 POP_TOP
    
-    15         122 LOAD_CONST               9 (<code object gen_feature_column_names, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 15>)
-               124 MAKE_FUNCTION            0
-               126 STORE_NAME              24 (gen_feature_column_names)
+    14         102 LOAD_CONST               9 (<code object gen_feature_column_names, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 14>)
+               104 MAKE_FUNCTION            0
+               106 STORE_NAME              19 (gen_feature_column_names)
    
-    19         128 PUSH_NULL
-               130 LOAD_BUILD_CLASS
-               132 LOAD_CONST              10 (<code object FeatureMetadata, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 19>)
-               134 MAKE_FUNCTION            0
-               136 LOAD_CONST              11 ('FeatureMetadata')
-               138 LOAD_NAME                3 (TypedDict)
-               140 LOAD_CONST              12 (False)
-               142 KW_NAMES                13
-               144 PRECALL                  4
-               148 CALL                     4
-               158 STORE_NAME              25 (FeatureMetadata)
+    18         108 PUSH_NULL
+               110 LOAD_BUILD_CLASS
+               112 LOAD_CONST              10 (<code object FeatureMetadata, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 18>)
+               114 MAKE_FUNCTION            0
+               116 LOAD_CONST              11 ('FeatureMetadata')
+               118 LOAD_NAME                3 (TypedDict)
+               120 LOAD_CONST              12 (False)
+               122 KW_NAMES                13
+               124 PRECALL                  4
+               128 CALL                     4
+               138 STORE_NAME              20 (FeatureMetadata)
    
-    24         160 LOAD_NAME               26 (str)
-               162 STORE_NAME              27 (RawBaseFeatureSpec)
+    23         140 LOAD_NAME               21 (str)
+               142 STORE_NAME              22 (RawBaseFeatureSpec)
    
-    25         164 LOAD_NAME               28 (dict)
-               166 LOAD_NAME               26 (str)
-               168 LOAD_NAME               25 (FeatureMetadata)
-               170 BUILD_TUPLE              2
-               172 BINARY_SUBSCR
-               182 STORE_NAME              29 (RawMetadataFeatureSpec)
+    24         144 LOAD_NAME               23 (dict)
+               146 LOAD_NAME               21 (str)
+               148 LOAD_NAME               20 (FeatureMetadata)
+               150 BUILD_TUPLE              2
+               152 BINARY_SUBSCR
+               162 STORE_NAME              24 (RawMetadataFeatureSpec)
    
-    26         184 LOAD_NAME               28 (dict)
-               186 LOAD_NAME               26 (str)
-               188 LOAD_NAME               30 (list)
-               190 LOAD_NAME               27 (RawBaseFeatureSpec)
-               192 LOAD_NAME               29 (RawMetadataFeatureSpec)
-               194 BINARY_OP                7 (|)
-               198 BINARY_SUBSCR
-               208 BUILD_TUPLE              2
-               210 BINARY_SUBSCR
-               220 STORE_NAME              31 (RawObservationSpecs)
+    25         164 LOAD_NAME               23 (dict)
+               166 LOAD_NAME               21 (str)
+               168 LOAD_NAME               25 (list)
+               170 LOAD_NAME               22 (RawBaseFeatureSpec)
+               172 LOAD_NAME               24 (RawMetadataFeatureSpec)
+               174 BINARY_OP                7 (|)
+               178 BINARY_SUBSCR
+               188 BUILD_TUPLE              2
+               190 BINARY_SUBSCR
+               200 STORE_NAME              26 (RawObservationSpecs)
    
-    29         222 PUSH_NULL
-               224 LOAD_BUILD_CLASS
-               226 LOAD_CONST              14 (<code object RawAnnotationSpecs, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 29>)
-               228 MAKE_FUNCTION            0
-               230 LOAD_CONST              15 ('RawAnnotationSpecs')
-               232 LOAD_NAME                3 (TypedDict)
-               234 LOAD_CONST              16 (True)
-               236 KW_NAMES                13
-               238 PRECALL                  4
-               242 CALL                     4
-               252 STORE_NAME              32 (RawAnnotationSpecs)
+    28         202 PUSH_NULL
+               204 LOAD_BUILD_CLASS
+               206 LOAD_CONST              14 (<code object RawAnnotationSpecs, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 28>)
+               208 MAKE_FUNCTION            0
+               210 LOAD_CONST              15 ('RawAnnotationSpecs')
+               212 LOAD_NAME                3 (TypedDict)
+               214 LOAD_CONST              16 (True)
+               216 KW_NAMES                13
+               218 PRECALL                  4
+               222 CALL                     4
+               232 STORE_NAME              27 (RawAnnotationSpecs)
    
-    34         254 PUSH_NULL
-               256 LOAD_BUILD_CLASS
-               258 LOAD_CONST              17 (<code object RawHeaderSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 34>)
-               260 MAKE_FUNCTION            0
-               262 LOAD_CONST              18 ('RawHeaderSpec')
-               264 LOAD_NAME                3 (TypedDict)
-               266 LOAD_CONST              12 (False)
-               268 KW_NAMES                13
-               270 PRECALL                  4
-               274 CALL                     4
-               284 STORE_NAME              33 (RawHeaderSpec)
+    33         234 PUSH_NULL
+               236 LOAD_BUILD_CLASS
+               238 LOAD_CONST              17 (<code object RawHeaderSpec, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 33>)
+               240 MAKE_FUNCTION            0
+               242 LOAD_CONST              18 ('RawHeaderSpec')
+               244 LOAD_NAME                3 (TypedDict)
+               246 LOAD_CONST              12 (False)
+               248 KW_NAMES                13
+               250 PRECALL                  4
+               254 CALL                     4
+               264 STORE_NAME              28 (RawHeaderSpec)
    
-    42         286 LOAD_NAME                8 (pd)
-               288 LOAD_ATTR               34 (DataFrame)
-               298 STORE_NAME              35 (RawDataType)
+    41         266 LOAD_CONST              29 (('md', 'MachineData', 'return', 'RawHeaderSpec'))
+               268 LOAD_CONST              22 (<code object convert_to_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 41>)
+               270 MAKE_FUNCTION            4 (annotations)
+               272 STORE_NAME              29 (convert_to_raw_header)
    
-    45         300 LOAD_CONST              29 (('md', 'MachineData', 'return', 'RawHeaderSpec'))
-               302 LOAD_CONST              22 (<code object convert_to_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 45>)
-               304 MAKE_FUNCTION            4 (annotations)
-               306 STORE_NAME              36 (convert_to_raw_header)
+    45         274 LOAD_CONST              30 (('md', 'MachineData', 'return', 'pd.DataFrame'))
+               276 LOAD_CONST              24 (<code object convert_to_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 45>)
+               278 MAKE_FUNCTION            4 (annotations)
+               280 STORE_NAME              30 (convert_to_raw_data)
    
-    49         308 LOAD_CONST              30 (('md', 'MachineData', 'return', 'RawDataType'))
-               310 LOAD_CONST              24 (<code object convert_to_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 49>)
-               312 MAKE_FUNCTION            4 (annotations)
-               314 STORE_NAME              37 (convert_to_raw_data)
+    69         282 LOAD_CONST              30 (('md', 'MachineData', 'return', 'pd.DataFrame'))
+               284 LOAD_CONST              25 (<code object convert_to_raw_data_legacy, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 69>)
+               286 MAKE_FUNCTION            4 (annotations)
+               288 STORE_NAME              31 (convert_to_raw_data_legacy)
    
-    74         316 LOAD_CONST              30 (('md', 'MachineData', 'return', 'RawDataType'))
-               318 LOAD_CONST              25 (<code object convert_to_raw_data_legacy, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 74>)
-               320 MAKE_FUNCTION            4 (annotations)
-               322 STORE_NAME              38 (convert_to_raw_data_legacy)
-   
-    92         324 LOAD_CONST              31 (('raw_data', 'RawDataType', 'raw_header', 'RawHeaderSpec'))
-               326 LOAD_CONST              28 (<code object create_machine_data_from_raw, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 92>)
-               328 MAKE_FUNCTION            4 (annotations)
-               330 STORE_NAME              39 (create_machine_data_from_raw)
-               332 LOAD_CONST               3 (None)
-               334 RETURN_VALUE
+    87         290 LOAD_CONST              31 (('raw_data', 'pd.DataFrame', 'raw_header', 'RawHeaderSpec', 'return', 'MachineData'))
+               292 LOAD_CONST              28 (<code object create_machine_data_from_raw, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 87>)
+               294 MAKE_FUNCTION            4 (annotations)
+               296 STORE_NAME              32 (create_machine_data_from_raw)
+               298 LOAD_CONST               3 (None)
+               300 RETURN_VALUE
    consts
       0
       ('annotations',)
       ('TypedDict', 'Any')
       None
       1
       ('derive_categoricals',)
-      ('metadata',)
       ('create_header_from_raw', 'ObservationSpec', 'convert_header_to_raw')
-      ('MDConcepts', 'EventTimeseriesCollection', 'MeasurementTimeseriesCollection', 'MachineData', 'TimeseriesCollectionFactory', 'TimeseriesSpecFactory')
+      ('MDConcepts',)
+      ('MachineData',)
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 6
          flags     : 16777219
          code
             0x97006401840074010000000000000000000064027c0064027a000000a6
             020000ab0200000000000000004400a6000000ab00000000000000000053
             00
-          15           0 RESUME                   0
+          14           0 RESUME                   0
          
-          16           2 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 16>)
+          15           2 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 15>)
                        4 MAKE_FUNCTION            0
                        6 LOAD_GLOBAL              1 (NULL + range)
                       18 LOAD_CONST               2 (1)
                       20 LOAD_FAST                0 (n)
                       22 LOAD_CONST               2 (1)
                       24 BINARY_OP                0 (+)
                       28 PRECALL                  2
@@ -213,15 +198,15 @@
             None
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 16777235
                code 0x970067007c005d077d0164007c019b009d0291028c085300
-                16           0 RESUME                   0
+                15           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 7 (to 22)
                              8 STORE_FAST               1 (i)
                             10 LOAD_CONST               0 ('f_')
                             12 LOAD_FAST                1 (i)
                             14 FORMAT_VALUE             0
@@ -233,46 +218,46 @@
                   'f_'
                names      ()
                varnames   ('.0', 'i')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
                name       '<listcomp>'
-               firstlineno 16
+               firstlineno 15
                lnotab 0x
             1
          names      ('range',)
          varnames   ('n',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'gen_feature_column_names'
-         firstlineno 15
+         firstlineno 14
          lnotab 0x0201
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 3
          flags     : 16777216
          code
             0x970065005a0164005a0255006401650364023c0000006401650364033c
             00000064045300
-          19           0 RESUME                   0
+          18           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('FeatureMetadata')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          20          12 LOAD_CONST               1 ('str')
+          19          12 LOAD_CONST               1 ('str')
                       14 LOAD_NAME                3 (__annotations__)
                       16 LOAD_CONST               2 ('data_type')
                       18 STORE_SUBSCR
          
-          21          22 LOAD_CONST               1 ('str')
+          20          22 LOAD_CONST               1 ('str')
                       24 LOAD_NAME                3 (__annotations__)
                       26 LOAD_CONST               3 ('print_name')
                       28 STORE_SUBSCR
                       32 LOAD_CONST               4 (None)
                       34 RETURN_VALUE
          consts
             'FeatureMetadata'
@@ -282,40 +267,40 @@
             None
          names      ('__name__', '__module__', '__qualname__', '__annotations__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'FeatureMetadata'
-         firstlineno 19
+         firstlineno 18
          lnotab 0x0c010a01
       'FeatureMetadata'
       False
       ('total',)
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 3
          flags     : 16777216
          code
             0x970065005a0164005a0255006401650364023c0000006401650364033c
             00000064045300
-          29           0 RESUME                   0
+          28           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('RawAnnotationSpecs')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          30          12 LOAD_CONST               1 ('RawObservationSpecs')
+          29          12 LOAD_CONST               1 ('RawObservationSpecs')
                       14 LOAD_NAME                3 (__annotations__)
                       16 LOAD_CONST               2 ('input')
                       18 STORE_SUBSCR
          
-          31          22 LOAD_CONST               1 ('RawObservationSpecs')
+          30          22 LOAD_CONST               1 ('RawObservationSpecs')
                       24 LOAD_NAME                3 (__annotations__)
                       26 LOAD_CONST               3 ('output')
                       28 STORE_SUBSCR
                       32 LOAD_CONST               4 (None)
                       34 RETURN_VALUE
          consts
             'RawAnnotationSpecs'
@@ -325,55 +310,55 @@
             None
          names      ('__name__', '__module__', '__qualname__', '__annotations__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'RawAnnotationSpecs'
-         firstlineno 29
+         firstlineno 28
          lnotab 0x0c010a01
       'RawAnnotationSpecs'
       True
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 3
          flags     : 16777216
          code
             0x970065005a0164005a0255006401650364023c0000006403650364043c
             0000006403650364053c0000006406650364073c0000006408650364093c
             000000640a5300
-          34           0 RESUME                   0
+          33           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('RawHeaderSpec')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          35          12 LOAD_CONST               1 ('list[str]')
+          34          12 LOAD_CONST               1 ('list[str]')
                       14 LOAD_NAME                3 (__annotations__)
                       16 LOAD_CONST               2 ('extensions')
                       18 STORE_SUBSCR
          
-          36          22 LOAD_CONST               3 ('RawObservationSpecs')
+          35          22 LOAD_CONST               3 ('RawObservationSpecs')
                       24 LOAD_NAME                3 (__annotations__)
                       26 LOAD_CONST               4 ('event_specs')
                       28 STORE_SUBSCR
          
-          37          32 LOAD_CONST               3 ('RawObservationSpecs')
+          36          32 LOAD_CONST               3 ('RawObservationSpecs')
                       34 LOAD_NAME                3 (__annotations__)
                       36 LOAD_CONST               5 ('measurement_specs')
                       38 STORE_SUBSCR
          
-          38          42 LOAD_CONST               6 ('RawAnnotationSpecs')
+          37          42 LOAD_CONST               6 ('RawAnnotationSpecs')
                       44 LOAD_NAME                3 (__annotations__)
                       46 LOAD_CONST               7 ('annotation_specs')
                       48 STORE_SUBSCR
          
-          39          52 LOAD_CONST               8 ('dict[str, Any]')
+          38          52 LOAD_CONST               8 ('dict[str, Any]')
                       54 LOAD_NAME                3 (__annotations__)
                       56 LOAD_CONST               9 ('metadata')
                       58 STORE_SUBSCR
                       62 LOAD_CONST              10 (None)
                       64 RETURN_VALUE
          consts
             'RawHeaderSpec'
@@ -389,749 +374,706 @@
             None
          names      ('__name__', '__module__', '__qualname__', '__annotations__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'RawHeaderSpec'
-         firstlineno 34
+         firstlineno 33
          lnotab 0x0c010a010a010a010a01
       'RawHeaderSpec'
       'md'
       'MachineData'
       'return'
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 3
          flags     : 16777219
          code
             0x97007401000000000000000000007c006a010000000000000000a60100
             00ab0100000000000000005300
-          45           0 RESUME                   0
+          41           0 RESUME                   0
          
-          46           2 LOAD_GLOBAL              1 (NULL + convert_header_to_raw)
+          42           2 LOAD_GLOBAL              1 (NULL + convert_header_to_raw)
                       14 LOAD_FAST                0 (md)
                       16 LOAD_ATTR                1 (header)
                       26 PRECALL                  1
                       30 CALL                     1
                       40 RETURN_VALUE
          consts
             None
          names      ('convert_header_to_raw', 'header')
          varnames   ('md',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'convert_to_raw_header'
-         firstlineno 45
+         firstlineno 41
          lnotab 0x0201
-      'RawDataType'
+      'pd.DataFrame'
       code
          argcount  : 1
          nlocals   : 6
-         stacksize : 7
+         stacksize : 6
          flags     : 16777219
          code
             0x9700740100000000000000000000740300000000000000000000640184
-            007c00a0020000000000000000000000000000000000000000a6000000ab
-            000000000000000000a6020000ab020000000000000000a6010000ab0100
-            000000000000007d017407000000000000000000006a0400000000000000
-            007c006a0500000000000000006402ac03a6020000ab0200000000000000
-            007d02740c000000000000000000006a0700000000000000007c02741100
-            0000000000000000007c01a6010000ab0100000000000000003c0000007c
-            00a0020000000000000000000000000000000000000000a6000000ab0000
-            0000000000000044005d6b7d037c036a0900000000000000007d04741100
-            0000000000000000007415000000000000000000007c036a0b0000000000
-            0000006a0c0000000000000000a6010000ab010000000000000000a60100
-            00ab0100000000000000007d057c046a0d00000000000000006400640085
-            02741d000000000000000000007c036a0b00000000000000006a0c000000
-            0000000000a6010000ab0100000000000000006602190000000000000000
-            006a0f00000000000000007c026a0d00000000000000007c046a10000000
-            00000000007c0566023c0000008c6c7422000000000000000000006a1200
-            000000000000007411000000000000000000007c01a6010000ab01000000
-            00000000007a0000007c025f1300000000000000007c025300
-          49           0 RESUME                   0
+            007c006a020000000000000000a6020000ab020000000000000000a60100
+            00ab0100000000000000007d017407000000000000000000006a04000000
+            00000000007c006a0500000000000000006402ac03a6020000ab02000000
+            00000000007d02740c000000000000000000006a0700000000000000007c
+            027411000000000000000000007c01a6010000ab0100000000000000003c
+            0000007c006a02000000000000000044005d6b7d037c036a090000000000
+            0000007d047411000000000000000000007415000000000000000000007c
+            036a0b00000000000000006a0c0000000000000000a6010000ab01000000
+            0000000000a6010000ab0100000000000000007d057c046a0d0000000000
+            000000640064008502741d000000000000000000007c036a0b0000000000
+            0000006a0c0000000000000000a6010000ab010000000000000000660219
+            0000000000000000006a0f00000000000000007c026a0d00000000000000
+            007c046a1000000000000000007c0566023c0000008c6c74220000000000
+            00000000006a1200000000000000007411000000000000000000007c01a6
+            010000ab0100000000000000007a0000007c025f1300000000000000007c
+            025300
+          45           0 RESUME                   0
          
-          50           2 LOAD_GLOBAL              1 (NULL + max)
+          46           2 LOAD_GLOBAL              1 (NULL + max)
                       14 LOAD_GLOBAL              3 (NULL + map)
-                      26 LOAD_CONST               1 (<code object <lambda>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 50>)
+                      26 LOAD_CONST               1 (<code object <lambda>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 46>)
                       28 MAKE_FUNCTION            0
                       30 LOAD_FAST                0 (md)
-                      32 LOAD_METHOD              2 (iter_all_timeseries)
-                      54 PRECALL                  0
-                      58 CALL                     0
-                      68 PRECALL                  2
-                      72 CALL                     2
-                      82 PRECALL                  1
-                      86 CALL                     1
-                      96 STORE_FAST               1 (max_features)
-         
-          58          98 LOAD_GLOBAL              7 (NULL + pd)
-                     110 LOAD_ATTR                4 (DataFrame)
-                     120 LOAD_FAST                0 (md)
-                     122 LOAD_ATTR                5 (index_frame)
-                     132 LOAD_CONST               2 (True)
-                     134 KW_NAMES                 3
-                     136 PRECALL                  2
-                     140 CALL                     2
-                     150 STORE_FAST               2 (res)
-         
-          59         152 LOAD_GLOBAL             12 (np)
-                     164 LOAD_ATTR                7 (NAN)
-                     174 LOAD_FAST                2 (res)
-                     176 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
-                     188 LOAD_FAST                1 (max_features)
-                     190 PRECALL                  1
-                     194 CALL                     1
-                     204 STORE_SUBSCR
-         
-          62         208 LOAD_FAST                0 (md)
-                     210 LOAD_METHOD              2 (iter_all_timeseries)
-                     232 PRECALL                  0
-                     236 CALL                     0
-                     246 GET_ITER
-                 >>  248 FOR_ITER               107 (to 464)
-                     250 STORE_FAST               3 (tsc)
-         
-          63         252 LOAD_FAST                3 (tsc)
-                     254 LOAD_ATTR                9 (df)
-                     264 STORE_FAST               4 (df)
-         
-          64         266 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
-                     278 LOAD_GLOBAL             21 (NULL + len)
-                     290 LOAD_FAST                3 (tsc)
-                     292 LOAD_ATTR               11 (timeseries_spec)
-                     302 LOAD_ATTR               12 (features)
-                     312 PRECALL                  1
-                     316 CALL                     1
-                     326 PRECALL                  1
-                     330 CALL                     1
-                     340 STORE_FAST               5 (cs)
-         
-          65         342 LOAD_FAST                4 (df)
-                     344 LOAD_ATTR               13 (loc)
-                     354 LOAD_CONST               0 (None)
-                     356 LOAD_CONST               0 (None)
-                     358 BUILD_SLICE              2
-                     360 LOAD_GLOBAL             29 (NULL + list)
-                     372 LOAD_FAST                3 (tsc)
-                     374 LOAD_ATTR               11 (timeseries_spec)
-                     384 LOAD_ATTR               12 (features)
-                     394 PRECALL                  1
-                     398 CALL                     1
-                     408 BUILD_TUPLE              2
-                     410 BINARY_SUBSCR
-                     420 LOAD_ATTR               15 (values)
-                     430 LOAD_FAST                2 (res)
-                     432 LOAD_ATTR               13 (loc)
-                     442 LOAD_FAST                4 (df)
-                     444 LOAD_ATTR               16 (index)
-                     454 LOAD_FAST                5 (cs)
-                     456 BUILD_TUPLE              2
-                     458 STORE_SUBSCR
-                     462 JUMP_BACKWARD          108 (to 248)
-         
-          67     >>  464 LOAD_GLOBAL             34 (MDConcepts)
-                     476 LOAD_ATTR               18 (base_columns)
-                     486 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
-                     498 LOAD_FAST                1 (max_features)
-                     500 PRECALL                  1
-                     504 CALL                     1
-                     514 BINARY_OP                0 (+)
-                     518 LOAD_FAST                2 (res)
-                     520 STORE_ATTR              19 (columns)
+                      32 LOAD_ATTR                2 (series_containers)
+                      42 PRECALL                  2
+                      46 CALL                     2
+                      56 PRECALL                  1
+                      60 CALL                     1
+                      70 STORE_FAST               1 (max_features)
+         
+          53          72 LOAD_GLOBAL              7 (NULL + pd)
+                      84 LOAD_ATTR                4 (DataFrame)
+                      94 LOAD_FAST                0 (md)
+                      96 LOAD_ATTR                5 (index_frame)
+                     106 LOAD_CONST               2 (True)
+                     108 KW_NAMES                 3
+                     110 PRECALL                  2
+                     114 CALL                     2
+                     124 STORE_FAST               2 (res)
+         
+          54         126 LOAD_GLOBAL             12 (np)
+                     138 LOAD_ATTR                7 (NAN)
+                     148 LOAD_FAST                2 (res)
+                     150 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
+                     162 LOAD_FAST                1 (max_features)
+                     164 PRECALL                  1
+                     168 CALL                     1
+                     178 STORE_SUBSCR
+         
+          57         182 LOAD_FAST                0 (md)
+                     184 LOAD_ATTR                2 (series_containers)
+                     194 GET_ITER
+                 >>  196 FOR_ITER               107 (to 412)
+                     198 STORE_FAST               3 (tsc)
+         
+          58         200 LOAD_FAST                3 (tsc)
+                     202 LOAD_ATTR                9 (df)
+                     212 STORE_FAST               4 (df)
+         
+          59         214 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
+                     226 LOAD_GLOBAL             21 (NULL + len)
+                     238 LOAD_FAST                3 (tsc)
+                     240 LOAD_ATTR               11 (timeseries_spec)
+                     250 LOAD_ATTR               12 (features)
+                     260 PRECALL                  1
+                     264 CALL                     1
+                     274 PRECALL                  1
+                     278 CALL                     1
+                     288 STORE_FAST               5 (cs)
+         
+          60         290 LOAD_FAST                4 (df)
+                     292 LOAD_ATTR               13 (loc)
+                     302 LOAD_CONST               0 (None)
+                     304 LOAD_CONST               0 (None)
+                     306 BUILD_SLICE              2
+                     308 LOAD_GLOBAL             29 (NULL + list)
+                     320 LOAD_FAST                3 (tsc)
+                     322 LOAD_ATTR               11 (timeseries_spec)
+                     332 LOAD_ATTR               12 (features)
+                     342 PRECALL                  1
+                     346 CALL                     1
+                     356 BUILD_TUPLE              2
+                     358 BINARY_SUBSCR
+                     368 LOAD_ATTR               15 (values)
+                     378 LOAD_FAST                2 (res)
+                     380 LOAD_ATTR               13 (loc)
+                     390 LOAD_FAST                4 (df)
+                     392 LOAD_ATTR               16 (index)
+                     402 LOAD_FAST                5 (cs)
+                     404 BUILD_TUPLE              2
+                     406 STORE_SUBSCR
+                     410 JUMP_BACKWARD          108 (to 196)
+         
+          62     >>  412 LOAD_GLOBAL             34 (MDConcepts)
+                     424 LOAD_ATTR               18 (base_columns)
+                     434 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
+                     446 LOAD_FAST                1 (max_features)
+                     448 PRECALL                  1
+                     452 CALL                     1
+                     462 BINARY_OP                0 (+)
+                     466 LOAD_FAST                2 (res)
+                     468 STORE_ATTR              19 (columns)
          
-          71         530 LOAD_FAST                2 (res)
-                     532 RETURN_VALUE
+          66         478 LOAD_FAST                2 (res)
+                     480 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777235
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                50           0 RESUME                   0
+                46           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + len)
-                            14 LOAD_FAST                0 (md_timeseries)
+                            14 LOAD_FAST                0 (tsc)
                             16 LOAD_ATTR                1 (timeseries_spec)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'timeseries_spec')
-               varnames   ('md_timeseries',)
+               varnames   ('tsc',)
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
                name       '<lambda>'
-               firstlineno 50
+               firstlineno 46
                lnotab 0x
             True
             ('copy',)
-         names      ('max', 'map', 'iter_all_timeseries', 'pd', 'DataFrame', 'index_frame', 'np', 'NAN', 'gen_feature_column_names', 'df', 'len', 'timeseries_spec', 'features', 'loc', 'list', 'values', 'index', 'MDConcepts', 'base_columns', 'columns')
+         names      ('max', 'map', 'series_containers', 'pd', 'DataFrame', 'index_frame', 'np', 'NAN', 'gen_feature_column_names', 'df', 'len', 'timeseries_spec', 'features', 'loc', 'list', 'values', 'index', 'MDConcepts', 'base_columns', 'columns')
          varnames   ('md', 'max_features', 'res', 'tsc', 'df', 'cs')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'convert_to_raw_data'
-         firstlineno 49
-         lnotab 0x02016008360138032c010e014c017a024204
+         firstlineno 45
+         lnotab 0x020146073601380312010e014c017a024204
       code
          argcount  : 1
          nlocals   : 6
          stacksize : 9
          flags     : 16777219
          code
             0x8706870797007401000000000000000000007403000000000000000000
-            00640184007c00a0020000000000000000000000000000000000000000a6
-            000000ab000000000000000000a6020000ab020000000000000000a60100
-            00ab0100000000000000007d0167007d027c00a002000000000000000000
-            0000000000000000000000a6000000ab00000000000000000044005d917d
-            037c036a0300000000000000007d047c036a0400000000000000008a0689
-            06a00500000000000000000000000000000000000000006402ac03a60100
-            00ab01000000000000000044005d6a8a077c02a006000000000000000000
-            0000000000000000000000740f0000000000000000000089077410000000
-            000000000000006a090000000000000000a6020000ab0200000000000000
-            00740f0000000000000000000089077410000000000000000000006a0a00
-            00000000000000a6020000ab0200000000000000007c046a0b0000000000
-            0000007c046a0c00000000000000006704880688076602640484087c046a
-            0d00000000000000004400a6000000ab0000000000000000007a000000a6
-            010000ab01000000000000000001008c6b8c92741d000000000000000000
-            006a0f00000000000000007c027410000000000000000000006a10000000
-            00000000007423000000000000000000007c01a6010000ab010000000000
-            0000007a000000ac05a6020000ab0200000000000000007d057c05a01200
-            000000000000000000000000000000000000007410000000000000000000
-            006a0900000000000000006402ac06a6020000ab02000000000000000001
-            007c055300
+            00640184007c006a020000000000000000a6020000ab0200000000000000
+            00a6010000ab0100000000000000007d0167007d027c006a020000000000
+            00000044005d917d037c036a0300000000000000007d047c036a04000000
+            00000000008a068906a00500000000000000000000000000000000000000
+            006402ac03a6010000ab01000000000000000044005d6a8a077c02a00600
+            00000000000000000000000000000000000000740f000000000000000000
+            0089077410000000000000000000006a090000000000000000a6020000ab
+            020000000000000000740f00000000000000000000890774100000000000
+            00000000006a0a0000000000000000a6020000ab0200000000000000007c
+            046a0b00000000000000007c046a0c000000000000000067048806880766
+            02640484087c046a0d00000000000000004400a6000000ab000000000000
+            0000007a000000a6010000ab01000000000000000001008c6b8c92741d00
+            0000000000000000006a0f00000000000000007c02741000000000000000
+            0000006a1000000000000000007423000000000000000000007c01a60100
+            00ab0100000000000000007a000000ac05a6020000ab0200000000000000
+            007d057c05a0120000000000000000000000000000000000000000741000
+            0000000000000000006a0900000000000000006402ac06a6020000ab0200
+            0000000000000001007c055300
                        0 MAKE_CELL                6 (df)
                        2 MAKE_CELL                7 (tup)
          
-          74           4 RESUME                   0
+          69           4 RESUME                   0
          
-          75           6 LOAD_GLOBAL              1 (NULL + max)
+          70           6 LOAD_GLOBAL              1 (NULL + max)
                       18 LOAD_GLOBAL              3 (NULL + map)
-                      30 LOAD_CONST               1 (<code object <lambda>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 75>)
+                      30 LOAD_CONST               1 (<code object <lambda>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 70>)
                       32 MAKE_FUNCTION            0
                       34 LOAD_FAST                0 (md)
-                      36 LOAD_METHOD              2 (iter_all_timeseries)
-                      58 PRECALL                  0
-                      62 CALL                     0
-                      72 PRECALL                  2
-                      76 CALL                     2
-                      86 PRECALL                  1
-                      90 CALL                     1
-                     100 STORE_FAST               1 (max_features)
-         
-          76         102 BUILD_LIST               0
-                     104 STORE_FAST               2 (rows)
-         
-          77         106 LOAD_FAST                0 (md)
-                     108 LOAD_METHOD              2 (iter_all_timeseries)
-                     130 PRECALL                  0
-                     134 CALL                     0
-                     144 GET_ITER
-                 >>  146 FOR_ITER               145 (to 438)
-                     148 STORE_FAST               3 (typed_timeseries)
-         
-          78         150 LOAD_FAST                3 (typed_timeseries)
-                     152 LOAD_ATTR                3 (timeseries_spec)
-                     162 STORE_FAST               4 (tt)
-         
-          79         164 LOAD_FAST                3 (typed_timeseries)
-                     166 LOAD_ATTR                4 (df)
-                     176 STORE_DEREF              6 (df)
-         
-          80         178 LOAD_DEREF               6 (df)
-                     180 LOAD_METHOD              5 (itertuples)
-                     202 LOAD_CONST               2 (True)
-                     204 KW_NAMES                 3
-                     206 PRECALL                  1
-                     210 CALL                     1
-                     220 GET_ITER
-                 >>  222 FOR_ITER               106 (to 436)
-                     224 STORE_DEREF              7 (tup)
-         
-          81         226 LOAD_FAST                2 (rows)
-                     228 LOAD_METHOD              6 (append)
-         
-          82         250 LOAD_GLOBAL             15 (NULL + getattr)
-                     262 LOAD_DEREF               7 (tup)
-                     264 LOAD_GLOBAL             16 (MDConcepts)
-                     276 LOAD_ATTR                9 (Time)
-                     286 PRECALL                  2
-                     290 CALL                     2
-                     300 LOAD_GLOBAL             15 (NULL + getattr)
-                     312 LOAD_DEREF               7 (tup)
-                     314 LOAD_GLOBAL             16 (MDConcepts)
-                     326 LOAD_ATTR               10 (Object)
-                     336 PRECALL                  2
-                     340 CALL                     2
-                     350 LOAD_FAST                4 (tt)
-                     352 LOAD_ATTR               11 (type)
-         
-          83         362 LOAD_FAST                4 (tt)
-                     364 LOAD_ATTR               12 (label)
-         
-          82         374 BUILD_LIST               4
-         
-          83         376 LOAD_CLOSURE             6 (df)
-                     378 LOAD_CLOSURE             7 (tup)
-                     380 BUILD_TUPLE              2
-                     382 LOAD_CONST               4 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 83>)
-                     384 MAKE_FUNCTION            8 (closure)
-         
-          85         386 LOAD_FAST                4 (tt)
-                     388 LOAD_ATTR               13 (features)
-         
-          83         398 GET_ITER
-                     400 PRECALL                  0
-                     404 CALL                     0
-         
-          82         414 BINARY_OP                0 (+)
-         
-          81         418 PRECALL                  1
-                     422 CALL                     1
-                     432 POP_TOP
-                     434 JUMP_BACKWARD          107 (to 222)
-         
-          80     >>  436 JUMP_BACKWARD          146 (to 146)
-         
-          87     >>  438 LOAD_GLOBAL             29 (NULL + pd)
-                     450 LOAD_ATTR               15 (DataFrame)
-                     460 LOAD_FAST                2 (rows)
-                     462 LOAD_GLOBAL             16 (MDConcepts)
-                     474 LOAD_ATTR               16 (base_columns)
-                     484 LOAD_GLOBAL             35 (NULL + gen_feature_column_names)
-                     496 LOAD_FAST                1 (max_features)
-                     498 PRECALL                  1
-                     502 CALL                     1
-                     512 BINARY_OP                0 (+)
-                     516 KW_NAMES                 5
-                     518 PRECALL                  2
-                     522 CALL                     2
-                     532 STORE_FAST               5 (res)
-         
-          88         534 LOAD_FAST                5 (res)
-                     536 LOAD_METHOD             18 (sort_values)
-                     558 LOAD_GLOBAL             16 (MDConcepts)
-                     570 LOAD_ATTR                9 (Time)
-                     580 LOAD_CONST               2 (True)
-                     582 KW_NAMES                 6
-                     584 PRECALL                  2
-                     588 CALL                     2
-                     598 POP_TOP
+                      36 LOAD_ATTR                2 (series_containers)
+                      46 PRECALL                  2
+                      50 CALL                     2
+                      60 PRECALL                  1
+                      64 CALL                     1
+                      74 STORE_FAST               1 (max_features)
+         
+          71          76 BUILD_LIST               0
+                      78 STORE_FAST               2 (rows)
+         
+          72          80 LOAD_FAST                0 (md)
+                      82 LOAD_ATTR                2 (series_containers)
+                      92 GET_ITER
+                 >>   94 FOR_ITER               145 (to 386)
+                      96 STORE_FAST               3 (typed_timeseries)
+         
+          73          98 LOAD_FAST                3 (typed_timeseries)
+                     100 LOAD_ATTR                3 (timeseries_spec)
+                     110 STORE_FAST               4 (tt)
+         
+          74         112 LOAD_FAST                3 (typed_timeseries)
+                     114 LOAD_ATTR                4 (df)
+                     124 STORE_DEREF              6 (df)
+         
+          75         126 LOAD_DEREF               6 (df)
+                     128 LOAD_METHOD              5 (itertuples)
+                     150 LOAD_CONST               2 (True)
+                     152 KW_NAMES                 3
+                     154 PRECALL                  1
+                     158 CALL                     1
+                     168 GET_ITER
+                 >>  170 FOR_ITER               106 (to 384)
+                     172 STORE_DEREF              7 (tup)
+         
+          76         174 LOAD_FAST                2 (rows)
+                     176 LOAD_METHOD              6 (append)
+         
+          77         198 LOAD_GLOBAL             15 (NULL + getattr)
+                     210 LOAD_DEREF               7 (tup)
+                     212 LOAD_GLOBAL             16 (MDConcepts)
+                     224 LOAD_ATTR                9 (Time)
+                     234 PRECALL                  2
+                     238 CALL                     2
+                     248 LOAD_GLOBAL             15 (NULL + getattr)
+                     260 LOAD_DEREF               7 (tup)
+                     262 LOAD_GLOBAL             16 (MDConcepts)
+                     274 LOAD_ATTR               10 (Object)
+                     284 PRECALL                  2
+                     288 CALL                     2
+                     298 LOAD_FAST                4 (tt)
+                     300 LOAD_ATTR               11 (type)
+         
+          78         310 LOAD_FAST                4 (tt)
+                     312 LOAD_ATTR               12 (label)
+         
+          77         322 BUILD_LIST               4
+         
+          78         324 LOAD_CLOSURE             6 (df)
+                     326 LOAD_CLOSURE             7 (tup)
+                     328 BUILD_TUPLE              2
+                     330 LOAD_CONST               4 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 78>)
+                     332 MAKE_FUNCTION            8 (closure)
+         
+          80         334 LOAD_FAST                4 (tt)
+                     336 LOAD_ATTR               13 (features)
+         
+          78         346 GET_ITER
+                     348 PRECALL                  0
+                     352 CALL                     0
+         
+          77         362 BINARY_OP                0 (+)
+         
+          76         366 PRECALL                  1
+                     370 CALL                     1
+                     380 POP_TOP
+                     382 JUMP_BACKWARD          107 (to 170)
+         
+          75     >>  384 JUMP_BACKWARD          146 (to 94)
+         
+          82     >>  386 LOAD_GLOBAL             29 (NULL + pd)
+                     398 LOAD_ATTR               15 (DataFrame)
+                     408 LOAD_FAST                2 (rows)
+                     410 LOAD_GLOBAL             16 (MDConcepts)
+                     422 LOAD_ATTR               16 (base_columns)
+                     432 LOAD_GLOBAL             35 (NULL + gen_feature_column_names)
+                     444 LOAD_FAST                1 (max_features)
+                     446 PRECALL                  1
+                     450 CALL                     1
+                     460 BINARY_OP                0 (+)
+                     464 KW_NAMES                 5
+                     466 PRECALL                  2
+                     470 CALL                     2
+                     480 STORE_FAST               5 (res)
+         
+          83         482 LOAD_FAST                5 (res)
+                     484 LOAD_METHOD             18 (sort_values)
+                     506 LOAD_GLOBAL             16 (MDConcepts)
+                     518 LOAD_ATTR                9 (Time)
+                     528 LOAD_CONST               2 (True)
+                     530 KW_NAMES                 6
+                     532 PRECALL                  2
+                     536 CALL                     2
+                     546 POP_TOP
          
-          89         600 LOAD_FAST                5 (res)
-                     602 RETURN_VALUE
+          84         548 LOAD_FAST                5 (res)
+                     550 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777235
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                75           0 RESUME                   0
+                70           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + len)
-                            14 LOAD_FAST                0 (md_timeseries)
+                            14 LOAD_FAST                0 (tsc)
                             16 LOAD_ATTR                1 (timeseries_spec)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'timeseries_spec')
-               varnames   ('md_timeseries',)
+               varnames   ('tsc',)
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
                name       '<lambda>'
-               firstlineno 75
+               firstlineno 70
                lnotab 0x
             True
             ('index',)
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 6
                flags     : 16777235
                code
                   0x9502970067007c005d1b7d017c0189026a0000000000000000007600af
                   0b74030000000000000000000089037c01a6020000ab0200000000000000
                   0091028c1c5300
                              0 COPY_FREE_VARS           2
                
-                83           2 RESUME                   0
+                78           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                27 (to 64)
                
-                84          10 STORE_FAST               1 (f)
+                79          10 STORE_FAST               1 (f)
                
-                86          12 LOAD_FAST                1 (f)
+                81          12 LOAD_FAST                1 (f)
                             14 LOAD_DEREF               2 (df)
                             16 LOAD_ATTR                0 (columns)
                             26 CONTAINS_OP              0
                             28 POP_JUMP_BACKWARD_IF_FALSE    11 (to 8)
                
-                83          30 LOAD_GLOBAL              3 (NULL + getattr)
+                78          30 LOAD_GLOBAL              3 (NULL + getattr)
                             42 LOAD_DEREF               3 (tup)
                             44 LOAD_FAST                1 (f)
                             46 PRECALL                  2
                             50 CALL                     2
                
-                86          60 LIST_APPEND              2
+                81          60 LIST_APPEND              2
                             62 JUMP_BACKWARD           28 (to 8)
                        >>   64 RETURN_VALUE
                consts
                names      ('columns', 'getattr')
                varnames   ('.0', 'f')
                freevars   ('df', 'tup')
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
                name       '<listcomp>'
-               firstlineno 83
+               firstlineno 78
                lnotab 0x0a01020212fd1e03
             ('columns',)
             ('inplace',)
-         names      ('max', 'map', 'iter_all_timeseries', 'timeseries_spec', 'df', 'itertuples', 'append', 'getattr', 'MDConcepts', 'Time', 'Object', 'type', 'label', 'features', 'pd', 'DataFrame', 'base_columns', 'gen_feature_column_names', 'sort_values')
+         names      ('max', 'map', 'series_containers', 'timeseries_spec', 'df', 'itertuples', 'append', 'getattr', 'MDConcepts', 'Time', 'Object', 'type', 'label', 'features', 'pd', 'DataFrame', 'base_columns', 'gen_feature_column_names', 'sort_values')
          varnames   ('md', 'max_features', 'rows', 'typed_timeseries', 'tt', 'res')
          freevars   ()
          cellvars   ('df', 'tup')
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'convert_to_raw_data_legacy'
-         firstlineno 74
+         firstlineno 69
          lnotab
-            0x0601600104012c010e010e013001180170010cff02010a020cfe10ff04
+            0x06014601040112010e010e013001180170010cff02010a020cfe10ff04
             ff12ff020760014201
       'raw_data'
       'raw_header'
       code
          argcount  : 2
          nlocals   : 20
-         stacksize : 7
+         stacksize : 9
          flags     : 16777219
          code
             0x97007401000000000000000000007c01a6010000ab0100000000000000
-            007d02670067007d047d037403000000000000000000007c007404000000
-            000000000000006a0300000000000000007404000000000000000000006a
-            0400000000000000007404000000000000000000006a0500000000000000
-            006703a6020000ab0200000000000000007d05740d000000000000000000
-            006a0700000000000000007c007404000000000000000000006a08000000
-            00000000006401ac02a6030000ab0300000000000000007d067c06a00900
-            000000000000000000000000000000000000007c056403ac04a6020000ab
-            0200000000000000007d067c06a00a000000000000000000000000000000
-            00000000007404000000000000000000006a050000000000000000740400
-            0000000000000000006a0400000000000000006702a6010000ab01000000
-            00000000006a0b0000000000000000a00c00000000000000000000000000
-            00000000000000a6000000ab000000000000000000440090015d775c0200
-            007d077d087c075c0200007d097d0a7c02a00d0000000000000000000000
-            0000000000000000007c097c0aa6020000ab0200000000000000007d0b02
-            00741d000000000000000000006a0f00000000000000007c09a6010000ab
-            0100000000000000007c0a7c0ba6020000ab0200000000000000007d0c7c
-            0c6a1000000000000000007d0d7423000000000000000000007c0da60100
-            00ab0100000000000000007d0e7425000000000000000000007c0ea60100
-            00ab0100000000000000007d0f740d000000000000000000006a13000000
-            00000000007c066a1400000000000000007c087404000000000000000000
-            006a0800000000000000006602190000000000000000007c006a14000000
-            00000000007c087c0f660219000000000000000000670264016405ac06a6
-            030000ab030000000000000000a015000000000000000000000000000000
-            00000000007c08a6010000ab0100000000000000007d1064078400742d00
-            0000000000000000007c0f7c0da6020000ab0200000000000000004400a6
-            000000ab0000000000000000007d117c10a0170000000000000000000000
-            0000000000000000007c116401ac08a6020000ab02000000000000000001
-            007431000000000000000000006a1900000000000000007c10640984007c
-            0b4400a6000000ab000000000000000000a6020000ab0200000000000000
-            00010002007435000000000000000000006a0f00000000000000007c0ca6
-            010000ab0100000000000000007c10a6010000ab0100000000000000007d
-            127437000000000000000000007c12743800000000000000000000a60200
-            00ab02000000000000000072177c03a01d00000000000000000000000000
-            000000000000007c12a6010000ab010000000000000000010090018c4d74
-            37000000000000000000007c12743c00000000000000000000a6020000ab
-            02000000000000000072157c04a01d000000000000000000000000000000
-            00000000007c12a6010000ab010000000000000000010090018c79743f00
-            0000000000000000007441000000000000000000007c066a210000000000
-            000000a6010000ab010000000000000000a0220000000000000000000000
-            0000000000000000007404000000000000000000006a0800000000000000
-            00a6010000ab010000000000000000a6010000ab0100000000000000007d
-            137c06a02300000000000000000000000000000000000000007c136401ac
-            08a6020000ab02000000000000000001007449000000000000000000007c
-            026a2500000000000000007c037c047c06ac0aa6040000ab040000000000
-            0000005300
-          92           0 RESUME                   0
+            007d02640164026c016d027d03010002007c037c026a0300000000000000
+            006a040000000000000000a6010000ab0100000000000000007d04740b00
+            0000000000000000007c00740c000000000000000000006a070000000000
+            000000740c000000000000000000006a080000000000000000740c000000
+            000000000000006a0900000000000000006703a6020000ab020000000000
+            0000007d057415000000000000000000006a0b00000000000000007c0074
+            0c000000000000000000006a0c00000000000000006403ac04a6030000ab
+            0300000000000000007d067c06a00d000000000000000000000000000000
+            00000000007c056405ac06a6020000ab0200000000000000007d0667007d
+            077c06a00e0000000000000000000000000000000000000000740c000000
+            000000000000006a090000000000000000740c000000000000000000006a
+            0800000000000000006702a6010000ab0100000000000000006a0f000000
+            0000000000a0100000000000000000000000000000000000000000a60000
+            00ab000000000000000000440090015d0b5c0200007d087d097c085c0200
+            007d0a7d0b7c02a01100000000000000000000000000000000000000007c
+            0a7c0ba6020000ab0200000000000000007d0c7c04a01200000000000000
+            000000000000000000000000007c0a7c0b66027c0ca6020000ab02000000
+            00000000007d0d7c0d6a1300000000000000007d0e742900000000000000
+            0000007c0ea6010000ab0100000000000000007d0f742b00000000000000
+            0000007c0fa6010000ab0100000000000000007d10741500000000000000
+            0000006a1600000000000000007c066a1700000000000000007c09740c00
+            0000000000000000006a0c00000000000000006602190000000000000000
+            007c006a1700000000000000007c097c1066021900000000000000000067
+            0264036401ac07a6030000ab030000000000000000a01800000000000000
+            000000000000000000000000007c09a6010000ab0100000000000000007d
+            11640884007433000000000000000000007c107c0ea6020000ab02000000
+            00000000004400a6000000ab0000000000000000007d127c11a01a000000
+            00000000000000000000000000000000007c126403ac09a6020000ab0200
+            0000000000000001007c07a01b0000000000000000000000000000000000
+            0000007c04a01c00000000000000000000000000000000000000007c0d7c
+            1164056403ac0aa6040000ab040000000000000000a6010000ab01000000
+            0000000000010090018c0d743b00000000000000000000743d0000000000
+            00000000007c066a1f0000000000000000a6010000ab0100000000000000
+            00a0200000000000000000000000000000000000000000740c0000000000
+            00000000006a0c0000000000000000a6010000ab010000000000000000a6
+            010000ab0100000000000000007d137c06a0210000000000000000000000
+            0000000000000000007c136403ac09a6020000ab02000000000000000001
+            007c04a02200000000000000000000000000000000000000007c026a0300
+            000000000000007c077c06ac0ba6030000ab0300000000000000005300
+          87           0 RESUME                   0
          
-          93           2 LOAD_GLOBAL              1 (NULL + create_header_from_raw)
+          88           2 LOAD_GLOBAL              1 (NULL + create_header_from_raw)
                       14 LOAD_FAST                1 (raw_header)
                       16 PRECALL                  1
                       20 CALL                     1
                       30 STORE_FAST               2 (header)
          
-          95          32 BUILD_LIST               0
-                      34 BUILD_LIST               0
-                      36 STORE_FAST               4 (mdms)
-                      38 STORE_FAST               3 (mdes)
-         
-          97          40 LOAD_GLOBAL              3 (NULL + derive_categoricals)
-                      52 LOAD_FAST                0 (raw_data)
-                      54 LOAD_GLOBAL              4 (MDConcepts)
-                      66 LOAD_ATTR                3 (Object)
-                      76 LOAD_GLOBAL              4 (MDConcepts)
-                      88 LOAD_ATTR                4 (Label)
-                      98 LOAD_GLOBAL              4 (MDConcepts)
-                     110 LOAD_ATTR                5 (Type)
-                     120 BUILD_LIST               3
-                     122 PRECALL                  2
-                     126 CALL                     2
-                     136 STORE_FAST               5 (categories)
-         
-          99         138 LOAD_GLOBAL             13 (NULL + pd)
-                     150 LOAD_ATTR                7 (DataFrame)
-                     160 LOAD_FAST                0 (raw_data)
-                     162 LOAD_GLOBAL              4 (MDConcepts)
-                     174 LOAD_ATTR                8 (base_columns)
-                     184 LOAD_CONST               1 (True)
-                     186 KW_NAMES                 2
-                     188 PRECALL                  3
-                     192 CALL                     3
-                     202 STORE_FAST               6 (overall)
-         
-         100         204 LOAD_FAST                6 (overall)
-                     206 LOAD_METHOD              9 (astype)
-                     228 LOAD_FAST                5 (categories)
-                     230 LOAD_CONST               3 (False)
+          90          32 LOAD_CONST               1 (1)
+                      34 LOAD_CONST               2 (('get_factory',))
+                      36 IMPORT_NAME              1 (factory)
+                      38 IMPORT_FROM              2 (get_factory)
+                      40 STORE_FAST               3 (get_factory)
+                      42 POP_TOP
+         
+          91          44 PUSH_NULL
+                      46 LOAD_FAST                3 (get_factory)
+                      48 LOAD_FAST                2 (header)
+                      50 LOAD_ATTR                3 (meta)
+                      60 LOAD_ATTR                4 (extensions)
+                      70 PRECALL                  1
+                      74 CALL                     1
+                      84 STORE_FAST               4 (factory)
+         
+          93          86 LOAD_GLOBAL             11 (NULL + derive_categoricals)
+                      98 LOAD_FAST                0 (raw_data)
+                     100 LOAD_GLOBAL             12 (MDConcepts)
+                     112 LOAD_ATTR                7 (Object)
+                     122 LOAD_GLOBAL             12 (MDConcepts)
+                     134 LOAD_ATTR                8 (Label)
+                     144 LOAD_GLOBAL             12 (MDConcepts)
+                     156 LOAD_ATTR                9 (Type)
+                     166 BUILD_LIST               3
+                     168 PRECALL                  2
+                     172 CALL                     2
+                     182 STORE_FAST               5 (categories)
+         
+          95         184 LOAD_GLOBAL             21 (NULL + pd)
+                     196 LOAD_ATTR               11 (DataFrame)
+                     206 LOAD_FAST                0 (raw_data)
+                     208 LOAD_GLOBAL             12 (MDConcepts)
+                     220 LOAD_ATTR               12 (base_columns)
+                     230 LOAD_CONST               3 (True)
                      232 KW_NAMES                 4
-                     234 PRECALL                  2
-                     238 CALL                     2
+                     234 PRECALL                  3
+                     238 CALL                     3
                      248 STORE_FAST               6 (overall)
          
-         102         250 LOAD_FAST                6 (overall)
-                     252 LOAD_METHOD             10 (groupby)
-                     274 LOAD_GLOBAL              4 (MDConcepts)
-                     286 LOAD_ATTR                5 (Type)
-                     296 LOAD_GLOBAL              4 (MDConcepts)
-                     308 LOAD_ATTR                4 (Label)
-                     318 BUILD_LIST               2
-                     320 PRECALL                  1
-                     324 CALL                     1
-                     334 LOAD_ATTR               11 (groups)
-                     344 LOAD_METHOD             12 (items)
-                     366 PRECALL                  0
-                     370 CALL                     0
-                     380 GET_ITER
-                 >>  382 EXTENDED_ARG             1
-                     384 FOR_ITER               375 (to 1136)
-                     386 UNPACK_SEQUENCE          2
-                     390 STORE_FAST               7 (group)
-                     392 STORE_FAST               8 (idx)
-         
-         103         394 LOAD_FAST                7 (group)
-                     396 UNPACK_SEQUENCE          2
-                     400 STORE_FAST               9 (tpy)
-                     402 STORE_FAST              10 (label)
-         
-         104         404 LOAD_FAST                2 (header)
-                     406 LOAD_METHOD             13 (lookup_spec)
-                     428 LOAD_FAST                9 (tpy)
-                     430 LOAD_FAST               10 (label)
-                     432 PRECALL                  2
-                     436 CALL                     2
-                     446 STORE_FAST              11 (spec)
-         
-         106         448 PUSH_NULL
-                     450 LOAD_GLOBAL             29 (NULL + TimeseriesSpecFactory)
-                     462 LOAD_ATTR               15 (for_type)
-                     472 LOAD_FAST                9 (tpy)
-                     474 PRECALL                  1
-                     478 CALL                     1
-                     488 LOAD_FAST               10 (label)
-                     490 LOAD_FAST               11 (spec)
-                     492 PRECALL                  2
-                     496 CALL                     2
-                     506 STORE_FAST              12 (timeseries_type)
-         
-         108         508 LOAD_FAST               12 (timeseries_type)
-                     510 LOAD_ATTR               16 (features)
-                     520 STORE_FAST              13 (actual_feature_labels)
-         
-         109         522 LOAD_GLOBAL             35 (NULL + len)
-                     534 LOAD_FAST               13 (actual_feature_labels)
-                     536 PRECALL                  1
-                     540 CALL                     1
-                     550 STORE_FAST              14 (feature_count)
-         
-         110         552 LOAD_GLOBAL             37 (NULL + gen_feature_column_names)
-                     564 LOAD_FAST               14 (feature_count)
-                     566 PRECALL                  1
-                     570 CALL                     1
-                     580 STORE_FAST              15 (placeholder_feature_labels)
-         
-         111         582 LOAD_GLOBAL             13 (NULL + pd)
-                     594 LOAD_ATTR               19 (concat)
-                     604 LOAD_FAST                6 (overall)
-                     606 LOAD_ATTR               20 (loc)
-                     616 LOAD_FAST                8 (idx)
-                     618 LOAD_GLOBAL              4 (MDConcepts)
-                     630 LOAD_ATTR                8 (base_columns)
-                     640 BUILD_TUPLE              2
-                     642 BINARY_SUBSCR
-                     652 LOAD_FAST                0 (raw_data)
-                     654 LOAD_ATTR               20 (loc)
-                     664 LOAD_FAST                8 (idx)
-                     666 LOAD_FAST               15 (placeholder_feature_labels)
-                     668 BUILD_TUPLE              2
-                     670 BINARY_SUBSCR
-                     680 BUILD_LIST               2
-         
-         112         682 LOAD_CONST               1 (True)
-                     684 LOAD_CONST               5 (1)
-         
-         111         686 KW_NAMES                 6
-                     688 PRECALL                  3
-                     692 CALL                     3
-         
-         112         702 LOAD_METHOD             21 (set_index)
-                     724 LOAD_FAST                8 (idx)
-                     726 PRECALL                  1
-                     730 CALL                     1
-         
-         111         740 STORE_FAST              16 (df)
-         
-         117         742 LOAD_CONST               7 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 117>)
-                     744 MAKE_FUNCTION            0
-                     746 LOAD_GLOBAL             45 (NULL + zip)
-                     758 LOAD_FAST               15 (placeholder_feature_labels)
-                     760 LOAD_FAST               13 (actual_feature_labels)
-                     762 PRECALL                  2
-                     766 CALL                     2
-                     776 GET_ITER
-                     778 PRECALL                  0
-                     782 CALL                     0
-                     792 STORE_FAST              17 (renaming_dict)
-         
-         118         794 LOAD_FAST               16 (df)
-                     796 LOAD_METHOD             23 (rename)
-                     818 LOAD_FAST               17 (renaming_dict)
-                     820 LOAD_CONST               1 (True)
-                     822 KW_NAMES                 8
-                     824 PRECALL                  2
-                     828 CALL                     2
-                     838 POP_TOP
-         
-         120         840 LOAD_GLOBAL             49 (NULL + metadata)
-                     852 LOAD_ATTR               25 (convert_df_inplace)
-                     862 LOAD_FAST               16 (df)
-                     864 LOAD_CONST               9 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 120>)
-                     866 MAKE_FUNCTION            0
-                     868 LOAD_FAST               11 (spec)
-                     870 GET_ITER
-                     872 PRECALL                  0
-                     876 CALL                     0
-                     886 PRECALL                  2
-                     890 CALL                     2
-                     900 POP_TOP
-         
-         122         902 PUSH_NULL
-                     904 LOAD_GLOBAL             53 (NULL + TimeseriesCollectionFactory)
-                     916 LOAD_ATTR               15 (for_type)
-                     926 LOAD_FAST               12 (timeseries_type)
-                     928 PRECALL                  1
-                     932 CALL                     1
-                     942 LOAD_FAST               16 (df)
-                     944 PRECALL                  1
-                     948 CALL                     1
-                     958 STORE_FAST              18 (ts_collection)
-         
-         123         960 LOAD_GLOBAL             55 (NULL + isinstance)
-                     972 LOAD_FAST               18 (ts_collection)
-                     974 LOAD_GLOBAL             56 (EventTimeseriesCollection)
-                     986 PRECALL                  2
-                     990 CALL                     2
-                    1000 POP_JUMP_FORWARD_IF_FALSE    23 (to 1048)
-         
-         124        1002 LOAD_FAST                3 (mdes)
-                    1004 LOAD_METHOD             29 (append)
-                    1026 LOAD_FAST               18 (ts_collection)
-                    1028 PRECALL                  1
-                    1032 CALL                     1
-                    1042 POP_TOP
-                    1044 EXTENDED_ARG             1
-                    1046 JUMP_BACKWARD          333 (to 382)
-         
-         125     >> 1048 LOAD_GLOBAL             55 (NULL + isinstance)
-                    1060 LOAD_FAST               18 (ts_collection)
-                    1062 LOAD_GLOBAL             60 (MeasurementTimeseriesCollection)
-                    1074 PRECALL                  2
-                    1078 CALL                     2
-                    1088 POP_JUMP_FORWARD_IF_FALSE    21 (to 1132)
-         
-         126        1090 LOAD_FAST                4 (mdms)
-                    1092 LOAD_METHOD             29 (append)
-                    1114 LOAD_FAST               18 (ts_collection)
-                    1116 PRECALL                  1
-                    1120 CALL                     1
-                    1130 POP_TOP
-                 >> 1132 EXTENDED_ARG             1
-                    1134 JUMP_BACKWARD          377 (to 382)
-         
-         128     >> 1136 LOAD_GLOBAL             63 (NULL + list)
-                    1148 LOAD_GLOBAL             65 (NULL + set)
-                    1160 LOAD_FAST                6 (overall)
-                    1162 LOAD_ATTR               33 (columns)
-                    1172 PRECALL                  1
-                    1176 CALL                     1
-                    1186 LOAD_METHOD             34 (difference)
-                    1208 LOAD_GLOBAL              4 (MDConcepts)
-                    1220 LOAD_ATTR                8 (base_columns)
-                    1230 PRECALL                  1
-                    1234 CALL                     1
-                    1244 PRECALL                  1
-                    1248 CALL                     1
-                    1258 STORE_FAST              19 (placeholder_cols)
-         
-         129        1260 LOAD_FAST                6 (overall)
-                    1262 LOAD_METHOD             35 (drop)
-                    1284 LOAD_FAST               19 (placeholder_cols)
-                    1286 LOAD_CONST               1 (True)
-                    1288 KW_NAMES                 8
-                    1290 PRECALL                  2
-                    1294 CALL                     2
-                    1304 POP_TOP
-         
-         131        1306 LOAD_GLOBAL             73 (NULL + MachineData)
-                    1318 LOAD_FAST                2 (header)
-                    1320 LOAD_ATTR               37 (meta)
-                    1330 LOAD_FAST                3 (mdes)
-                    1332 LOAD_FAST                4 (mdms)
-                    1334 LOAD_FAST                6 (overall)
-                    1336 KW_NAMES                10
-                    1338 PRECALL                  4
-                    1342 CALL                     4
-                    1352 RETURN_VALUE
+          96         250 LOAD_FAST                6 (overall)
+                     252 LOAD_METHOD             13 (astype)
+                     274 LOAD_FAST                5 (categories)
+                     276 LOAD_CONST               5 (False)
+                     278 KW_NAMES                 6
+                     280 PRECALL                  2
+                     284 CALL                     2
+                     294 STORE_FAST               6 (overall)
+         
+          98         296 BUILD_LIST               0
+                     298 STORE_FAST               7 (series_containers)
+         
+          99         300 LOAD_FAST                6 (overall)
+                     302 LOAD_METHOD             14 (groupby)
+                     324 LOAD_GLOBAL             12 (MDConcepts)
+                     336 LOAD_ATTR                9 (Type)
+                     346 LOAD_GLOBAL             12 (MDConcepts)
+                     358 LOAD_ATTR                8 (Label)
+                     368 BUILD_LIST               2
+                     370 PRECALL                  1
+                     374 CALL                     1
+                     384 LOAD_ATTR               15 (groups)
+                     394 LOAD_METHOD             16 (items)
+                     416 PRECALL                  0
+                     420 CALL                     0
+                     430 GET_ITER
+                 >>  432 EXTENDED_ARG             1
+                     434 FOR_ITER               267 (to 970)
+                     436 UNPACK_SEQUENCE          2
+                     440 STORE_FAST               8 (group)
+                     442 STORE_FAST               9 (idx)
+         
+         100         444 LOAD_FAST                8 (group)
+                     446 UNPACK_SEQUENCE          2
+                     450 STORE_FAST              10 (tpy)
+                     452 STORE_FAST              11 (label)
+         
+         101         454 LOAD_FAST                2 (header)
+                     456 LOAD_METHOD             17 (lookup_spec)
+                     478 LOAD_FAST               10 (tpy)
+                     480 LOAD_FAST               11 (label)
+                     482 PRECALL                  2
+                     486 CALL                     2
+                     496 STORE_FAST              12 (spec)
+         
+         102         498 LOAD_FAST                4 (factory)
+                     500 LOAD_METHOD             18 (make_ts_spec)
+                     522 LOAD_FAST               10 (tpy)
+                     524 LOAD_FAST               11 (label)
+                     526 BUILD_TUPLE              2
+                     528 LOAD_FAST               12 (spec)
+                     530 PRECALL                  2
+                     534 CALL                     2
+                     544 STORE_FAST              13 (ts_spec)
+         
+         104         546 LOAD_FAST               13 (ts_spec)
+                     548 LOAD_ATTR               19 (features)
+                     558 STORE_FAST              14 (actual_feature_labels)
+         
+         105         560 LOAD_GLOBAL             41 (NULL + len)
+                     572 LOAD_FAST               14 (actual_feature_labels)
+                     574 PRECALL                  1
+                     578 CALL                     1
+                     588 STORE_FAST              15 (feature_count)
+         
+         106         590 LOAD_GLOBAL             43 (NULL + gen_feature_column_names)
+                     602 LOAD_FAST               15 (feature_count)
+                     604 PRECALL                  1
+                     608 CALL                     1
+                     618 STORE_FAST              16 (placeholder_feature_labels)
+         
+         107         620 LOAD_GLOBAL             21 (NULL + pd)
+                     632 LOAD_ATTR               22 (concat)
+                     642 LOAD_FAST                6 (overall)
+                     644 LOAD_ATTR               23 (loc)
+                     654 LOAD_FAST                9 (idx)
+                     656 LOAD_GLOBAL             12 (MDConcepts)
+                     668 LOAD_ATTR               12 (base_columns)
+                     678 BUILD_TUPLE              2
+                     680 BINARY_SUBSCR
+                     690 LOAD_FAST                0 (raw_data)
+                     692 LOAD_ATTR               23 (loc)
+                     702 LOAD_FAST                9 (idx)
+                     704 LOAD_FAST               16 (placeholder_feature_labels)
+                     706 BUILD_TUPLE              2
+                     708 BINARY_SUBSCR
+                     718 BUILD_LIST               2
+         
+         108         720 LOAD_CONST               3 (True)
+                     722 LOAD_CONST               1 (1)
+         
+         107         724 KW_NAMES                 7
+                     726 PRECALL                  3
+                     730 CALL                     3
+         
+         108         740 LOAD_METHOD             24 (set_index)
+                     762 LOAD_FAST                9 (idx)
+                     764 PRECALL                  1
+                     768 CALL                     1
+         
+         107         778 STORE_FAST              17 (df)
+         
+         113         780 LOAD_CONST               8 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\raw.py", line 113>)
+                     782 MAKE_FUNCTION            0
+                     784 LOAD_GLOBAL             51 (NULL + zip)
+                     796 LOAD_FAST               16 (placeholder_feature_labels)
+                     798 LOAD_FAST               14 (actual_feature_labels)
+                     800 PRECALL                  2
+                     804 CALL                     2
+                     814 GET_ITER
+                     816 PRECALL                  0
+                     820 CALL                     0
+                     830 STORE_FAST              18 (renaming_dict)
+         
+         114         832 LOAD_FAST               17 (df)
+                     834 LOAD_METHOD             26 (rename)
+                     856 LOAD_FAST               18 (renaming_dict)
+                     858 LOAD_CONST               3 (True)
+                     860 KW_NAMES                 9
+                     862 PRECALL                  2
+                     866 CALL                     2
+                     876 POP_TOP
+         
+         116         878 LOAD_FAST                7 (series_containers)
+                     880 LOAD_METHOD             27 (append)
+                     902 LOAD_FAST                4 (factory)
+                     904 LOAD_METHOD             28 (make_ts_container)
+                     926 LOAD_FAST               13 (ts_spec)
+                     928 LOAD_FAST               17 (df)
+                     930 LOAD_CONST               5 (False)
+                     932 LOAD_CONST               3 (True)
+                     934 KW_NAMES                10
+                     936 PRECALL                  4
+                     940 CALL                     4
+                     950 PRECALL                  1
+                     954 CALL                     1
+                     964 POP_TOP
+                     966 EXTENDED_ARG             1
+                     968 JUMP_BACKWARD          269 (to 432)
+         
+         118     >>  970 LOAD_GLOBAL             59 (NULL + list)
+                     982 LOAD_GLOBAL             61 (NULL + set)
+                     994 LOAD_FAST                6 (overall)
+                     996 LOAD_ATTR               31 (columns)
+                    1006 PRECALL                  1
+                    1010 CALL                     1
+                    1020 LOAD_METHOD             32 (difference)
+                    1042 LOAD_GLOBAL             12 (MDConcepts)
+                    1054 LOAD_ATTR               12 (base_columns)
+                    1064 PRECALL                  1
+                    1068 CALL                     1
+                    1078 PRECALL                  1
+                    1082 CALL                     1
+                    1092 STORE_FAST              19 (placeholder_cols)
+         
+         119        1094 LOAD_FAST                6 (overall)
+                    1096 LOAD_METHOD             33 (drop)
+                    1118 LOAD_FAST               19 (placeholder_cols)
+                    1120 LOAD_CONST               3 (True)
+                    1122 KW_NAMES                 9
+                    1124 PRECALL                  2
+                    1128 CALL                     2
+                    1138 POP_TOP
+         
+         121        1140 LOAD_FAST                4 (factory)
+                    1142 LOAD_METHOD             34 (make)
+                    1164 LOAD_FAST                2 (header)
+                    1166 LOAD_ATTR                3 (meta)
+                    1176 LOAD_FAST                7 (series_containers)
+                    1178 LOAD_FAST                6 (overall)
+                    1180 KW_NAMES                11
+                    1182 PRECALL                  3
+                    1186 CALL                     3
+                    1196 RETURN_VALUE
          consts
             None
+            1
+            ('get_factory',)
             True
             ('columns', 'copy')
             False
             ('copy',)
-            1
             ('copy', 'axis')
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 4
                flags     : 16777235
                code 0x970069007c005d085c0200007d017d027c017c0293028c095300
-               117           0 RESUME                   0
+               113           0 RESUME                   0
                              2 BUILD_MAP                0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 8 (to 24)
                              8 UNPACK_SEQUENCE          2
                             12 STORE_FAST               1 (old)
                             14 STORE_FAST               2 (new)
                             16 LOAD_FAST                1 (old)
@@ -1142,63 +1084,35 @@
                consts
                names      ()
                varnames   ('.0', 'old', 'new')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
                name       '<dictcomp>'
-               firstlineno 117
+               firstlineno 113
                lnotab 0x
             ('columns', 'inplace')
-            code
-               argcount  : 1
-               nlocals   : 2
-               stacksize : 4
-               flags     : 16777235
-               code
-                  0x970069007c005d0f7d017c016a0000000000000000007c016a01000000
-                  000000000093028c105300
-               120           0 RESUME                   0
-                             2 BUILD_MAP                0
-                             4 LOAD_FAST                0 (.0)
-                       >>    6 FOR_ITER                15 (to 38)
-                             8 STORE_FAST               1 (f)
-                            10 LOAD_FAST                1 (f)
-                            12 LOAD_ATTR                0 (name)
-                            22 LOAD_FAST                1 (f)
-                            24 LOAD_ATTR                1 (data_type)
-                            34 MAP_ADD                  2
-                            36 JUMP_BACKWARD           16 (to 6)
-                       >>   38 RETURN_VALUE
-               consts
-               names      ('name', 'data_type')
-               varnames   ('.0', 'f')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
-               name       '<dictcomp>'
-               firstlineno 120
-               lnotab 0x
-            ('index_frame',)
-         names      ('create_header_from_raw', 'derive_categoricals', 'MDConcepts', 'Object', 'Label', 'Type', 'pd', 'DataFrame', 'base_columns', 'astype', 'groupby', 'groups', 'items', 'lookup_spec', 'TimeseriesSpecFactory', 'for_type', 'features', 'len', 'gen_feature_column_names', 'concat', 'loc', 'set_index', 'zip', 'rename', 'metadata', 'convert_df_inplace', 'TimeseriesCollectionFactory', 'isinstance', 'EventTimeseriesCollection', 'append', 'MeasurementTimeseriesCollection', 'list', 'set', 'columns', 'difference', 'drop', 'MachineData', 'meta')
-         varnames   ('raw_data', 'raw_header', 'header', 'mdes', 'mdms', 'categories', 'overall', 'group', 'idx', 'tpy', 'label', 'spec', 'timeseries_type', 'actual_feature_labels', 'feature_count', 'placeholder_feature_labels', 'df', 'renaming_dict', 'ts_collection', 'placeholder_cols')
+            ('copy', 'convert_dtypes')
+            ('series_containers', 'index_frame')
+         names      ('create_header_from_raw', 'factory', 'get_factory', 'meta', 'extensions', 'derive_categoricals', 'MDConcepts', 'Object', 'Label', 'Type', 'pd', 'DataFrame', 'base_columns', 'astype', 'groupby', 'groups', 'items', 'lookup_spec', 'make_ts_spec', 'features', 'len', 'gen_feature_column_names', 'concat', 'loc', 'set_index', 'zip', 'rename', 'append', 'make_ts_container', 'list', 'set', 'columns', 'difference', 'drop', 'make')
+         varnames   ('raw_data', 'raw_header', 'header', 'get_factory', 'factory', 'categories', 'overall', 'series_containers', 'group', 'idx', 'tpy', 'label', 'spec', 'ts_spec', 'actual_feature_labels', 'feature_count', 'placeholder_feature_labels', 'df', 'renaming_dict', 'placeholder_cols')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
          name       'create_machine_data_from_raw'
-         firstlineno 92
+         firstlineno 87
          lnotab
-            0x02011e020802620242012e0290010a012c023c020e011e011e01640104
-            ff100126ff020634012e023e023a012a012e012a012e027c012e02
+            0x02011e020c012a02620242012e02040190010a012c0130020e011e011e
+            01640104ff100126ff020634012e025c027c012e02
       ('md', 'MachineData', 'return', 'RawHeaderSpec')
-      ('md', 'MachineData', 'return', 'RawDataType')
-      ('raw_data', 'RawDataType', 'raw_header', 'RawHeaderSpec')
-   names      ('__future__', 'annotations', 'typing', 'TypedDict', 'Any', 'numpy', 'np', 'pandas', 'pd', 'df_utils', 'derive_categoricals', 'extensions', 'metadata', 'header', 'create_header_from_raw', 'ObservationSpec', 'convert_header_to_raw', 'machine_data_def', 'MDConcepts', 'EventTimeseriesCollection', 'MeasurementTimeseriesCollection', 'MachineData', 'TimeseriesCollectionFactory', 'TimeseriesSpecFactory', 'gen_feature_column_names', 'FeatureMetadata', 'str', 'RawBaseFeatureSpec', 'dict', 'RawMetadataFeatureSpec', 'list', 'RawObservationSpecs', 'RawAnnotationSpecs', 'RawHeaderSpec', 'DataFrame', 'RawDataType', 'convert_to_raw_header', 'convert_to_raw_data', 'convert_to_raw_data_legacy', 'create_machine_data_from_raw')
+      ('md', 'MachineData', 'return', 'pd.DataFrame')
+      ('raw_data', 'pd.DataFrame', 'raw_header', 'RawHeaderSpec', 'return', 'MachineData')
+   names      ('__future__', 'annotations', 'typing', 'TypedDict', 'Any', 'numpy', 'np', 'pandas', 'pd', 'df_utils', 'derive_categoricals', 'header', 'create_header_from_raw', 'ObservationSpec', 'convert_header_to_raw', 'shared_defs', 'MDConcepts', 'protocols', 'MachineData', 'gen_feature_column_names', 'FeatureMetadata', 'str', 'RawBaseFeatureSpec', 'dict', 'RawMetadataFeatureSpec', 'list', 'RawObservationSpecs', 'RawAnnotationSpecs', 'RawHeaderSpec', 'convert_to_raw_header', 'convert_to_raw_data', 'convert_to_raw_data_legacy', 'create_machine_data_from_raw')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\raw.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c021002080108020c010c0114012004060420050401140126
-      03200520080e03080408190812
+      0x00ff02010c021002080108020c0114010c010c03060420050401140126
+      0320052008080408180812
```

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/util.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/util.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/__pycache__/util.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/__pycache__/util.cpython-311.pyc`

 * *Files 25% similar despite different names*

#### Python bytecode

```diff
@@ -1,23 +1,27 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
-files sz: 3019
+moddate:  0xebf6d064 (Mon Aug  7 13:51:39 2023 UTC)
+files sz: 3403
 code
    argcount  : 0
    nlocals   : 0
-   stacksize : 7
+   stacksize : 9
    flags     : 16777216
    code
       0x9700640064016c006d015a010100640064026c025a02640064036c036d
-      045a046d055a056d065a066d075a070100640064046c086d095a096d0a5a
-      0a01000200470064058400640665046506650ba6050000ab050000000000
-      0000005a0c02004700640784006408650cac09a6030000ab030000000000
-      0000005a0d6420640e84045a0e6421641084045a0f6422641284045a1064
-      236424641684055a11641784005a126425641884015a136425641984015a
-      146426641e84045a156427641f84015a1664025300
+      045a040100640064046c056d065a066d075a076d085a086d095a09010064
+      0064056c0a6d0b5a0b6d0c5a0c6d0d5a0d6d0e5a0e010002004700640684
+      006407650fa6030000ab0300000000000000005a10020047006408840064
+      096510ac0aa6030000ab0300000000000000005a110200650e640ba60100
+      00ab0100000000000000005a120200650e640c640dac0ea6020000ab0200
+      000000000000005a1302004700640f840064106508650665131900000000
+      0000000000650d65126513660219000000000000000000a6050000ab0500
+      000000000000005a146426641584045a156427641784045a166428641984
+      045a176429642a641c84055a18641d84005a19642b641e84015a1a642b64
+      1f84015a1b642c642484045a1c642d642584015a1d64025300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('annotations',))
                  6 IMPORT_NAME              0 (__future__)
                  8 IMPORT_FROM              1 (annotations)
                 10 STORE_NAME               1 (annotations)
@@ -25,150 +29,194 @@
    
      3          14 LOAD_CONST               0 (0)
                 16 LOAD_CONST               2 (None)
                 18 IMPORT_NAME              2 (enum)
                 20 STORE_NAME               2 (enum)
    
      4          22 LOAD_CONST               0 (0)
-                24 LOAD_CONST               3 (('Iterable', 'Collection', 'Sized', 'Iterator'))
-                26 IMPORT_NAME              3 (collections.abc)
-                28 IMPORT_FROM              4 (Iterable)
-                30 STORE_NAME               4 (Iterable)
-                32 IMPORT_FROM              5 (Collection)
-                34 STORE_NAME               5 (Collection)
-                36 IMPORT_FROM              6 (Sized)
-                38 STORE_NAME               6 (Sized)
-                40 IMPORT_FROM              7 (Iterator)
-                42 STORE_NAME               7 (Iterator)
-                44 POP_TOP
+                24 LOAD_CONST               3 (('abstractmethod',))
+                26 IMPORT_NAME              3 (abc)
+                28 IMPORT_FROM              4 (abstractmethod)
+                30 STORE_NAME               4 (abstractmethod)
+                32 POP_TOP
    
-     5          46 LOAD_CONST               0 (0)
-                48 LOAD_CONST               4 (('Any', 'Optional'))
-                50 IMPORT_NAME              8 (typing)
-                52 IMPORT_FROM              9 (Any)
-                54 STORE_NAME               9 (Any)
-                56 IMPORT_FROM             10 (Optional)
-                58 STORE_NAME              10 (Optional)
-                60 POP_TOP
+     5          34 LOAD_CONST               0 (0)
+                36 LOAD_CONST               4 (('Iterable', 'Collection', 'Sized', 'Iterator'))
+                38 IMPORT_NAME              5 (collections.abc)
+                40 IMPORT_FROM              6 (Iterable)
+                42 STORE_NAME               6 (Iterable)
+                44 IMPORT_FROM              7 (Collection)
+                46 STORE_NAME               7 (Collection)
+                48 IMPORT_FROM              8 (Sized)
+                50 STORE_NAME               8 (Sized)
+                52 IMPORT_FROM              9 (Iterator)
+                54 STORE_NAME               9 (Iterator)
+                56 POP_TOP
    
-     8          62 PUSH_NULL
-                64 LOAD_BUILD_CLASS
-                66 LOAD_CONST               5 (<code object MyMeta, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 8>)
-                68 MAKE_FUNCTION            0
-                70 LOAD_CONST               6 ('MyMeta')
-                72 LOAD_NAME                4 (Iterable)
-                74 LOAD_NAME                6 (Sized)
-                76 LOAD_NAME               11 (type)
-                78 PRECALL                  5
-                82 CALL                     5
-                92 STORE_NAME              12 (MyMeta)
+     6          58 LOAD_CONST               0 (0)
+                60 LOAD_CONST               5 (('Any', 'Optional', 'Protocol', 'TypeVar'))
+                62 IMPORT_NAME             10 (typing)
+                64 IMPORT_FROM             11 (Any)
+                66 STORE_NAME              11 (Any)
+                68 IMPORT_FROM             12 (Optional)
+                70 STORE_NAME              12 (Optional)
+                72 IMPORT_FROM             13 (Protocol)
+                74 STORE_NAME              13 (Protocol)
+                76 IMPORT_FROM             14 (TypeVar)
+                78 STORE_NAME              14 (TypeVar)
+                80 POP_TOP
    
-    31          94 PUSH_NULL
-                96 LOAD_BUILD_CLASS
-                98 LOAD_CONST               7 (<code object StringEnumeration, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 31>)
-               100 MAKE_FUNCTION            0
-               102 LOAD_CONST               8 ('StringEnumeration')
-               104 LOAD_NAME               12 (MyMeta)
-               106 KW_NAMES                 9
-               108 PRECALL                  3
-               112 CALL                     3
-               122 STORE_NAME              13 (StringEnumeration)
+     9          82 PUSH_NULL
+                84 LOAD_BUILD_CLASS
+                86 LOAD_CONST               6 (<code object MyMeta, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 9>)
+                88 MAKE_FUNCTION            0
+                90 LOAD_CONST               7 ('MyMeta')
+                92 LOAD_NAME               15 (type)
+                94 PRECALL                  3
+                98 CALL                     3
+               108 STORE_NAME              16 (MyMeta)
    
-    35         124 LOAD_CONST              32 (('arg', 'Iterable[Any]', 'return', 'Optional[Any]'))
-               126 LOAD_CONST              14 (<code object take_first, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 35>)
-               128 MAKE_FUNCTION            4 (annotations)
-               130 STORE_NAME              14 (take_first)
+    32         110 PUSH_NULL
+               112 LOAD_BUILD_CLASS
+               114 LOAD_CONST               8 (<code object StringEnumeration, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 32>)
+               116 MAKE_FUNCTION            0
+               118 LOAD_CONST               9 ('StringEnumeration')
+               120 LOAD_NAME               16 (MyMeta)
+               122 KW_NAMES                10
+               124 PRECALL                  3
+               128 CALL                     3
+               138 STORE_NAME              17 (StringEnumeration)
    
-    39         132 LOAD_CONST              33 (('return', 'set'))
-               134 LOAD_CONST              16 (<code object intersection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 39>)
-               136 MAKE_FUNCTION            4 (annotations)
-               138 STORE_NAME              15 (intersection)
+    36         140 PUSH_NULL
+               142 LOAD_NAME               14 (TypeVar)
+               144 LOAD_CONST              11 ('K')
+               146 PRECALL                  1
+               150 CALL                     1
+               160 STORE_NAME              18 (K)
    
-    46         140 LOAD_CONST              34 (('return', 'tuple[set, set]'))
-               142 LOAD_CONST              18 (<code object symmetric_difference, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 46>)
-               144 MAKE_FUNCTION            4 (annotations)
-               146 STORE_NAME              16 (symmetric_difference)
+    37         162 PUSH_NULL
+               164 LOAD_NAME               14 (TypeVar)
+               166 LOAD_CONST              12 ('V')
+               168 LOAD_CONST              13 (True)
+               170 KW_NAMES                14
+               172 PRECALL                  2
+               176 CALL                     2
+               186 STORE_NAME              19 (V)
    
-    58         148 LOAD_CONST              35 ((False, True, False))
-               150 LOAD_CONST              36 (('arg', 'None | str | Iterable'))
-               152 LOAD_CONST              22 (<code object mangle_arg_to, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 58>)
-               154 MAKE_FUNCTION            5 (defaults, annotations)
-               156 STORE_NAME              17 (mangle_arg_to)
+    40         188 PUSH_NULL
+               190 LOAD_BUILD_CLASS
+               192 LOAD_CONST              15 (<code object SlimMapping, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 40>)
+               194 MAKE_FUNCTION            0
+               196 LOAD_CONST              16 ('SlimMapping')
+               198 LOAD_NAME                8 (Sized)
+               200 LOAD_NAME                6 (Iterable)
+               202 LOAD_NAME               19 (V)
+               204 BINARY_SUBSCR
+               214 LOAD_NAME               13 (Protocol)
+               216 LOAD_NAME               18 (K)
+               218 LOAD_NAME               19 (V)
+               220 BUILD_TUPLE              2
+               222 BINARY_SUBSCR
+               232 PRECALL                  5
+               236 CALL                     5
+               246 STORE_NAME              20 (SlimMapping)
    
-    75         158 LOAD_CONST              23 (<code object mangle_arg_to_set, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 75>)
-               160 MAKE_FUNCTION            0
-               162 STORE_NAME              18 (mangle_arg_to_set)
+    48         248 LOAD_CONST              38 (('arg', 'Iterable[Any]', 'return', 'Optional[Any]'))
+               250 LOAD_CONST              21 (<code object take_first, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 48>)
+               252 MAKE_FUNCTION            4 (annotations)
+               254 STORE_NAME              21 (take_first)
    
-    79         164 LOAD_CONST              37 ((True, True))
-               166 LOAD_CONST              24 (<code object mangle_arg_to_list, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 79>)
-               168 MAKE_FUNCTION            1 (defaults)
-               170 STORE_NAME              19 (mangle_arg_to_list)
+    52         256 LOAD_CONST              39 (('return', 'set'))
+               258 LOAD_CONST              23 (<code object intersection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 52>)
+               260 MAKE_FUNCTION            4 (annotations)
+               262 STORE_NAME              22 (intersection)
    
-    83         172 LOAD_CONST              37 ((True, True))
-               174 LOAD_CONST              25 (<code object mangle_arg_to_tuple, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 83>)
-               176 MAKE_FUNCTION            1 (defaults)
-               178 STORE_NAME              20 (mangle_arg_to_tuple)
+    59         264 LOAD_CONST              40 (('return', 'tuple[set, set]'))
+               266 LOAD_CONST              25 (<code object symmetric_difference, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 59>)
+               268 MAKE_FUNCTION            4 (annotations)
+               270 STORE_NAME              23 (symmetric_difference)
    
-    87         180 LOAD_CONST              38 (('items', 'Iterable', 'allowed', 'Collection'))
-               182 LOAD_CONST              30 (<code object assert_in, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 87>)
-               184 MAKE_FUNCTION            4 (annotations)
-               186 STORE_NAME              21 (assert_in)
+    71         272 LOAD_CONST              41 ((False, True, False))
+               274 LOAD_CONST              42 (('arg', 'None | str | Iterable'))
+               276 LOAD_CONST              28 (<code object mangle_arg_to, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 71>)
+               278 MAKE_FUNCTION            5 (defaults, annotations)
+               280 STORE_NAME              24 (mangle_arg_to)
    
-    91         188 LOAD_CONST              39 ((None, None, True))
-               190 LOAD_CONST              31 (<code object mangle_arg_with_bool_fallback, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 91>)
-               192 MAKE_FUNCTION            1 (defaults)
-               194 STORE_NAME              22 (mangle_arg_with_bool_fallback)
-               196 LOAD_CONST               2 (None)
-               198 RETURN_VALUE
+    88         282 LOAD_CONST              29 (<code object mangle_arg_to_set, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 88>)
+               284 MAKE_FUNCTION            0
+               286 STORE_NAME              25 (mangle_arg_to_set)
+   
+    92         288 LOAD_CONST              43 ((True, True))
+               290 LOAD_CONST              30 (<code object mangle_arg_to_list, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 92>)
+               292 MAKE_FUNCTION            1 (defaults)
+               294 STORE_NAME              26 (mangle_arg_to_list)
+   
+    96         296 LOAD_CONST              43 ((True, True))
+               298 LOAD_CONST              31 (<code object mangle_arg_to_tuple, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 96>)
+               300 MAKE_FUNCTION            1 (defaults)
+               302 STORE_NAME              27 (mangle_arg_to_tuple)
+   
+   100         304 LOAD_CONST              44 (('items', 'Iterable', 'allowed', 'Collection'))
+               306 LOAD_CONST              36 (<code object assert_in, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 100>)
+               308 MAKE_FUNCTION            4 (annotations)
+               310 STORE_NAME              28 (assert_in)
+   
+   104         312 LOAD_CONST              45 ((None, None, True))
+               314 LOAD_CONST              37 (<code object mangle_arg_with_bool_fallback, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 104>)
+               316 MAKE_FUNCTION            1 (defaults)
+               318 STORE_NAME              29 (mangle_arg_with_bool_fallback)
+               320 LOAD_CONST               2 (None)
+               322 RETURN_VALUE
    consts
       0
       ('annotations',)
       None
+      ('abstractmethod',)
       ('Iterable', 'Collection', 'Sized', 'Iterator')
-      ('Any', 'Optional')
+      ('Any', 'Optional', 'Protocol', 'TypeVar')
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 2
          flags     : 16777216
          code
             0x8700970065005a0164005a0288006601640184085a03640b640484045a
             04640c640684045a05640d640884045a06640e640a84015a07880078015a
             085300
                        0 MAKE_CELL                0 (__class__)
          
-           8           2 RESUME                   0
+           9           2 RESUME                   0
                        4 LOAD_NAME                0 (__name__)
                        6 STORE_NAME               1 (__module__)
                        8 LOAD_CONST               0 ('MyMeta')
                       10 STORE_NAME               2 (__qualname__)
          
-           9          12 LOAD_CLOSURE             0 (__class__)
+          10          12 LOAD_CLOSURE             0 (__class__)
                       14 BUILD_TUPLE              1
-                      16 LOAD_CONST               1 (<code object __new__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 9>)
+                      16 LOAD_CONST               1 (<code object __new__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 10>)
                       18 MAKE_FUNCTION            8 (closure)
                       20 STORE_NAME               3 (__new__)
          
-          15          22 LOAD_CONST              11 (('return', 'str'))
-                      24 LOAD_CONST               4 (<code object __getitem__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 15>)
+          16          22 LOAD_CONST              11 (('return', 'str'))
+                      24 LOAD_CONST               4 (<code object __getitem__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 16>)
                       26 MAKE_FUNCTION            4 (annotations)
                       28 STORE_NAME               4 (__getitem__)
          
-          21          30 LOAD_CONST              12 (('return', 'int'))
-                      32 LOAD_CONST               6 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 21>)
+          22          30 LOAD_CONST              12 (('return', 'int'))
+                      32 LOAD_CONST               6 (<code object __len__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 22>)
                       34 MAKE_FUNCTION            4 (annotations)
                       36 STORE_NAME               5 (__len__)
          
-          24          38 LOAD_CONST              13 (('return', 'Iterator[str]'))
-                      40 LOAD_CONST               8 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 24>)
+          25          38 LOAD_CONST              13 (('return', 'Iterator[str]'))
+                      40 LOAD_CONST               8 (<code object __iter__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 25>)
                       42 MAKE_FUNCTION            4 (annotations)
                       44 STORE_NAME               6 (__iter__)
          
-          27          46 LOAD_CONST              14 ((None,))
-                      48 LOAD_CONST              10 (<code object derive_enum, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 27>)
+          28          46 LOAD_CONST              14 ((None,))
+                      48 LOAD_CONST              10 (<code object derive_enum, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 28>)
                       50 MAKE_FUNCTION            1 (defaults)
                       52 STORE_NAME               7 (derive_enum)
                       54 LOAD_CLOSURE             0 (__class__)
                       56 COPY                     1
                       58 STORE_NAME               8 (__classcell__)
                       60 RETURN_VALUE
          consts
@@ -185,67 +233,67 @@
                   000000000000000000000000000000a6000000ab00000000000000000044
                   00a6000000ab0000000000000000007c045f030000000000000000740900
                   0000000000000000007c046a030000000000000000a00500000000000000
                   00000000000000000000000000a6000000ab000000000000000000a60100
                   00ab0100000000000000007c045f0500000000000000007c045300
                              0 COPY_FREE_VARS           1
                
-                 9           2 RESUME                   0
+                10           2 RESUME                   0
                
-                10           4 LOAD_GLOBAL              1 (NULL + super)
+                11           4 LOAD_GLOBAL              1 (NULL + super)
                             16 PRECALL                  0
                             20 CALL                     0
                             30 LOAD_METHOD              1 (__new__)
                             52 LOAD_FAST                0 (cls)
                             54 LOAD_FAST                1 (name)
                             56 LOAD_FAST                2 (bases)
                             58 LOAD_FAST                3 (dct)
                             60 PRECALL                  4
                             64 CALL                     4
                             74 STORE_FAST               4 (cli)
                
-                11          76 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 11>)
+                12          76 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 12>)
                             78 MAKE_FUNCTION            0
                             80 LOAD_FAST                3 (dct)
                             82 LOAD_METHOD              2 (items)
                            104 PRECALL                  0
                            108 CALL                     0
                            118 GET_ITER
                            120 PRECALL                  0
                            124 CALL                     0
                            134 LOAD_FAST                4 (cli)
                            136 STORE_ATTR               3 (value_map)
                
-                12         146 LOAD_GLOBAL              9 (NULL + list)
+                13         146 LOAD_GLOBAL              9 (NULL + list)
                            158 LOAD_FAST                4 (cli)
                            160 LOAD_ATTR                3 (value_map)
                            170 LOAD_METHOD              5 (values)
                            192 PRECALL                  0
                            196 CALL                     0
                            206 PRECALL                  1
                            210 CALL                     1
                            220 LOAD_FAST                4 (cli)
                            222 STORE_ATTR               5 (values)
                
-                13         232 LOAD_FAST                4 (cli)
+                14         232 LOAD_FAST                4 (cli)
                            234 RETURN_VALUE
                consts
                   None
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 6
                      flags     : 16777235
                      code
                         0x970069007c005d395c0200007d017d02740000000000000000000000a0
                         0100000000000000000000000000000000000000007c016400a6020000ab
                         020000000000000000b0207405000000000000000000007c02a6010000ab
                         0100000000000000007400000000000000000000007500af367c017c0293
                         028c3a5300
-                      11           0 RESUME                   0
+                      12           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                57 (to 122)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (k)
                                   14 STORE_FAST               2 (v)
                                   16 LOAD_GLOBAL              0 (str)
@@ -271,222 +319,323 @@
                         '_'
                      names      ('str', 'startswith', 'type')
                      varnames   ('.0', 'k', 'v')
                      freevars   ()
                      cellvars   ()
                      filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                      name       '<dictcomp>'
-                     firstlineno 11
+                     firstlineno 12
                      lnotab 0x
                names      ('super', '__new__', 'items', 'value_map', 'list', 'values')
                varnames   ('cls', 'name', 'bases', 'dct', 'cli')
                freevars   ('__class__',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '__new__'
-               firstlineno 9
+               firstlineno 10
                lnotab 0x0401480146015601
             'return'
             'str'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 16777219
                code
                   0x97007c017c006a0000000000000000007600720d7c006a000000000000
                   0000007c011900000000000000000053007c017c006a0100000000000000
                   00760072027c01530064005300
-                15           0 RESUME                   0
+                16           0 RESUME                   0
                
-                16           2 LOAD_FAST                1 (key)
+                17           2 LOAD_FAST                1 (key)
                              4 LOAD_FAST                0 (self)
                              6 LOAD_ATTR                0 (value_map)
                             16 CONTAINS_OP              0
                             18 POP_JUMP_FORWARD_IF_FALSE    13 (to 46)
                
-                17          20 LOAD_FAST                0 (self)
+                18          20 LOAD_FAST                0 (self)
                             22 LOAD_ATTR                0 (value_map)
                             32 LOAD_FAST                1 (key)
                             34 BINARY_SUBSCR
                             44 RETURN_VALUE
                
-                18     >>   46 LOAD_FAST                1 (key)
+                19     >>   46 LOAD_FAST                1 (key)
                             48 LOAD_FAST                0 (self)
                             50 LOAD_ATTR                1 (values)
                             60 CONTAINS_OP              0
                             62 POP_JUMP_FORWARD_IF_FALSE     2 (to 68)
                
-                19          64 LOAD_FAST                1 (key)
+                20          64 LOAD_FAST                1 (key)
                             66 RETURN_VALUE
                
-                18     >>   68 LOAD_CONST               0 (None)
+                19     >>   68 LOAD_CONST               0 (None)
                             70 RETURN_VALUE
                consts
                   None
                names      ('value_map', 'values')
                varnames   ('self', 'key')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '__getitem__'
-               firstlineno 15
+               firstlineno 16
                lnotab 0x020112011a01120104ff
             'int'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                21           0 RESUME                   0
+                22           0 RESUME                   0
                
-                22           2 LOAD_GLOBAL              1 (NULL + len)
+                23           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (value_map)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'value_map')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '__len__'
-               firstlineno 21
+               firstlineno 22
                lnotab 0x0201
             'Iterator[str]'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 16777219
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-                24           0 RESUME                   0
+                25           0 RESUME                   0
                
-                25           2 LOAD_GLOBAL              1 (NULL + iter)
+                26           2 LOAD_GLOBAL              1 (NULL + iter)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (values)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('iter', 'values')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '__iter__'
-               firstlineno 24
+               firstlineno 25
                lnotab 0x0201
             None
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 5
                flags     : 16777219
                code
-                  0x97007401000000000000000000006a0100000000000000007c0180147c
-                  006a0200000000000000006a030000000000000000640064018502190000
-                  000000000000006e017c017c006a040000000000000000a6020000ab0200
-                  000000000000005300
-                27           0 RESUME                   0
+                  0x97007401000000000000000000006a0100000000000000007c01800f7c
+                  006a020000000000000000640064018502190000000000000000006e017c
+                  017c006a030000000000000000a6020000ab0200000000000000005300
+                28           0 RESUME                   0
                
-                28           2 LOAD_GLOBAL              1 (NULL + enum)
+                29           2 LOAD_GLOBAL              1 (NULL + enum)
                             14 LOAD_ATTR                1 (Enum)
                             24 LOAD_FAST                1 (name)
-                            26 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 68)
+                            26 POP_JUMP_FORWARD_IF_NOT_NONE    15 (to 58)
                             28 LOAD_FAST                0 (cls)
-                            30 LOAD_ATTR                2 (__class__)
-                            40 LOAD_ATTR                3 (__name__)
-                            50 LOAD_CONST               0 (None)
-                            52 LOAD_CONST               1 (-1)
-                            54 BUILD_SLICE              2
-                            56 BINARY_SUBSCR
-                            66 JUMP_FORWARD             1 (to 70)
-                       >>   68 LOAD_FAST                1 (name)
-                       >>   70 LOAD_FAST                0 (cls)
-                            72 LOAD_ATTR                4 (value_map)
-                            82 PRECALL                  2
-                            86 CALL                     2
-                            96 RETURN_VALUE
+                            30 LOAD_ATTR                2 (__name__)
+                            40 LOAD_CONST               0 (None)
+                            42 LOAD_CONST               1 (-1)
+                            44 BUILD_SLICE              2
+                            46 BINARY_SUBSCR
+                            56 JUMP_FORWARD             1 (to 60)
+                       >>   58 LOAD_FAST                1 (name)
+                       >>   60 LOAD_FAST                0 (cls)
+                            62 LOAD_ATTR                3 (value_map)
+                            72 PRECALL                  2
+                            76 CALL                     2
+                            86 RETURN_VALUE
                consts
                   None
                   -1
-               names      ('enum', 'Enum', '__class__', '__name__', 'value_map')
+               names      ('enum', 'Enum', '__name__', 'value_map')
                varnames   ('cls', 'name')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       'derive_enum'
-               firstlineno 27
+               firstlineno 28
                lnotab 0x0201
             ('return', 'str')
             ('return', 'int')
             ('return', 'Iterator[str]')
             (None,)
          names      ('__name__', '__module__', '__qualname__', '__new__', '__getitem__', '__len__', '__iter__', 'derive_enum', '__classcell__')
          varnames   ()
          freevars   ()
          cellvars   ('__class__',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'MyMeta'
-         firstlineno 8
+         firstlineno 9
          lnotab 0x0c010a06080608030803
       'MyMeta'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 16777216
          code 0x970065005a0164005a0264015300
-          31           0 RESUME                   0
+          32           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('StringEnumeration')
                        8 STORE_NAME               2 (__qualname__)
          
-          32          10 LOAD_CONST               1 (None)
+          33          10 LOAD_CONST               1 (None)
                       12 RETURN_VALUE
          consts
             'StringEnumeration'
             None
          names      ('__name__', '__module__', '__qualname__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'StringEnumeration'
-         firstlineno 31
+         firstlineno 32
          lnotab 0x0a01
       'StringEnumeration'
       ('metaclass',)
+      'K'
+      'V'
+      True
+      ('covariant',)
+      code
+         argcount  : 0
+         nlocals   : 0
+         stacksize : 3
+         flags     : 16777216
+         code
+            0x970065005a0164005a026503640b64058404a6000000ab000000000000
+            0000005a046503640c64098404a6000000ab0000000000000000005a0564
+            0a5300
+          40           0 RESUME                   0
+                       2 LOAD_NAME                0 (__name__)
+                       4 STORE_NAME               1 (__module__)
+                       6 LOAD_CONST               0 ('SlimMapping')
+                       8 STORE_NAME               2 (__qualname__)
+         
+          41          10 LOAD_NAME                3 (abstractmethod)
+         
+          42          12 LOAD_CONST              11 (('_SlimMapping__x', 'object', 'return', 'bool'))
+                      14 LOAD_CONST               5 (<code object __contains__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 41>)
+                      16 MAKE_FUNCTION            4 (annotations)
+         
+          41          18 PRECALL                  0
+                      22 CALL                     0
+         
+          42          32 STORE_NAME               4 (__contains__)
+         
+          44          34 LOAD_NAME                3 (abstractmethod)
+         
+          45          36 LOAD_CONST              12 (('item', 'K', 'return', 'V'))
+                      38 LOAD_CONST               9 (<code object __getitem__, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 44>)
+                      40 MAKE_FUNCTION            4 (annotations)
+         
+          44          42 PRECALL                  0
+                      46 CALL                     0
+         
+          45          56 STORE_NAME               5 (__getitem__)
+                      58 LOAD_CONST              10 (None)
+                      60 RETURN_VALUE
+         consts
+            'SlimMapping'
+            '_SlimMapping__x'
+            'object'
+            'return'
+            'bool'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 1
+               flags     : 16777219
+               code 0x970064005300
+                41           0 RESUME                   0
+               
+                42           2 LOAD_CONST               0 (None)
+                             4 RETURN_VALUE
+               consts
+                  None
+               names      ()
+               varnames   ('self', '_SlimMapping__x')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
+               name       '__contains__'
+               firstlineno 41
+               lnotab 0x0201
+            'item'
+            'K'
+            'V'
+            code
+               argcount  : 2
+               nlocals   : 2
+               stacksize : 1
+               flags     : 16777219
+               code 0x970064005300
+                44           0 RESUME                   0
+               
+                45           2 LOAD_CONST               0 (None)
+                             4 RETURN_VALUE
+               consts
+                  None
+               names      ()
+               varnames   ('self', 'item')
+               freevars   ()
+               cellvars   ()
+               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
+               name       '__getitem__'
+               firstlineno 44
+               lnotab 0x0201
+            None
+            ('_SlimMapping__x', 'object', 'return', 'bool')
+            ('item', 'K', 'return', 'V')
+         names      ('__name__', '__module__', '__qualname__', 'abstractmethod', '__contains__', '__getitem__')
+         varnames   ()
+         freevars   ()
+         cellvars   ()
+         filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
+         name       'SlimMapping'
+         firstlineno 40
+         lnotab 0x0a01020106ff0e010202020106ff0e01
+      'SlimMapping'
       'arg'
       'Iterable[Any]'
       'return'
       'Optional[Any]'
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 5
          flags     : 16777219
          code
             0x97007401000000000000000000007403000000000000000000007c00a6
             010000ab0100000000000000006400a6020000ab02000000000000000053
             00
-          35           0 RESUME                   0
+          48           0 RESUME                   0
          
-          36           2 LOAD_GLOBAL              1 (NULL + next)
+          49           2 LOAD_GLOBAL              1 (NULL + next)
                       14 LOAD_GLOBAL              3 (NULL + iter)
                       26 LOAD_FAST                0 (arg)
                       28 PRECALL                  1
                       32 CALL                     1
                       42 LOAD_CONST               0 (None)
                       44 PRECALL                  2
                       48 CALL                     2
@@ -495,40 +644,40 @@
             None
          names      ('next', 'iter')
          varnames   ('arg',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'take_first'
-         firstlineno 35
+         firstlineno 48
          lnotab 0x0201
       'set'
       code
          argcount  : 2
          nlocals   : 2
          stacksize : 4
          flags     : 16777219
          code
             0x97007c0081027c01800e740100000000000000000000a6000000ab0000
             0000000000000053007401000000000000000000007c00a6010000ab0100
             000000000000007401000000000000000000007c01a6010000ab01000000
             00000000007a0100005300
-          39           0 RESUME                   0
+          52           0 RESUME                   0
          
-          40           2 LOAD_FAST                0 (a)
+          53           2 LOAD_FAST                0 (a)
                        4 POP_JUMP_FORWARD_IF_NONE     2 (to 10)
                        6 LOAD_FAST                1 (b)
                        8 POP_JUMP_FORWARD_IF_NOT_NONE    14 (to 38)
          
-          41     >>   10 LOAD_GLOBAL              1 (NULL + set)
+          54     >>   10 LOAD_GLOBAL              1 (NULL + set)
                       22 PRECALL                  0
                       26 CALL                     0
                       36 RETURN_VALUE
          
-          43     >>   38 LOAD_GLOBAL              1 (NULL + set)
+          56     >>   38 LOAD_GLOBAL              1 (NULL + set)
                       50 LOAD_FAST                0 (a)
                       52 PRECALL                  1
                       56 CALL                     1
                       66 LOAD_GLOBAL              1 (NULL + set)
                       78 LOAD_FAST                1 (b)
                       80 PRECALL                  1
                       84 CALL                     1
@@ -538,15 +687,15 @@
             None
          names      ('set',)
          varnames   ('a', 'b')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'intersection'
-         firstlineno 39
+         firstlineno 52
          lnotab 0x020108011c02
       'tuple[set, set]'
       code
          argcount  : 2
          nlocals   : 2
          stacksize : 4
          flags     : 16777219
@@ -557,68 +706,68 @@
             000000000000007401000000000000000000007c01a6010000ab01000000
             0000000000660253007c01801d7401000000000000000000007c00a60100
             00ab010000000000000000740100000000000000000000a6000000ab0000
             00000000000000660253007401000000000000000000007c00a6010000ab
             0100000000000000007401000000000000000000007c01a6010000ab0100
             000000000000007d017d007c007c017a0a00007c017c007a0a0000660253
             00
-          46           0 RESUME                   0
+          59           0 RESUME                   0
          
-          47           2 LOAD_FAST                0 (a)
+          60           2 LOAD_FAST                0 (a)
                        4 POP_JUMP_FORWARD_IF_NOT_NONE    30 (to 66)
                        6 LOAD_FAST                1 (b)
                        8 POP_JUMP_FORWARD_IF_NOT_NONE    28 (to 66)
          
-          48          10 LOAD_GLOBAL              1 (NULL + set)
+          61          10 LOAD_GLOBAL              1 (NULL + set)
                       22 PRECALL                  0
                       26 CALL                     0
                       36 LOAD_GLOBAL              1 (NULL + set)
                       48 PRECALL                  0
                       52 CALL                     0
                       62 BUILD_TUPLE              2
                       64 RETURN_VALUE
          
-          49     >>   66 LOAD_FAST                0 (a)
+          62     >>   66 LOAD_FAST                0 (a)
                       68 POP_JUMP_FORWARD_IF_NOT_NONE    29 (to 128)
          
-          50          70 LOAD_GLOBAL              1 (NULL + set)
+          63          70 LOAD_GLOBAL              1 (NULL + set)
                       82 PRECALL                  0
                       86 CALL                     0
                       96 LOAD_GLOBAL              1 (NULL + set)
                      108 LOAD_FAST                1 (b)
                      110 PRECALL                  1
                      114 CALL                     1
                      124 BUILD_TUPLE              2
                      126 RETURN_VALUE
          
-          51     >>  128 LOAD_FAST                1 (b)
+          64     >>  128 LOAD_FAST                1 (b)
                      130 POP_JUMP_FORWARD_IF_NOT_NONE    29 (to 190)
          
-          52         132 LOAD_GLOBAL              1 (NULL + set)
+          65         132 LOAD_GLOBAL              1 (NULL + set)
                      144 LOAD_FAST                0 (a)
                      146 PRECALL                  1
                      150 CALL                     1
                      160 LOAD_GLOBAL              1 (NULL + set)
                      172 PRECALL                  0
                      176 CALL                     0
                      186 BUILD_TUPLE              2
                      188 RETURN_VALUE
          
-          54     >>  190 LOAD_GLOBAL              1 (NULL + set)
+          67     >>  190 LOAD_GLOBAL              1 (NULL + set)
                      202 LOAD_FAST                0 (a)
                      204 PRECALL                  1
                      208 CALL                     1
                      218 LOAD_GLOBAL              1 (NULL + set)
                      230 LOAD_FAST                1 (b)
                      232 PRECALL                  1
                      236 CALL                     1
                      246 STORE_FAST               1 (b)
                      248 STORE_FAST               0 (a)
          
-          55         250 LOAD_FAST                0 (a)
+          68         250 LOAD_FAST                0 (a)
                      252 LOAD_FAST                1 (b)
                      254 BINARY_OP               10 (-)
                      258 LOAD_FAST                1 (b)
                      260 LOAD_FAST                0 (a)
                      262 BINARY_OP               10 (-)
                      266 BUILD_TUPLE              2
                      268 RETURN_VALUE
@@ -626,18 +775,17 @@
             None
          names      ('set',)
          varnames   ('a', 'b')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'symmetric_difference'
-         firstlineno 46
+         firstlineno 59
          lnotab 0x02010801380104013a0104013a023c01
       False
-      True
       'None | str | Iterable'
       code
          argcount  : 5
          nlocals   : 5
          stacksize : 5
          flags     : 16777219
          code
@@ -650,94 +798,94 @@
             037225740900000000000000000000a6000000ab0000000000000000008a
             0502007c0188056601640184087c004400a6000000ab0000000000000000
             00a6010000ab01000000000000000053006400530002007c017c00a60100
             00ab010000000000000000530002007c017c006601a6010000ab01000000
             00000000005300
                        0 MAKE_CELL                5 (s)
          
-          58           2 RESUME                   0
+          71           2 RESUME                   0
          
-          59           4 LOAD_FAST                0 (arg)
+          72           4 LOAD_FAST                0 (arg)
                        6 POP_JUMP_FORWARD_IF_NOT_NONE    14 (to 36)
          
-          60           8 LOAD_FAST                4 (preserve_none)
+          73           8 LOAD_FAST                4 (preserve_none)
                       10 POP_JUMP_FORWARD_IF_FALSE     2 (to 16)
                       12 LOAD_FAST                0 (arg)
                       14 JUMP_FORWARD             9 (to 34)
                  >>   16 PUSH_NULL
                       18 LOAD_FAST                1 (cls)
                       20 PRECALL                  0
                       24 CALL                     0
                  >>   34 RETURN_VALUE
          
-          61     >>   36 LOAD_GLOBAL              1 (NULL + type)
+          74     >>   36 LOAD_GLOBAL              1 (NULL + type)
                       48 LOAD_FAST                0 (arg)
                       50 PRECALL                  1
                       54 CALL                     1
                       64 LOAD_GLOBAL              2 (str)
                       76 IS_OP                    1
                       78 POP_JUMP_FORWARD_IF_FALSE   101 (to 282)
                       80 LOAD_GLOBAL              5 (NULL + isinstance)
                       92 LOAD_FAST                0 (arg)
                       94 LOAD_GLOBAL              6 (Iterable)
                      106 PRECALL                  2
                      110 CALL                     2
                      120 POP_JUMP_FORWARD_IF_FALSE    80 (to 282)
          
-          62         122 LOAD_FAST                2 (rm_duplicates)
+          75         122 LOAD_FAST                2 (rm_duplicates)
                      124 POP_JUMP_FORWARD_IF_FALSE    67 (to 260)
          
-          63         126 LOAD_FAST                3 (preserve_order)
+          76         126 LOAD_FAST                3 (preserve_order)
                      128 POP_JUMP_FORWARD_IF_TRUE    24 (to 178)
          
-          64         130 PUSH_NULL
+          77         130 PUSH_NULL
                      132 LOAD_FAST                1 (cls)
                      134 LOAD_GLOBAL              9 (NULL + set)
                      146 LOAD_FAST                0 (arg)
                      148 PRECALL                  1
                      152 CALL                     1
                      162 PRECALL                  1
                      166 CALL                     1
                      176 RETURN_VALUE
          
-          65     >>  178 LOAD_FAST                3 (preserve_order)
+          78     >>  178 LOAD_FAST                3 (preserve_order)
                      180 POP_JUMP_FORWARD_IF_FALSE    37 (to 256)
          
-          66         182 LOAD_GLOBAL              9 (NULL + set)
+          79         182 LOAD_GLOBAL              9 (NULL + set)
                      194 PRECALL                  0
                      198 CALL                     0
                      208 STORE_DEREF              5 (s)
          
-          67         210 PUSH_NULL
+          80         210 PUSH_NULL
                      212 LOAD_FAST                1 (cls)
          
-          68         214 LOAD_CLOSURE             5 (s)
+          81         214 LOAD_CLOSURE             5 (s)
                      216 BUILD_TUPLE              1
-                     218 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 68>)
+                     218 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 81>)
                      220 MAKE_FUNCTION            8 (closure)
                      222 LOAD_FAST                0 (arg)
                      224 GET_ITER
                      226 PRECALL                  0
                      230 CALL                     0
          
-          67         240 PRECALL                  1
+          80         240 PRECALL                  1
                      244 CALL                     1
                      254 RETURN_VALUE
          
-          65     >>  256 LOAD_CONST               0 (None)
+          78     >>  256 LOAD_CONST               0 (None)
                      258 RETURN_VALUE
          
-          70     >>  260 PUSH_NULL
+          83     >>  260 PUSH_NULL
                      262 LOAD_FAST                1 (cls)
                      264 LOAD_FAST                0 (arg)
                      266 PRECALL                  1
                      270 CALL                     1
                      280 RETURN_VALUE
          
-          72     >>  282 PUSH_NULL
+          85     >>  282 PUSH_NULL
                      284 LOAD_FAST                1 (cls)
                      286 LOAD_FAST                0 (arg)
                      288 BUILD_TUPLE              1
                      290 PRECALL                  1
                      294 CALL                     1
                      304 RETURN_VALUE
          consts
@@ -748,15 +896,15 @@
                stacksize : 3
                flags     : 16777267
                code
                   0x95014b00010097007c005d127d017c0189027601af0689027c0168017a
                   07000078018a02af0e7c015600970101008c1364005300
                              0 COPY_FREE_VARS           1
                
-                68           2 RETURN_GENERATOR
+                81           2 RETURN_GENERATOR
                              4 POP_TOP
                              6 RESUME                   0
                              8 LOAD_FAST                0 (.0)
                        >>   10 FOR_ITER                18 (to 48)
                             12 STORE_FAST               1 (i)
                             14 LOAD_FAST                1 (i)
                             16 LOAD_DEREF               2 (s)
@@ -780,35 +928,35 @@
                   None
                names      ()
                varnames   ('.0', 'i')
                freevars   ('s',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '<genexpr>'
-               firstlineno 68
+               firstlineno 81
                lnotab 0x
          names      ('type', 'str', 'isinstance', 'Iterable', 'set')
          varnames   ('arg', 'cls', 'rm_duplicates', 'preserve_order', 'preserve_none')
          freevars   ()
          cellvars   ('s',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'mangle_arg_to'
-         firstlineno 58
+         firstlineno 71
          lnotab 0x040104011c01560104010401300104011c0104011aff10fe04051602
       code
          argcount  : 1
          nlocals   : 2
          stacksize : 5
          flags     : 16777227
          code
             0x97007401000000000000000000007c0074020000000000000000000066
             0269007c01a4018e015300
-          75           0 RESUME                   0
+          88           0 RESUME                   0
          
-          76           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
+          89           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
                       14 LOAD_FAST                0 (arg)
                       16 LOAD_GLOBAL              2 (set)
                       28 BUILD_TUPLE              2
                       30 BUILD_MAP                0
                       32 LOAD_FAST                1 (kwargs)
                       34 DICT_MERGE               1
                       36 CALL_FUNCTION_EX         1
@@ -817,27 +965,27 @@
             None
          names      ('mangle_arg_to', 'set')
          varnames   ('arg', 'kwargs')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'mangle_arg_to_set'
-         firstlineno 75
+         firstlineno 88
          lnotab 0x0201
       code
          argcount  : 3
          nlocals   : 4
          stacksize : 6
          flags     : 16777227
          code
             0x97007401000000000000000000007c0074020000000000000000000066
             027c017c0264019c027c03a4018e015300
-          79           0 RESUME                   0
+          92           0 RESUME                   0
          
-          80           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
+          93           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
                       14 LOAD_FAST                0 (arg)
                       16 LOAD_GLOBAL              2 (list)
                       28 BUILD_TUPLE              2
                       30 LOAD_FAST                1 (rm_duplicates)
                       32 LOAD_FAST                2 (preserve_order)
                       34 LOAD_CONST               1 (('rm_duplicates', 'preserve_order'))
                       36 BUILD_CONST_KEY_MAP      2
@@ -850,27 +998,27 @@
             ('rm_duplicates', 'preserve_order')
          names      ('mangle_arg_to', 'list')
          varnames   ('arg', 'rm_duplicates', 'preserve_order', 'kwargs')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'mangle_arg_to_list'
-         firstlineno 79
+         firstlineno 92
          lnotab 0x0201
       code
          argcount  : 3
          nlocals   : 4
          stacksize : 6
          flags     : 16777227
          code
             0x97007401000000000000000000007c0074020000000000000000000066
             027c017c0264019c027c03a4018e015300
-          83           0 RESUME                   0
+          96           0 RESUME                   0
          
-          84           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
+          97           2 LOAD_GLOBAL              1 (NULL + mangle_arg_to)
                       14 LOAD_FAST                0 (arg)
                       16 LOAD_GLOBAL              2 (tuple)
                       28 BUILD_TUPLE              2
                       30 LOAD_FAST                1 (rm_duplicates)
                       32 LOAD_FAST                2 (preserve_order)
                       34 LOAD_CONST               1 (('rm_duplicates', 'preserve_order'))
                       36 BUILD_CONST_KEY_MAP      2
@@ -883,15 +1031,15 @@
             ('rm_duplicates', 'preserve_order')
          names      ('mangle_arg_to', 'tuple')
          varnames   ('arg', 'rm_duplicates', 'preserve_order', 'kwargs')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'mangle_arg_to_tuple'
-         firstlineno 83
+         firstlineno 96
          lnotab 0x0201
       'items'
       'Iterable'
       'allowed'
       'Collection'
       code
          argcount  : 2
@@ -900,20 +1048,20 @@
          flags     : 16777219
          code
             0x8701970074010000000000000000000088016601640184087c004400a6
             000000ab000000000000000000a6010000ab01000000000000000073024a
             00820164005300
                        0 MAKE_CELL                1 (allowed)
          
-          87           2 RESUME                   0
+         100           2 RESUME                   0
          
-          88           4 LOAD_GLOBAL              1 (NULL + all)
+         101           4 LOAD_GLOBAL              1 (NULL + all)
                       16 LOAD_CLOSURE             1 (allowed)
                       18 BUILD_TUPLE              1
-                      20 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 88>)
+                      20 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\util.py", line 101>)
                       22 MAKE_FUNCTION            8 (closure)
                       24 LOAD_FAST                0 (items)
                       26 GET_ITER
                       28 PRECALL                  0
                       32 CALL                     0
                       42 PRECALL                  1
                       46 CALL                     1
@@ -930,15 +1078,15 @@
                stacksize : 3
                flags     : 16777267
                code
                   0x95014b00010097007c005d087d017c01890276005600970101008c0964
                   005300
                              0 COPY_FREE_VARS           1
                
-                88           2 RETURN_GENERATOR
+               101           2 RETURN_GENERATOR
                              4 POP_TOP
                              6 RESUME                   0
                              8 LOAD_FAST                0 (.0)
                        >>   10 FOR_ITER                 8 (to 28)
                             12 STORE_FAST               1 (i)
                             14 LOAD_FAST                1 (i)
                             16 LOAD_DEREF               2 (allowed)
@@ -953,59 +1101,59 @@
                   None
                names      ()
                varnames   ('.0', 'i')
                freevars   ('allowed',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
                name       '<genexpr>'
-               firstlineno 88
+               firstlineno 101
                lnotab 0x
          names      ('all',)
          varnames   ('items', 'allowed')
          freevars   ()
          cellvars   ('allowed',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'assert_in'
-         firstlineno 87
+         firstlineno 100
          lnotab 0x0401
       code
          argcount  : 5
          nlocals   : 6
          stacksize : 5
          flags     : 16777227
          code
             0x97007c0180057c0472037c037d016e1b7401000000000000000000007c
             01740200000000000000000000a6020000ab02000000000000000072067c
             0172027c026e017c037d0102007c007c01660169007c05a4018e015300
-          91           0 RESUME                   0
+         104           0 RESUME                   0
          
-          92           2 LOAD_FAST                1 (arg)
+         105           2 LOAD_FAST                1 (arg)
                        4 POP_JUMP_FORWARD_IF_NOT_NONE     5 (to 16)
                        6 LOAD_FAST                4 (treat_none_as_false)
                        8 POP_JUMP_FORWARD_IF_FALSE     3 (to 16)
          
-          93          10 LOAD_FAST                3 (if_false)
+         106          10 LOAD_FAST                3 (if_false)
                       12 STORE_FAST               1 (arg)
                       14 JUMP_FORWARD            27 (to 70)
          
-          94     >>   16 LOAD_GLOBAL              1 (NULL + isinstance)
+         107     >>   16 LOAD_GLOBAL              1 (NULL + isinstance)
                       28 LOAD_FAST                1 (arg)
                       30 LOAD_GLOBAL              2 (bool)
                       42 PRECALL                  2
                       46 CALL                     2
                       56 POP_JUMP_FORWARD_IF_FALSE     6 (to 70)
          
-          95          58 LOAD_FAST                1 (arg)
+         108          58 LOAD_FAST                1 (arg)
                       60 POP_JUMP_FORWARD_IF_FALSE     2 (to 66)
                       62 LOAD_FAST                2 (if_true)
                       64 JUMP_FORWARD             1 (to 68)
                  >>   66 LOAD_FAST                3 (if_false)
                  >>   68 STORE_FAST               1 (arg)
          
-          96     >>   70 PUSH_NULL
+         109     >>   70 PUSH_NULL
                       72 LOAD_FAST                0 (mangler)
                       74 LOAD_FAST                1 (arg)
                       76 BUILD_TUPLE              1
                       78 BUILD_MAP                0
                       80 LOAD_FAST                5 (kwargs)
                       82 DICT_MERGE               1
                       84 CALL_FUNCTION_EX         1
@@ -1014,27 +1162,27 @@
             None
          names      ('isinstance', 'bool')
          varnames   ('mangler', 'arg', 'if_true', 'if_false', 'treat_none_as_false', 'kwargs')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
          name       'mangle_arg_with_bool_fallback'
-         firstlineno 91
+         firstlineno 104
          lnotab 0x0201080106012a010c01
       ('arg', 'Iterable[Any]', 'return', 'Optional[Any]')
       ('return', 'set')
       ('return', 'tuple[set, set]')
       (False, True, False)
       ('arg', 'None | str | Iterable')
       (True, True)
       ('items', 'Iterable', 'allowed', 'Collection')
       (None, None, True)
-   names      ('__future__', 'annotations', 'enum', 'collections.abc', 'Iterable', 'Collection', 'Sized', 'Iterator', 'typing', 'Any', 'Optional', 'type', 'MyMeta', 'StringEnumeration', 'take_first', 'intersection', 'symmetric_difference', 'mangle_arg_to', 'mangle_arg_to_set', 'mangle_arg_to_list', 'mangle_arg_to_tuple', 'assert_in', 'mangle_arg_with_bool_fallback')
+   names      ('__future__', 'annotations', 'enum', 'abc', 'abstractmethod', 'collections.abc', 'Iterable', 'Collection', 'Sized', 'Iterator', 'typing', 'Any', 'Optional', 'Protocol', 'TypeVar', 'type', 'MyMeta', 'StringEnumeration', 'K', 'V', 'SlimMapping', 'take_first', 'intersection', 'symmetric_difference', 'mangle_arg_to', 'mangle_arg_to_set', 'mangle_arg_to_list', 'mangle_arg_to_tuple', 'assert_in', 'mangle_arg_with_bool_fallback')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\util.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c0208011801100320171e0408040807080c0a110604080408
-      040804
+      0x00ff02010c0208010c01180118031c171e0416011a033c080804080708
+      0c0a110604080408040804
```

### Comparing `mdata-0.1.2/src/mdata/core/extensions/__pycache__/annotations.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/extensions/__pycache__/annotations.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/extensions/__pycache__/metadata.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/extensions/__pycache__/metadata.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/extensions/__pycache__/metadata.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/extensions/__pycache__/metadata.cpython-311.pyc`

 * *Files 5% similar despite different names*

#### Python bytecode

```diff
@@ -1,23 +1,23 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
-files sz: 4693
+moddate:  0xa3f8d064 (Mon Aug  7 13:58:59 2023 UTC)
+files sz: 4949
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 5
    flags     : 16777216
    code
       0x9700640064016c006d015a010100640064026c026d035a030100640064
       036c045a05640064036c065a0764045a08020047006405840064066509a6
       030000ab0300000000000000005a0a020047006407840064086503a60300
       00ab0300000000000000005a0b650b6a0c0000000000000000650d650b6a
-      0e0000000000000000650f69025a10641b640b84045a11641c640d84045a
-      12641d641084045a13641e641284045a14641f641484045a156420641684
-      045a1664216422641a84055a1764035300
+      0e0000000000000000650f69025a10641c640b84045a11641d640d84045a
+      12641e641084045a13641f641284045a146420641484045a156421642264
+      1784055a1664236424641b84055a1764035300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('annotations',))
                  6 IMPORT_NAME              0 (__future__)
                  8 IMPORT_FROM              1 (annotations)
                 10 STORE_NAME               1 (annotations)
@@ -68,51 +68,52 @@
                114 LOAD_NAME               13 (int)
                116 LOAD_NAME               11 (FeatureDataType)
                118 LOAD_ATTR               14 (Float)
                128 LOAD_NAME               15 (float)
                130 BUILD_MAP                2
                132 STORE_NAME              16 (target_numeric_types)
    
-    29         134 LOAD_CONST              27 (('series', 'pd.Series'))
+    29         134 LOAD_CONST              28 (('series', 'pd.Series'))
                136 LOAD_CONST              11 (<code object infer_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 29>)
                138 MAKE_FUNCTION            4 (annotations)
                140 STORE_NAME              17 (infer_type)
    
-    34         142 LOAD_CONST              28 (('series', 'pd.Series', 'return', 'FeatureDataType'))
-               144 LOAD_CONST              13 (<code object get_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 34>)
+    35         142 LOAD_CONST              29 (('series', 'pd.Series', 'return', 'FeatureDataType'))
+               144 LOAD_CONST              13 (<code object get_type, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 35>)
                146 MAKE_FUNCTION            4 (annotations)
                148 STORE_NAME              18 (get_type)
    
-    57         150 LOAD_CONST              29 (('df', 'pd.DataFrame'))
-               152 LOAD_CONST              16 (<code object infer_types, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 57>)
+    58         150 LOAD_CONST              30 (('df', 'pd.DataFrame'))
+               152 LOAD_CONST              16 (<code object infer_types, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 58>)
                154 MAKE_FUNCTION            4 (annotations)
                156 STORE_NAME              19 (infer_types)
    
-    61         158 LOAD_CONST              30 (('df', 'pd.DataFrame', 'return', 'dict[str, FeatureDataType]'))
-               160 LOAD_CONST              18 (<code object get_types, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 61>)
+    62         158 LOAD_CONST              31 (('df', 'pd.DataFrame', 'return', 'dict[str, FeatureDataType]'))
+               160 LOAD_CONST              18 (<code object get_types, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 62>)
                162 MAKE_FUNCTION            4 (annotations)
                164 STORE_NAME              20 (get_types)
    
-    65         166 LOAD_CONST              31 (('series', 'pd.Series', 'data_type', 'FeatureDataType'))
-               168 LOAD_CONST              20 (<code object is_series_convertible, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 65>)
+    66         166 LOAD_CONST              32 (('series', 'pd.Series', 'data_type', 'FeatureDataType'))
+               168 LOAD_CONST              20 (<code object is_series_convertible, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 66>)
                170 MAKE_FUNCTION            4 (annotations)
                172 STORE_NAME              21 (is_series_convertible)
    
-    93         174 LOAD_CONST              32 (('df', 'pd.DataFrame', 'data_types', 'dict[str, FeatureDataType]'))
-               176 LOAD_CONST              22 (<code object convert_df_inplace, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 93>)
-               178 MAKE_FUNCTION            4 (annotations)
-               180 STORE_NAME              22 (convert_df_inplace)
+    94         174 LOAD_CONST              33 ((False,))
+               176 LOAD_CONST              34 (('df', 'pd.DataFrame', 'data_types', 'dict[str, FeatureDataType]'))
+               178 LOAD_CONST              23 (<code object convert_df, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 94>)
+               180 MAKE_FUNCTION            5 (defaults, annotations)
+               182 STORE_NAME              22 (convert_df)
    
-   101         182 LOAD_CONST              33 ((True,))
-               184 LOAD_CONST              34 (('arg', 'pd.Series | pd.DataFrame', 'data_type', 'FeatureDataType'))
-               186 LOAD_CONST              26 (<code object convert_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 101>)
-               188 MAKE_FUNCTION            5 (defaults, annotations)
-               190 STORE_NAME              23 (convert_series)
-               192 LOAD_CONST               3 (None)
-               194 RETURN_VALUE
+   109         184 LOAD_CONST              35 ((True,))
+               186 LOAD_CONST              36 (('arg', 'pd.Series | pd.DataFrame', 'data_type', 'FeatureDataType'))
+               188 LOAD_CONST              27 (<code object convert_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 109>)
+               190 MAKE_FUNCTION            5 (defaults, annotations)
+               192 STORE_NAME              23 (convert_series)
+               194 LOAD_CONST               3 (None)
+               196 RETURN_VALUE
    consts
       0
       ('annotations',)
       ('Enum',)
       None
       'META'
       code
@@ -251,17 +252,17 @@
             00720c7412000000000000000000006a0d0000000000000000530002007c
             047c08a6010000ab010000000000000000720c7412000000000000000000
             006a0e0000000000000000530002007c057c08a6010000ab010000000000
             000000720c7412000000000000000000006a0f0000000000000000530002
             007c067c08a6010000ab010000000000000000720c741200000000000000
             0000006a10000000000000000053007412000000000000000000006a1100
             000000000000005300
-          34           0 RESUME                   0
+          35           0 RESUME                   0
          
-          35           2 LOAD_CONST               1 (0)
+          36           2 LOAD_CONST               1 (0)
                        4 LOAD_CONST               2 (('is_bool_dtype', 'is_float_dtype', 'is_integer_dtype', 'is_categorical_dtype', 'is_datetime64_any_dtype', 'is_timedelta64_dtype', 'is_string_dtype'))
                        6 IMPORT_NAME              0 (pandas.api.types)
                        8 IMPORT_FROM              1 (is_bool_dtype)
                       10 STORE_FAST               1 (is_bool_dtype)
                       12 IMPORT_FROM              2 (is_float_dtype)
                       14 STORE_FAST               2 (is_float_dtype)
                       16 IMPORT_FROM              3 (is_integer_dtype)
@@ -272,109 +273,109 @@
                       26 STORE_FAST               5 (is_datetime64_any_dtype)
                       28 IMPORT_FROM              6 (is_timedelta64_dtype)
                       30 STORE_FAST               6 (is_timedelta64_dtype)
                       32 IMPORT_FROM              7 (is_string_dtype)
                       34 STORE_FAST               7 (is_string_dtype)
                       36 POP_TOP
          
-          38          38 LOAD_FAST                0 (series)
+          39          38 LOAD_FAST                0 (series)
                       40 LOAD_ATTR                8 (dtype)
                       50 STORE_FAST               8 (dtype)
          
-          39          52 PUSH_NULL
+          40          52 PUSH_NULL
                       54 LOAD_FAST                7 (is_string_dtype)
                       56 LOAD_FAST                8 (dtype)
                       58 PRECALL                  1
                       62 CALL                     1
                       72 POP_JUMP_FORWARD_IF_FALSE    12 (to 98)
          
-          40          74 LOAD_GLOBAL             18 (FeatureDataType)
+          41          74 LOAD_GLOBAL             18 (FeatureDataType)
                       86 LOAD_ATTR               10 (String)
                       96 RETURN_VALUE
          
-          41     >>   98 PUSH_NULL
+          42     >>   98 PUSH_NULL
                      100 LOAD_FAST                3 (is_integer_dtype)
                      102 LOAD_FAST                8 (dtype)
                      104 PRECALL                  1
                      108 CALL                     1
                      118 POP_JUMP_FORWARD_IF_FALSE    12 (to 144)
          
-          42         120 LOAD_GLOBAL             18 (FeatureDataType)
+          43         120 LOAD_GLOBAL             18 (FeatureDataType)
                      132 LOAD_ATTR               11 (Int)
                      142 RETURN_VALUE
          
-          43     >>  144 PUSH_NULL
+          44     >>  144 PUSH_NULL
                      146 LOAD_FAST                2 (is_float_dtype)
                      148 LOAD_FAST                8 (dtype)
                      150 PRECALL                  1
                      154 CALL                     1
                      164 POP_JUMP_FORWARD_IF_FALSE    12 (to 190)
          
-          44         166 LOAD_GLOBAL             18 (FeatureDataType)
+          45         166 LOAD_GLOBAL             18 (FeatureDataType)
                      178 LOAD_ATTR               12 (Float)
                      188 RETURN_VALUE
          
-          45     >>  190 PUSH_NULL
+          46     >>  190 PUSH_NULL
                      192 LOAD_FAST                1 (is_bool_dtype)
                      194 LOAD_FAST                8 (dtype)
                      196 PRECALL                  1
                      200 CALL                     1
                      210 POP_JUMP_FORWARD_IF_FALSE    12 (to 236)
          
-          46         212 LOAD_GLOBAL             18 (FeatureDataType)
+          47         212 LOAD_GLOBAL             18 (FeatureDataType)
                      224 LOAD_ATTR               13 (Boolean)
                      234 RETURN_VALUE
          
-          47     >>  236 PUSH_NULL
+          48     >>  236 PUSH_NULL
                      238 LOAD_FAST                4 (is_categorical_dtype)
                      240 LOAD_FAST                8 (dtype)
                      242 PRECALL                  1
                      246 CALL                     1
                      256 POP_JUMP_FORWARD_IF_FALSE    12 (to 282)
          
-          48         258 LOAD_GLOBAL             18 (FeatureDataType)
+          49         258 LOAD_GLOBAL             18 (FeatureDataType)
                      270 LOAD_ATTR               14 (Categorical)
                      280 RETURN_VALUE
          
-          49     >>  282 PUSH_NULL
+          50     >>  282 PUSH_NULL
                      284 LOAD_FAST                5 (is_datetime64_any_dtype)
                      286 LOAD_FAST                8 (dtype)
                      288 PRECALL                  1
                      292 CALL                     1
                      302 POP_JUMP_FORWARD_IF_FALSE    12 (to 328)
          
-          50         304 LOAD_GLOBAL             18 (FeatureDataType)
+          51         304 LOAD_GLOBAL             18 (FeatureDataType)
                      316 LOAD_ATTR               15 (Datetime)
                      326 RETURN_VALUE
          
-          51     >>  328 PUSH_NULL
+          52     >>  328 PUSH_NULL
                      330 LOAD_FAST                6 (is_timedelta64_dtype)
                      332 LOAD_FAST                8 (dtype)
                      334 PRECALL                  1
                      338 CALL                     1
                      348 POP_JUMP_FORWARD_IF_FALSE    12 (to 374)
          
-          52         350 LOAD_GLOBAL             18 (FeatureDataType)
+          53         350 LOAD_GLOBAL             18 (FeatureDataType)
                      362 LOAD_ATTR               16 (Duration)
                      372 RETURN_VALUE
          
-          54     >>  374 LOAD_GLOBAL             18 (FeatureDataType)
+          55     >>  374 LOAD_GLOBAL             18 (FeatureDataType)
                      386 LOAD_ATTR               17 (Infer)
                      396 RETURN_VALUE
          consts
             None
             0
             ('is_bool_dtype', 'is_float_dtype', 'is_integer_dtype', 'is_categorical_dtype', 'is_datetime64_any_dtype', 'is_timedelta64_dtype', 'is_string_dtype')
          names      ('pandas.api.types', 'is_bool_dtype', 'is_float_dtype', 'is_integer_dtype', 'is_categorical_dtype', 'is_datetime64_any_dtype', 'is_timedelta64_dtype', 'is_string_dtype', 'dtype', 'FeatureDataType', 'String', 'Int', 'Float', 'Boolean', 'Categorical', 'Datetime', 'Duration', 'Infer')
          varnames   ('series', 'is_bool_dtype', 'is_float_dtype', 'is_integer_dtype', 'is_categorical_dtype', 'is_datetime64_any_dtype', 'is_timedelta64_dtype', 'is_string_dtype', 'dtype')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
          name       'get_type'
-         firstlineno 34
+         firstlineno 35
          lnotab
             0x020124030e011601180116011801160118011601180116011801160118
             0116011802
       'df'
       'pd.DataFrame'
       code
          argcount  : 1
@@ -382,19 +383,19 @@
          stacksize : 2
          flags     : 16777219
          code
             0x87009700880066016401840889006a0000000000000000004400a60000
             00ab0000000000000000005300
                        0 MAKE_CELL                0 (df)
          
-          57           2 RESUME                   0
+          58           2 RESUME                   0
          
-          58           4 LOAD_CLOSURE             0 (df)
+          59           4 LOAD_CLOSURE             0 (df)
                        6 BUILD_TUPLE              1
-                       8 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 58>)
+                       8 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 59>)
                       10 MAKE_FUNCTION            8 (closure)
                       12 LOAD_DEREF               0 (df)
                       14 LOAD_ATTR                0 (columns)
                       24 GET_ITER
                       26 PRECALL                  0
                       30 CALL                     0
                       40 RETURN_VALUE
@@ -407,15 +408,15 @@
                flags     : 16777235
                code
                   0x9501970069007c005d217d017c0174010000000000000000000089026a
                   0100000000000000006400640085027c01660219000000000000000000a6
                   010000ab01000000000000000093028c225300
                              0 COPY_FREE_VARS           1
                
-                58           2 RESUME                   0
+                59           2 RESUME                   0
                              4 BUILD_MAP                0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                33 (to 76)
                             10 STORE_FAST               1 (c)
                             12 LOAD_FAST                1 (c)
                             14 LOAD_GLOBAL              1 (NULL + infer_type)
                             26 LOAD_DEREF               2 (df)
@@ -435,40 +436,40 @@
                   None
                names      ('infer_type', 'loc')
                varnames   ('.0', 'c')
                freevars   ('df',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
                name       '<dictcomp>'
-               firstlineno 58
+               firstlineno 59
                lnotab 0x
          names      ('columns',)
          varnames   ('df',)
          freevars   ()
          cellvars   ('df',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
          name       'infer_types'
-         firstlineno 57
+         firstlineno 58
          lnotab 0x0401
       'dict[str, FeatureDataType]'
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 2
          flags     : 16777219
          code
             0x87009700880066016401840889006a0000000000000000004400a60000
             00ab0000000000000000005300
                        0 MAKE_CELL                0 (df)
          
-          61           2 RESUME                   0
+          62           2 RESUME                   0
          
-          62           4 LOAD_CLOSURE             0 (df)
+          63           4 LOAD_CLOSURE             0 (df)
                        6 BUILD_TUPLE              1
-                       8 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 62>)
+                       8 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 63>)
                       10 MAKE_FUNCTION            8 (closure)
                       12 LOAD_DEREF               0 (df)
                       14 LOAD_ATTR                0 (columns)
                       24 GET_ITER
                       26 PRECALL                  0
                       30 CALL                     0
                       40 RETURN_VALUE
@@ -481,15 +482,15 @@
                flags     : 16777235
                code
                   0x9501970069007c005d217d017c0174010000000000000000000089026a
                   0100000000000000006400640085027c01660219000000000000000000a6
                   010000ab01000000000000000093028c225300
                              0 COPY_FREE_VARS           1
                
-                62           2 RESUME                   0
+                63           2 RESUME                   0
                              4 BUILD_MAP                0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                33 (to 76)
                             10 STORE_FAST               1 (c)
                             12 LOAD_FAST                1 (c)
                             14 LOAD_GLOBAL              1 (NULL + get_type)
                             26 LOAD_DEREF               2 (df)
@@ -509,29 +510,29 @@
                   None
                names      ('get_type', 'loc')
                varnames   ('.0', 'c')
                freevars   ('df',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
                name       '<dictcomp>'
-               firstlineno 62
+               firstlineno 63
                lnotab 0x
          names      ('columns',)
          varnames   ('df',)
          freevars   ()
          cellvars   ('df',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
          name       'get_types'
-         firstlineno 61
+         firstlineno 62
          lnotab 0x0401
       'data_type'
       code
          argcount  : 2
          nlocals   : 3
-         stacksize : 4
+         stacksize : 5
          flags     : 16777219
          code
             0x97007c017400000000000000000000006a0100000000000000006b0200
             00000073107c017400000000000000000000006a0200000000000000006b
             0200000000724a09007c00a0030000000000000000000000000000000000
             0000007408000000000000000000007c01190000000000000000006401ac
             02a6020000ab0200000000000000007d026e112300740a00000000000000
@@ -539,319 +540,365 @@
             00000000006a0700000000000000007c007c02a6020000ab020000000000
             00000053007c017400000000000000000000006a0800000000000000006b
             0200000000724409007c00a0030000000000000000000000000000000000
             0000007412000000000000000000006401ac02a6020000ab020000000000
             0000007d026e112300740a00000000000000000000240072040100590064
             0353007700780359007701740d000000000000000000006a070000000000
             0000007c007c02a6020000ab02000000000000000053007c017400000000
-            000000000000006a0a00000000000000006b0200000000722b0900741700
-            0000000000000000006a0c00000000000000007c006401ac02a6020000ab
+            000000000000006a0a00000000000000006b0200000000722c0900741700
+            0000000000000000006a0c00000000000000007c0064016404ac05a60300
+            00ab03000000000000000001006e112300740a0000000000000000000024
+            00720401005900640353007700780359007701640653007c017400000000
+            000000000000006a0d00000000000000006b0200000000722b0900741700
+            0000000000000000006a0e00000000000000007c006401ac02a6020000ab
             02000000000000000001006e112300740a00000000000000000000240072
-            0401005900640353007700780359007701640453007c0174000000000000
-            00000000006a0d00000000000000006b0200000000722b09007417000000
-            000000000000006a0e00000000000000007c006401ac02a6020000ab0200
-            0000000000000001006e112300740a000000000000000000002400720401
-            0059006403530077007803590077016404530064035300
-          65           0 RESUME                   0
+            04010059006403530077007803590077016406530064035300
+          66           0 RESUME                   0
          
-          66           2 LOAD_FAST                1 (data_type)
+          67           2 LOAD_FAST                1 (data_type)
                        4 LOAD_GLOBAL              0 (FeatureDataType)
                       16 LOAD_ATTR                1 (Int)
                       26 COMPARE_OP               2 (==)
                       32 POP_JUMP_FORWARD_IF_TRUE    16 (to 66)
                       34 LOAD_FAST                1 (data_type)
                       36 LOAD_GLOBAL              0 (FeatureDataType)
                       48 LOAD_ATTR                2 (Float)
                       58 COMPARE_OP               2 (==)
                       64 POP_JUMP_FORWARD_IF_FALSE    74 (to 214)
          
-          67     >>   66 NOP
+          68     >>   66 NOP
          
-          68          68 LOAD_FAST                0 (series)
+          69          68 LOAD_FAST                0 (series)
                       70 LOAD_METHOD              3 (astype)
                       92 LOAD_GLOBAL              8 (target_numeric_types)
                      104 LOAD_FAST                1 (data_type)
                      106 BINARY_SUBSCR
                      116 LOAD_CONST               1 ('raise')
                      118 KW_NAMES                 2
                      120 PRECALL                  2
                      124 CALL                     2
                      134 STORE_FAST               2 (conv)
                      136 JUMP_FORWARD            17 (to 172)
                  >>  138 PUSH_EXC_INFO
          
-          69         140 LOAD_GLOBAL             10 (Exception)
+          70         140 LOAD_GLOBAL             10 (Exception)
                      152 CHECK_EXC_MATCH
                      154 POP_JUMP_FORWARD_IF_FALSE     4 (to 164)
                      156 POP_TOP
          
-          70         158 POP_EXCEPT
+          71         158 POP_EXCEPT
                      160 LOAD_CONST               3 (False)
                      162 RETURN_VALUE
          
-          69     >>  164 RERAISE                  0
+          70     >>  164 RERAISE                  0
                  >>  166 COPY                     3
                      168 POP_EXCEPT
                      170 RERAISE                  1
          
-          71     >>  172 LOAD_GLOBAL             13 (NULL + np)
+          72     >>  172 LOAD_GLOBAL             13 (NULL + np)
                      184 LOAD_ATTR                7 (array_equal)
                      194 LOAD_FAST                0 (series)
                      196 LOAD_FAST                2 (conv)
                      198 PRECALL                  2
                      202 CALL                     2
                      212 RETURN_VALUE
          
-          72     >>  214 LOAD_FAST                1 (data_type)
+          73     >>  214 LOAD_FAST                1 (data_type)
                      216 LOAD_GLOBAL              0 (FeatureDataType)
                      228 LOAD_ATTR                8 (Boolean)
                      238 COMPARE_OP               2 (==)
                      244 POP_JUMP_FORWARD_IF_FALSE    68 (to 382)
          
-          73         246 NOP
+          74         246 NOP
          
-          74         248 LOAD_FAST                0 (series)
+          75         248 LOAD_FAST                0 (series)
                      250 LOAD_METHOD              3 (astype)
                      272 LOAD_GLOBAL             18 (bool)
                      284 LOAD_CONST               1 ('raise')
                      286 KW_NAMES                 2
                      288 PRECALL                  2
                      292 CALL                     2
                      302 STORE_FAST               2 (conv)
                      304 JUMP_FORWARD            17 (to 340)
                  >>  306 PUSH_EXC_INFO
          
-          75         308 LOAD_GLOBAL             10 (Exception)
+          76         308 LOAD_GLOBAL             10 (Exception)
                      320 CHECK_EXC_MATCH
                      322 POP_JUMP_FORWARD_IF_FALSE     4 (to 332)
                      324 POP_TOP
          
-          76         326 POP_EXCEPT
+          77         326 POP_EXCEPT
                      328 LOAD_CONST               3 (False)
                      330 RETURN_VALUE
          
-          75     >>  332 RERAISE                  0
+          76     >>  332 RERAISE                  0
                  >>  334 COPY                     3
                      336 POP_EXCEPT
                      338 RERAISE                  1
          
-          77     >>  340 LOAD_GLOBAL             13 (NULL + np)
+          78     >>  340 LOAD_GLOBAL             13 (NULL + np)
                      352 LOAD_ATTR                7 (array_equal)
                      362 LOAD_FAST                0 (series)
                      364 LOAD_FAST                2 (conv)
                      366 PRECALL                  2
                      370 CALL                     2
                      380 RETURN_VALUE
          
-          78     >>  382 LOAD_FAST                1 (data_type)
+          79     >>  382 LOAD_FAST                1 (data_type)
                      384 LOAD_GLOBAL              0 (FeatureDataType)
                      396 LOAD_ATTR               10 (Datetime)
                      406 COMPARE_OP               2 (==)
-                     412 POP_JUMP_FORWARD_IF_FALSE    43 (to 500)
+                     412 POP_JUMP_FORWARD_IF_FALSE    44 (to 502)
          
-          79         414 NOP
+          80         414 NOP
          
-          80         416 LOAD_GLOBAL             23 (NULL + pd)
+          81         416 LOAD_GLOBAL             23 (NULL + pd)
                      428 LOAD_ATTR               12 (to_datetime)
                      438 LOAD_FAST                0 (series)
                      440 LOAD_CONST               1 ('raise')
-                     442 KW_NAMES                 2
-                     444 PRECALL                  2
-                     448 CALL                     2
-                     458 POP_TOP
-                     460 JUMP_FORWARD            17 (to 496)
-                 >>  462 PUSH_EXC_INFO
-         
-          81         464 LOAD_GLOBAL             10 (Exception)
-                     476 CHECK_EXC_MATCH
-                     478 POP_JUMP_FORWARD_IF_FALSE     4 (to 488)
-                     480 POP_TOP
-         
-          82         482 POP_EXCEPT
-                     484 LOAD_CONST               3 (False)
-                     486 RETURN_VALUE
-         
-          81     >>  488 RERAISE                  0
-                 >>  490 COPY                     3
-                     492 POP_EXCEPT
-                     494 RERAISE                  1
-         
-          83     >>  496 LOAD_CONST               4 (True)
-                     498 RETURN_VALUE
-         
-          84     >>  500 LOAD_FAST                1 (data_type)
-                     502 LOAD_GLOBAL              0 (FeatureDataType)
-                     514 LOAD_ATTR               13 (Duration)
-                     524 COMPARE_OP               2 (==)
-                     530 POP_JUMP_FORWARD_IF_FALSE    43 (to 618)
-         
-          85         532 NOP
-         
-          86         534 LOAD_GLOBAL             23 (NULL + pd)
-                     546 LOAD_ATTR               14 (to_timedelta)
-                     556 LOAD_FAST                0 (series)
-                     558 LOAD_CONST               1 ('raise')
-                     560 KW_NAMES                 2
-                     562 PRECALL                  2
-                     566 CALL                     2
-                     576 POP_TOP
-                     578 JUMP_FORWARD            17 (to 614)
-                 >>  580 PUSH_EXC_INFO
-         
-          87         582 LOAD_GLOBAL             10 (Exception)
-                     594 CHECK_EXC_MATCH
-                     596 POP_JUMP_FORWARD_IF_FALSE     4 (to 606)
-                     598 POP_TOP
-         
-          88         600 POP_EXCEPT
-                     602 LOAD_CONST               3 (False)
-                     604 RETURN_VALUE
-         
-          87     >>  606 RERAISE                  0
-                 >>  608 COPY                     3
-                     610 POP_EXCEPT
-                     612 RERAISE                  1
+                     442 LOAD_CONST               4 ('ISO8601')
+                     444 KW_NAMES                 5
+                     446 PRECALL                  3
+                     450 CALL                     3
+                     460 POP_TOP
+                     462 JUMP_FORWARD            17 (to 498)
+                 >>  464 PUSH_EXC_INFO
+         
+          82         466 LOAD_GLOBAL             10 (Exception)
+                     478 CHECK_EXC_MATCH
+                     480 POP_JUMP_FORWARD_IF_FALSE     4 (to 490)
+                     482 POP_TOP
+         
+          83         484 POP_EXCEPT
+                     486 LOAD_CONST               3 (False)
+                     488 RETURN_VALUE
+         
+          82     >>  490 RERAISE                  0
+                 >>  492 COPY                     3
+                     494 POP_EXCEPT
+                     496 RERAISE                  1
+         
+          84     >>  498 LOAD_CONST               6 (True)
+                     500 RETURN_VALUE
+         
+          85     >>  502 LOAD_FAST                1 (data_type)
+                     504 LOAD_GLOBAL              0 (FeatureDataType)
+                     516 LOAD_ATTR               13 (Duration)
+                     526 COMPARE_OP               2 (==)
+                     532 POP_JUMP_FORWARD_IF_FALSE    43 (to 620)
+         
+          86         534 NOP
+         
+          87         536 LOAD_GLOBAL             23 (NULL + pd)
+                     548 LOAD_ATTR               14 (to_timedelta)
+                     558 LOAD_FAST                0 (series)
+                     560 LOAD_CONST               1 ('raise')
+                     562 KW_NAMES                 2
+                     564 PRECALL                  2
+                     568 CALL                     2
+                     578 POP_TOP
+                     580 JUMP_FORWARD            17 (to 616)
+                 >>  582 PUSH_EXC_INFO
+         
+          88         584 LOAD_GLOBAL             10 (Exception)
+                     596 CHECK_EXC_MATCH
+                     598 POP_JUMP_FORWARD_IF_FALSE     4 (to 608)
+                     600 POP_TOP
+         
+          89         602 POP_EXCEPT
+                     604 LOAD_CONST               3 (False)
+                     606 RETURN_VALUE
+         
+          88     >>  608 RERAISE                  0
+                 >>  610 COPY                     3
+                     612 POP_EXCEPT
+                     614 RERAISE                  1
          
-          89     >>  614 LOAD_CONST               4 (True)
-                     616 RETURN_VALUE
+          90     >>  616 LOAD_CONST               6 (True)
+                     618 RETURN_VALUE
          
-          90     >>  618 LOAD_CONST               3 (False)
-                     620 RETURN_VALUE
+          91     >>  620 LOAD_CONST               3 (False)
+                     622 RETURN_VALUE
          ExceptionTable:
            68 to 134 -> 138 [0]
            138 to 156 -> 166 [1] lasti
            164 to 164 -> 166 [1] lasti
            248 to 302 -> 306 [0]
            306 to 324 -> 334 [1] lasti
            332 to 332 -> 334 [1] lasti
-           416 to 458 -> 462 [0]
-           462 to 480 -> 490 [1] lasti
-           488 to 488 -> 490 [1] lasti
-           534 to 576 -> 580 [0]
-           580 to 598 -> 608 [1] lasti
-           606 to 606 -> 608 [1] lasti
+           416 to 460 -> 464 [0]
+           464 to 482 -> 492 [1] lasti
+           490 to 490 -> 492 [1] lasti
+           536 to 578 -> 582 [0]
+           582 to 600 -> 610 [1] lasti
+           608 to 608 -> 610 [1] lasti
          consts
             None
             'raise'
             ('errors',)
             False
+            'ISO8601'
+            ('errors', 'format')
             True
          names      ('FeatureDataType', 'Int', 'Float', 'astype', 'target_numeric_types', 'Exception', 'np', 'array_equal', 'Boolean', 'bool', 'Datetime', 'pd', 'to_datetime', 'Duration', 'to_timedelta')
          varnames   ('series', 'data_type', 'conv')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
          name       'is_series_convertible'
-         firstlineno 65
+         firstlineno 66
          lnotab
             0x0201400102014801120106ff08022a01200102013c01120106ff08022a
-            01200102013001120106ff08020401200102013001120106ff08020401
+            01200102013201120106ff08020401200102013001120106ff08020401
+      False
       'data_types'
       code
-         argcount  : 2
-         nlocals   : 5
+         argcount  : 3
+         nlocals   : 7
          stacksize : 9
          flags     : 16777219
          code
-            0x97007c01a0000000000000000000000000000000000000000000a60000
-            00ab00000000000000000044005d605c0200007d027d0309007403000000
-            000000000000007c006a0200000000000000006400640085027c02670166
-            02190000000000000000007c036401ac02a6030000ab0300000000000000
-            0001008c2923007406000000000000000000002400722b7d047409000000
-            0000000000000064037c029b0064047c039b0064059d05740b0000000000
-            00000000007c04a6010000ab0100000000000000007a000000a6010000ab
-            010000000000000000820164007d047e0477017700780359007701640053
-            00
-          93           0 RESUME                   0
-         
-          94           2 LOAD_FAST                1 (data_types)
-                       4 LOAD_METHOD              0 (items)
-                      26 PRECALL                  0
-                      30 CALL                     0
-                      40 GET_ITER
-                 >>   42 FOR_ITER                96 (to 236)
-                      44 UNPACK_SEQUENCE          2
-                      48 STORE_FAST               2 (f)
-                      50 STORE_FAST               3 (dt)
-         
-          95          52 NOP
-         
-          96          54 LOAD_GLOBAL              3 (NULL + convert_series)
-                      66 LOAD_FAST                0 (df)
-                      68 LOAD_ATTR                2 (loc)
-                      78 LOAD_CONST               0 (None)
-                      80 LOAD_CONST               0 (None)
-                      82 BUILD_SLICE              2
-                      84 LOAD_FAST                2 (f)
-                      86 BUILD_LIST               1
-                      88 BUILD_TUPLE              2
-                      90 BINARY_SUBSCR
-                     100 LOAD_FAST                3 (dt)
-                     102 LOAD_CONST               1 (True)
-                     104 KW_NAMES                 2
-                     106 PRECALL                  3
-                     110 CALL                     3
-                     120 POP_TOP
-                     122 JUMP_BACKWARD           41 (to 42)
-                 >>  124 PUSH_EXC_INFO
-         
-          97         126 LOAD_GLOBAL              6 (Exception)
-                     138 CHECK_EXC_MATCH
-                     140 POP_JUMP_FORWARD_IF_FALSE    43 (to 228)
-                     142 STORE_FAST               4 (e)
-         
-          98         144 LOAD_GLOBAL              9 (NULL + FeatureDataTypeConversionException)
-                     156 LOAD_CONST               3 ('Conversion of feature ')
-                     158 LOAD_FAST                2 (f)
-                     160 FORMAT_VALUE             0
-                     162 LOAD_CONST               4 (' to ')
-                     164 LOAD_FAST                3 (dt)
-                     166 FORMAT_VALUE             0
-                     168 LOAD_CONST               5 (' failed:\n')
-                     170 BUILD_STRING             5
-                     172 LOAD_GLOBAL             11 (NULL + str)
-                     184 LOAD_FAST                4 (e)
-                     186 PRECALL                  1
-                     190 CALL                     1
-                     200 BINARY_OP                0 (+)
-                     204 PRECALL                  1
-                     208 CALL                     1
-                     218 RAISE_VARARGS            1
-                 >>  220 LOAD_CONST               0 (None)
-                     222 STORE_FAST               4 (e)
-                     224 DELETE_FAST              4 (e)
-                     226 RERAISE                  1
-         
-          97     >>  228 RERAISE                  0
-                 >>  230 COPY                     3
-                     232 POP_EXCEPT
-                     234 RERAISE                  1
+            0x97007c02731a7401000000000000000000006a0100000000000000007c
+            006a020000000000000000ac01a6010000ab0100000000000000006e017c
+            007d037c01a0030000000000000000000000000000000000000000a60000
+            00ab00000000000000000044005d885c0200007d047d0509007c02722374
+            09000000000000000000007c006a0500000000000000006400640085027c
+            0467016602190000000000000000007c056402ac03a6030000ab03000000
+            000000000001006e257409000000000000000000007c006a050000000000
+            0000006400640085027c0467016602190000000000000000007c056404ac
+            03a6030000ab0300000000000000007c037c043c0000008c512300740c00
+            0000000000000000002400722b7d06740f0000000000000000000064057c
+            049b0064067c059b0064079d057411000000000000000000007c06a60100
+            00ab0100000000000000007a000000a6010000ab01000000000000000082
+            0164007d067e06770177007803590077017c035300
+          94           0 RESUME                   0
+         
+          95           2 LOAD_FAST                2 (inplace)
+                       4 POP_JUMP_FORWARD_IF_TRUE    26 (to 58)
+                       6 LOAD_GLOBAL              1 (NULL + pd)
+                      18 LOAD_ATTR                1 (DataFrame)
+                      28 LOAD_FAST                0 (df)
+                      30 LOAD_ATTR                2 (index)
+                      40 KW_NAMES                 1
+                      42 PRECALL                  1
+                      46 CALL                     1
+                      56 JUMP_FORWARD             1 (to 60)
+                 >>   58 LOAD_FAST                0 (df)
+                 >>   60 STORE_FAST               3 (res)
+         
+          97          62 LOAD_FAST                1 (data_types)
+                      64 LOAD_METHOD              3 (items)
+                      86 PRECALL                  0
+                      90 CALL                     0
+                     100 GET_ITER
+                 >>  102 FOR_ITER               136 (to 376)
+                     104 UNPACK_SEQUENCE          2
+                     108 STORE_FAST               4 (f)
+                     110 STORE_FAST               5 (dt)
+         
+          98         112 NOP
+         
+          99         114 LOAD_FAST                2 (inplace)
+                     116 POP_JUMP_FORWARD_IF_FALSE    35 (to 188)
+         
+         100         118 LOAD_GLOBAL              9 (NULL + convert_series)
+                     130 LOAD_FAST                0 (df)
+                     132 LOAD_ATTR                5 (loc)
+                     142 LOAD_CONST               0 (None)
+                     144 LOAD_CONST               0 (None)
+                     146 BUILD_SLICE              2
+                     148 LOAD_FAST                4 (f)
+                     150 BUILD_LIST               1
+                     152 BUILD_TUPLE              2
+                     154 BINARY_SUBSCR
+                     164 LOAD_FAST                5 (dt)
+                     166 LOAD_CONST               2 (True)
+                     168 KW_NAMES                 3
+                     170 PRECALL                  3
+                     174 CALL                     3
+                     184 POP_TOP
+                     186 JUMP_FORWARD            37 (to 262)
+         
+         102     >>  188 LOAD_GLOBAL              9 (NULL + convert_series)
+                     200 LOAD_FAST                0 (df)
+                     202 LOAD_ATTR                5 (loc)
+                     212 LOAD_CONST               0 (None)
+                     214 LOAD_CONST               0 (None)
+                     216 BUILD_SLICE              2
+                     218 LOAD_FAST                4 (f)
+                     220 BUILD_LIST               1
+                     222 BUILD_TUPLE              2
+                     224 BINARY_SUBSCR
+                     234 LOAD_FAST                5 (dt)
+                     236 LOAD_CONST               4 (False)
+                     238 KW_NAMES                 3
+                     240 PRECALL                  3
+                     244 CALL                     3
+                     254 LOAD_FAST                3 (res)
+                     256 LOAD_FAST                4 (f)
+                     258 STORE_SUBSCR
+                 >>  262 JUMP_BACKWARD           81 (to 102)
+                 >>  264 PUSH_EXC_INFO
+         
+         103         266 LOAD_GLOBAL             12 (Exception)
+                     278 CHECK_EXC_MATCH
+                     280 POP_JUMP_FORWARD_IF_FALSE    43 (to 368)
+                     282 STORE_FAST               6 (e)
+         
+         104         284 LOAD_GLOBAL             15 (NULL + FeatureDataTypeConversionException)
+                     296 LOAD_CONST               5 ('Conversion of feature ')
+                     298 LOAD_FAST                4 (f)
+                     300 FORMAT_VALUE             0
+                     302 LOAD_CONST               6 (' to ')
+                     304 LOAD_FAST                5 (dt)
+                     306 FORMAT_VALUE             0
+                     308 LOAD_CONST               7 (' failed:\n')
+                     310 BUILD_STRING             5
+                     312 LOAD_GLOBAL             17 (NULL + str)
+                     324 LOAD_FAST                6 (e)
+                     326 PRECALL                  1
+                     330 CALL                     1
+                     340 BINARY_OP                0 (+)
+                     344 PRECALL                  1
+                     348 CALL                     1
+                     358 RAISE_VARARGS            1
+                 >>  360 LOAD_CONST               0 (None)
+                     362 STORE_FAST               6 (e)
+                     364 DELETE_FAST              6 (e)
+                     366 RERAISE                  1
+         
+         103     >>  368 RERAISE                  0
+                 >>  370 COPY                     3
+                     372 POP_EXCEPT
+                     374 RERAISE                  1
          
-          94     >>  236 LOAD_CONST               0 (None)
-                     238 RETURN_VALUE
+         106     >>  376 LOAD_FAST                3 (res)
+                     378 RETURN_VALUE
          ExceptionTable:
-           54 to 120 -> 124 [1]
-           124 to 142 -> 230 [2] lasti
-           144 to 218 -> 220 [2] lasti
-           220 to 228 -> 230 [2] lasti
+           114 to 260 -> 264 [1]
+           264 to 282 -> 370 [2] lasti
+           284 to 358 -> 360 [2] lasti
+           360 to 368 -> 370 [2] lasti
          consts
             None
+            ('index',)
             True
             ('inplace',)
+            False
             'Conversion of feature '
             ' to '
             ' failed:\n'
-         names      ('items', 'convert_series', 'loc', 'Exception', 'FeatureDataTypeConversionException', 'str')
-         varnames   ('df', 'data_types', 'f', 'dt', 'e')
+         names      ('pd', 'DataFrame', 'index', 'items', 'convert_series', 'loc', 'Exception', 'FeatureDataTypeConversionException', 'str')
+         varnames   ('df', 'data_types', 'inplace', 'res', 'f', 'dt', 'e')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
-         name       'convert_df_inplace'
-         firstlineno 93
-         lnotab 0x0201320102014801120154ff08fd
+         name       'convert_df'
+         firstlineno 94
+         lnotab 0x02013c0232010201040146024e01120154ff0803
       True
       'arg'
       'pd.Series | pd.DataFrame'
       code
          argcount  : 3
          nlocals   : 9
          stacksize : 5
@@ -865,15 +912,15 @@
             00000000006a0500000000000000007500721c8900a00300000000000000
             00000000000000000000000000740c000000000000000000007c03ac02a6
             020000ab02000000000000000053007c017400000000000000000000006a
             070000000000000000750072297411000000000000000000006a09000000
             0000000000890064036404ac05a6030000ab0300000000000000007d057c
             02720e02007c0489007c05a6020000ab0200000000000000000100890053
             007c0553007c017400000000000000000000006a0a000000000000000075
-            0072287411000000000000000000006a0b000000000000000089006404ac
+            0072287411000000000000000000006a0b000000000000000089006403ac
             06a6020000ab0200000000000000007d067c02720e02007c0489007c06a6
             020000ab0200000000000000000100890053007c0653007c017400000000
             000000000000006a0c00000000000000007500721c8900a0030000000000
             000000000000000000000000000000741a000000000000000000007c03ac
             02a6020000ab02000000000000000053007c017400000000000000000000
             006a0e000000000000000075007297741f00000000000000000000890074
             10000000000000000000006a100000000000000000a6020000ab02000000
@@ -888,227 +935,227 @@
             02a6020000ab02000000000000000053007c017400000000000000000000
             006a160000000000000000750072268900a0170000000000000000000000
             000000000000000000a6000000ab0000000000000000007d087c02720e02
             007c0489007c08a6020000ab0200000000000000000100890053007c0853
             0064005300
                        0 MAKE_CELL                0 (arg)
          
-         101           2 RESUME                   0
+         109           2 RESUME                   0
          
-         102           4 LOAD_FAST                2 (inplace)
+         110           4 LOAD_FAST                2 (inplace)
                        6 UNARY_NOT
                        8 STORE_FAST               3 (copy)
          
-         104          10 LOAD_CONST               1 (<code object upd_inplace, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 104>)
+         112          10 LOAD_CONST               1 (<code object upd_inplace, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 112>)
                       12 MAKE_FUNCTION            0
                       14 STORE_FAST               4 (upd_inplace)
          
-         110          16 LOAD_FAST                1 (data_type)
+         118          16 LOAD_FAST                1 (data_type)
                       18 LOAD_GLOBAL              0 (FeatureDataType)
                       30 LOAD_ATTR                1 (Int)
                       40 IS_OP                    0
                       42 POP_JUMP_FORWARD_IF_TRUE    14 (to 72)
                       44 LOAD_FAST                1 (data_type)
                       46 LOAD_GLOBAL              0 (FeatureDataType)
                       58 LOAD_ATTR                2 (Float)
                       68 IS_OP                    0
                       70 POP_JUMP_FORWARD_IF_FALSE    34 (to 140)
          
-         111     >>   72 LOAD_DEREF               0 (arg)
+         119     >>   72 LOAD_DEREF               0 (arg)
                       74 LOAD_METHOD              3 (astype)
                       96 LOAD_GLOBAL              8 (target_numeric_types)
                      108 LOAD_FAST                1 (data_type)
                      110 BINARY_SUBSCR
                      120 LOAD_FAST                3 (copy)
                      122 KW_NAMES                 2
                      124 PRECALL                  2
                      128 CALL                     2
                      138 RETURN_VALUE
          
-         112     >>  140 LOAD_FAST                1 (data_type)
+         120     >>  140 LOAD_FAST                1 (data_type)
                      142 LOAD_GLOBAL              0 (FeatureDataType)
                      154 LOAD_ATTR                5 (Boolean)
                      164 IS_OP                    0
                      166 POP_JUMP_FORWARD_IF_FALSE    28 (to 224)
          
-         113         168 LOAD_DEREF               0 (arg)
+         121         168 LOAD_DEREF               0 (arg)
                      170 LOAD_METHOD              3 (astype)
                      192 LOAD_GLOBAL             12 (bool)
                      204 LOAD_FAST                3 (copy)
                      206 KW_NAMES                 2
                      208 PRECALL                  2
                      212 CALL                     2
                      222 RETURN_VALUE
          
-         114     >>  224 LOAD_FAST                1 (data_type)
+         122     >>  224 LOAD_FAST                1 (data_type)
                      226 LOAD_GLOBAL              0 (FeatureDataType)
                      238 LOAD_ATTR                7 (Datetime)
                      248 IS_OP                    0
                      250 POP_JUMP_FORWARD_IF_FALSE    41 (to 334)
          
-         115         252 LOAD_GLOBAL             17 (NULL + pd)
+         123         252 LOAD_GLOBAL             17 (NULL + pd)
                      264 LOAD_ATTR                9 (to_datetime)
                      274 LOAD_DEREF               0 (arg)
-                     276 LOAD_CONST               3 (True)
-                     278 LOAD_CONST               4 ('raise')
+                     276 LOAD_CONST               3 ('raise')
+                     278 LOAD_CONST               4 ('ISO8601')
                      280 KW_NAMES                 5
                      282 PRECALL                  3
                      286 CALL                     3
                      296 STORE_FAST               5 (datetime)
          
-         116         298 LOAD_FAST                2 (inplace)
+         124         298 LOAD_FAST                2 (inplace)
                      300 POP_JUMP_FORWARD_IF_FALSE    14 (to 330)
          
-         117         302 PUSH_NULL
+         125         302 PUSH_NULL
                      304 LOAD_FAST                4 (upd_inplace)
                      306 LOAD_DEREF               0 (arg)
                      308 LOAD_FAST                5 (datetime)
                      310 PRECALL                  2
                      314 CALL                     2
                      324 POP_TOP
          
-         118         326 LOAD_DEREF               0 (arg)
+         126         326 LOAD_DEREF               0 (arg)
                      328 RETURN_VALUE
          
-         120     >>  330 LOAD_FAST                5 (datetime)
+         128     >>  330 LOAD_FAST                5 (datetime)
                      332 RETURN_VALUE
          
-         121     >>  334 LOAD_FAST                1 (data_type)
+         129     >>  334 LOAD_FAST                1 (data_type)
                      336 LOAD_GLOBAL              0 (FeatureDataType)
                      348 LOAD_ATTR               10 (Duration)
                      358 IS_OP                    0
                      360 POP_JUMP_FORWARD_IF_FALSE    40 (to 442)
          
-         122         362 LOAD_GLOBAL             17 (NULL + pd)
+         130         362 LOAD_GLOBAL             17 (NULL + pd)
                      374 LOAD_ATTR               11 (to_timedelta)
                      384 LOAD_DEREF               0 (arg)
-                     386 LOAD_CONST               4 ('raise')
+                     386 LOAD_CONST               3 ('raise')
                      388 KW_NAMES                 6
                      390 PRECALL                  2
                      394 CALL                     2
                      404 STORE_FAST               6 (timedelta)
          
-         123         406 LOAD_FAST                2 (inplace)
+         131         406 LOAD_FAST                2 (inplace)
                      408 POP_JUMP_FORWARD_IF_FALSE    14 (to 438)
          
-         124         410 PUSH_NULL
+         132         410 PUSH_NULL
                      412 LOAD_FAST                4 (upd_inplace)
                      414 LOAD_DEREF               0 (arg)
                      416 LOAD_FAST                6 (timedelta)
                      418 PRECALL                  2
                      422 CALL                     2
                      432 POP_TOP
          
-         125         434 LOAD_DEREF               0 (arg)
+         133         434 LOAD_DEREF               0 (arg)
                      436 RETURN_VALUE
          
-         127     >>  438 LOAD_FAST                6 (timedelta)
+         135     >>  438 LOAD_FAST                6 (timedelta)
                      440 RETURN_VALUE
          
-         128     >>  442 LOAD_FAST                1 (data_type)
+         136     >>  442 LOAD_FAST                1 (data_type)
                      444 LOAD_GLOBAL              0 (FeatureDataType)
                      456 LOAD_ATTR               12 (String)
                      466 IS_OP                    0
                      468 POP_JUMP_FORWARD_IF_FALSE    28 (to 526)
          
-         129         470 LOAD_DEREF               0 (arg)
+         137         470 LOAD_DEREF               0 (arg)
                      472 LOAD_METHOD              3 (astype)
                      494 LOAD_GLOBAL             26 (str)
                      506 LOAD_FAST                3 (copy)
                      508 KW_NAMES                 2
                      510 PRECALL                  2
                      514 CALL                     2
                      524 RETURN_VALUE
          
-         130     >>  526 LOAD_FAST                1 (data_type)
+         138     >>  526 LOAD_FAST                1 (data_type)
                      528 LOAD_GLOBAL              0 (FeatureDataType)
                      540 LOAD_ATTR               14 (Categorical)
                      550 IS_OP                    0
                      552 POP_JUMP_FORWARD_IF_FALSE   151 (to 856)
          
-         131         554 LOAD_GLOBAL             31 (NULL + isinstance)
+         139         554 LOAD_GLOBAL             31 (NULL + isinstance)
                      566 LOAD_DEREF               0 (arg)
                      568 LOAD_GLOBAL             16 (pd)
                      580 LOAD_ATTR               16 (DataFrame)
                      590 PRECALL                  2
                      594 CALL                     2
                      604 POP_JUMP_FORWARD_IF_FALSE    20 (to 646)
          
-         132         606 LOAD_CLOSURE             0 (arg)
+         140         606 LOAD_CLOSURE             0 (arg)
                      608 BUILD_TUPLE              1
-                     610 LOAD_CONST               7 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 132>)
+                     610 LOAD_CONST               7 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\core\extensions\metadata.py", line 140>)
                      612 MAKE_FUNCTION            8 (closure)
                      614 LOAD_DEREF               0 (arg)
                      616 LOAD_ATTR               17 (columns)
                      626 GET_ITER
                      628 PRECALL                  0
                      632 CALL                     0
                      642 STORE_FAST               7 (cdt)
                      644 JUMP_FORWARD            82 (to 810)
          
-         133     >>  646 LOAD_GLOBAL             31 (NULL + isinstance)
+         141     >>  646 LOAD_GLOBAL             31 (NULL + isinstance)
                      658 LOAD_DEREF               0 (arg)
                      660 LOAD_GLOBAL             16 (pd)
                      672 LOAD_ATTR               18 (Series)
                      682 PRECALL                  2
                      686 CALL                     2
                      696 POP_JUMP_FORWARD_IF_FALSE    56 (to 810)
          
-         134         698 LOAD_GLOBAL             17 (NULL + pd)
+         142         698 LOAD_GLOBAL             17 (NULL + pd)
                      710 LOAD_ATTR               19 (CategoricalDtype)
                      720 LOAD_DEREF               0 (arg)
                      722 LOAD_METHOD             20 (dropna)
                      744 PRECALL                  0
                      748 CALL                     0
                      758 LOAD_METHOD             21 (unique)
                      780 PRECALL                  0
                      784 CALL                     0
                      794 PRECALL                  1
                      798 CALL                     1
                      808 STORE_FAST               7 (cdt)
          
-         135     >>  810 LOAD_DEREF               0 (arg)
+         143     >>  810 LOAD_DEREF               0 (arg)
                      812 LOAD_METHOD              3 (astype)
                      834 LOAD_FAST                7 (cdt)
                      836 LOAD_FAST                3 (copy)
                      838 KW_NAMES                 2
                      840 PRECALL                  2
                      844 CALL                     2
                      854 RETURN_VALUE
          
-         136     >>  856 LOAD_FAST                1 (data_type)
+         144     >>  856 LOAD_FAST                1 (data_type)
                      858 LOAD_GLOBAL              0 (FeatureDataType)
                      870 LOAD_ATTR               22 (Infer)
                      880 IS_OP                    0
                      882 POP_JUMP_FORWARD_IF_FALSE    38 (to 960)
          
-         137         884 LOAD_DEREF               0 (arg)
+         145         884 LOAD_DEREF               0 (arg)
                      886 LOAD_METHOD             23 (convert_dtypes)
                      908 PRECALL                  0
                      912 CALL                     0
                      922 STORE_FAST               8 (conv)
          
-         138         924 LOAD_FAST                2 (inplace)
+         146         924 LOAD_FAST                2 (inplace)
                      926 POP_JUMP_FORWARD_IF_FALSE    14 (to 956)
          
-         139         928 PUSH_NULL
+         147         928 PUSH_NULL
                      930 LOAD_FAST                4 (upd_inplace)
                      932 LOAD_DEREF               0 (arg)
                      934 LOAD_FAST                8 (conv)
                      936 PRECALL                  2
                      940 CALL                     2
                      950 POP_TOP
          
-         140         952 LOAD_DEREF               0 (arg)
+         148         952 LOAD_DEREF               0 (arg)
                      954 RETURN_VALUE
          
-         142     >>  956 LOAD_FAST                8 (conv)
+         150     >>  956 LOAD_FAST                8 (conv)
                      958 RETURN_VALUE
          
-         136     >>  960 LOAD_CONST               0 (None)
+         144     >>  960 LOAD_CONST               0 (None)
                      962 RETURN_VALUE
          consts
             None
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 5
@@ -1116,72 +1163,72 @@
                code
                   0x97007401000000000000000000007c007402000000000000000000006a
                   020000000000000000a6020000ab020000000000000000720e7c017c006a
                   0300000000000000006400640085023c0000006400530074010000000000
                   00000000007c007402000000000000000000006a040000000000000000a6
                   020000ab02000000000000000072127c017c006a03000000000000000064
                   006400850264006400850266023c0000006400530064005300
-               104           0 RESUME                   0
+               112           0 RESUME                   0
                
-               105           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               113           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                0 (arg)
                             16 LOAD_GLOBAL              2 (pd)
                             28 LOAD_ATTR                2 (Series)
                             38 PRECALL                  2
                             42 CALL                     2
                             52 POP_JUMP_FORWARD_IF_FALSE    14 (to 82)
                
-               106          54 LOAD_FAST                1 (conv)
+               114          54 LOAD_FAST                1 (conv)
                             56 LOAD_FAST                0 (arg)
                             58 LOAD_ATTR                3 (loc)
                             68 LOAD_CONST               0 (None)
                             70 LOAD_CONST               0 (None)
                             72 BUILD_SLICE              2
                             74 STORE_SUBSCR
                             78 LOAD_CONST               0 (None)
                             80 RETURN_VALUE
                
-               107     >>   82 LOAD_GLOBAL              1 (NULL + isinstance)
+               115     >>   82 LOAD_GLOBAL              1 (NULL + isinstance)
                             94 LOAD_FAST                0 (arg)
                             96 LOAD_GLOBAL              2 (pd)
                            108 LOAD_ATTR                4 (DataFrame)
                            118 PRECALL                  2
                            122 CALL                     2
                            132 POP_JUMP_FORWARD_IF_FALSE    18 (to 170)
                
-               108         134 LOAD_FAST                1 (conv)
+               116         134 LOAD_FAST                1 (conv)
                            136 LOAD_FAST                0 (arg)
                            138 LOAD_ATTR                3 (loc)
                            148 LOAD_CONST               0 (None)
                            150 LOAD_CONST               0 (None)
                            152 BUILD_SLICE              2
                            154 LOAD_CONST               0 (None)
                            156 LOAD_CONST               0 (None)
                            158 BUILD_SLICE              2
                            160 BUILD_TUPLE              2
                            162 STORE_SUBSCR
                            166 LOAD_CONST               0 (None)
                            168 RETURN_VALUE
                
-               107     >>  170 LOAD_CONST               0 (None)
+               115     >>  170 LOAD_CONST               0 (None)
                            172 RETURN_VALUE
                consts
                   None
                names      ('isinstance', 'pd', 'Series', 'loc', 'DataFrame')
                varnames   ('arg', 'conv')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
                name       'upd_inplace'
-               firstlineno 104
+               firstlineno 112
                lnotab 0x020134011c01340124ff
             ('copy',)
-            True
             'raise'
-            ('infer_datetime_format', 'errors')
+            'ISO8601'
+            ('errors', 'format')
             ('errors',)
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 8
                flags     : 16777235
                code
@@ -1189,15 +1236,15 @@
                   0000000000000089026a0200000000000000006400640085027c01660219
                   000000000000000000a00300000000000000000000000000000000000000
                   00a6000000ab000000000000000000a00400000000000000000000000000
                   00000000000000a6000000ab000000000000000000a6010000ab01000000
                   000000000093028c4b5300
                              0 COPY_FREE_VARS           1
                
-               132           2 RESUME                   0
+               140           2 RESUME                   0
                              4 BUILD_MAP                0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                74 (to 158)
                             10 STORE_FAST               1 (c)
                             12 LOAD_FAST                1 (c)
                             14 LOAD_GLOBAL              1 (NULL + pd)
                             26 LOAD_ATTR                1 (CategoricalDtype)
@@ -1224,38 +1271,39 @@
                   None
                names      ('pd', 'CategoricalDtype', 'loc', 'dropna', 'unique')
                varnames   ('.0', 'c')
                freevars   ('arg',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
                name       '<dictcomp>'
-               firstlineno 132
+               firstlineno 140
                lnotab 0x
          names      ('FeatureDataType', 'Int', 'Float', 'astype', 'target_numeric_types', 'Boolean', 'bool', 'Datetime', 'pd', 'to_datetime', 'Duration', 'to_timedelta', 'String', 'str', 'Categorical', 'isinstance', 'DataFrame', 'columns', 'Series', 'CategoricalDtype', 'dropna', 'unique', 'Infer', 'convert_dtypes')
          varnames   ('arg', 'data_type', 'inplace', 'copy', 'upd_inplace', 'datetime', 'timedelta', 'cdt', 'conv')
          freevars   ()
          cellvars   ('arg',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
          name       'convert_series'
-         firstlineno 101
+         firstlineno 109
          lnotab
             0x040106020606380144011c0138011c012e0104011801040204011c012c
             0104011801040204011c0138011c0134012801340170012e011c01280104
             011801040204fa
       ('series', 'pd.Series')
       ('series', 'pd.Series', 'return', 'FeatureDataType')
       ('df', 'pd.DataFrame')
       ('df', 'pd.DataFrame', 'return', 'dict[str, FeatureDataType]')
       ('series', 'pd.Series', 'data_type', 'FeatureDataType')
+      (False,)
       ('df', 'pd.DataFrame', 'data_types', 'dict[str, FeatureDataType]')
       (True,)
       ('arg', 'pd.Series | pd.DataFrame', 'data_type', 'FeatureDataType')
-   names      ('__future__', 'annotations', 'enum', 'Enum', 'numpy', 'np', 'pandas', 'pd', 'CSV_KEY', 'Exception', 'FeatureDataTypeConversionException', 'FeatureDataType', 'Int', 'int', 'Float', 'float', 'target_numeric_types', 'infer_type', 'get_type', 'infer_types', 'get_types', 'is_series_convertible', 'convert_df_inplace', 'convert_series')
+   names      ('__future__', 'annotations', 'enum', 'Enum', 'numpy', 'np', 'pandas', 'pd', 'CSV_KEY', 'Exception', 'FeatureDataTypeConversionException', 'FeatureDataType', 'Int', 'int', 'Float', 'float', 'target_numeric_types', 'infer_type', 'get_type', 'infer_types', 'get_types', 'is_series_convertible', 'convert_df', 'convert_series')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\core\\extensions\\metadata.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c020c020801080204031c041c0b2003080508170804080408
-      1c0808
+      0x00ff02010c020c020801080204031c041c0b2003080608170804080408
+      1c0a0f
```

### Comparing `mdata-0.1.2/src/mdata/core/extensions/__pycache__/registry.cpython-310.pyc` & `mdata-0.1.3/src/mdata/core/extensions/__pycache__/registry.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/core/extensions/__pycache__/registry.cpython-311.pyc` & `mdata-0.1.3/src/mdata/core/extensions/__pycache__/registry.cpython-311.pyc`

 * *Files 2% similar despite different names*

#### Python bytecode

```diff
@@ -1,9 +1,9 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
+moddate:  0xe273c764 (Mon Jul 31 08:42:10 2023 UTC)
 files sz: 279
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 5
    flags     : 0
    code
```

### Comparing `mdata-0.1.2/src/mdata/core/extensions/annotations.py` & `mdata-0.1.3/src/mdata/core/extensions/annotations.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,19 +1,20 @@
 """
 annotate object series (object-segments if extension specified) with input/output before/after events
 design decisions:
     how to handle validity checking with dependence on segment extension
     permit multiple annotations of same type per object (object-segment)?
     permit missing annotations?
 """
+from typing import Literal
 
 from mdata.core.util import StringEnumeration
 
 CSV_KEY = 'A'
 
-
+AnnotationTypeLongNames = Literal['input', 'output']
 class AnnotationTypes(StringEnumeration):
     Input = 'I'
     Output = 'O'
     csv_tuple_qualifiers = [(CSV_KEY, Input), (CSV_KEY, Output)]
     long_names = {Input: 'input', Output: 'output'}
```

### Comparing `mdata-0.1.2/src/mdata/core/extensions/metadata.py` & `mdata-0.1.3/src/mdata/core/extensions/metadata.py`

 * *Files 8% similar despite different names*

```diff
@@ -27,14 +27,15 @@
 
 
 def infer_type(series: pd.Series):
     converted = series.convert_dtypes()
     return get_type(converted)
 
 
+# noinspection PyProtectedMember
 def get_type(series: pd.Series) -> FeatureDataType:
     from pandas.api.types import is_bool_dtype, is_float_dtype, is_integer_dtype, is_categorical_dtype, \
         is_datetime64_any_dtype, is_timedelta64_dtype, is_string_dtype
 
     dtype = series.dtype
     if is_string_dtype(dtype):
         return FeatureDataType.String
@@ -73,34 +74,41 @@
         try:
             conv = series.astype(bool, errors='raise')
         except Exception:
             return False
         return np.array_equal(series, conv)
     elif data_type == FeatureDataType.Datetime:
         try:
-            pd.to_datetime(series, errors='raise')
+            pd.to_datetime(series, errors='raise', format='ISO8601')
         except Exception:
             return False
         return True
     elif data_type == FeatureDataType.Duration:
         try:
             pd.to_timedelta(series, errors='raise')
         except Exception:
             return False
         return True
     return False
 
 
-def convert_df_inplace(df: pd.DataFrame, data_types: dict[str, FeatureDataType]):
+def convert_df(df: pd.DataFrame, data_types: dict[str, FeatureDataType], inplace=False):
+    res = pd.DataFrame(index=df.index) if not inplace else df
+
     for f, dt in data_types.items():
         try:
-            convert_series(df.loc[:, [f]], dt, inplace=True)
+            if inplace:
+                convert_series(df.loc[:, [f]], dt, inplace=True)
+            else:
+                res[f] = convert_series(df.loc[:, [f]], dt, inplace=False)
         except Exception as e:
             raise FeatureDataTypeConversionException(f'Conversion of feature {f} to {dt} failed:\n' + str(e))
 
+    return res
+
 
 def convert_series(arg: pd.Series | pd.DataFrame, data_type: FeatureDataType, inplace=True):
     copy = not inplace
 
     def upd_inplace(arg, conv):
         if isinstance(arg, pd.Series):
             arg.loc[:] = conv
@@ -108,15 +116,15 @@
             arg.loc[:, :] = conv
 
     if data_type is FeatureDataType.Int or data_type is FeatureDataType.Float:
         return arg.astype(target_numeric_types[data_type], copy=copy)
     elif data_type is FeatureDataType.Boolean:
         return arg.astype(bool, copy=copy)
     elif data_type is FeatureDataType.Datetime:
-        datetime = pd.to_datetime(arg, infer_datetime_format=True, errors='raise')
+        datetime = pd.to_datetime(arg, errors='raise', format='ISO8601')
         if inplace:
             upd_inplace(arg, datetime)
             return arg
         else:
             return datetime
     elif data_type is FeatureDataType.Duration:
         timedelta = pd.to_timedelta(arg, errors='raise')
```

### Comparing `mdata-0.1.2/src/mdata/core/extensions/multiplicity.py` & `mdata-0.1.3/src/mdata/core/extensions/multiplicity.py.txt`

 * *Files 4% similar despite different names*

```diff
@@ -1,29 +1,31 @@
 from ..machine_data_def import *
+from ..protocols import TSSpec, TSView
+from ..base_types import EventSpecLabel, MeasurementSpecLabel
 
 
 @dataclass
-class IndexedMachineDataTimeseries(MachineDataTimeseries[TSSpec]):
+class IndexedTimeseriesView(TimeseriesView[TSSpec]):
     indices: Collection[int]
 
 
 @dataclass
-class IndexedEventSeries(IndexedMachineDataTimeseries[EventTimeseriesSpec]):
+class IndexedEventSeries(IndexedTimeseriesView[EventTimeseriesSpec]):
     pass
 
 
 @dataclass
-class IndexedMeasurementSeries(IndexedMachineDataTimeseries[MeasurementTimeseriesSpec]):
+class IndexedMeasurementSeries(IndexedTimeseriesView[MeasurementTimeseriesSpec]):
     pass
 
 
-TSI = TypeVar('TSI', bound=IndexedMachineDataTimeseries)
+TSI = TypeVar('TSI', bound=IndexedTimeseriesView)
 
 
-class TypedIndexedTimeseriesCollection(Generic[TSSpec, TS, TSI], TypedTimeseriesCollection[TSSpec, TS]):
+class TypedIndexedTimeseriesCollection(Generic[TSSpec, TSView, TSI], AbstractTimeseriesContainer[TSSpec, TSView]):
     _tsi_cls: type[TSI] = None
 
     def __init__(self, timeseries_spec: TSSpec, df: pd.DataFrame) -> None:
         super().__init__(timeseries_spec, df)
 
     @property
     def occurring_series_indices(self) -> pd.Index:
@@ -49,42 +51,42 @@
     def view_indexed(self, objs: str | list[str] | slice, indices: str | list[str] | slice) -> TSI:
         if objs is None:
             objs = slice(None)
         if indices is None:
             indices = slice(None)
         return self._mk_indexed_timeseries_view(self.timeseries_spec, objs, indices)
 
-    def _mk_timeseries_view(self, timeseries_spec, objs) -> TS:
+    def _mk_timeseries_view(self, timeseries_spec, objs) -> TSView:
         df = self.df.loc[self._internal_index.loc[objs, :]]
         return self._ts_cls(timeseries_spec, df, set(df[MDConcepts.Object]))
 
     def __str__(self):
         return f'IndexedTimeseriesCollection(type={self.timeseries_spec}, #time series={self.time_series_count}, #obs={self.observation_count}, #objects={len(self.occurring_objects)}, #series_indices={len(self.occurring_series_indices)})'
 
 
 class IndexedEventTimeseriesCollection(
-    EventTimeseriesCollection, TypedIndexedTimeseriesCollection[EventTimeseriesSpec, EventSeries, IndexedEventSeries]):
+    EventTimeseriesContainer, TypedIndexedTimeseriesCollection[EventTimeseriesSpec, EventTimeseriesView, IndexedEventSeries]):
     #_ts_type_cls = EventTimeseriesType
     #_ts_cls = EventSeries
     _tsi_cls = IndexedEventSeries
 
 
 class IndexedMeasurementTimeseriesCollection(
-    MeasurementTimeseriesCollection, TypedIndexedTimeseriesCollection[MeasurementTimeseriesSpec, MeasurementSeries, IndexedMeasurementSeries]):
+    MeasurementTimeseriesContainer, TypedIndexedTimeseriesCollection[MeasurementTimeseriesSpec, MeasurementTimeseriesView, IndexedMeasurementSeries]):
     #_ts_type_cls = MeasurementTimeseriesType
     #_ts_cls = MeasurementSeries
     _tsi_cls = IndexedMeasurementSeries
 
 
-ETSI = TypeVar('ETSI', bound=IndexedMachineDataTimeseries)
-MTSI = TypeVar('MTSI', bound=IndexedMachineDataTimeseries)
+ETSI = TypeVar('ETSI', bound=IndexedTimeseriesView)
+MTSI = TypeVar('MTSI', bound=IndexedTimeseriesView)
 
 
 class AbstractMultiplicityMachineData(Generic[ETSI, MTSI], AbstractMachineData[
-    EventTimeseriesSpec, MeasurementTimeseriesSpec, EventSeries, MeasurementSeries, IndexedEventTimeseriesCollection, IndexedMeasurementTimeseriesCollection]):
+    EventTimeseriesSpec, MeasurementTimeseriesSpec, EventTimeseriesView, MeasurementTimeseriesView, IndexedEventTimeseriesCollection, IndexedMeasurementTimeseriesCollection]):
     _etsc_cls = IndexedEventTimeseriesCollection
     _mtsc_cls = IndexedMeasurementTimeseriesCollection
     _etsi_cls: type[ETSI] = None
     _mtsi_cls: type[MTSI] = None
 
     def recalculate_index(self, **kwargs):
         super().recalculate_index(index_cols=MDExtensionConcepts.combined_columns, **kwargs)
@@ -109,20 +111,20 @@
         assert label is not None
         return self.measurement_series[label].view_indexed(objs, indices)
 
     def summary(self):
         first = min(self.index_frame[MDConcepts.Time])
         last = max(self.index_frame[MDConcepts.Time])
         num_obs = len(self.index_frame)
-        return f'#Observations: {num_obs} between {first} and {last}.' + '\n' + f'#Objects: {len(self.occurring_objects)}' + '\n' + f'#Series Indices: {len(self.occurring_series_indices)}' + '\n' + f'#Event types: {len(self.event_specs)}' + '\n' + f'#Measurement types: {len(self.measurement_specs)}'
+        return f'#Observations: {num_obs} between {first} and {last}.' + '\n' + f'#Objects: {len(self.objects)}' + '\n' + f'#Series Indices: {len(self.occurring_series_indices)}' + '\n' + f'#Event types: {len(self.event_specs)}' + '\n' + f'#Measurement types: {len(self.measurement_specs)}'
 
     def __str__(self) -> str:
         ets = '\n'.join([f'\t{l}: {", ".join(tt.features)}' for l, tt in self.event_specs.items()])
         mts = '\n'.join([f'\t{l}: {", ".join(tt.features)}' for l, tt in self.measurement_specs.items()])
-        objs = ' ' + ', '.join(self.occurring_objects)
+        objs = ' ' + ', '.join(self.objects)
         sidx = ' ' + str(self.occurring_series_indices)
         return 'MachineData {' + '\n' + 'Event types:' + '\n' + ets + '\n' + 'Measurement types:' + '\n' + mts + '\n' + 'Objects:' + objs + '\n' + 'Series Indices:' + sidx + '\n' + '}'
 
 
 class MultiplicityMachineData(AbstractMultiplicityMachineData[IndexedEventSeries, IndexedMeasurementSeries]):
     _etsi_cls = IndexedEventSeries
     _mtsi_cls = IndexedMeasurementSeries
```

### Comparing `mdata-0.1.2/src/mdata/core/header.py` & `mdata-0.1.3/src/mdata/core/header.py`

 * *Files 2% similar despite different names*

```diff
@@ -108,19 +108,19 @@
     extensions: frozenset[Extension] = field(default_factory=frozenset)
     metadata: immutabledict[str, Any] = field(default_factory=immutabledict)
 
     @classmethod
     def of(cls, extensions: Collection[Extension], metadata: Mapping[str, Any]):
         return cls(frozenset(extensions), immutabledict(metadata))
 
-    def is_mergable(self, other: Meta):
+    def is_mergeable(self, other: Meta):
         return self.extensions == other.extensions
 
     def merge(self, b: Meta) -> Meta:
-        if not self.is_mergable(b):
+        if not self.is_mergeable(b):
             raise NotMergeableException
         return Meta.of(self.extensions | b.extensions, dict(self.metadata) | dict(b.metadata))
 
 
 @dataclass(frozen=True, eq=True, repr=True)
 class Header:
     meta: Meta = field(default_factory=Meta)
@@ -128,15 +128,15 @@
     measurement_specs: ObservationSpecs = field(default_factory=immutabledict)
     annotation_specs: AnnotationSpecs = field(default_factory=AnnotationSpecs)
 
     def lookup_feature(self, spec_type, label, feature) -> FeatureSpec:
         return self.lookup_spec(spec_type, label).features[feature]
 
     def lookup_spec(self, spec_type, label) -> ObservationSpec:
-        from mdata.core.machine_data_def import ObservationTypes
+        from .shared_defs import ObservationTypes
         if spec_type == ObservationTypes.E:
             return self.event_specs.get(label)
         elif spec_type == ObservationTypes.M:
             return self.measurement_specs.get(label)
         elif spec_type in AnnotationTypes.csv_tuple_qualifiers:
             _, subtype = spec_type
             if subtype == AnnotationTypes.Input:
```

### Comparing `mdata-0.1.2/src/mdata/core/machine_data_def.py` & `mdata-0.1.3/src/mdata/core/base_machine_data.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,272 +1,301 @@
 from __future__ import annotations
 
 import itertools
+import logging
+import typing
 from abc import ABC
-from dataclasses import dataclass, field
-from functools import partial
-from typing import Iterable, Generic, TypeVar, Sized, TYPE_CHECKING, Collection, Literal, ClassVar, Callable
+from collections.abc import Iterable, Collection, Mapping, Set, Iterator
+from dataclasses import dataclass
+from typing import Generic, Literal, Union
 
 import numpy as np
 import pandas as pd
+from immutabledict import immutabledict
 
+from .shared_defs import StrIndexer, TimeseriesFeatureLabel, TimeseriesFeatureLabels, ObservationTypeValue, \
+    ObservationType, ObservationSpecLabel, ObservationSpecIdentifier, EventSpecLabel, MeasurementSpecLabel, \
+    ObservationTypes, MDConcepts, only_feature_columns
 from .df_utils import derive_categoricals
 from .header import Header, ObservationSpec, Meta, FeatureSpec
-from .util import mangle_arg_to_set, mangle_arg_with_bool_fallback, mangle_arg_to_list, mangle_arg_to_tuple, \
-    symmetric_difference, intersection, assert_in, StringEnumeration
-
-if TYPE_CHECKING:
-    pass
-
-MDConcept = str
-
-
-class MDConcepts(StringEnumeration):
-    Time = 'time'
-    Object = 'object'
-    Type = 'type'
-    Label = 'label'
-
-    base_columns = [Time, Object, Type, Label]
-
-
-class MDExtensionConcepts(StringEnumeration):
-    Index = 'series_index'
-
-    extension_columns = [Index]
-    combined_columns = MDConcepts.base_columns + extension_columns
-
-
-def only_feature_columns(cols):
-    return [c for c in cols if (c not in MDConcepts.base_columns) and (c not in MDExtensionConcepts.extension_columns)]
-
-
-def project_on_feature_columns(df: pd.DataFrame):
-    return df[only_feature_columns(df.columns)]
-
-
-TimeseriesFeatureLabel = str
-TimeseriesFeatureLabels = tuple[TimeseriesFeatureLabel, ...]
-
-ObservationTypeType = str
-
-
-class ObservationTypes(StringEnumeration):
-    E: ObservationTypeType = 'E'
-    M: ObservationTypeType = 'M'
-
-
-ObservationTypeLabel = str
-ObservationSpecIdentifier = tuple[ObservationTypeType, ObservationTypeLabel]
-
-EventSpecLabel = str
-MeasurementSpecLabel = str
-
-TimeseriesSpecType = TypeVar('TimeseriesTypeType', bound='TimeseriesSpec')
+from .protocols import EventSpecific, MeasurementSpecific, TimeseriesSpecProtocol, TimeseriesViewProtocol, \
+    TimeseriesContainerProtocol, MachineDataProtocol, TSSpec, TSView, ETSC, MTSC, \
+    ETSView, ETSSpec, MTSView, MTSSpec, TSContainer, MachineData
+from .util import mangle_arg_to_set, mangle_arg_with_bool_fallback, mangle_arg_to_tuple, \
+    assert_in
 
 
 class TimeseriesTypeMergeException(Exception):
     pass
 
 
 class TimeseriesCollectionMergeException(Exception):
     pass
 
 
 class MachineDataMergeException(Exception):
     pass
 
 
-@dataclass(frozen=True, unsafe_hash=True, eq=True, repr=True, init=False)
-class TimeseriesSpec(Iterable, Sized):
-    type: ClassVar[ObservationTypeType]
-    label: ObservationTypeLabel
-    base: ObservationSpec
-    features: TimeseriesFeatureLabels = field(init=False)
-    display_names: TimeseriesFeatureLabels = field(init=False)
+@dataclass(frozen=True, unsafe_hash=True, eq=True, repr=False)
+class TimeseriesSpec(TimeseriesSpecProtocol):
+    observation_type: typing.ClassVar[ObservationType]
+    _label: ObservationSpecLabel
+    _base: ObservationSpec
+    _features: TimeseriesFeatureLabels
 
-    def __init__(self, label: ObservationTypeLabel, spec: ObservationSpec) -> None:
-        super().__init__()
-        object.__setattr__(self, 'label', label)
-        object.__setattr__(self, 'base', spec)
-        object.__setattr__(self, 'features', tuple((f.name for f in spec)))
-        object.__setattr__(self, 'display_names', tuple((f.print_name for f in spec)))
+    @classmethod
+    def of(cls, label: ObservationSpecLabel, base_spec: ObservationSpec) -> typing.Self:
+        return cls(label, base_spec, tuple((f.name for f in base_spec)))
 
-    def __iter__(self):
-        return iter(self.features)
+    @property
+    def type(self) -> ObservationTypeValue:
+        return self.observation_type.value
 
-    def __len__(self):
-        return len(self.features)
+    @property
+    def label(self) -> ObservationSpecLabel:
+        return self._label
 
     @property
     def identifier(self) -> ObservationSpecIdentifier:
         return self.type, self.label
 
-    def is_mergeable(self, other: TimeseriesSpec) -> bool:
-        return (self.__class__ == other.__class__) and (self.type == other.type) and (self.label == other.label)
+    @property
+    def base(self) -> ObservationSpec:
+        return self._base
+
+    @property
+    def features(self) -> TimeseriesFeatureLabels:
+        return self._features
+
+    @property
+    def long_names(self) -> TimeseriesFeatureLabels:
+        return tuple((f.print_name for f in self.base))
+
+    def __iter__(self) -> Iterator[str]:
+        return iter(self.features)
+
+    def __len__(self) -> int:
+        return len(self.features)
 
-    def feature_intersection(self, other: TimeseriesSpec) -> list[str]:
+    def __repr__(self):
+        extended_feature_labels = tuple(
+            (str(f) if f == ln else f'{f} ({ln})') for f, ln in zip(self.features, self.long_names))
+        return f'{self.__class__.__name__}(spec_id=({self.observation_type}, {self.label}), features={extended_feature_labels})'
+
+    def __str__(self):
+        return self.__repr__()
+
+    def is_mergeable(self, other: TimeseriesSpecProtocol) -> bool:
+        return (self.__class__ == other.__class__) and self.identifier == other.identifier
+
+    def feature_intersection(self, other: TimeseriesSpecProtocol) -> list[str]:
         return [f for f in self.features if f in set(other.features)]
 
-    def feature_symmetric_difference(self, other: TimeseriesSpec) -> tuple[list[str], list[str]]:
+    def feature_symmetric_difference(self, other: TimeseriesSpecProtocol) -> tuple[list[str], list[str]]:
         return [f for f in self.features if f not in set(other.features)], [f for f in other.features if
                                                                             f not in set(self.features)]
 
-    def project(self: TimeseriesSpecType, feature_selection: bool | str | Collection[str]) -> TimeseriesSpecType:
+    def project(self, feature_selection: bool | str | Collection[str]) -> typing.Self:
         feature_selection = mangle_arg_with_bool_fallback(mangle_arg_to_tuple, feature_selection, if_true=self.features)
         assert all(f in self.features for f in feature_selection)
-        return self.__class__(self.label, ObservationSpec.of(*(self.base[f] for f in feature_selection)))
+        return self.__class__.of(self.label, ObservationSpec.of(*(self.base[f] for f in feature_selection)))
 
-    def merge(self: TimeseriesSpecType, other: TimeseriesSpecType) -> TimeseriesSpecType:
+    def merge(self, other: typing.Self) -> typing.Self:
         assert self.is_mergeable(other)
         specs = list(self.base.features)
         for fspec in other.base:
             if fspec not in self.base:
                 specs.append(fspec)
             elif self.base[fspec.name] != fspec:
                 print('redefined', self.base, self.base[fspec.name], fspec.name)
                 raise TimeseriesTypeMergeException
-        return self.__class__(self.label, ObservationSpec.of(*specs))
+        return self.__class__.of(self.label, ObservationSpec.of(*specs))
 
 
-@dataclass(frozen=True, init=False)
-class EventTimeseriesSpec(TimeseriesSpec):
-    type = ObservationTypes.E
+# @dataclass(frozen=True, repr=False)
+class EventTimeseriesSpec(TimeseriesSpec, EventSpecific):
+    observation_type = ObservationType.E
 
 
-@dataclass(frozen=True, init=False)
-class MeasurementTimeseriesSpec(TimeseriesSpec):
-    type = ObservationTypes.M
+# @dataclass(frozen=True, repr=False)
+class MeasurementTimeseriesSpec(TimeseriesSpec, MeasurementSpecific):
+    observation_type = ObservationType.M
 
 
-class TimeseriesSpecFactory:
-    types = {ObservationTypes.E: EventTimeseriesSpec, ObservationTypes.M: MeasurementTimeseriesSpec}
+class TimeseriesView(TimeseriesViewProtocol[TSSpec], Generic[TSSpec]):
+
+    def __init__(self, timeseries_spec: TSSpec, df: pd.DataFrame, objects: Collection[str] = None) -> None:
+        super().__init__()
+        self._timeseries_spec: TSSpec = timeseries_spec
+        self._df = df
+        self._objects = frozenset(objects) if objects is not None else frozenset()
+
+    @property
+    def observation_type(self) -> ObservationTypeValue:
+        return self.timeseries_spec.observation_type
+
+    @property
+    def timeseries_spec(self) -> TSSpec:
+        return self._timeseries_spec
+
+    @property
+    def df(self) -> pd.DataFrame:
+        return self._df
+
+    def feature_column_view(self, include_time_col=True, include_object_col=False, add_spec_id_prefix=False,
+                            use_long_names=False) -> pd.DataFrame:
+        return _feature_column_view(self.timeseries_spec, self.df, include_time_col=include_time_col,
+                                    include_object_col=include_object_col, add_spec_id_prefix=add_spec_id_prefix,
+                                    use_long_names=use_long_names)
 
     @classmethod
-    def for_type(cls, arg: str) -> Callable[[ObservationTypeLabel, ObservationSpec], TimeseriesSpec]:
-        return cls.types[arg]
+    def of(cls, timeseries_spec: TSSpec, df: pd.DataFrame, objects: Collection[str] = None, *args,
+           **kwargs) -> typing.Self:
+        c = cls(timeseries_spec, df, objects)
+        return c
 
+    @property
+    def objects(self) -> Set[str]:
+        return self._objects
 
-TSSpec = TypeVar('TSSpec', bound=TimeseriesSpec)
+    def __repr__(self):
+        return f'{self.__class__.__name__}(spec={self.timeseries_spec}, #observations={len(self.df)}, objects={str(self.objects)})'
 
+    def __str__(self):
+        return repr(self)
 
-@dataclass
-class AbstractMachineDataTimeseries(Generic[TSSpec], ABC):
-    timeseries_spec: TSSpec
-    df: pd.DataFrame
 
+cl = TimeseriesView[EventTimeseriesSpec]
 
-@dataclass
-class MachineDataTimeseries(AbstractMachineDataTimeseries[TSSpec]):
-    objects: Collection[str]
 
+class EventTimeseriesView(TimeseriesView[EventTimeseriesSpec]):
 
-@dataclass
-class EventSeries(MachineDataTimeseries[EventTimeseriesSpec]):
-    pass
+    def __init__(self, timeseries_spec: EventTimeseriesSpec, df: pd.DataFrame, objects: Collection[str] = None) -> None:
+        super().__init__(timeseries_spec, df, objects)
 
 
-@dataclass
-class MeasurementSeries(MachineDataTimeseries[MeasurementTimeseriesSpec]):
-    pass
+class MeasurementTimeseriesView(TimeseriesView[MeasurementTimeseriesSpec]):
 
+    def __init__(self, timeseries_spec: MeasurementTimeseriesSpec, df: pd.DataFrame,
+                 objects: Collection[str] = None) -> None:
+        super().__init__(timeseries_spec, df, objects)
 
-TS = TypeVar('TS', bound=MachineDataTimeseries)
 
-TTC = TypeVar('TTC', bound='TypedTimeseriesCollection')
+def _feature_column_view(spec, df, include_time_col=True, include_object_col=False, add_spec_id_prefix=False,
+                         use_long_names=False):
+    cols = list(spec.features)
+    if include_object_col:
+        cols = [MDConcepts.Object] + cols
+    if include_time_col:
+        cols = [MDConcepts.Time] + cols
 
+    view = df.loc[:, cols]
 
-class TypedTimeseriesCollection(Generic[TSSpec, TS], ABC):
+    renaming = {}
+
+    def maybe_prefix(c):
+        if add_spec_id_prefix:
+            return spec.type + '_' + spec.label + '_' + c
+        else:
+            return c
+
+    if use_long_names | add_spec_id_prefix:
+        if use_long_names:
+            renaming = {f: maybe_prefix(ln) for f, ln in
+                        zip(spec.features, spec.long_names)}
+        else:
+            renaming = {f: maybe_prefix(f) for f in spec.features}
+
+    return view.rename(renaming, inplace=False, axis='columns') if renaming else view
+
+
+class AbstractTimeseriesContainer(TimeseriesContainerProtocol[TSSpec, TSView], Generic[TSSpec, TSView], ABC):
     _ts_spec_cls: type[TSSpec] = None
-    _ts_cls: type[TS] = None
+    _ts_view_cls: type[TSView] = None
 
     def __init__(self, timeseries_spec: TSSpec, df: pd.DataFrame) -> None:
         super().__init__()
-        self.timeseries_spec: TSSpec = timeseries_spec
-        self.df: pd.DataFrame = df
-        self._object_map: dict[str, TS] = {}
-        self._repopulate_internal_index()
-
-    @property
-    def observation_count(self) -> int:
-        return len(self.df)
+        assert isinstance(timeseries_spec, self._ts_spec_cls)
+        self.timeseries_spec = timeseries_spec
+        self.df = df
 
-    @property
-    def occurring_objects(self) -> set[str]:
-        return self._occurring_objects
+        self._internal_index = None
+        self._object_map: Mapping[str, TSView] = {}
+        self._repopulate_internal_index()
 
     @property
-    def time_series_count(self) -> int:
-        return len(self._occurring_objects)
+    def observation_type(self) -> ObservationType:
+        return self.timeseries_spec.observation_type
 
     @property
-    def object_map(self) -> dict[str, TS]:
-        return self._object_map
+    def timeseries_spec(self) -> TSSpec:
+        return self._timeseries_spec
 
-    @property
-    def feature_column_view(self):
-        return self.df.loc[:, list(self.timeseries_spec.features)]
+    @timeseries_spec.setter
+    def timeseries_spec(self, value: TSSpec):
+        self._timeseries_spec = value
 
     @property
-    def prefixed_feature_column_view(self):
-        df = self.feature_column_view
-        return df.rename(
-            {c: self.timeseries_spec.type + '_' + self.timeseries_spec.label + '_' + c for c in df.columns},
-            inplace=False)
+    def df(self) -> pd.DataFrame:
+        return self._df
 
-    def _repopulate_internal_index(self):
-        self._internal_index = pd.Series(self.df.index, index=self.df[MDConcepts.Object])
-        self._occurring_objects = set(self._internal_index.index)
-        self._object_map = {obj: self.view(obj) for obj in self._occurring_objects}
+    @df.setter
+    def df(self, value: pd.DataFrame):
+        self._df = value
 
-    def _check_ts_features(self):
-        return set(self.timeseries_spec.features) <= set(self.df.columns)
-
-    def _mk_timeseries_view(self, timeseries_spec, objs) -> TS:
-        df = self.df.loc[self._internal_index.loc[objs]]
-        return self._ts_cls(timeseries_spec, df, set(df[MDConcepts.Object]))
+    @classmethod
+    def of(cls, timeseries_spec: TSSpec, df: pd.DataFrame, *args, **kwargs) -> typing.Self:
+        return cls(timeseries_spec, df)
 
-    def _update_timeseries_spec(self, timeseries_spec: TSSpec = None) -> None:
-        self.timeseries_spec = self._derive_timeseries_spec() if timeseries_spec is None else timeseries_spec
-        assert self._check_ts_features()
+    @property
+    def objects(self) -> Set[str]:
+        return self._object_map.keys()
 
-    def _derive_timeseries_spec(self) -> TSSpec:
-        current_features = only_feature_columns(self.df.columns)
-        from .extensions import metadata
+    @property
+    def observation_count(self) -> int:
+        return len(self.df)
 
-        specs: list[FeatureSpec] = []
-        for f in current_features:
-            fdt = metadata.get_type(self.df.loc[:, f])
-            long_name = f
-            if f in self.timeseries_spec.base:
-                fspec: FeatureSpec = self.timeseries_spec.base[f]
-                long_name = fspec.print_name
-            specs.append(FeatureSpec(f, long_name, fdt))
+    @property
+    def time_series_count(self) -> int:
+        return len(self.objects)
 
-        return self._ts_spec_cls(self.timeseries_spec.label, ObservationSpec(*specs))
+    def __contains__(self, item) -> bool:
+        return item in self._object_map
 
-    def update_index(self):
-        self._repopulate_internal_index()
+    def __getitem__(self, item: str) -> TSView:
+        return self._object_map[item]
 
-    def fit_to_data(self) -> None:
-        self._update_timeseries_spec()
-        self.update_index()
+    def __len__(self) -> int:
+        return len(self.objects)
 
-    def view(self, objs: str | list[str] | slice) -> TS:
-        objs = slice(None) if objs is None else objs
-        return self._mk_timeseries_view(self.timeseries_spec, objs)
+    def __iter__(self) -> Iterator[TSView]:
+        return iter(self._object_map.values())
 
     def __str__(self):
-        return f'TimeseriesCollection(spec={self.timeseries_spec}, #obs={self.observation_count}, #objects={len(self.occurring_objects)})'
+        return f'{self.__class__.__name__}(spec={self.timeseries_spec}, #obs={self.observation_count}, #objects={len(self.objects)})'
 
     def __repr__(self) -> str:
         return str(self)
 
-    def merge(self: TTC, other: TTC,
-              axis: Literal['horizontal', 'vertical'] = 'vertical') -> TTC:
+    def feature_column_view(self, include_time_col=True, include_object_col=False, add_spec_id_prefix=False,
+                            use_long_names=False) -> pd.DataFrame:
+        return _feature_column_view(self.timeseries_spec, self.df, include_time_col=include_time_col,
+                                    include_object_col=include_object_col, add_spec_id_prefix=add_spec_id_prefix,
+                                    use_long_names=use_long_names)
+
+    def view(self, objs: StrIndexer) -> TSView:
+        if not objs:
+            objs = []
+        elif objs is True:
+            objs = slice(None)
+        return self._mk_timeseries_view(self.timeseries_spec, objs)
+
+    def merge(self, other: typing.Self,
+              axis: Literal['horizontal', 'vertical'] = 'vertical') -> typing.Self:
         assert axis in {'horizontal', 'vertical'}
         if axis == 'horizontal':
             assert self.timeseries_spec.is_mergeable(other.timeseries_spec)
             ov = self.timeseries_spec.feature_intersection(other.timeseries_spec)
             if ov:
                 assert self.df.loc[:, ov].equals(
                     other.df.loc[:, ov])  # np.array_equal(self.df.loc[:, ov].values, other.df.loc[:, ov].values)
@@ -278,165 +307,250 @@
             return self
         elif axis == 'vertical':
             assert self.timeseries_spec == other.timeseries_spec
             df = pd.concat([self.df, other.df], axis='index', ignore_index=True, copy=True)
             df.sort_values(MDConcepts.Time, ignore_index=True, inplace=True)
             return self.__class__(self.timeseries_spec, df)
 
-    @classmethod
-    def lifted_merge(cls: type[TTC], tscs: dict[str, TTC], o_tscs: dict[str, TTC],
-                     axis: Literal['horizontal', 'vertical'] = 'vertical') -> dict[str, TTC]:
-        assert axis in {'horizontal', 'vertical'}
-        ov = intersection(tscs.keys(), o_tscs.keys())
-        s1, s2 = symmetric_difference(tscs.keys(), o_tscs.keys())
-        res = {e: tscs[e] for e in s1} | {e: tscs[e].merge(o_tscs[e], axis=axis) for e in ov}
-        if axis == 'horizontal':
-            return res
-        elif axis == 'vertical':
-            return res | {e: o_tscs[e] for e in s2}
-
+    def _repopulate_internal_index(self):
+        self._internal_index = pd.Series(self.df.index, index=self.df[MDConcepts.Object])
+        self._object_map: dict[str, TSView] = {obj: self.view(obj) for obj in self._internal_index.index.unique()}
 
-class EventTimeseriesCollection(TypedTimeseriesCollection[EventTimeseriesSpec, EventSeries]):
-    _ts_spec_cls = EventTimeseriesSpec
-    _ts_cls = EventSeries
+    def _check_ts_features(self):
+        return set(self.timeseries_spec.features) <= set(self.df.columns)
 
+    def _mk_timeseries_view(self, timeseries_spec, objs) -> TSView:
+        df = self.df.loc[self._internal_index.loc[objs]]
+        return self._ts_view_cls(timeseries_spec, df, objects=set(df[MDConcepts.Object]))
 
-class MeasurementTimeseriesCollection(TypedTimeseriesCollection[MeasurementTimeseriesSpec, MeasurementSeries]):
-    _ts_spec_cls = MeasurementTimeseriesSpec
-    _ts_cls = MeasurementSeries
+    def _update_timeseries_spec(self, timeseries_spec: TSSpec = None) -> None:
+        self.timeseries_spec = self._derive_timeseries_spec() if timeseries_spec is None else timeseries_spec
+        assert self._check_ts_features()
 
+    def _derive_timeseries_spec(self) -> TSSpec:
+        current_features = only_feature_columns(self.df.columns)
+        from .extensions import metadata
 
-ETSType = TypeVar('ETSType', bound=TimeseriesSpec)
-MTSType = TypeVar('MTSType', bound=TimeseriesSpec)
+        specs: list[FeatureSpec] = []
+        for f in current_features:
+            fdt = metadata.get_type(self.df.loc[:, f])
+            long_name = f
+            if f in self.timeseries_spec.base:
+                fspec: FeatureSpec = self.timeseries_spec.base[f]
+                long_name = fspec.print_name
+            specs.append(FeatureSpec(f, long_name, fdt))
 
-ETS = TypeVar('ETS', bound=MachineDataTimeseries)
-MTS = TypeVar('MTS', bound=MachineDataTimeseries)
+        return self._ts_spec_cls(self.timeseries_spec.label, ObservationSpec(*specs))
 
-ETSC = TypeVar('ETSC', bound=TypedTimeseriesCollection)
-MTSC = TypeVar('MTSC', bound=TypedTimeseriesCollection)
+    def update_index(self):
+        self._repopulate_internal_index()
 
+    def fit_to_data(self) -> None:
+        self._update_timeseries_spec()
+        self.update_index()
 
-class TimeseriesCollectionFactory:
-    types = {ObservationTypes.E: EventTimeseriesCollection, ObservationTypes.M: MeasurementTimeseriesCollection}
 
-    @classmethod
-    def for_type(cls, timeseries_spec: TimeseriesSpec) -> Callable[[pd.DataFrame], TypedTimeseriesCollection]:
-        if isinstance(timeseries_spec, EventTimeseriesSpec):
-            return partial(cls.types[ObservationTypes.E], timeseries_spec)
-        elif isinstance(timeseries_spec, MeasurementTimeseriesSpec):
-            return partial(cls.types[ObservationTypes.M], timeseries_spec)
+class EventTimeseriesContainer(AbstractTimeseriesContainer[EventTimeseriesSpec, EventTimeseriesView]):
+    _ts_spec_cls = EventTimeseriesSpec
+    _ts_view_cls = EventTimeseriesView
 
 
-AMD = TypeVar('AMD', bound='AbstractMachineData')
+class MeasurementTimeseriesContainer(AbstractTimeseriesContainer[MeasurementTimeseriesSpec, MeasurementTimeseriesView]):
+    _ts_spec_cls = MeasurementTimeseriesSpec
+    _ts_view_cls = MeasurementTimeseriesView
 
 
-class AbstractMachineData(Generic[ETSType, MTSType, ETS, MTS, ETSC, MTSC], ABC):
+class AbstractMachineData(MachineDataProtocol[ETSSpec, ETSView, ETSC, MTSSpec, MTSView, MTSC], ABC):
     _etsc_cls: type[ETSC] = None
     _mtsc_cls: type[MTSC] = None
 
     def __init__(self, meta: Meta, events: Iterable[ETSC],
                  measurements: Iterable[MTSC],
                  index_frame: pd.DataFrame = None) -> None:
-        self._index_frame: pd.DataFrame = index_frame
+
         self.meta: Meta = meta
-        self.event_specs: dict[EventSpecLabel, ETSType]
-        self.measurement_specs: dict[MeasurementSpecLabel, MTSType]
-        self.event_series: dict[EventSpecLabel, ETSC] = {etc.timeseries_spec.label: etc for etc in events}
-        self.measurement_series: dict[MeasurementSpecLabel, MTSC] = {mtc.timeseries_spec.label: mtc for mtc in
-                                                                     measurements}
-        self._repopulate_maps()
+        self.event_series: Mapping[EventSpecLabel, ETSC] = immutabledict(
+            {etc.timeseries_spec.label: etc for etc in events})
+        self.measurement_series: Mapping[MeasurementSpecLabel, MTSC] = immutabledict(
+            {mtc.timeseries_spec.label: mtc for mtc in
+             measurements})
+
+        for etsc in self.event_series.values():
+            assert isinstance(etsc, self._etsc_cls)
+        for mtsc in self.measurement_series.values():
+            assert isinstance(mtsc, self._mtsc_cls)
+
+        # derived fields/maps
+        self._event_specs = None
+        self._measurement_specs = None
+        self._index_frame: pd.DataFrame = index_frame
+        self._objects = None
+        self._series_containers: typing.Optional[tuple[typing.Union[ETSC | MTSC], ...]] = tuple(
+            itertools.chain(self.event_series.values(), self.measurement_series.values()))
+
+    @classmethod
+    def of(cls, meta: Meta = Meta(), events: Iterable[ETSC] = (),
+           measurements: Iterable[MTSC] = (), lazy_index_creation=False, lazy_map_creation=True,
+           *args,
+           **kwargs) -> typing.Self:
+        md = cls(meta, events, measurements, **kwargs)
+        if not lazy_index_creation:
+            md.recalculate_index()
+        if not lazy_map_creation:
+            md._repopulate_maps()
+        return md
 
     @property
-    def header(self):
+    def header(self) -> Header:
         return Header(self.meta, {e: tspec.base for e, tspec in self.event_specs.items()},
                       {m: tspec.base for m, tspec in self.measurement_specs.items()})
 
     @property
     def index_frame(self) -> pd.DataFrame:
         if self._index_frame is None:
             self.recalculate_index()
         return self._index_frame
 
     @index_frame.setter
     def index_frame(self, value: pd.DataFrame):
         self._index_frame = value
 
     @property
-    def occurring_objects(self) -> set[str]:
-        return self._occurring_objects
+    def objects(self) -> Set[str]:
+        if self._objects is None:
+            self._repopulate_maps()
+        return self._objects
 
     @property
     def observation_count(self) -> int:
         return len(self.index_frame)
 
     @property
-    def series_containers(self) -> list[ETSC | MTSC]:
-        return list(self.event_series.values()) + list(self.measurement_series.values())
+    def series_containers(self) -> tuple[Union[ETSC | MTSC], ...]:
+        if self._series_containers is None:
+            self._repopulate_maps()
+        return self._series_containers
+
+    @property
+    def event_specs(self) -> Mapping[EventSpecLabel, ETSSpec]:
+        if self._event_specs is None:
+            self._repopulate_maps()
+        return self._event_specs
+
+    @property
+    def measurement_specs(self) -> Mapping[MeasurementSpecLabel, MTSSpec]:
+        if self._measurement_specs is None:
+            self._repopulate_maps()
+        return self._measurement_specs
+
+    def __getitem__(self, item: ObservationSpecIdentifier) -> ETSC | MTSC:
+        t, label = item
+        match t:
+            case ObservationTypes.E:
+                return self.event_series[label]
+            case ObservationTypes.M:
+                return self.measurement_series[label]
+            case _:
+                raise KeyError
 
-    @classmethod
-    def from_series(cls: type[AMD], events: Iterable[ETSC],
-                    measurements: Iterable[MTSC], lazy_index_creation=True, meta: Meta = Meta()) -> AMD:
-        md = cls(meta, events, measurements)
-        if not lazy_index_creation:
-            md.recalulate_index()
-        return md
+    def __contains__(self, item: object) -> bool:
+        if not isinstance(item, tuple):
+            return False
+        try:
+            self[item]
+        except KeyError:
+            return False
+        return True
+
+    def __len__(self) -> int:
+        return len(self.series_containers)
+
+    def __iter__(self) -> Iterator[ETSC | MTSC]:
+        return iter(self.series_containers)
+
+    def get_spec(self, identifier: ObservationSpecIdentifier, *args) -> ETSSpec | MTSSpec:
+        if len(args) > 0:
+            t, label = identifier, args[0]
+        else:
+            t, label = identifier
+        match t:
+            case ObservationTypes.E:
+                return self.event_specs[label]
+            case ObservationTypes.M:
+                return self.measurement_specs[label]
+            case _:
+                raise KeyError
+
+    def get_events(self, label: EventSpecLabel) -> ETSC:
+        return self.event_series[label]
+
+    def get_measurements(self, label: MeasurementSpecLabel) -> MTSC:
+        return self.measurement_series[label]
+
+    def view_event_series(self, label: EventSpecLabel, objs: StrIndexer = slice(None), *args,
+                          **kwargs) -> ETSView:
+        return self.event_series[label].view(objs=objs, **kwargs)
+
+    def view_measurement_series(self, label: MeasurementSpecLabel, objs: StrIndexer = slice(None), *args,
+                                **kwargs) -> MTSView:
+        return self.measurement_series[label].view(objs=objs, **kwargs)
 
     def recalculate_index(self, override_categorical_types=True, sort_by_time=True, **kwargs):
         self._index_frame = build_shared_index(self.series_containers,
                                                override_categorical_types=override_categorical_types,
                                                sort_by_time=sort_by_time, **kwargs)
 
     def _repopulate_maps(self):
-        self.event_specs = {es.timeseries_spec.label: es.timeseries_spec for es in
-                            self.event_series.values()}
-        self.measurement_specs = {ms.timeseries_spec.label: ms.timeseries_spec for ms in
-                                  self.measurement_series.values()}
-        self._occurring_objects = set(self.index_frame[MDConcepts.Object])
+        self._series_containers = tuple(self.event_series.values()) + tuple(self.measurement_series.values())
+        self._event_specs = immutabledict({es.timeseries_spec.label: es.timeseries_spec for es in
+                                           self.event_series.values()})
+        self._measurement_specs = immutabledict({ms.timeseries_spec.label: ms.timeseries_spec for ms in
+                                                 self.measurement_series.values()})
+        self._objects = frozenset(self.index_frame[MDConcepts.Object])
 
-    def fit_to_data(self, recreate_index=False):
-        for tsc in self.iter_all_timeseries():
+    def fit_to_data(self, ignore_index=False):
+        for tsc in self.series_containers:
             # retain only the rows that are referenced in the overall index
-            if not recreate_index:
+            if not ignore_index:
                 tsc.df = tsc.df.filter(items=self.index_frame.index, axis=0)
             tsc.fit_to_data()
 
-        if recreate_index:
+        if ignore_index:
             self.recalculate_index()
         else:
-            mask = pd.Series(False, index=self.index_frame.index)
-            for tsc in self.iter_all_timeseries():
-                mask |= self.index_frame.index.isin(tsc.df.index)
-            self.index_frame = self.index_frame.loc[mask]
-
-        self._repopulate_maps()
-
-    def iter_all_timeseries(self) -> Iterable[TypedTimeseriesCollection]:
-        return itertools.chain(self.event_series.values(), self.measurement_series.values())
+            old_index = self.index_frame.index
+            mask = pd.Series(False, index=old_index)
+            for tsc in self.series_containers:
+                mask |= old_index.isin(tsc.df.index)
+            self._index_frame = self.index_frame[mask]
 
     def create_joined_df(self, event_series_labels: Iterable[EventSpecLabel] | bool = None,
                          measurement_series_labels: Iterable[MeasurementSpecLabel] | bool = None,
-                         prefix_columns_to_avoid_collisions=True):
+                         prefix_columns_to_avoid_collisions=True, copy=False):
         event_keys = self.event_specs.keys()
         esl = mangle_arg_with_bool_fallback(mangle_arg_to_tuple, event_series_labels,
                                             if_true=event_keys,
                                             rm_duplicates=True, preserve_order=True)
         assert_in(esl, event_keys)
         measurement_keys = self.measurement_specs.keys()
         msl = mangle_arg_with_bool_fallback(mangle_arg_to_tuple, measurement_series_labels,
                                             if_true=measurement_keys,
                                             rm_duplicates=True, preserve_order=True)
         assert_in(msl, measurement_keys)
+        it: Iterable[ETSC | MTSC] = itertools.chain((self.event_series[e] for e in esl),
+                                                    (self.measurement_series[m] for m in msl))
         return pd.concat([self.index_frame] + [
-            tsc.prefixed_feature_column_view if prefix_columns_to_avoid_collisions else tsc.feature_column_view for
-            tsc in self.series_containers], axis='columns', copy=False)
+            tsc.feature_column_view(add_spec_id_prefix=prefix_columns_to_avoid_collisions, include_time_col=False,
+                                    include_object_col=False) for
+            tsc in it], axis='columns', copy=copy)
 
-    def create_index_view(self, typ: ObservationTypeType = None, types: Collection[ObservationTypeType] = None,
+    def create_index_view(self, typ: ObservationTypeValue = None, types: Iterable[ObservationTypeValue] = None,
                           obj: str = None, objs: Iterable[str] = None,
-                          label: ObservationTypeLabel = None,
-                          labels: Iterable[ObservationTypeLabel] = None) -> pd.DataFrame:
+                          label: ObservationSpecLabel = None,
+                          labels: Iterable[ObservationSpecLabel] = None) -> pd.DataFrame:
         assert typ is None or types is None
         assert obj is None or objs is None
         assert label is None or labels is None
 
         mask = pd.Series(True, index=self.index_frame.index)
         if obj is not None:
             mask &= (self.index_frame[MDConcepts.Object] == obj)
@@ -449,150 +563,126 @@
         if typ is not None:
             mask &= (self.index_frame[MDConcepts.Type] == typ)
         elif types is not None:
             mask &= (self.index_frame[MDConcepts.Type].isin(mangle_arg_to_set(typ)))
 
         return self.index_frame.loc[mask]
 
-    def project(self: AMD,
-                measurement_feature_selection: dict[
-                    MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]] = None,
-                event_feature_selection: dict[EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]] = None,
-                project_underlying_dfs=False, copy_underlying_dfs=False) -> AMD:
-        if measurement_feature_selection is None:
-            measurement_feature_selection = {}
-        if event_feature_selection is None:
-            event_feature_selection = {}
-        ms = []
-        for m, fs in measurement_feature_selection.items():
-            fs = mangle_arg_with_bool_fallback(mangle_arg_to_list, fs,
-                                               if_true=self.measurement_specs[m].features,
-                                               preserve_order=True)
-            mtc = self.measurement_series[m]
-            tspec = mtc.timeseries_spec.project(fs)
-            df = mtc.df.loc[:, MDConcepts.base_columns + list(tspec.features)] if project_underlying_dfs else mtc.df
-            if copy_underlying_dfs:
-                df = df.copy()
-            ms.append(self._mtsc_cls(tspec, df))
-        es = []
-        for m, fs in event_feature_selection.items():
-            fs = mangle_arg_with_bool_fallback(mangle_arg_to_tuple, event_feature_selection,
-                                               if_true=self.event_specs.keys(), preserve_order=True)
-            etc = self.event_series[m]
-            tspec = etc.timeseries_spec.project(fs)
-            df = etc.df.loc[:, MDConcepts.base_columns + list(tspec.features)] if project_underlying_dfs else etc.df
-            if copy_underlying_dfs:
-                df = df.copy()
-            es.append(self._etsc_cls(tspec, df))
+    def project(self,
+                event_feature_selection: Mapping[
+                    EventSpecLabel, bool | Collection[TimeseriesFeatureLabel]] = immutabledict(),
+                measurement_feature_selection: Mapping[
+                    MeasurementSpecLabel, bool | Collection[TimeseriesFeatureLabel]] = immutabledict(),
+                project_underlying_dfs=False, copy_underlying_dfs=False) -> typing.Self:
+        def proj(tsc: TimeseriesContainerProtocol, fs):
+            tspec = tsc.timeseries_spec
+            fs = mangle_arg_with_bool_fallback(mangle_arg_to_tuple, fs, if_true=tspec.features, preserve_order=True)
+            spec_proj = tspec.project(fs)
+            df_proj = tsc.df.loc[:,
+                      MDConcepts.base_columns + list(spec_proj.features)] if project_underlying_dfs else tsc.df
+            return spec_proj, (df_proj.copy() if copy_underlying_dfs else df_proj)
+
+        es = [self._etsc_cls(*proj(self.event_series[e], fs)) for e, fs in event_feature_selection.items()]
+        ms = [self._mtsc_cls(*proj(self.measurement_series[m], fs)) for m, fs in
+              measurement_feature_selection.items()]
 
         index_view = self.create_index_view(
-            labels=itertools.chain(measurement_feature_selection.keys(), event_feature_selection.keys()))
+            labels=itertools.chain(event_feature_selection.keys(), measurement_feature_selection.keys()))
         if copy_underlying_dfs:
             index_view = index_view.copy()
-        return self.__class__(self.meta, es, ms, index_frame=index_view)
+        return self.__class__.of(meta=self.meta, events=es, measurements=ms, index_frame=index_view,
+                                 lazy_index_creation=True,
+                                 lazy_map_creation=True)
 
-    def is_mergeable(self, other: AbstractMachineData):
+    def is_mergeable(self, other: MachineDataProtocol) -> bool:
         if self.__class__ != other.__class__:
             return False
+        other: typing.Self = other
         for e, et in self.event_specs.items():
             if o_et := other.event_specs.get(e):
                 if not et.is_mergeable(o_et):
                     return False
         for m, mt in self.measurement_specs.items():
             if o_mt := other.measurement_specs.get(m):
                 if not mt.is_mergeable(o_mt):
                     return False
         return True
 
-    def merge(self: AMD, other: AMD,
-              axis: Literal['horizontal', 'vertical'] = 'horizontal') -> AMD:
-        result = self.merge_series(other.event_series, other.measurement_series, axis=axis)
-        result.meta = self.meta.merge(other.meta)
-        return result
-
-    def merge_series(self, event_series: dict[EventSpecLabel, ETSC],
-                     measurement_series: dict[MeasurementSpecLabel, MTSC],
-                     axis: Literal['horizontal', 'vertical'] = 'horizontal') -> AMD:
+    def merge(self, other: MachineData,
+              axis: Literal['horizontal', 'vertical'] = 'horizontal') -> MachineData:
         assert axis in {'horizontal', 'vertical'}
-        recalc_index = axis == 'vertical'  # TODO actually detect if index changed #or (tsc. for tsc in event_series.values())
-        if event_series is None:
-            event_series = {}
-        if measurement_series is None:
-            measurement_series = {}
-        es: dict[str, ETSC] = self._etsc_cls.lifted_merge(self.event_series, event_series, axis=axis)
-        ms: dict[str, MTSC] = self._mtsc_cls.lifted_merge(self.measurement_series, measurement_series, axis=axis)
-        if recalc_index:
-            return self.__class__(self.meta, es.values(), ms.values())
-        else:
-            return self.__class__(self.meta, es.values(), ms.values(), self.index_frame)
-
-    def get_event_series_collection(self, label: EventSpecLabel) -> ETSC:
-        return self.event_series[label]
-
-    def get_measurement_series_collection(self, label: MeasurementSpecLabel) -> MTSC:
-        return self.measurement_series[label]
-
-    def view_measurement_series(self, label: MeasurementSpecLabel, objs: str | list[str] | slice = slice(None),
-                                **kwargs) -> MTS:
-        return self.measurement_series[label].view(objs=objs)
-
-    def view_event_series(self, label: EventSpecLabel, objs: str | list[str] | slice = slice(None),
-                          **kwargs) -> ETS:
-        return self.event_series[label].view(objs=objs)
+        assert self.is_mergeable(other)
+        es, e_index_change = self._etsc_cls.lifted_merge(self.event_series, other.event_series, axis=axis)
+        ms, m_index_change = self._mtsc_cls.lifted_merge(self.measurement_series, other.measurement_series, axis=axis)
+        meta = self.meta.merge(other.meta)
+        return self.__class__.of(meta=meta, events=es.values(), measurements=ms.values(), lazy_index_creation=True,
+                                 lazy_map_creation=True,
+                                 index_frame=(None if e_index_change | m_index_change else self.index_frame))
 
-    def summary(self):
+    def summary(self) -> str:
         first = min(self.index_frame[MDConcepts.Time])
         last = max(self.index_frame[MDConcepts.Time])
-        return f'#Observations: {self.observation_count} between {first} and {last}.' + '\n' + f'#Objects: {len(self.occurring_objects)}' + '\n' + f'#Event Specs: {len(self.event_specs)}' + '\n' + f'#Measurement Specs: {len(self.measurement_specs)}'
+        return f'#Observations: {self.observation_count} between {first} and {last}.' + '\n' + f'#Objects: {len(self.objects)}' + '\n' + f'#Event Specs: {len(self.event_specs)}' + '\n' + f'#Measurement Specs: {len(self.measurement_specs)}'
 
     def __str__(self):
         def spec_strings(specs_dict):
-            return '\n'.join([f'\t{l}: {", ".join(tspec.features)}' for l, tspec in specs_dict.items()])
+            return '\n'.join([f'\t{label}: {", ".join(tspec.features)}' for label, tspec in specs_dict.items()])
 
-        especs = spec_strings(self.event_specs)
-        mspecs = spec_strings(self.measurement_specs)
-        objs = ' ' + ', '.join(self.occurring_objects)
+        e_specs = spec_strings(self.event_specs)
+        m_specs = spec_strings(self.measurement_specs)
+        objs = ' ' + ', '.join(self.objects)
         return 'MachineData {' + '\n' + 'Event Specs:' + (
-            '\n' + especs if especs != "" else "[]") + '\n' + 'Measurement Specs:' + (
-            '\n' + mspecs if mspecs != "" else "[]") + '\n' + 'Objects:' + objs + '\n' + f'Observations: {self.observation_count}' + '\n' + '}'
+            '\n' + e_specs if e_specs != "" else "[]") + '\n' + 'Measurement Specs:' + (
+            '\n' + m_specs if m_specs != "" else "[]") + '\n' + 'Objects:' + objs + '\n' + f'Observations: {self.observation_count}' + '\n' + '}'
 
     def __repr__(self):
         return str(self)
 
 
-class MachineData(AbstractMachineData[
-                      EventTimeseriesSpec, MeasurementTimeseriesSpec, EventSeries, MeasurementSeries, EventTimeseriesCollection, MeasurementTimeseriesCollection]):
-    _etsc_cls = EventTimeseriesCollection
-    _mtsc_cls = MeasurementTimeseriesCollection
+class BaseMachineData(AbstractMachineData[
+                      EventTimeseriesSpec, EventTimeseriesView, EventTimeseriesContainer, MeasurementTimeseriesSpec, MeasurementTimeseriesView, MeasurementTimeseriesContainer]):
+    _etsc_cls = EventTimeseriesContainer
+    _mtsc_cls = MeasurementTimeseriesContainer
+
+    @classmethod
+    def of(cls, meta: Meta = Meta(), events: Iterable[ETSC] = (), measurements: Iterable[MTSC] = (),
+           lazy_index_creation=True,
+           lazy_map_creation=True, *args, **kwargs) -> BaseMachineData:
+        return super().of(meta, events, measurements, *args, lazy_index_creation=lazy_index_creation,
+                          lazy_map_creation=lazy_map_creation, **kwargs)
+
+    def merge(self, other: BaseMachineData, axis: Literal['horizontal', 'vertical'] = 'horizontal') -> BaseMachineData:
+        return super().merge(other, axis)
 
 
-def build_shared_index(series: Iterable[TypedTimeseriesCollection], index_cols=None,
+def build_shared_index(series: Iterable[TSContainer], index_cols=None,
                        override_categorical_types=True,
-                       sort_by_time=False):
+                       sort_by_time=False) -> pd.DataFrame:
     if index_cols is None:
         index_cols = MDConcepts.base_columns
     series = list(series)
     lengths = [len(tsc.df) for tsc in series]
     orig_idx_ranges = np.empty(len(lengths) + 1, dtype=int)
     np.cumsum(lengths, out=orig_idx_ranges[1:])
     orig_idx_ranges[0] = 0
 
-    frame = pd.concat((tsc.df[index_cols] for tsc in series), ignore_index=True, join='inner',
-                      copy=False)
+    frame = pd.concat((tsc.df.loc[:, index_cols] for tsc in series), ignore_index=True, join='inner',
+                      copy=True)
 
     if sort_by_time:
         sorted_idx = np.argsort(frame[MDConcepts.Time].values)
         frame = frame.iloc[sorted_idx]
         frame.reset_index(drop=True, inplace=True)
         rev = np.empty_like(sorted_idx)
         rev[sorted_idx] = np.arange(len(sorted_idx))
         for tsc, start, end in zip(series, orig_idx_ranges[:-1], orig_idx_ranges[1:]):
             tsc.df.index = pd.Index(rev[start:end])
             tsc.update_index()
     else:
+        logging.log(logging.WARN, 'machine data index was not sorted')
         for tsc, start, end in zip(series, orig_idx_ranges[:-1], orig_idx_ranges[1:]):
             tsc.df.index = pd.RangeIndex(start, end)
             tsc.update_index()
 
     cats = derive_categoricals(frame, [MDConcepts.Object, MDConcepts.Type, MDConcepts.Label])
     frame = frame.astype(cats, copy=False)
     if override_categorical_types:
```

### Comparing `mdata-0.1.2/src/mdata/core/raw.py` & `mdata-0.1.3/src/mdata/file_formats/csv/checking.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,131 +1,129 @@
-from __future__ import annotations
-
-from typing import TypedDict, Any
-
-import numpy as np
-import pandas as pd
-
-from .df_utils import derive_categoricals
-from .extensions import metadata
-from .header import create_header_from_raw, ObservationSpec, convert_header_to_raw
-from .machine_data_def import MDConcepts, EventTimeseriesCollection, MeasurementTimeseriesCollection, MachineData, \
-    TimeseriesCollectionFactory, TimeseriesSpecFactory
-
-
-def gen_feature_column_names(n):
-    return [f'f_{i}' for i in range(1, n + 1)]
-
-
-class FeatureMetadata(TypedDict, total=False):
-    data_type: str
-    print_name: str
-
-
-RawBaseFeatureSpec = str
-RawMetadataFeatureSpec = dict[str, FeatureMetadata]
-RawObservationSpecs = dict[str, list[RawBaseFeatureSpec | RawMetadataFeatureSpec]]
-
-
-class RawAnnotationSpecs(TypedDict, total=True):
-    input: RawObservationSpecs
-    output: RawObservationSpecs
-
-
-class RawHeaderSpec(TypedDict, total=False):
-    extensions: list[str]
-    event_specs: RawObservationSpecs
-    measurement_specs: RawObservationSpecs
-    annotation_specs: RawAnnotationSpecs
-    metadata: dict[str, Any]
-
-
-RawDataType = pd.DataFrame
-
-
-def convert_to_raw_header(md: MachineData) -> RawHeaderSpec:
-    return convert_header_to_raw(md.header)
-
-
-def convert_to_raw_data(md: MachineData) -> RawDataType:
-    max_features = max(map(lambda md_timeseries: len(md_timeseries.timeseries_spec), md.iter_all_timeseries()))
-    # dfs = [pd.DataFrame(tsc.df[base_machine_data_columns + list(tsc.timeseries_type.features)], copy=False) for tsc in
-    #       md.iter_all_timeseries()]
-    # for df, tsc in zip(dfs, md.iter_all_timeseries()):
-    #    df.columns = base_machine_data_columns + gen_feature_column_names(len(tsc.timeseries_type.features))
-    # res = md.index_frame.join((df.drop(base_machine_data_columns, axis=1) for df in dfs), how='inner')
-    # TODO CHANGE BACK
-
-    res = pd.DataFrame(md.index_frame, copy=True)  # .reindex(columns=))
-    res[gen_feature_column_names(max_features)] = np.NAN
-
-    # res.columns = base_raw_machine_data_columns + gen_feature_column_names(max_features)
-    for tsc in md.iter_all_timeseries():
-        df = tsc.df
-        cs = gen_feature_column_names(len(tsc.timeseries_spec.features))
-        res.loc[df.index, cs] = df.loc[:, list(tsc.timeseries_spec.features)].values
-
-    res.columns = MDConcepts.base_columns + gen_feature_column_names(max_features)
-    # res = pd.concat(dfs, ignore_index=True, copy=False, verify_integrity=False, join='inner') # TODO check copying
-
-    # res.sort_values(COLUMN_NAME_DICT[MDConcepts.Time], ascending=True, inplace=True)
-    return res
-
-
-def convert_to_raw_data_legacy(md: MachineData) -> RawDataType:
-    max_features = max(map(lambda md_timeseries: len(md_timeseries.timeseries_spec), md.iter_all_timeseries()))
-    rows = []
-    for typed_timeseries in md.iter_all_timeseries():
-        tt = typed_timeseries.timeseries_spec
-        df = typed_timeseries.df
-        for tup in df.itertuples(index=True):
-            rows.append(
-                [getattr(tup, MDConcepts.Time), getattr(tup, MDConcepts.Object), tt.type,
-                 tt.label] + [getattr(tup, f)
-                              for f in
-                              tt.features if
-                              f in df.columns])
-    res = pd.DataFrame(rows, columns=(MDConcepts.base_columns + gen_feature_column_names(max_features)))
-    res.sort_values(MDConcepts.Time, inplace=True)
-    return res
-
-
-def create_machine_data_from_raw(raw_data: RawDataType, raw_header: RawHeaderSpec):
-    header = create_header_from_raw(raw_header)
-
-    mdes, mdms = [], []
-
-    categories = derive_categoricals(raw_data, [MDConcepts.Object, MDConcepts.Label, MDConcepts.Type])
-
-    overall = pd.DataFrame(raw_data, columns=MDConcepts.base_columns, copy=True)
-    overall = overall.astype(categories, copy=False)
-
-    for group, idx in overall.groupby([MDConcepts.Type, MDConcepts.Label]).groups.items():
-        tpy, label = group
-        spec: ObservationSpec = header.lookup_spec(tpy, label)
-
-        timeseries_type = TimeseriesSpecFactory.for_type(tpy)(label, spec)
-
-        actual_feature_labels = timeseries_type.features
-        feature_count = len(actual_feature_labels)
-        placeholder_feature_labels = gen_feature_column_names(feature_count)
-        df = pd.concat([overall.loc[idx, MDConcepts.base_columns], raw_data.loc[idx, placeholder_feature_labels]],
-                       copy=True, axis=1).set_index(idx)
-        # relevant_cols = list(base_machine_data_columns) + placeholder_feature_labels
-        # df = pd.DataFrame(raw_data.loc[idx, relevant_cols], copy=True)
-        # not a good idea in case of duplicates
-        # df.set_index('time', inplace=True, verify_integrity=True, drop=False)
-        renaming_dict = {old: new for old, new in zip(placeholder_feature_labels, actual_feature_labels)}
-        df.rename(columns=renaming_dict, inplace=True)
-
-        metadata.convert_df_inplace(df, {f.name: f.data_type for f in spec})
-
-        ts_collection = TimeseriesCollectionFactory.for_type(timeseries_type)(df)
-        if isinstance(ts_collection, EventTimeseriesCollection):
-            mdes.append(ts_collection)
-        elif isinstance(ts_collection, MeasurementTimeseriesCollection):
-            mdms.append(ts_collection)
-
-    placeholder_cols = list(set(overall.columns).difference(MDConcepts.base_columns))
-    overall.drop(columns=placeholder_cols, inplace=True)
-
-    return MachineData(header.meta, mdes, mdms, index_frame=overall)
+import os
+from collections import defaultdict
+from json import JSONDecodeError
+
+import jsonschema
+from yaml import YAMLError
+
+from mdata.core.shared_defs import ObservationTypes
+from mdata.core import raw
+from mdata.core.extensions import registry, metadata, annotations
+from mdata.file_formats.io_utils import DataSource
+from .importing import read_raw_data, read_machine_data, read_machine_data_canonical
+from .. import io_utils
+from ..validity_checking_utils import *
+
+
+def is_valid_canonical_file_pair(base_path):
+    try:
+        read_machine_data_canonical(base_path, validity_checking=True)
+    except ValidityCheckingException:
+        return False
+    return True
+
+
+def is_valid_file_pair(header_path, data_path):
+    try:
+        read_machine_data(header_path, data_path, validity_checking=True)
+    except ValidityCheckingException:
+        return False
+    return True
+
+
+def check_if_readable_header_definition_file(file: DataSource, do_full_check=True):
+    seen = defaultdict(set)
+    try:
+        lines_from = io_utils.read_csv_lines_from(file)
+    except Exception as e:
+        raise MalformedHeaderFileException('Unparseable csv:\n' + str(e))
+    if do_full_check:
+        for k, row in enumerate(lines_from, start=1):
+            if row[0] == MDConcepts.Type and row[1] == MDConcepts.Label:
+                # skip header if included
+                continue
+
+            row_identifier = row[0]
+            non_empty_idx = [0]
+            if row_identifier in ObservationTypes:
+                label = row[1]
+                non_empty_idx.append(1)
+                if label in seen[row_identifier]:
+                    raise MalformedHeaderFileException(f'Duplicate observation type specification in line {k}.')
+                seen[row_identifier].add(label)
+            elif row_identifier == registry.CSV_KEY:
+                if True in seen[row_identifier]:
+                    raise MalformedHeaderFileException(f'Duplicate extension declaration in line {k}.')
+                seen[row_identifier].add(True)
+            elif row_identifier == metadata.CSV_KEY:
+                non_empty_idx.extend([1, 2, 3, 4, 5])
+                if row[2] in ObservationTypes:
+                    e = tuple(row[1:5])
+                elif row[2] == annotations.CSV_KEY:
+                    e = tuple(row[1:6])
+                    non_empty_idx.append(6)
+                else:
+                    raise MalformedHeaderFileException(f'Invalid symbol in metadata declaration in line {k}.')
+                if e in seen[row_identifier]:
+                    raise MalformedHeaderFileException(f'Duplicate metadata declaration in line {k}.')
+                seen[row_identifier].add(e)
+            elif row_identifier == annotations.CSV_KEY:
+                non_empty_idx.extend([1, 2, 3])
+                label = (row[1], row[2])
+                if label in seen[row_identifier]:
+                    raise MalformedHeaderFileException(f'Duplicate annotation declaration in line {k}.')
+                seen[row_identifier].add(label)
+            else:
+                raise MalformedHeaderFileException(f'Invalid specification symbol in first column in line {k}.')
+            if any(row[i] == '' for i in non_empty_idx):
+                raise MalformedHeaderFileException(f'Incomplete specification line in Line {k}.')
+    return True
+
+
+def check_if_readable_header_definition_file_yaml(file: DataSource, do_full_check=True):
+    try:
+        header = io_utils.read_yaml_dict_from(file, swallow_exceptions=False)
+        if do_full_check:
+            check_if_valid_raw_header(header)
+    except YAMLError as e:
+        raise MalformedHeaderFileException('Unparseable yaml:\n' + str(e))
+
+    return True
+
+
+def check_if_readable_header_definition_file_json(file: DataSource, do_full_check=True):
+    try:
+        header = io_utils.read_json_dict_from(file, swallow_exceptions=False)
+        if do_full_check:
+            check_if_valid_raw_header(header)
+    except JSONDecodeError as e:
+        raise MalformedHeaderFileException('Unparseable json:\n' + str(e))
+    return True
+
+
+header_schema = io_utils.read_json_dict_from(os.path.join(os.path.dirname(__file__), '..', 'header_schema.json'))
+
+
+def check_if_valid_raw_header(raw_header: raw.RawHeaderSpec):
+    try:
+        jsonschema.validate(raw_header, header_schema)
+    except jsonschema.exceptions.ValidationError as e:
+        raise MalformedHeaderFileException('Schema validation failed.\n' + str(e))
+    return True
+
+
+def check_if_valid_data_file(path):
+    df = read_raw_data(path)
+    check_if_valid_raw_data(df)
+    return True
+
+
+def check_if_valid_raw_data(df):
+    if any(c not in df.columns for c in MDConcepts.base_columns):
+        raise MalformedDataFileException(
+            f'Data is missing base column(s): {set(MDConcepts.base_columns) - set(df.columns)}.')
+    check_time_column(df)
+    placeholder_cols = get_placeholder_cols(df)
+    to_be_cols = gen_feature_column_names(len(placeholder_cols))
+    if any(a != b for a, b in zip(placeholder_cols, to_be_cols)):
+        raise MalformedDataFileException('Placeholder feature columns have unexpected labels.')
+    return True
```

### Comparing `mdata-0.1.2/src/mdata/core/util.py` & `mdata-0.1.3/src/mdata/core/util.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,15 +1,16 @@
 from __future__ import annotations
 
 import enum
+from abc import abstractmethod
 from collections.abc import Iterable, Collection, Sized, Iterator
-from typing import Any, Optional
+from typing import Any, Optional, Protocol, TypeVar
 
 
-class MyMeta(Iterable, Sized, type):
+class MyMeta(type): # implements Iterable[str] and Sized, however explicit subclassing breaks pandas isinstance checks
     def __new__(cls, name, bases, dct):
         cli = super().__new__(cls, name, bases, dct)
         cli.value_map = {k: v for k, v in dct.items() if not str.startswith(k, '_') and type(v) is str}
         cli.values = list(cli.value_map.values())
         return cli
 
     def __getitem__(self, key) -> str:
@@ -21,21 +22,33 @@
     def __len__(self) -> int:
         return len(self.value_map)
 
     def __iter__(self) -> Iterator[str]:
         return iter(self.values)
 
     def derive_enum(cls, name=None):
-        return enum.Enum(cls.__class__.__name__[:-1] if name is None else name, cls.value_map)
+        return enum.Enum(cls.__name__[:-1] if name is None else name, cls.value_map)
 
 
 class StringEnumeration(metaclass=MyMeta):
     pass
 
 
+K = TypeVar('K')
+V = TypeVar('V', covariant=True)
+
+
+class SlimMapping(Sized, Iterable[V], Protocol[K, V]):
+    @abstractmethod
+    def __contains__(self, __x: object) -> bool: ...
+
+    @abstractmethod
+    def __getitem__(self, item: K) -> V:  ...
+
+
 def take_first(arg: Iterable[Any]) -> Optional[Any]:
     return next(iter(arg), None)
 
 
 def intersection(a, b) -> set:
     if a is None or b is None:
         return set()
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/__pycache__/io_utils.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/__pycache__/io_utils.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/__pycache__/io_utils.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/__pycache__/io_utils.cpython-311.pyc`

 * *Files 1% similar despite different names*

#### Python bytecode

```diff
@@ -1,9 +1,9 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
+moddate:  0xe273c764 (Mon Jul 31 08:42:10 2023 UTC)
 files sz: 2818
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 3
    flags     : 16777216
    code
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/__pycache__/validity_checking_utils.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/checking.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/checking.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/checking.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/checking.cpython-311.pyc`

 * *Files 7% similar despite different names*

#### Python bytecode

```diff
@@ -1,29 +1,29 @@
 magic:    0xa70d0d0a
-moddate:  0x91f5c064 (Wed Jul 26 10:29:37 2023 UTC)
-files sz: 5263
+moddate:  0xaaebd064 (Mon Aug  7 13:03:38 2023 UTC)
+files sz: 5281
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 7
    flags     : 0
    code
       0x9700640064016c005a00640064026c016d025a020100640064036c036d
       045a040100640064016c055a05640064046c066d075a070100640064056c
-      086d095a090100640064066c0a6d0b5a0b6d0c5a0c6d0d5a0d0100640064
-      076c0e6d0f5a0f0100640864096c106d115a116d125a126d135a13010064
-      0a640b6c146d155a150100640a640c6c165400640d84005a17640e84005a
-      18641a6410650f6602641184055a19641a6410650f6602641284055a1a64
-      1a6410650f6602641384055a1b020065156a1c000000000000000065006a
-      1d0000000000000000a01e00000000000000000000000000000000000000
-      0065006a1d0000000000000000a01f000000000000000000000000000000
-      00000000006520a6010000ab01000000000000000064146415a6030000ab
-      030000000000000000a6010000ab0100000000000000005a21641665096a
-      2200000000000000006602641784045a23641884005a24641984005a2564
-      015300
+      086d095a090100640064066c0a6d0b5a0b0100640064076c0c6d0d5a0d6d
+      0e5a0e6d0f5a0f0100640064086c106d115a1101006409640a6c126d135a
+      136d145a146d155a150100640b640c6c166d175a170100640b640d6c1854
+      00640e84005a19640f84005a1a641b641165116602641284055a1b641b64
+      1165116602641384055a1c641b641165116602641484055a1d020065176a
+      1e000000000000000065006a1f0000000000000000a02000000000000000
+      0000000000000000000000000065006a1f0000000000000000a021000000
+      00000000000000000000000000000000006522a6010000ab010000000000
+      00000064156416a6030000ab030000000000000000a6010000ab01000000
+      00000000005a236417650b6a2400000000000000006602641884045a2564
+      1984005a26641a84005a2764015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (None)
                  6 IMPORT_NAME              0 (os)
                  8 STORE_NAME               0 (os)
    
@@ -50,136 +50,144 @@
                 44 LOAD_CONST               4 (('YAMLError',))
                 46 IMPORT_NAME              6 (yaml)
                 48 IMPORT_FROM              7 (YAMLError)
                 50 STORE_NAME               7 (YAMLError)
                 52 POP_TOP
    
      8          54 LOAD_CONST               0 (0)
-                56 LOAD_CONST               5 (('raw',))
-                58 IMPORT_NAME              8 (mdata.core)
-                60 IMPORT_FROM              9 (raw)
-                62 STORE_NAME               9 (raw)
+                56 LOAD_CONST               5 (('ObservationTypes',))
+                58 IMPORT_NAME              8 (mdata.core.shared_defs)
+                60 IMPORT_FROM              9 (ObservationTypes)
+                62 STORE_NAME               9 (ObservationTypes)
                 64 POP_TOP
    
      9          66 LOAD_CONST               0 (0)
-                68 LOAD_CONST               6 (('registry', 'metadata', 'annotations'))
-                70 IMPORT_NAME             10 (mdata.core.extensions)
-                72 IMPORT_FROM             11 (registry)
-                74 STORE_NAME              11 (registry)
-                76 IMPORT_FROM             12 (metadata)
-                78 STORE_NAME              12 (metadata)
-                80 IMPORT_FROM             13 (annotations)
-                82 STORE_NAME              13 (annotations)
-                84 POP_TOP
-   
-    10          86 LOAD_CONST               0 (0)
-                88 LOAD_CONST               7 (('DataSource',))
-                90 IMPORT_NAME             14 (mdata.file_formats.io_utils)
-                92 IMPORT_FROM             15 (DataSource)
-                94 STORE_NAME              15 (DataSource)
+                68 LOAD_CONST               6 (('raw',))
+                70 IMPORT_NAME             10 (mdata.core)
+                72 IMPORT_FROM             11 (raw)
+                74 STORE_NAME              11 (raw)
+                76 POP_TOP
+   
+    10          78 LOAD_CONST               0 (0)
+                80 LOAD_CONST               7 (('registry', 'metadata', 'annotations'))
+                82 IMPORT_NAME             12 (mdata.core.extensions)
+                84 IMPORT_FROM             13 (registry)
+                86 STORE_NAME              13 (registry)
+                88 IMPORT_FROM             14 (metadata)
+                90 STORE_NAME              14 (metadata)
+                92 IMPORT_FROM             15 (annotations)
+                94 STORE_NAME              15 (annotations)
                 96 POP_TOP
    
-    11          98 LOAD_CONST               8 (1)
-               100 LOAD_CONST               9 (('read_raw_data', 'read_machine_data', 'read_machine_data_canonical'))
-               102 IMPORT_NAME             16 (importing)
-               104 IMPORT_FROM             17 (read_raw_data)
-               106 STORE_NAME              17 (read_raw_data)
-               108 IMPORT_FROM             18 (read_machine_data)
-               110 STORE_NAME              18 (read_machine_data)
-               112 IMPORT_FROM             19 (read_machine_data_canonical)
-               114 STORE_NAME              19 (read_machine_data_canonical)
-               116 POP_TOP
-   
-    12         118 LOAD_CONST              10 (2)
-               120 LOAD_CONST              11 (('io_utils',))
-               122 IMPORT_NAME             20
-               124 IMPORT_FROM             21 (io_utils)
-               126 STORE_NAME              21 (io_utils)
+    11          98 LOAD_CONST               0 (0)
+               100 LOAD_CONST               8 (('DataSource',))
+               102 IMPORT_NAME             16 (mdata.file_formats.io_utils)
+               104 IMPORT_FROM             17 (DataSource)
+               106 STORE_NAME              17 (DataSource)
+               108 POP_TOP
+   
+    12         110 LOAD_CONST               9 (1)
+               112 LOAD_CONST              10 (('read_raw_data', 'read_machine_data', 'read_machine_data_canonical'))
+               114 IMPORT_NAME             18 (importing)
+               116 IMPORT_FROM             19 (read_raw_data)
+               118 STORE_NAME              19 (read_raw_data)
+               120 IMPORT_FROM             20 (read_machine_data)
+               122 STORE_NAME              20 (read_machine_data)
+               124 IMPORT_FROM             21 (read_machine_data_canonical)
+               126 STORE_NAME              21 (read_machine_data_canonical)
                128 POP_TOP
    
-    13         130 LOAD_CONST              10 (2)
-               132 LOAD_CONST              12 (('*',))
-               134 IMPORT_NAME             22 (validity_checking_utils)
-               136 IMPORT_STAR
-   
-    16         138 LOAD_CONST              13 (<code object is_valid_canonical_file_pair, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 16>)
-               140 MAKE_FUNCTION            0
-               142 STORE_NAME              23 (is_valid_canonical_file_pair)
-   
-    24         144 LOAD_CONST              14 (<code object is_valid_file_pair, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 24>)
-               146 MAKE_FUNCTION            0
-               148 STORE_NAME              24 (is_valid_file_pair)
-   
-    32         150 LOAD_CONST              26 ((True,))
-               152 LOAD_CONST              16 ('file')
-               154 LOAD_NAME               15 (DataSource)
-               156 BUILD_TUPLE              2
-               158 LOAD_CONST              17 (<code object check_if_readable_header_definition_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 32>)
-               160 MAKE_FUNCTION            5 (defaults, annotations)
-               162 STORE_NAME              25 (check_if_readable_header_definition_file)
-   
-    82         164 LOAD_CONST              26 ((True,))
-               166 LOAD_CONST              16 ('file')
-               168 LOAD_NAME               15 (DataSource)
-               170 BUILD_TUPLE              2
-               172 LOAD_CONST              18 (<code object check_if_readable_header_definition_file_yaml, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 82>)
-               174 MAKE_FUNCTION            5 (defaults, annotations)
-               176 STORE_NAME              26 (check_if_readable_header_definition_file_yaml)
-   
-    93         178 LOAD_CONST              26 ((True,))
-               180 LOAD_CONST              16 ('file')
-               182 LOAD_NAME               15 (DataSource)
-               184 BUILD_TUPLE              2
-               186 LOAD_CONST              19 (<code object check_if_readable_header_definition_file_json, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 93>)
-               188 MAKE_FUNCTION            5 (defaults, annotations)
-               190 STORE_NAME              27 (check_if_readable_header_definition_file_json)
-   
-   104         192 PUSH_NULL
-               194 LOAD_NAME               21 (io_utils)
-               196 LOAD_ATTR               28 (read_json_dict_from)
-               206 LOAD_NAME                0 (os)
-               208 LOAD_ATTR               29 (path)
-               218 LOAD_METHOD             30 (join)
-               240 LOAD_NAME                0 (os)
-               242 LOAD_ATTR               29 (path)
-               252 LOAD_METHOD             31 (dirname)
-               274 LOAD_NAME               32 (__file__)
-               276 PRECALL                  1
-               280 CALL                     1
-               290 LOAD_CONST              20 ('..')
-               292 LOAD_CONST              21 ('header_schema.json')
-               294 PRECALL                  3
-               298 CALL                     3
-               308 PRECALL                  1
-               312 CALL                     1
-               322 STORE_NAME              33 (header_schema)
-   
-   107         324 LOAD_CONST              22 ('raw_header')
-               326 LOAD_NAME                9 (raw)
-               328 LOAD_ATTR               34 (RawHeaderSpec)
-               338 BUILD_TUPLE              2
-               340 LOAD_CONST              23 (<code object check_if_valid_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 107>)
-               342 MAKE_FUNCTION            4 (annotations)
-               344 STORE_NAME              35 (check_if_valid_raw_header)
-   
-   115         346 LOAD_CONST              24 (<code object check_if_valid_data_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 115>)
-               348 MAKE_FUNCTION            0
-               350 STORE_NAME              36 (check_if_valid_data_file)
-   
-   121         352 LOAD_CONST              25 (<code object check_if_valid_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 121>)
-               354 MAKE_FUNCTION            0
-               356 STORE_NAME              37 (check_if_valid_raw_data)
-               358 LOAD_CONST               1 (None)
-               360 RETURN_VALUE
+    13         130 LOAD_CONST              11 (2)
+               132 LOAD_CONST              12 (('io_utils',))
+               134 IMPORT_NAME             22
+               136 IMPORT_FROM             23 (io_utils)
+               138 STORE_NAME              23 (io_utils)
+               140 POP_TOP
+   
+    14         142 LOAD_CONST              11 (2)
+               144 LOAD_CONST              13 (('*',))
+               146 IMPORT_NAME             24 (validity_checking_utils)
+               148 IMPORT_STAR
+   
+    17         150 LOAD_CONST              14 (<code object is_valid_canonical_file_pair, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 17>)
+               152 MAKE_FUNCTION            0
+               154 STORE_NAME              25 (is_valid_canonical_file_pair)
+   
+    25         156 LOAD_CONST              15 (<code object is_valid_file_pair, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 25>)
+               158 MAKE_FUNCTION            0
+               160 STORE_NAME              26 (is_valid_file_pair)
+   
+    33         162 LOAD_CONST              27 ((True,))
+               164 LOAD_CONST              17 ('file')
+               166 LOAD_NAME               17 (DataSource)
+               168 BUILD_TUPLE              2
+               170 LOAD_CONST              18 (<code object check_if_readable_header_definition_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 33>)
+               172 MAKE_FUNCTION            5 (defaults, annotations)
+               174 STORE_NAME              27 (check_if_readable_header_definition_file)
+   
+    82         176 LOAD_CONST              27 ((True,))
+               178 LOAD_CONST              17 ('file')
+               180 LOAD_NAME               17 (DataSource)
+               182 BUILD_TUPLE              2
+               184 LOAD_CONST              19 (<code object check_if_readable_header_definition_file_yaml, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 82>)
+               186 MAKE_FUNCTION            5 (defaults, annotations)
+               188 STORE_NAME              28 (check_if_readable_header_definition_file_yaml)
+   
+    93         190 LOAD_CONST              27 ((True,))
+               192 LOAD_CONST              17 ('file')
+               194 LOAD_NAME               17 (DataSource)
+               196 BUILD_TUPLE              2
+               198 LOAD_CONST              20 (<code object check_if_readable_header_definition_file_json, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 93>)
+               200 MAKE_FUNCTION            5 (defaults, annotations)
+               202 STORE_NAME              29 (check_if_readable_header_definition_file_json)
+   
+   103         204 PUSH_NULL
+               206 LOAD_NAME               23 (io_utils)
+               208 LOAD_ATTR               30 (read_json_dict_from)
+               218 LOAD_NAME                0 (os)
+               220 LOAD_ATTR               31 (path)
+               230 LOAD_METHOD             32 (join)
+               252 LOAD_NAME                0 (os)
+               254 LOAD_ATTR               31 (path)
+               264 LOAD_METHOD             33 (dirname)
+               286 LOAD_NAME               34 (__file__)
+               288 PRECALL                  1
+               292 CALL                     1
+               302 LOAD_CONST              21 ('..')
+               304 LOAD_CONST              22 ('header_schema.json')
+               306 PRECALL                  3
+               310 CALL                     3
+               320 PRECALL                  1
+               324 CALL                     1
+               334 STORE_NAME              35 (header_schema)
+   
+   106         336 LOAD_CONST              23 ('raw_header')
+               338 LOAD_NAME               11 (raw)
+               340 LOAD_ATTR               36 (RawHeaderSpec)
+               350 BUILD_TUPLE              2
+               352 LOAD_CONST              24 (<code object check_if_valid_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 106>)
+               354 MAKE_FUNCTION            4 (annotations)
+               356 STORE_NAME              37 (check_if_valid_raw_header)
+   
+   114         358 LOAD_CONST              25 (<code object check_if_valid_data_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 114>)
+               360 MAKE_FUNCTION            0
+               362 STORE_NAME              38 (check_if_valid_data_file)
+   
+   120         364 LOAD_CONST              26 (<code object check_if_valid_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 120>)
+               366 MAKE_FUNCTION            0
+               368 STORE_NAME              39 (check_if_valid_raw_data)
+               370 LOAD_CONST               1 (None)
+               372 RETURN_VALUE
    consts
       0
       None
       ('defaultdict',)
       ('JSONDecodeError',)
       ('YAMLError',)
+      ('ObservationTypes',)
       ('raw',)
       ('registry', 'metadata', 'annotations')
       ('DataSource',)
       1
       ('read_raw_data', 'read_machine_data', 'read_machine_data_canonical')
       2
       ('io_utils',)
@@ -189,43 +197,43 @@
          nlocals   : 1
          stacksize : 4
          flags     : 3
          code
             0x970009007401000000000000000000007c006401ac02a6020000ab0200
             0000000000000001006e1123007402000000000000000000002400720401
             00590064035300770078035900770164015300
-          16           0 RESUME                   0
+          17           0 RESUME                   0
          
-          17           2 NOP
+          18           2 NOP
          
-          18           4 LOAD_GLOBAL              1 (NULL + read_machine_data_canonical)
+          19           4 LOAD_GLOBAL              1 (NULL + read_machine_data_canonical)
                       16 LOAD_FAST                0 (base_path)
                       18 LOAD_CONST               1 (True)
                       20 KW_NAMES                 2
                       22 PRECALL                  2
                       26 CALL                     2
                       36 POP_TOP
                       38 JUMP_FORWARD            17 (to 74)
                  >>   40 PUSH_EXC_INFO
          
-          19          42 LOAD_GLOBAL              2 (ValidityCheckingException)
+          20          42 LOAD_GLOBAL              2 (ValidityCheckingException)
                       54 CHECK_EXC_MATCH
                       56 POP_JUMP_FORWARD_IF_FALSE     4 (to 66)
                       58 POP_TOP
          
-          20          60 POP_EXCEPT
+          21          60 POP_EXCEPT
                       62 LOAD_CONST               3 (False)
                       64 RETURN_VALUE
          
-          19     >>   66 RERAISE                  0
+          20     >>   66 RERAISE                  0
                  >>   68 COPY                     3
                       70 POP_EXCEPT
                       72 RERAISE                  1
          
-          21     >>   74 LOAD_CONST               1 (True)
+          22     >>   74 LOAD_CONST               1 (True)
                       76 RETURN_VALUE
          ExceptionTable:
            4 to 36 -> 40 [0]
            40 to 58 -> 68 [1] lasti
            66 to 66 -> 68 [1] lasti
          consts
             None
@@ -234,55 +242,55 @@
             False
          names      ('read_machine_data_canonical', 'ValidityCheckingException')
          varnames   ('base_path',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'is_valid_canonical_file_pair'
-         firstlineno 16
+         firstlineno 17
          lnotab 0x020102012601120106ff0802
       code
          argcount  : 2
          nlocals   : 2
          stacksize : 5
          flags     : 3
          code
             0x970009007401000000000000000000007c007c016401ac02a6030000ab
             03000000000000000001006e112300740200000000000000000000240072
             040100590064035300770078035900770164015300
-          24           0 RESUME                   0
+          25           0 RESUME                   0
          
-          25           2 NOP
+          26           2 NOP
          
-          26           4 LOAD_GLOBAL              1 (NULL + read_machine_data)
+          27           4 LOAD_GLOBAL              1 (NULL + read_machine_data)
                       16 LOAD_FAST                0 (header_path)
                       18 LOAD_FAST                1 (data_path)
                       20 LOAD_CONST               1 (True)
                       22 KW_NAMES                 2
                       24 PRECALL                  3
                       28 CALL                     3
                       38 POP_TOP
                       40 JUMP_FORWARD            17 (to 76)
                  >>   42 PUSH_EXC_INFO
          
-          27          44 LOAD_GLOBAL              2 (ValidityCheckingException)
+          28          44 LOAD_GLOBAL              2 (ValidityCheckingException)
                       56 CHECK_EXC_MATCH
                       58 POP_JUMP_FORWARD_IF_FALSE     4 (to 68)
                       60 POP_TOP
          
-          28          62 POP_EXCEPT
+          29          62 POP_EXCEPT
                       64 LOAD_CONST               3 (False)
                       66 RETURN_VALUE
          
-          27     >>   68 RERAISE                  0
+          28     >>   68 RERAISE                  0
                  >>   70 COPY                     3
                       72 POP_EXCEPT
                       74 RERAISE                  1
          
-          29     >>   76 LOAD_CONST               1 (True)
+          30     >>   76 LOAD_CONST               1 (True)
                       78 RETURN_VALUE
          ExceptionTable:
            4 to 38 -> 42 [0]
            42 to 60 -> 70 [1] lasti
            68 to 68 -> 70 [1] lasti
          consts
             None
@@ -291,15 +299,15 @@
             False
          names      ('read_machine_data', 'ValidityCheckingException')
          varnames   ('header_path', 'data_path')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'is_valid_file_pair'
-         firstlineno 24
+         firstlineno 25
          lnotab 0x020102012801120106ff0802
       True
       'file'
       code
          argcount  : 2
          nlocals   : 9
          stacksize : 7
@@ -307,429 +315,419 @@
          code
             0x87099700740100000000000000000000740200000000000000000000a6
             010000ab0100000000000000007d0209007405000000000000000000006a
             0300000000000000007c00a6010000ab0100000000000000007d036e3123
             00740800000000000000000000240072247d04740b000000000000000000
             006401740d000000000000000000007c04a6010000ab0100000000000000
             007a000000a6010000ab010000000000000000820164007d047e04770177
-            007803590077017c01900272a2740f000000000000000000007c036402ac
-            03a6020000ab020000000000000000440090025d8f5c0200007d058a0989
+            007803590077017c0190027289740f000000000000000000007c036402ac
+            03a6020000ab020000000000000000440090025d765c0200007d058a0989
             096404190000000000000000007410000000000000000000006a09000000
             00000000006b020000000072178909640219000000000000000000741000
             0000000000000000006a0a00000000000000006b020000000072018c3389
             096404190000000000000000007d06640467017d077c0674160000000000
-            00000000006a0c0000000000000000760072578909640219000000000000
-            0000007d087c07a00d000000000000000000000000000000000000000064
-            02a6010000ab01000000000000000001007c087c027c0619000000000000
-            00000076007213740b0000000000000000000064057c059b0064069d03a6
-            010000ab01000000000000000082017c027c0619000000000000000000a0
-            0e00000000000000000000000000000000000000007c08a6010000ab0100
-            00000000000000010090016eaf7c06741e000000000000000000006a1000
-            000000000000006b0200000000723a64077c027c06190000000000000000
-            0076007213740b0000000000000000000064087c059b0064069d03a60100
-            00ab01000000000000000082017c027c0619000000000000000000a00e00
-            000000000000000000000000000000000000006407a6010000ab01000000
-            0000000000010090016e657c067422000000000000000000006a10000000
-            00000000006b020000000072d27c07a01200000000000000000000000000
-            0000000000000067006409a201a6010000ab010000000000000000010089
-            09640a190000000000000000007416000000000000000000006a0c000000
-            00000000007600721874270000000000000000000089096402640b850219
-            000000000000000000a6010000ab0100000000000000007d046e56890964
-            0a190000000000000000007428000000000000000000006a100000000000
-            0000006b0200000000722d74270000000000000000000089096402640c85
-            0219000000000000000000a6010000ab0100000000000000007d047c07a0
-            0d0000000000000000000000000000000000000000640ca6010000ab0100
-            0000000000000001006e13740b00000000000000000000640d7c059b0064
-            069d03a6010000ab01000000000000000082017c047c027c061900000000
-            000000000076007213740b00000000000000000000640e7c059b0064069d
-            03a6010000ab01000000000000000082017c027c06190000000000000000
-            00a00e00000000000000000000000000000000000000007c04a6010000ab
-            01000000000000000001006e837c067428000000000000000000006a1000
-            000000000000006b020000000072607c07a0120000000000000000000000
-            0000000000000000006700640fa201a6010000ab01000000000000000001
-            0089096402190000000000000000008909640a1900000000000000000066
-            027d087c087c027c061900000000000000000076007213740b0000000000
-            000000000064107c059b0064069d03a6010000ab01000000000000000082
-            017c027c0619000000000000000000a00e00000000000000000000000000
-            000000000000007c08a6010000ab01000000000000000001006e13740b00
-            00000000000000000064117c059b0064069d03a6010000ab010000000000
-            0000008201742b0000000000000000000088096601641284087c074400a6
-            000000ab000000000000000000a6010000ab010000000000000000722274
-            2d000000000000000000008909a6010000ab010000000000000000010074
-            0b0000000000000000000064137c059b0064069d03a6010000ab01000000
-            0000000000820190028c9164075300
+            00000000007600725789096402190000000000000000007d087c07a00c00
+            000000000000000000000000000000000000006402a6010000ab01000000
+            000000000001007c087c027c061900000000000000000076007213740b00
+            00000000000000000064057c059b0064069d03a6010000ab010000000000
+            00000082017c027c0619000000000000000000a00d000000000000000000
+            00000000000000000000007c08a6010000ab010000000000000000010090
+            016eaa7c06741c000000000000000000006a0f00000000000000006b0200
+            000000723a64077c027c061900000000000000000076007213740b000000
+            0000000000000064087c059b0064069d03a6010000ab0100000000000000
+            0082017c027c0619000000000000000000a00d0000000000000000000000
+            0000000000000000006407a6010000ab010000000000000000010090016e
+            607c067420000000000000000000006a0f00000000000000006b02000000
+            0072cd7c07a0110000000000000000000000000000000000000000670064
+            09a201a6010000ab01000000000000000001008909640a19000000000000
+            000000741600000000000000000000760072187425000000000000000000
+            0089096402640b850219000000000000000000a6010000ab010000000000
+            0000007d046e568909640a19000000000000000000742600000000000000
+            0000006a0f00000000000000006b0200000000722d742500000000000000
+            00000089096402640c850219000000000000000000a6010000ab01000000
+            00000000007d047c07a00c00000000000000000000000000000000000000
+            00640ca6010000ab01000000000000000001006e13740b00000000000000
+            000000640d7c059b0064069d03a6010000ab01000000000000000082017c
+            047c027c061900000000000000000076007213740b000000000000000000
+            00640e7c059b0064069d03a6010000ab01000000000000000082017c027c
+            0619000000000000000000a00d0000000000000000000000000000000000
+            0000007c04a6010000ab01000000000000000001006e837c067426000000
+            000000000000006a0f00000000000000006b020000000072607c07a01100
+            000000000000000000000000000000000000006700640fa201a6010000ab
+            010000000000000000010089096402190000000000000000008909640a19
+            00000000000000000066027d087c087c027c061900000000000000000076
+            007213740b0000000000000000000064107c059b0064069d03a6010000ab
+            01000000000000000082017c027c0619000000000000000000a00d000000
+            00000000000000000000000000000000007c08a6010000ab010000000000
+            00000001006e13740b0000000000000000000064117c059b0064069d03a6
+            010000ab0100000000000000008201742900000000000000000000880966
+            01641284087c074400a6000000ab000000000000000000a6010000ab0100
+            000000000000007213740b0000000000000000000064137c059b0064069d
+            03a6010000ab010000000000000000820190028c7864075300
                        0 MAKE_CELL                9 (row)
          
-          32           2 RESUME                   0
+          33           2 RESUME                   0
          
-          33           4 LOAD_GLOBAL              1 (NULL + defaultdict)
+          34           4 LOAD_GLOBAL              1 (NULL + defaultdict)
                       16 LOAD_GLOBAL              2 (set)
                       28 PRECALL                  1
                       32 CALL                     1
                       42 STORE_FAST               2 (seen)
          
-          34          44 NOP
+          35          44 NOP
          
-          35          46 LOAD_GLOBAL              5 (NULL + io_utils)
+          36          46 LOAD_GLOBAL              5 (NULL + io_utils)
                       58 LOAD_ATTR                3 (read_csv_lines_from)
                       68 LOAD_FAST                0 (file)
                       70 PRECALL                  1
                       74 CALL                     1
                       84 STORE_FAST               3 (lines_from)
                       86 JUMP_FORWARD            49 (to 186)
                  >>   88 PUSH_EXC_INFO
          
-          36          90 LOAD_GLOBAL              8 (Exception)
+          37          90 LOAD_GLOBAL              8 (Exception)
                      102 CHECK_EXC_MATCH
                      104 POP_JUMP_FORWARD_IF_FALSE    36 (to 178)
                      106 STORE_FAST               4 (e)
          
-          37         108 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                     120 LOAD_CONST               1 ('Unparsable csv:\n')
+          38         108 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                     120 LOAD_CONST               1 ('Unparseable csv:\n')
                      122 LOAD_GLOBAL             13 (NULL + str)
                      134 LOAD_FAST                4 (e)
                      136 PRECALL                  1
                      140 CALL                     1
                      150 BINARY_OP                0 (+)
                      154 PRECALL                  1
                      158 CALL                     1
                      168 RAISE_VARARGS            1
                  >>  170 LOAD_CONST               0 (None)
                      172 STORE_FAST               4 (e)
                      174 DELETE_FAST              4 (e)
                      176 RERAISE                  1
          
-          36     >>  178 RERAISE                  0
+          37     >>  178 RERAISE                  0
                  >>  180 COPY                     3
                      182 POP_EXCEPT
                      184 RERAISE                  1
          
-          38     >>  186 LOAD_FAST                1 (do_full_check)
+          39     >>  186 LOAD_FAST                1 (do_full_check)
                      188 EXTENDED_ARG             2
-                     190 POP_JUMP_FORWARD_IF_FALSE   674 (to 1540)
+                     190 POP_JUMP_FORWARD_IF_FALSE   649 (to 1490)
          
-          39         192 LOAD_GLOBAL             15 (NULL + enumerate)
+          40         192 LOAD_GLOBAL             15 (NULL + enumerate)
                      204 LOAD_FAST                3 (lines_from)
                      206 LOAD_CONST               2 (1)
                      208 KW_NAMES                 3
                      210 PRECALL                  2
                      214 CALL                     2
                      224 GET_ITER
                  >>  226 EXTENDED_ARG             2
-                     228 FOR_ITER               655 (to 1540)
+                     228 FOR_ITER               630 (to 1490)
                      230 UNPACK_SEQUENCE          2
                      234 STORE_FAST               5 (k)
                      236 STORE_DEREF              9 (row)
          
-          40         238 LOAD_DEREF               9 (row)
+          41         238 LOAD_DEREF               9 (row)
                      240 LOAD_CONST               4 (0)
                      242 BINARY_SUBSCR
                      252 LOAD_GLOBAL             16 (MDConcepts)
                      264 LOAD_ATTR                9 (Type)
                      274 COMPARE_OP               2 (==)
                      280 POP_JUMP_FORWARD_IF_FALSE    23 (to 328)
                      282 LOAD_DEREF               9 (row)
                      284 LOAD_CONST               2 (1)
                      286 BINARY_SUBSCR
                      296 LOAD_GLOBAL             16 (MDConcepts)
                      308 LOAD_ATTR               10 (Label)
                      318 COMPARE_OP               2 (==)
                      324 POP_JUMP_FORWARD_IF_FALSE     1 (to 328)
          
-          42         326 JUMP_BACKWARD           51 (to 226)
+          43         326 JUMP_BACKWARD           51 (to 226)
          
-          44     >>  328 LOAD_DEREF               9 (row)
+          45     >>  328 LOAD_DEREF               9 (row)
                      330 LOAD_CONST               4 (0)
                      332 BINARY_SUBSCR
                      342 STORE_FAST               6 (row_identifier)
          
-          45         344 LOAD_CONST               4 (0)
+          46         344 LOAD_CONST               4 (0)
                      346 BUILD_LIST               1
                      348 STORE_FAST               7 (non_empty_idx)
          
-          46         350 LOAD_FAST                6 (row_identifier)
-                     352 LOAD_GLOBAL             22 (mdd)
-                     364 LOAD_ATTR               12 (ObservationTypes)
-                     374 CONTAINS_OP              0
-                     376 POP_JUMP_FORWARD_IF_FALSE    87 (to 552)
-         
-          47         378 LOAD_DEREF               9 (row)
-                     380 LOAD_CONST               2 (1)
-                     382 BINARY_SUBSCR
-                     392 STORE_FAST               8 (label)
-         
-          48         394 LOAD_FAST                7 (non_empty_idx)
-                     396 LOAD_METHOD             13 (append)
-                     418 LOAD_CONST               2 (1)
-                     420 PRECALL                  1
-                     424 CALL                     1
-                     434 POP_TOP
-         
-          49         436 LOAD_FAST                8 (label)
-                     438 LOAD_FAST                2 (seen)
-                     440 LOAD_FAST                6 (row_identifier)
-                     442 BINARY_SUBSCR
-                     452 CONTAINS_OP              0
-                     454 POP_JUMP_FORWARD_IF_FALSE    19 (to 494)
-         
-          50         456 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                     468 LOAD_CONST               5 ('Duplicate observation type specification in line ')
-                     470 LOAD_FAST                5 (k)
-                     472 FORMAT_VALUE             0
-                     474 LOAD_CONST               6 ('.')
-                     476 BUILD_STRING             3
-                     478 PRECALL                  1
-                     482 CALL                     1
-                     492 RAISE_VARARGS            1
-         
-          51     >>  494 LOAD_FAST                2 (seen)
-                     496 LOAD_FAST                6 (row_identifier)
-                     498 BINARY_SUBSCR
-                     508 LOAD_METHOD             14 (add)
-                     530 LOAD_FAST                8 (label)
-                     532 PRECALL                  1
-                     536 CALL                     1
-                     546 POP_TOP
-                     548 EXTENDED_ARG             1
-                     550 JUMP_FORWARD           431 (to 1414)
-         
-          52     >>  552 LOAD_FAST                6 (row_identifier)
-                     554 LOAD_GLOBAL             30 (registry)
-                     566 LOAD_ATTR               16 (CSV_KEY)
-                     576 COMPARE_OP               2 (==)
-                     582 POP_JUMP_FORWARD_IF_FALSE    58 (to 700)
-         
-          53         584 LOAD_CONST               7 (True)
-                     586 LOAD_FAST                2 (seen)
-                     588 LOAD_FAST                6 (row_identifier)
-                     590 BINARY_SUBSCR
-                     600 CONTAINS_OP              0
-                     602 POP_JUMP_FORWARD_IF_FALSE    19 (to 642)
-         
-          54         604 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                     616 LOAD_CONST               8 ('Duplicate extension declaration in line ')
-                     618 LOAD_FAST                5 (k)
-                     620 FORMAT_VALUE             0
-                     622 LOAD_CONST               6 ('.')
-                     624 BUILD_STRING             3
-                     626 PRECALL                  1
-                     630 CALL                     1
-                     640 RAISE_VARARGS            1
-         
-          55     >>  642 LOAD_FAST                2 (seen)
-                     644 LOAD_FAST                6 (row_identifier)
-                     646 BINARY_SUBSCR
-                     656 LOAD_METHOD             14 (add)
-                     678 LOAD_CONST               7 (True)
-                     680 PRECALL                  1
-                     684 CALL                     1
-                     694 POP_TOP
-                     696 EXTENDED_ARG             1
-                     698 JUMP_FORWARD           357 (to 1414)
-         
-          56     >>  700 LOAD_FAST                6 (row_identifier)
-                     702 LOAD_GLOBAL             34 (metadata)
-                     714 LOAD_ATTR               16 (CSV_KEY)
-                     724 COMPARE_OP               2 (==)
-                     730 POP_JUMP_FORWARD_IF_FALSE   210 (to 1152)
-         
-          57         732 LOAD_FAST                7 (non_empty_idx)
-                     734 LOAD_METHOD             18 (extend)
-                     756 BUILD_LIST               0
-                     758 LOAD_CONST               9 ((1, 2, 3, 4, 5))
-                     760 LIST_EXTEND              1
-                     762 PRECALL                  1
-                     766 CALL                     1
-                     776 POP_TOP
-         
-          58         778 LOAD_DEREF               9 (row)
-                     780 LOAD_CONST              10 (2)
-                     782 BINARY_SUBSCR
-                     792 LOAD_GLOBAL             22 (mdd)
-                     804 LOAD_ATTR               12 (ObservationTypes)
-                     814 CONTAINS_OP              0
-                     816 POP_JUMP_FORWARD_IF_FALSE    24 (to 866)
-         
-          59         818 LOAD_GLOBAL             39 (NULL + tuple)
-                     830 LOAD_DEREF               9 (row)
-                     832 LOAD_CONST               2 (1)
-                     834 LOAD_CONST              11 (5)
-                     836 BUILD_SLICE              2
-                     838 BINARY_SUBSCR
-                     848 PRECALL                  1
-                     852 CALL                     1
-                     862 STORE_FAST               4 (e)
-                     864 JUMP_FORWARD            86 (to 1038)
-         
-          60     >>  866 LOAD_DEREF               9 (row)
-                     868 LOAD_CONST              10 (2)
-                     870 BINARY_SUBSCR
-                     880 LOAD_GLOBAL             40 (annotations)
-                     892 LOAD_ATTR               16 (CSV_KEY)
-                     902 COMPARE_OP               2 (==)
-                     908 POP_JUMP_FORWARD_IF_FALSE    45 (to 1000)
-         
-          61         910 LOAD_GLOBAL             39 (NULL + tuple)
-                     922 LOAD_DEREF               9 (row)
-                     924 LOAD_CONST               2 (1)
-                     926 LOAD_CONST              12 (6)
-                     928 BUILD_SLICE              2
-                     930 BINARY_SUBSCR
-                     940 PRECALL                  1
-                     944 CALL                     1
-                     954 STORE_FAST               4 (e)
-         
-          62         956 LOAD_FAST                7 (non_empty_idx)
-                     958 LOAD_METHOD             13 (append)
-                     980 LOAD_CONST              12 (6)
-                     982 PRECALL                  1
-                     986 CALL                     1
-                     996 POP_TOP
-                     998 JUMP_FORWARD            19 (to 1038)
-         
-          64     >> 1000 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                    1012 LOAD_CONST              13 ('Invalid symbol in metadata declaration in line ')
-                    1014 LOAD_FAST                5 (k)
-                    1016 FORMAT_VALUE             0
-                    1018 LOAD_CONST               6 ('.')
-                    1020 BUILD_STRING             3
-                    1022 PRECALL                  1
-                    1026 CALL                     1
-                    1036 RAISE_VARARGS            1
-         
-          65     >> 1038 LOAD_FAST                4 (e)
-                    1040 LOAD_FAST                2 (seen)
-                    1042 LOAD_FAST                6 (row_identifier)
-                    1044 BINARY_SUBSCR
-                    1054 CONTAINS_OP              0
-                    1056 POP_JUMP_FORWARD_IF_FALSE    19 (to 1096)
-         
-          66        1058 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                    1070 LOAD_CONST              14 ('Duplicate metadata declaration in line ')
-                    1072 LOAD_FAST                5 (k)
-                    1074 FORMAT_VALUE             0
-                    1076 LOAD_CONST               6 ('.')
-                    1078 BUILD_STRING             3
-                    1080 PRECALL                  1
-                    1084 CALL                     1
-                    1094 RAISE_VARARGS            1
-         
-          67     >> 1096 LOAD_FAST                2 (seen)
-                    1098 LOAD_FAST                6 (row_identifier)
-                    1100 BINARY_SUBSCR
-                    1110 LOAD_METHOD             14 (add)
-                    1132 LOAD_FAST                4 (e)
-                    1134 PRECALL                  1
-                    1138 CALL                     1
-                    1148 POP_TOP
-                    1150 JUMP_FORWARD           131 (to 1414)
-         
-          68     >> 1152 LOAD_FAST                6 (row_identifier)
-                    1154 LOAD_GLOBAL             40 (annotations)
-                    1166 LOAD_ATTR               16 (CSV_KEY)
-                    1176 COMPARE_OP               2 (==)
-                    1182 POP_JUMP_FORWARD_IF_FALSE    96 (to 1376)
-         
-          69        1184 LOAD_FAST                7 (non_empty_idx)
-                    1186 LOAD_METHOD             18 (extend)
-                    1208 BUILD_LIST               0
-                    1210 LOAD_CONST              15 ((1, 2, 3))
-                    1212 LIST_EXTEND              1
-                    1214 PRECALL                  1
-                    1218 CALL                     1
-                    1228 POP_TOP
-         
-          70        1230 LOAD_DEREF               9 (row)
-                    1232 LOAD_CONST               2 (1)
-                    1234 BINARY_SUBSCR
-                    1244 LOAD_DEREF               9 (row)
-                    1246 LOAD_CONST              10 (2)
+          47         350 LOAD_FAST                6 (row_identifier)
+                     352 LOAD_GLOBAL             22 (ObservationTypes)
+                     364 CONTAINS_OP              0
+                     366 POP_JUMP_FORWARD_IF_FALSE    87 (to 542)
+         
+          48         368 LOAD_DEREF               9 (row)
+                     370 LOAD_CONST               2 (1)
+                     372 BINARY_SUBSCR
+                     382 STORE_FAST               8 (label)
+         
+          49         384 LOAD_FAST                7 (non_empty_idx)
+                     386 LOAD_METHOD             12 (append)
+                     408 LOAD_CONST               2 (1)
+                     410 PRECALL                  1
+                     414 CALL                     1
+                     424 POP_TOP
+         
+          50         426 LOAD_FAST                8 (label)
+                     428 LOAD_FAST                2 (seen)
+                     430 LOAD_FAST                6 (row_identifier)
+                     432 BINARY_SUBSCR
+                     442 CONTAINS_OP              0
+                     444 POP_JUMP_FORWARD_IF_FALSE    19 (to 484)
+         
+          51         446 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                     458 LOAD_CONST               5 ('Duplicate observation type specification in line ')
+                     460 LOAD_FAST                5 (k)
+                     462 FORMAT_VALUE             0
+                     464 LOAD_CONST               6 ('.')
+                     466 BUILD_STRING             3
+                     468 PRECALL                  1
+                     472 CALL                     1
+                     482 RAISE_VARARGS            1
+         
+          52     >>  484 LOAD_FAST                2 (seen)
+                     486 LOAD_FAST                6 (row_identifier)
+                     488 BINARY_SUBSCR
+                     498 LOAD_METHOD             13 (add)
+                     520 LOAD_FAST                8 (label)
+                     522 PRECALL                  1
+                     526 CALL                     1
+                     536 POP_TOP
+                     538 EXTENDED_ARG             1
+                     540 JUMP_FORWARD           426 (to 1394)
+         
+          53     >>  542 LOAD_FAST                6 (row_identifier)
+                     544 LOAD_GLOBAL             28 (registry)
+                     556 LOAD_ATTR               15 (CSV_KEY)
+                     566 COMPARE_OP               2 (==)
+                     572 POP_JUMP_FORWARD_IF_FALSE    58 (to 690)
+         
+          54         574 LOAD_CONST               7 (True)
+                     576 LOAD_FAST                2 (seen)
+                     578 LOAD_FAST                6 (row_identifier)
+                     580 BINARY_SUBSCR
+                     590 CONTAINS_OP              0
+                     592 POP_JUMP_FORWARD_IF_FALSE    19 (to 632)
+         
+          55         594 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                     606 LOAD_CONST               8 ('Duplicate extension declaration in line ')
+                     608 LOAD_FAST                5 (k)
+                     610 FORMAT_VALUE             0
+                     612 LOAD_CONST               6 ('.')
+                     614 BUILD_STRING             3
+                     616 PRECALL                  1
+                     620 CALL                     1
+                     630 RAISE_VARARGS            1
+         
+          56     >>  632 LOAD_FAST                2 (seen)
+                     634 LOAD_FAST                6 (row_identifier)
+                     636 BINARY_SUBSCR
+                     646 LOAD_METHOD             13 (add)
+                     668 LOAD_CONST               7 (True)
+                     670 PRECALL                  1
+                     674 CALL                     1
+                     684 POP_TOP
+                     686 EXTENDED_ARG             1
+                     688 JUMP_FORWARD           352 (to 1394)
+         
+          57     >>  690 LOAD_FAST                6 (row_identifier)
+                     692 LOAD_GLOBAL             32 (metadata)
+                     704 LOAD_ATTR               15 (CSV_KEY)
+                     714 COMPARE_OP               2 (==)
+                     720 POP_JUMP_FORWARD_IF_FALSE   205 (to 1132)
+         
+          58         722 LOAD_FAST                7 (non_empty_idx)
+                     724 LOAD_METHOD             17 (extend)
+                     746 BUILD_LIST               0
+                     748 LOAD_CONST               9 ((1, 2, 3, 4, 5))
+                     750 LIST_EXTEND              1
+                     752 PRECALL                  1
+                     756 CALL                     1
+                     766 POP_TOP
+         
+          59         768 LOAD_DEREF               9 (row)
+                     770 LOAD_CONST              10 (2)
+                     772 BINARY_SUBSCR
+                     782 LOAD_GLOBAL             22 (ObservationTypes)
+                     794 CONTAINS_OP              0
+                     796 POP_JUMP_FORWARD_IF_FALSE    24 (to 846)
+         
+          60         798 LOAD_GLOBAL             37 (NULL + tuple)
+                     810 LOAD_DEREF               9 (row)
+                     812 LOAD_CONST               2 (1)
+                     814 LOAD_CONST              11 (5)
+                     816 BUILD_SLICE              2
+                     818 BINARY_SUBSCR
+                     828 PRECALL                  1
+                     832 CALL                     1
+                     842 STORE_FAST               4 (e)
+                     844 JUMP_FORWARD            86 (to 1018)
+         
+          61     >>  846 LOAD_DEREF               9 (row)
+                     848 LOAD_CONST              10 (2)
+                     850 BINARY_SUBSCR
+                     860 LOAD_GLOBAL             38 (annotations)
+                     872 LOAD_ATTR               15 (CSV_KEY)
+                     882 COMPARE_OP               2 (==)
+                     888 POP_JUMP_FORWARD_IF_FALSE    45 (to 980)
+         
+          62         890 LOAD_GLOBAL             37 (NULL + tuple)
+                     902 LOAD_DEREF               9 (row)
+                     904 LOAD_CONST               2 (1)
+                     906 LOAD_CONST              12 (6)
+                     908 BUILD_SLICE              2
+                     910 BINARY_SUBSCR
+                     920 PRECALL                  1
+                     924 CALL                     1
+                     934 STORE_FAST               4 (e)
+         
+          63         936 LOAD_FAST                7 (non_empty_idx)
+                     938 LOAD_METHOD             12 (append)
+                     960 LOAD_CONST              12 (6)
+                     962 PRECALL                  1
+                     966 CALL                     1
+                     976 POP_TOP
+                     978 JUMP_FORWARD            19 (to 1018)
+         
+          65     >>  980 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                     992 LOAD_CONST              13 ('Invalid symbol in metadata declaration in line ')
+                     994 LOAD_FAST                5 (k)
+                     996 FORMAT_VALUE             0
+                     998 LOAD_CONST               6 ('.')
+                    1000 BUILD_STRING             3
+                    1002 PRECALL                  1
+                    1006 CALL                     1
+                    1016 RAISE_VARARGS            1
+         
+          66     >> 1018 LOAD_FAST                4 (e)
+                    1020 LOAD_FAST                2 (seen)
+                    1022 LOAD_FAST                6 (row_identifier)
+                    1024 BINARY_SUBSCR
+                    1034 CONTAINS_OP              0
+                    1036 POP_JUMP_FORWARD_IF_FALSE    19 (to 1076)
+         
+          67        1038 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                    1050 LOAD_CONST              14 ('Duplicate metadata declaration in line ')
+                    1052 LOAD_FAST                5 (k)
+                    1054 FORMAT_VALUE             0
+                    1056 LOAD_CONST               6 ('.')
+                    1058 BUILD_STRING             3
+                    1060 PRECALL                  1
+                    1064 CALL                     1
+                    1074 RAISE_VARARGS            1
+         
+          68     >> 1076 LOAD_FAST                2 (seen)
+                    1078 LOAD_FAST                6 (row_identifier)
+                    1080 BINARY_SUBSCR
+                    1090 LOAD_METHOD             13 (add)
+                    1112 LOAD_FAST                4 (e)
+                    1114 PRECALL                  1
+                    1118 CALL                     1
+                    1128 POP_TOP
+                    1130 JUMP_FORWARD           131 (to 1394)
+         
+          69     >> 1132 LOAD_FAST                6 (row_identifier)
+                    1134 LOAD_GLOBAL             38 (annotations)
+                    1146 LOAD_ATTR               15 (CSV_KEY)
+                    1156 COMPARE_OP               2 (==)
+                    1162 POP_JUMP_FORWARD_IF_FALSE    96 (to 1356)
+         
+          70        1164 LOAD_FAST                7 (non_empty_idx)
+                    1166 LOAD_METHOD             17 (extend)
+                    1188 BUILD_LIST               0
+                    1190 LOAD_CONST              15 ((1, 2, 3))
+                    1192 LIST_EXTEND              1
+                    1194 PRECALL                  1
+                    1198 CALL                     1
+                    1208 POP_TOP
+         
+          71        1210 LOAD_DEREF               9 (row)
+                    1212 LOAD_CONST               2 (1)
+                    1214 BINARY_SUBSCR
+                    1224 LOAD_DEREF               9 (row)
+                    1226 LOAD_CONST              10 (2)
+                    1228 BINARY_SUBSCR
+                    1238 BUILD_TUPLE              2
+                    1240 STORE_FAST               8 (label)
+         
+          72        1242 LOAD_FAST                8 (label)
+                    1244 LOAD_FAST                2 (seen)
+                    1246 LOAD_FAST                6 (row_identifier)
                     1248 BINARY_SUBSCR
-                    1258 BUILD_TUPLE              2
-                    1260 STORE_FAST               8 (label)
+                    1258 CONTAINS_OP              0
+                    1260 POP_JUMP_FORWARD_IF_FALSE    19 (to 1300)
          
-          71        1262 LOAD_FAST                8 (label)
-                    1264 LOAD_FAST                2 (seen)
-                    1266 LOAD_FAST                6 (row_identifier)
-                    1268 BINARY_SUBSCR
-                    1278 CONTAINS_OP              0
-                    1280 POP_JUMP_FORWARD_IF_FALSE    19 (to 1320)
-         
-          72        1282 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                    1294 LOAD_CONST              16 ('Duplicate annotation declaration in line ')
-                    1296 LOAD_FAST                5 (k)
-                    1298 FORMAT_VALUE             0
-                    1300 LOAD_CONST               6 ('.')
-                    1302 BUILD_STRING             3
-                    1304 PRECALL                  1
-                    1308 CALL                     1
-                    1318 RAISE_VARARGS            1
-         
-          73     >> 1320 LOAD_FAST                2 (seen)
-                    1322 LOAD_FAST                6 (row_identifier)
-                    1324 BINARY_SUBSCR
-                    1334 LOAD_METHOD             14 (add)
-                    1356 LOAD_FAST                8 (label)
-                    1358 PRECALL                  1
-                    1362 CALL                     1
-                    1372 POP_TOP
-                    1374 JUMP_FORWARD            19 (to 1414)
-         
-          75     >> 1376 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                    1388 LOAD_CONST              17 ('Invalid specification symbol in first column in line ')
-                    1390 LOAD_FAST                5 (k)
-                    1392 FORMAT_VALUE             0
-                    1394 LOAD_CONST               6 ('.')
-                    1396 BUILD_STRING             3
-                    1398 PRECALL                  1
-                    1402 CALL                     1
-                    1412 RAISE_VARARGS            1
-         
-          76     >> 1414 LOAD_GLOBAL             43 (NULL + any)
-                    1426 LOAD_CLOSURE             9 (row)
-                    1428 BUILD_TUPLE              1
-                    1430 LOAD_CONST              18 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 76>)
-                    1432 MAKE_FUNCTION            8 (closure)
-                    1434 LOAD_FAST                7 (non_empty_idx)
-                    1436 GET_ITER
-                    1438 PRECALL                  0
-                    1442 CALL                     0
-                    1452 PRECALL                  1
-                    1456 CALL                     1
-                    1466 POP_JUMP_FORWARD_IF_FALSE    34 (to 1536)
-         
-          77        1468 LOAD_GLOBAL             45 (NULL + print)
-                    1480 LOAD_DEREF               9 (row)
-                    1482 PRECALL                  1
-                    1486 CALL                     1
-                    1496 POP_TOP
-         
-          78        1498 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
-                    1510 LOAD_CONST              19 ('Incomplete specification line in Line ')
-                    1512 LOAD_FAST                5 (k)
-                    1514 FORMAT_VALUE             0
-                    1516 LOAD_CONST               6 ('.')
-                    1518 BUILD_STRING             3
-                    1520 PRECALL                  1
-                    1524 CALL                     1
-                    1534 RAISE_VARARGS            1
+          73        1262 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                    1274 LOAD_CONST              16 ('Duplicate annotation declaration in line ')
+                    1276 LOAD_FAST                5 (k)
+                    1278 FORMAT_VALUE             0
+                    1280 LOAD_CONST               6 ('.')
+                    1282 BUILD_STRING             3
+                    1284 PRECALL                  1
+                    1288 CALL                     1
+                    1298 RAISE_VARARGS            1
+         
+          74     >> 1300 LOAD_FAST                2 (seen)
+                    1302 LOAD_FAST                6 (row_identifier)
+                    1304 BINARY_SUBSCR
+                    1314 LOAD_METHOD             13 (add)
+                    1336 LOAD_FAST                8 (label)
+                    1338 PRECALL                  1
+                    1342 CALL                     1
+                    1352 POP_TOP
+                    1354 JUMP_FORWARD            19 (to 1394)
+         
+          76     >> 1356 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                    1368 LOAD_CONST              17 ('Invalid specification symbol in first column in line ')
+                    1370 LOAD_FAST                5 (k)
+                    1372 FORMAT_VALUE             0
+                    1374 LOAD_CONST               6 ('.')
+                    1376 BUILD_STRING             3
+                    1378 PRECALL                  1
+                    1382 CALL                     1
+                    1392 RAISE_VARARGS            1
+         
+          77     >> 1394 LOAD_GLOBAL             41 (NULL + any)
+                    1406 LOAD_CLOSURE             9 (row)
+                    1408 BUILD_TUPLE              1
+                    1410 LOAD_CONST              18 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 77>)
+                    1412 MAKE_FUNCTION            8 (closure)
+                    1414 LOAD_FAST                7 (non_empty_idx)
+                    1416 GET_ITER
+                    1418 PRECALL                  0
+                    1422 CALL                     0
+                    1432 PRECALL                  1
+                    1436 CALL                     1
+                    1446 POP_JUMP_FORWARD_IF_FALSE    19 (to 1486)
+         
+          78        1448 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+                    1460 LOAD_CONST              19 ('Incomplete specification line in Line ')
+                    1462 LOAD_FAST                5 (k)
+                    1464 FORMAT_VALUE             0
+                    1466 LOAD_CONST               6 ('.')
+                    1468 BUILD_STRING             3
+                    1470 PRECALL                  1
+                    1474 CALL                     1
+                    1484 RAISE_VARARGS            1
          
-          76     >> 1536 EXTENDED_ARG             2
-                    1538 JUMP_BACKWARD          657 (to 226)
+          77     >> 1486 EXTENDED_ARG             2
+                    1488 JUMP_BACKWARD          632 (to 226)
          
-          79     >> 1540 LOAD_CONST               7 (True)
-                    1542 RETURN_VALUE
+          79     >> 1490 LOAD_CONST               7 (True)
+                    1492 RETURN_VALUE
          ExceptionTable:
            46 to 84 -> 88 [0]
            88 to 106 -> 180 [1] lasti
            108 to 168 -> 170 [1] lasti
            170 to 178 -> 180 [1] lasti
          consts
             None
-            'Unparsable csv:\n'
+            'Unparseable csv:\n'
             1
             ('start',)
             0
             'Duplicate observation type specification in line '
             '.'
             True
             'Duplicate extension declaration in line '
@@ -748,15 +746,15 @@
                stacksize : 3
                flags     : 51
                code
                   0x95014b00010097007c005d107d0189027c011900000000000000000064
                   006b02000000005600970101008c1164015300
                              0 COPY_FREE_VARS           1
                
-                76           2 RETURN_GENERATOR
+                77           2 RETURN_GENERATOR
                              4 POP_TOP
                              6 RESUME                   0
                              8 LOAD_FAST                0 (.0)
                        >>   10 FOR_ITER                16 (to 44)
                             12 STORE_FAST               1 (i)
                             14 LOAD_DEREF               2 (row)
                             16 LOAD_FAST                1 (i)
@@ -774,29 +772,28 @@
                   None
                names      ()
                varnames   ('.0', 'i')
                freevars   ('row',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
                name       '<genexpr>'
-               firstlineno 76
+               firstlineno 77
                lnotab 0x
             'Incomplete specification line in Line '
-         names      ('defaultdict', 'set', 'io_utils', 'read_csv_lines_from', 'Exception', 'MalformedHeaderFileException', 'str', 'enumerate', 'MDConcepts', 'Type', 'Label', 'mdd', 'ObservationTypes', 'append', 'add', 'registry', 'CSV_KEY', 'metadata', 'extend', 'tuple', 'annotations', 'any', 'print')
+         names      ('defaultdict', 'set', 'io_utils', 'read_csv_lines_from', 'Exception', 'MalformedHeaderFileException', 'str', 'enumerate', 'MDConcepts', 'Type', 'Label', 'ObservationTypes', 'append', 'add', 'registry', 'CSV_KEY', 'metadata', 'extend', 'tuple', 'annotations', 'any')
          varnames   ('file', 'do_full_check', 'seen', 'lines_from', 'e', 'k', 'row_identifier', 'non_empty_idx', 'label')
          freevars   ()
          cellvars   ('row',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_readable_header_definition_file'
-         firstlineno 32
+         firstlineno 33
          lnotab
-            0x0401280102012c01120146ff080206012e0158020202100106011c0110
-            012a01140126013a012001140126013a0120012e01280130012c012e012c
-            02260114012601380120012e012001140126013802260136011e0126fe04
-            03
+            0x0401280102012c01120146ff080206012e015802020210010601120110
+            012a01140126013a012001140126013a0120012e011e0130012c012e012c
+            02260114012601380120012e0120011401260138022601360126ff0402
       code
          argcount  : 2
          nlocals   : 4
          stacksize : 7
          flags     : 3
          code
             0x970009007401000000000000000000006a0100000000000000007c0064
@@ -832,15 +829,15 @@
          
           87          86 LOAD_GLOBAL              6 (YAMLError)
                       98 CHECK_EXC_MATCH
                      100 POP_JUMP_FORWARD_IF_FALSE    36 (to 174)
                      102 STORE_FAST               3 (e)
          
           88         104 LOAD_GLOBAL              9 (NULL + MalformedHeaderFileException)
-                     116 LOAD_CONST               3 ('Unparsable yaml:\n')
+                     116 LOAD_CONST               3 ('Unparseable yaml:\n')
                      118 LOAD_GLOBAL             11 (NULL + str)
                      130 LOAD_FAST                3 (e)
                      132 PRECALL                  1
                      136 CALL                     1
                      146 BINARY_OP                0 (+)
                      150 PRECALL                  1
                      154 CALL                     1
@@ -862,15 +859,15 @@
            84 to 102 -> 176 [1] lasti
            104 to 164 -> 166 [1] lasti
            166 to 174 -> 176 [1] lasti
          consts
             None
             False
             ('swallow_exceptions',)
-            'Unparsable yaml:\n'
+            'Unparseable yaml:\n'
             True
          names      ('io_utils', 'read_yaml_dict_from', 'check_if_valid_raw_header', 'YAMLError', 'MalformedHeaderFileException', 'str')
          varnames   ('file', 'do_full_check', 'header', 'e')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_readable_header_definition_file_yaml'
@@ -915,15 +912,15 @@
          
           98          86 LOAD_GLOBAL              6 (JSONDecodeError)
                       98 CHECK_EXC_MATCH
                      100 POP_JUMP_FORWARD_IF_FALSE    36 (to 174)
                      102 STORE_FAST               3 (e)
          
           99         104 LOAD_GLOBAL              9 (NULL + MalformedHeaderFileException)
-                     116 LOAD_CONST               3 ('Unparsable json:\n')
+                     116 LOAD_CONST               3 ('Unparseable json:\n')
                      118 LOAD_GLOBAL             11 (NULL + str)
                      130 LOAD_FAST                3 (e)
                      132 PRECALL                  1
                      136 CALL                     1
                      146 BINARY_OP                0 (+)
                      150 PRECALL                  1
                      154 CALL                     1
@@ -934,35 +931,35 @@
                      172 RERAISE                  1
          
           98     >>  174 RERAISE                  0
                  >>  176 COPY                     3
                      178 POP_EXCEPT
                      180 RERAISE                  1
          
-         101     >>  182 LOAD_CONST               4 (True)
+         100     >>  182 LOAD_CONST               4 (True)
                      184 RETURN_VALUE
          ExceptionTable:
            4 to 80 -> 84 [0]
            84 to 102 -> 176 [1] lasti
            104 to 164 -> 166 [1] lasti
            166 to 174 -> 176 [1] lasti
          consts
             None
             False
             ('swallow_exceptions',)
-            'Unparsable json:\n'
+            'Unparseable json:\n'
             True
          names      ('io_utils', 'read_json_dict_from', 'check_if_valid_raw_header', 'JSONDecodeError', 'MalformedHeaderFileException', 'str')
          varnames   ('file', 'do_full_check', 'header', 'e')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_readable_header_definition_file_json'
          firstlineno 93
-         lnotab 0x020102012c0104012201120146ff0803
+         lnotab 0x020102012c0104012201120146ff0802
       '..'
       'header_schema.json'
       'raw_header'
       code
          argcount  : 1
          nlocals   : 2
          stacksize : 7
@@ -971,56 +968,56 @@
             0x970009007401000000000000000000006a0100000000000000007c0074
             0400000000000000000000a6020000ab02000000000000000001006e3b23
             007400000000000000000000006a0300000000000000006a040000000000
             000000240072247d01740b000000000000000000006401740d0000000000
             00000000007c01a6010000ab0100000000000000007a000000a6010000ab
             010000000000000000820164007d017e0177017700780359007701640253
             00
-         107           0 RESUME                   0
+         106           0 RESUME                   0
          
-         108           2 NOP
+         107           2 NOP
          
-         109           4 LOAD_GLOBAL              1 (NULL + jsonschema)
+         108           4 LOAD_GLOBAL              1 (NULL + jsonschema)
                       16 LOAD_ATTR                1 (validate)
                       26 LOAD_FAST                0 (raw_header)
                       28 LOAD_GLOBAL              4 (header_schema)
                       40 PRECALL                  2
                       44 CALL                     2
                       54 POP_TOP
                       56 JUMP_FORWARD            59 (to 176)
                  >>   58 PUSH_EXC_INFO
          
-         110          60 LOAD_GLOBAL              0 (jsonschema)
+         109          60 LOAD_GLOBAL              0 (jsonschema)
                       72 LOAD_ATTR                3 (exceptions)
                       82 LOAD_ATTR                4 (ValidationError)
                       92 CHECK_EXC_MATCH
                       94 POP_JUMP_FORWARD_IF_FALSE    36 (to 168)
                       96 STORE_FAST               1 (e)
          
-         111          98 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
+         110          98 LOAD_GLOBAL             11 (NULL + MalformedHeaderFileException)
                      110 LOAD_CONST               1 ('Schema validation failed.\n')
                      112 LOAD_GLOBAL             13 (NULL + str)
                      124 LOAD_FAST                1 (e)
                      126 PRECALL                  1
                      130 CALL                     1
                      140 BINARY_OP                0 (+)
                      144 PRECALL                  1
                      148 CALL                     1
                      158 RAISE_VARARGS            1
                  >>  160 LOAD_CONST               0 (None)
                      162 STORE_FAST               1 (e)
                      164 DELETE_FAST              1 (e)
                      166 RERAISE                  1
          
-         110     >>  168 RERAISE                  0
+         109     >>  168 RERAISE                  0
                  >>  170 COPY                     3
                      172 POP_EXCEPT
                      174 RERAISE                  1
          
-         112     >>  176 LOAD_CONST               2 (True)
+         111     >>  176 LOAD_CONST               2 (True)
                      178 RETURN_VALUE
          ExceptionTable:
            4 to 54 -> 58 [0]
            58 to 96 -> 170 [1] lasti
            98 to 158 -> 160 [1] lasti
            160 to 168 -> 170 [1] lasti
          consts
@@ -1029,51 +1026,51 @@
             True
          names      ('jsonschema', 'validate', 'header_schema', 'exceptions', 'ValidationError', 'MalformedHeaderFileException', 'str')
          varnames   ('raw_header', 'e')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_valid_raw_header'
-         firstlineno 107
+         firstlineno 106
          lnotab 0x020102013801260146ff0802
       code
          argcount  : 1
          nlocals   : 2
          stacksize : 3
          flags     : 3
          code
             0x97007401000000000000000000007c00a6010000ab0100000000000000
             007d017403000000000000000000007c01a6010000ab0100000000000000
             00010064015300
-         115           0 RESUME                   0
+         114           0 RESUME                   0
          
-         116           2 LOAD_GLOBAL              1 (NULL + read_raw_data)
+         115           2 LOAD_GLOBAL              1 (NULL + read_raw_data)
                       14 LOAD_FAST                0 (path)
                       16 PRECALL                  1
                       20 CALL                     1
                       30 STORE_FAST               1 (df)
          
-         117          32 LOAD_GLOBAL              3 (NULL + check_if_valid_raw_data)
+         116          32 LOAD_GLOBAL              3 (NULL + check_if_valid_raw_data)
                       44 LOAD_FAST                1 (df)
                       46 PRECALL                  1
                       50 CALL                     1
                       60 POP_TOP
          
-         118          62 LOAD_CONST               1 (True)
+         117          62 LOAD_CONST               1 (True)
                       64 RETURN_VALUE
          consts
             None
             True
          names      ('read_raw_data', 'check_if_valid_raw_data')
          varnames   ('path', 'df')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_valid_data_file'
-         firstlineno 115
+         firstlineno 114
          lnotab 0x02011e011e01
       code
          argcount  : 1
          nlocals   : 3
          stacksize : 7
          flags     : 3
          code
@@ -1090,33 +1087,33 @@
             0000000000a6010000ab0100000000000000007d02740100000000000000
             000000640484007415000000000000000000007c017c02a6020000ab0200
             000000000000004400a6000000ab000000000000000000a6010000ab0100
             00000000000000720f7407000000000000000000006405a6010000ab0100
             00000000000000820164065300
                        0 MAKE_CELL                0 (df)
          
-         121           2 RESUME                   0
+         120           2 RESUME                   0
          
-         122           4 LOAD_GLOBAL              1 (NULL + any)
+         121           4 LOAD_GLOBAL              1 (NULL + any)
                       16 LOAD_CLOSURE             0 (df)
                       18 BUILD_TUPLE              1
-                      20 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 122>)
+                      20 LOAD_CONST               1 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 121>)
                       22 MAKE_FUNCTION            8 (closure)
                       24 LOAD_GLOBAL              2 (MDConcepts)
                       36 LOAD_ATTR                2 (base_columns)
                       46 GET_ITER
                       48 PRECALL                  0
                       52 CALL                     0
                       62 PRECALL                  1
                       66 CALL                     1
                       76 POP_JUMP_FORWARD_IF_FALSE    63 (to 204)
          
-         123          78 LOAD_GLOBAL              7 (NULL + MalformedDataFileException)
+         122          78 LOAD_GLOBAL              7 (NULL + MalformedDataFileException)
          
-         124          90 LOAD_CONST               2 ('Data is missing base column(s): ')
+         123          90 LOAD_CONST               2 ('Data is missing base column(s): ')
                       92 LOAD_GLOBAL              9 (NULL + set)
                      104 LOAD_GLOBAL              2 (MDConcepts)
                      116 LOAD_ATTR                2 (base_columns)
                      126 PRECALL                  1
                      130 CALL                     1
                      140 LOAD_GLOBAL              9 (NULL + set)
                      152 LOAD_DEREF               0 (df)
@@ -1124,75 +1121,75 @@
                      164 PRECALL                  1
                      168 CALL                     1
                      178 BINARY_OP               10 (-)
                      182 FORMAT_VALUE             0
                      184 LOAD_CONST               3 ('.')
                      186 BUILD_STRING             3
          
-         123         188 PRECALL                  1
+         122         188 PRECALL                  1
                      192 CALL                     1
                      202 RAISE_VARARGS            1
          
-         125     >>  204 LOAD_GLOBAL             13 (NULL + check_time_column)
+         124     >>  204 LOAD_GLOBAL             13 (NULL + check_time_column)
                      216 LOAD_DEREF               0 (df)
                      218 PRECALL                  1
                      222 CALL                     1
                      232 POP_TOP
          
-         126         234 LOAD_GLOBAL             15 (NULL + get_placeholder_cols)
+         125         234 LOAD_GLOBAL             15 (NULL + get_placeholder_cols)
                      246 LOAD_DEREF               0 (df)
                      248 PRECALL                  1
                      252 CALL                     1
                      262 STORE_FAST               1 (placeholder_cols)
          
-         127         264 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
+         126         264 LOAD_GLOBAL             17 (NULL + gen_feature_column_names)
                      276 LOAD_GLOBAL             19 (NULL + len)
                      288 LOAD_FAST                1 (placeholder_cols)
                      290 PRECALL                  1
                      294 CALL                     1
                      304 PRECALL                  1
                      308 CALL                     1
                      318 STORE_FAST               2 (to_be_cols)
          
-         128         320 LOAD_GLOBAL              1 (NULL + any)
-                     332 LOAD_CONST               4 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 128>)
+         127         320 LOAD_GLOBAL              1 (NULL + any)
+                     332 LOAD_CONST               4 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\checking.py", line 127>)
                      334 MAKE_FUNCTION            0
                      336 LOAD_GLOBAL             21 (NULL + zip)
                      348 LOAD_FAST                1 (placeholder_cols)
                      350 LOAD_FAST                2 (to_be_cols)
                      352 PRECALL                  2
                      356 CALL                     2
                      366 GET_ITER
                      368 PRECALL                  0
                      372 CALL                     0
                      382 PRECALL                  1
                      386 CALL                     1
                      396 POP_JUMP_FORWARD_IF_FALSE    15 (to 428)
          
-         129         398 LOAD_GLOBAL              7 (NULL + MalformedDataFileException)
+         128         398 LOAD_GLOBAL              7 (NULL + MalformedDataFileException)
                      410 LOAD_CONST               5 ('Placeholder feature columns have unexpected labels.')
                      412 PRECALL                  1
                      416 CALL                     1
                      426 RAISE_VARARGS            1
          
-         130     >>  428 LOAD_CONST               6 (True)
+         129     >>  428 LOAD_CONST               6 (True)
                      430 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 3
                flags     : 51
                code
                   0x95014b00010097007c005d0d7d017c0189026a00000000000000000076
                   015600970101008c0e64005300
                              0 COPY_FREE_VARS           1
                
-               122           2 RETURN_GENERATOR
+               121           2 RETURN_GENERATOR
                              4 POP_TOP
                              6 RESUME                   0
                              8 LOAD_FAST                0 (.0)
                        >>   10 FOR_ITER                13 (to 38)
                             12 STORE_FAST               1 (c)
                             14 LOAD_FAST                1 (c)
                             16 LOAD_DEREF               2 (df)
@@ -1208,27 +1205,27 @@
                   None
                names      ('columns',)
                varnames   ('.0', 'c')
                freevars   ('df',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
                name       '<genexpr>'
-               firstlineno 122
+               firstlineno 121
                lnotab 0x
             'Data is missing base column(s): '
             '.'
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 3
                flags     : 51
                code
                   0x4b00010097007c005d0d5c0200007d017d027c017c026b030000000056
                   00970101008c0e64005300
-               128           0 RETURN_GENERATOR
+               127           0 RETURN_GENERATOR
                              2 POP_TOP
                              4 RESUME                   0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                13 (to 36)
                             10 UNPACK_SEQUENCE          2
                             14 STORE_FAST               1 (a)
                             16 STORE_FAST               2 (b)
@@ -1245,30 +1242,30 @@
                   None
                names      ()
                varnames   ('.0', 'a', 'b')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
                name       '<genexpr>'
-               firstlineno 128
+               firstlineno 127
                lnotab 0x
             'Placeholder feature columns have unexpected labels.'
             True
          names      ('any', 'MDConcepts', 'base_columns', 'MalformedDataFileException', 'set', 'columns', 'check_time_column', 'get_placeholder_cols', 'gen_feature_column_names', 'len', 'zip')
          varnames   ('df', 'placeholder_cols', 'to_be_cols')
          freevars   ()
          cellvars   ('df',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
          name       'check_if_valid_raw_data'
-         firstlineno 121
+         firstlineno 120
          lnotab 0x04014a010c0162ff10021e011e0138014e011e01
       (True,)
-   names      ('os', 'collections', 'defaultdict', 'json', 'JSONDecodeError', 'jsonschema', 'yaml', 'YAMLError', 'mdata.core', 'raw', 'mdata.core.extensions', 'registry', 'metadata', 'annotations', 'mdata.file_formats.io_utils', 'DataSource', 'importing', 'read_raw_data', 'read_machine_data', 'read_machine_data_canonical', '', 'io_utils', 'validity_checking_utils', 'is_valid_canonical_file_pair', 'is_valid_file_pair', 'check_if_readable_header_definition_file', 'check_if_readable_header_definition_file_yaml', 'check_if_readable_header_definition_file_json', 'read_json_dict_from', 'path', 'join', 'dirname', '__file__', 'header_schema', 'RawHeaderSpec', 'check_if_valid_raw_header', 'check_if_valid_data_file', 'check_if_valid_raw_data')
+   names      ('os', 'collections', 'defaultdict', 'json', 'JSONDecodeError', 'jsonschema', 'yaml', 'YAMLError', 'mdata.core.shared_defs', 'ObservationTypes', 'mdata.core', 'raw', 'mdata.core.extensions', 'registry', 'metadata', 'annotations', 'mdata.file_formats.io_utils', 'DataSource', 'importing', 'read_raw_data', 'read_machine_data', 'read_machine_data_canonical', '', 'io_utils', 'validity_checking_utils', 'is_valid_canonical_file_pair', 'is_valid_file_pair', 'check_if_readable_header_definition_file', 'check_if_readable_header_definition_file_yaml', 'check_if_readable_header_definition_file_json', 'read_json_dict_from', 'path', 'join', 'dirname', '__file__', 'header_schema', 'RawHeaderSpec', 'check_if_valid_raw_header', 'check_if_valid_data_file', 'check_if_valid_raw_data')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\checking.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff020108010c010c0208010c020c0114010c0114010c010803060806
-      080e320e0b0e0b840316080606
+      0x00ff020108010c010c0208010c020c010c0114010c0114010c01080306
+      0806080e310e0b0e0a840316080606
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/exporting.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/exporting.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/exporting.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/exporting.cpython-311.pyc`

 * *Files 8% similar despite different names*

#### Python bytecode

```diff
@@ -1,35 +1,34 @@
 magic:    0xa70d0d0a
-moddate:  0x91f5c064 (Wed Jul 26 10:29:37 2023 UTC)
-files sz: 5710
+moddate:  0xf7e7d164 (Tue Aug  8 07:00:07 2023 UTC)
+files sz: 5718
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 8
    flags     : 0
    code
       0x9700640064016c005a00640064016c015a01640064016c025a02640064
-      016c035a03640064016c045a04640064026c056d065a066d075a07010064
-      0064016c085a08640064036c096d0a5a0b0100640064046c096d0c5a0c01
-      00640064056c0d6d0e5a0e6d0f5a0f0100640064066c106d115a11010064
-      0764086c126d135a136d145a146d155a156d165a16010002004700640984
-      00640a6517a6030000ab0300000000000000005a18651965036a1a000000
-      00000000006519190000000000000000007a07000065077a07000065016a
-      1b00000000000000007a0700005a1c640b651d651d651919000000000000
-      000000190000000000000000006602640c84045a1e640d651c640e650c6a
-      1f00000000000000006604640f84045a20641f640e650c6a1f0000000000
-      000000641165166604641284055a21640d651c6413650c6a220000000000
-      0000006604641484045a2364206416651965036a1a00000000000000007a
-      0700006417650b6a240000000000000000641865146606641984055a2564
-      1a6506651c19000000000000000000641b6506651c190000000000000000
-      006417650b6a240000000000000000641865146608641c84045a26642064
-      16651965036a1a00000000000000007a0700006417650b6a240000000000
-      000000641865146606641d84055a276416651965036a1a00000000000000
-      007a0700006417650b6a2400000000000000006604641e84045a28640153
-      00
+      016c035a03640064016c045a04640064026c056d065a066d075a076d085a
+      080100640064016c095a0a640064016c0b5a0b640064036c0c6d0d5a0d6d
+      0e5a0e6d0f5a0f6d105a106d115a110100640064046c126d135a136d145a
+      140100640064056c156d165a160100640664076c176d185a186d195a196d
+      1a5a1a6d1b5a1b010002004700640884006409651ca6030000ab03000000
+      00000000005a1d651e65036a1f0000000000000000651e19000000000000
+      0000007a07000065077a07000065016a2000000000000000007a0700005a
+      21640a65226522651e190000000000000000001900000000000000000066
+      02640b84045a23640c6521640d650e6a2400000000000000006604640e84
+      045a25641e640d650e6a2400000000000000006410651b6604641184055a
+      26640c65216412650a6a2700000000000000006604641384045a28641f64
+      15651e65036a1f00000000000000007a0700006416650f64176519660664
+      1884055a2964196506652119000000000000000000641a65066521190000
+      000000000000006416650f641765196608641b84045a2a641f6415651e65
+      036a1f00000000000000007a0700006416650f641765196606641c84055a
+      2b6415651e65036a1f00000000000000007a0700006416650f6604641d84
+      045a2c64015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (None)
                  6 IMPORT_NAME              0 (csv)
                  8 STORE_NAME               0 (csv)
    
@@ -50,209 +49,212 @@
    
      5          34 LOAD_CONST               0 (0)
                 36 LOAD_CONST               1 (None)
                 38 IMPORT_NAME              4 (sys)
                 40 STORE_NAME               4 (sys)
    
      6          42 LOAD_CONST               0 (0)
-                44 LOAD_CONST               2 (('Optional', 'TextIO'))
+                44 LOAD_CONST               2 (('Optional', 'TextIO', 'Any'))
                 46 IMPORT_NAME              5 (typing)
                 48 IMPORT_FROM              6 (Optional)
                 50 STORE_NAME               6 (Optional)
                 52 IMPORT_FROM              7 (TextIO)
                 54 STORE_NAME               7 (TextIO)
-                56 POP_TOP
-   
-     8          58 LOAD_CONST               0 (0)
-                60 LOAD_CONST               1 (None)
-                62 IMPORT_NAME              8 (yaml)
-                64 STORE_NAME               8 (yaml)
-   
-    10          66 LOAD_CONST               0 (0)
-                68 LOAD_CONST               3 (('machine_data_def',))
-                70 IMPORT_NAME              9 (mdata.core)
-                72 IMPORT_FROM             10 (machine_data_def)
-                74 STORE_NAME              11 (mdd)
-                76 POP_TOP
+                56 IMPORT_FROM              8 (Any)
+                58 STORE_NAME               8 (Any)
+                60 POP_TOP
+   
+     8          62 LOAD_CONST               0 (0)
+                64 LOAD_CONST               1 (None)
+                66 IMPORT_NAME              9 (pandas)
+                68 STORE_NAME              10 (pd)
+   
+     9          70 LOAD_CONST               0 (0)
+                72 LOAD_CONST               1 (None)
+                74 IMPORT_NAME             11 (yaml)
+                76 STORE_NAME              11 (yaml)
    
     11          78 LOAD_CONST               0 (0)
-                80 LOAD_CONST               4 (('raw',))
-                82 IMPORT_NAME              9 (mdata.core)
-                84 IMPORT_FROM             12 (raw)
-                86 STORE_NAME              12 (raw)
-                88 POP_TOP
-   
-    12          90 LOAD_CONST               0 (0)
-                92 LOAD_CONST               5 (('metadata', 'registry'))
-                94 IMPORT_NAME             13 (mdata.core.extensions)
-                96 IMPORT_FROM             14 (metadata)
-                98 STORE_NAME              14 (metadata)
-               100 IMPORT_FROM             15 (registry)
-               102 STORE_NAME              15 (registry)
+                80 LOAD_CONST               3 (('bmd', 'raw', 'MachineData', 'ObservationTypes', 'MDConcepts'))
+                82 IMPORT_NAME             12 (mdata.core)
+                84 IMPORT_FROM             13 (bmd)
+                86 STORE_NAME              13 (bmd)
+                88 IMPORT_FROM             14 (raw)
+                90 STORE_NAME              14 (raw)
+                92 IMPORT_FROM             15 (MachineData)
+                94 STORE_NAME              15 (MachineData)
+                96 IMPORT_FROM             16 (ObservationTypes)
+                98 STORE_NAME              16 (ObservationTypes)
+               100 IMPORT_FROM             17 (MDConcepts)
+               102 STORE_NAME              17 (MDConcepts)
                104 POP_TOP
    
-    13         106 LOAD_CONST               0 (0)
-               108 LOAD_CONST               6 (('io_utils',))
-               110 IMPORT_NAME             16 (mdata.file_formats)
-               112 IMPORT_FROM             17 (io_utils)
-               114 STORE_NAME              17 (io_utils)
-               116 POP_TOP
-   
-    14         118 LOAD_CONST               7 (1)
-               120 LOAD_CONST               8 (('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'DictHeaderFormatLiterals'))
-               122 IMPORT_NAME             18 (shared)
-               124 IMPORT_FROM             19 (mk_filename_pair)
-               126 STORE_NAME              19 (mk_filename_pair)
-               128 IMPORT_FROM             20 (HeaderFormatLiterals)
-               130 STORE_NAME              20 (HeaderFormatLiterals)
-               132 IMPORT_FROM             21 (HeaderFileFormat)
-               134 STORE_NAME              21 (HeaderFileFormat)
-               136 IMPORT_FROM             22 (DictHeaderFormatLiterals)
-               138 STORE_NAME              22 (DictHeaderFormatLiterals)
-               140 POP_TOP
-   
-    17         142 PUSH_NULL
-               144 LOAD_BUILD_CLASS
-               146 LOAD_CONST               9 (<code object UnsupportedWritingTarget, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 17>)
-               148 MAKE_FUNCTION            0
-               150 LOAD_CONST              10 ('UnsupportedWritingTarget')
-               152 LOAD_NAME               23 (Exception)
-               154 PRECALL                  3
-               158 CALL                     3
-               168 STORE_NAME              24 (UnsupportedWritingTarget)
-   
-    22         170 LOAD_NAME               25 (str)
-               172 LOAD_NAME                3 (os)
-               174 LOAD_ATTR               26 (PathLike)
-               184 LOAD_NAME               25 (str)
-               186 BINARY_SUBSCR
-               196 BINARY_OP                7 (|)
-               200 LOAD_NAME                7 (TextIO)
-               202 BINARY_OP                7 (|)
-               206 LOAD_NAME                1 (io)
-               208 LOAD_ATTR               27 (StringIO)
+    12         106 LOAD_CONST               0 (0)
+               108 LOAD_CONST               4 (('metadata', 'registry'))
+               110 IMPORT_NAME             18 (mdata.core.extensions)
+               112 IMPORT_FROM             19 (metadata)
+               114 STORE_NAME              19 (metadata)
+               116 IMPORT_FROM             20 (registry)
+               118 STORE_NAME              20 (registry)
+               120 POP_TOP
+   
+    13         122 LOAD_CONST               0 (0)
+               124 LOAD_CONST               5 (('io_utils',))
+               126 IMPORT_NAME             21 (mdata.file_formats)
+               128 IMPORT_FROM             22 (io_utils)
+               130 STORE_NAME              22 (io_utils)
+               132 POP_TOP
+   
+    14         134 LOAD_CONST               6 (1)
+               136 LOAD_CONST               7 (('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'DictHeaderFormatLiterals'))
+               138 IMPORT_NAME             23 (shared)
+               140 IMPORT_FROM             24 (mk_filename_pair)
+               142 STORE_NAME              24 (mk_filename_pair)
+               144 IMPORT_FROM             25 (HeaderFormatLiterals)
+               146 STORE_NAME              25 (HeaderFormatLiterals)
+               148 IMPORT_FROM             26 (HeaderFileFormat)
+               150 STORE_NAME              26 (HeaderFileFormat)
+               152 IMPORT_FROM             27 (DictHeaderFormatLiterals)
+               154 STORE_NAME              27 (DictHeaderFormatLiterals)
+               156 POP_TOP
+   
+    17         158 PUSH_NULL
+               160 LOAD_BUILD_CLASS
+               162 LOAD_CONST               8 (<code object UnsupportedWritingTarget, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 17>)
+               164 MAKE_FUNCTION            0
+               166 LOAD_CONST               9 ('UnsupportedWritingTarget')
+               168 LOAD_NAME               28 (Exception)
+               170 PRECALL                  3
+               174 CALL                     3
+               184 STORE_NAME              29 (UnsupportedWritingTarget)
+   
+    22         186 LOAD_NAME               30 (str)
+               188 LOAD_NAME                3 (os)
+               190 LOAD_ATTR               31 (PathLike)
+               200 LOAD_NAME               30 (str)
+               202 BINARY_SUBSCR
+               212 BINARY_OP                7 (|)
+               216 LOAD_NAME                7 (TextIO)
                218 BINARY_OP                7 (|)
-               222 STORE_NAME              28 (WritingTarget)
-   
-    25         224 LOAD_CONST              11 ('lol')
-               226 LOAD_NAME               29 (list)
-               228 LOAD_NAME               29 (list)
-               230 LOAD_NAME               25 (str)
-               232 BINARY_SUBSCR
-               242 BINARY_SUBSCR
-               252 BUILD_TUPLE              2
-               254 LOAD_CONST              12 (<code object pad_lengths, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 25>)
-               256 MAKE_FUNCTION            4 (annotations)
-               258 STORE_NAME              30 (pad_lengths)
-   
-    30         260 LOAD_CONST              13 ('target')
-               262 LOAD_NAME               28 (WritingTarget)
-               264 LOAD_CONST              14 ('header')
-               266 LOAD_NAME               12 (raw)
-               268 LOAD_ATTR               31 (RawHeaderSpec)
-               278 BUILD_TUPLE              4
-               280 LOAD_CONST              15 (<code object write_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 30>)
-               282 MAKE_FUNCTION            4 (annotations)
-               284 STORE_NAME              32 (write_raw_header)
-   
-    77         286 LOAD_CONST              31 (('json',))
-               288 LOAD_CONST              14 ('header')
-               290 LOAD_NAME               12 (raw)
-               292 LOAD_ATTR               31 (RawHeaderSpec)
-               302 LOAD_CONST              17 ('dict_header_format')
-               304 LOAD_NAME               22 (DictHeaderFormatLiterals)
-               306 BUILD_TUPLE              4
-               308 LOAD_CONST              18 (<code object write_raw_header_dict, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 77>)
-               310 MAKE_FUNCTION            5 (defaults, annotations)
-               312 STORE_NAME              33 (write_raw_header_dict)
-   
-   103         314 LOAD_CONST              13 ('target')
-               316 LOAD_NAME               28 (WritingTarget)
-               318 LOAD_CONST              19 ('df')
-               320 LOAD_NAME               12 (raw)
-               322 LOAD_ATTR               34 (RawDataType)
-               332 BUILD_TUPLE              4
-               334 LOAD_CONST              20 (<code object write_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 103>)
-               336 MAKE_FUNCTION            4 (annotations)
-               338 STORE_NAME              35 (write_raw_data)
-   
-   110         340 LOAD_CONST              32 (('csv',))
-               342 LOAD_CONST              22 ('path')
-               344 LOAD_NAME               25 (str)
-               346 LOAD_NAME                3 (os)
-               348 LOAD_ATTR               26 (PathLike)
-               358 BINARY_OP                7 (|)
-               362 LOAD_CONST              23 ('md')
-               364 LOAD_NAME               11 (mdd)
-               366 LOAD_ATTR               36 (MachineData)
-               376 LOAD_CONST              24 ('header_format')
-               378 LOAD_NAME               20 (HeaderFormatLiterals)
-               380 BUILD_TUPLE              6
-               382 LOAD_CONST              25 (<code object write_machine_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 110>)
-               384 MAKE_FUNCTION            5 (defaults, annotations)
-               386 STORE_NAME              37 (write_machine_data)
-   
-   115         388 LOAD_CONST              26 ('header_target')
-               390 LOAD_NAME                6 (Optional)
-               392 LOAD_NAME               28 (WritingTarget)
-               394 BINARY_SUBSCR
-               404 LOAD_CONST              27 ('data_target')
-               406 LOAD_NAME                6 (Optional)
-               408 LOAD_NAME               28 (WritingTarget)
-               410 BINARY_SUBSCR
-               420 LOAD_CONST              23 ('md')
-   
-   116         422 LOAD_NAME               11 (mdd)
-               424 LOAD_ATTR               36 (MachineData)
-   
-   115         434 LOAD_CONST              24 ('header_format')
-   
-   117         436 LOAD_NAME               20 (HeaderFormatLiterals)
-   
-   115         438 BUILD_TUPLE              8
-               440 LOAD_CONST              28 (<code object write_machine_data_custom, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 115>)
-               442 MAKE_FUNCTION            4 (annotations)
-               444 STORE_NAME              38 (write_machine_data_custom)
-   
-   129         446 LOAD_CONST              32 (('csv',))
-               448 LOAD_CONST              22 ('path')
-               450 LOAD_NAME               25 (str)
-               452 LOAD_NAME                3 (os)
-               454 LOAD_ATTR               26 (PathLike)
-               464 BINARY_OP                7 (|)
-               468 LOAD_CONST              23 ('md')
-               470 LOAD_NAME               11 (mdd)
-               472 LOAD_ATTR               36 (MachineData)
-               482 LOAD_CONST              24 ('header_format')
-               484 LOAD_NAME               20 (HeaderFormatLiterals)
-               486 BUILD_TUPLE              6
-               488 LOAD_CONST              29 (<code object write_header_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 129>)
-               490 MAKE_FUNCTION            5 (defaults, annotations)
-               492 STORE_NAME              39 (write_header_file)
-   
-   139         494 LOAD_CONST              22 ('path')
-               496 LOAD_NAME               25 (str)
-               498 LOAD_NAME                3 (os)
-               500 LOAD_ATTR               26 (PathLike)
-               510 BINARY_OP                7 (|)
-               514 LOAD_CONST              23 ('md')
-               516 LOAD_NAME               11 (mdd)
-               518 LOAD_ATTR               36 (MachineData)
-               528 BUILD_TUPLE              4
-               530 LOAD_CONST              30 (<code object write_data_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 139>)
-               532 MAKE_FUNCTION            4 (annotations)
-               534 STORE_NAME              40 (write_data_file)
-               536 LOAD_CONST               1 (None)
-               538 RETURN_VALUE
+               222 LOAD_NAME                1 (io)
+               224 LOAD_ATTR               32 (StringIO)
+               234 BINARY_OP                7 (|)
+               238 STORE_NAME              33 (WritingTarget)
+   
+    25         240 LOAD_CONST              10 ('lol')
+               242 LOAD_NAME               34 (list)
+               244 LOAD_NAME               34 (list)
+               246 LOAD_NAME               30 (str)
+               248 BINARY_SUBSCR
+               258 BINARY_SUBSCR
+               268 BUILD_TUPLE              2
+               270 LOAD_CONST              11 (<code object pad_lengths, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 25>)
+               272 MAKE_FUNCTION            4 (annotations)
+               274 STORE_NAME              35 (pad_lengths)
+   
+    30         276 LOAD_CONST              12 ('target')
+               278 LOAD_NAME               33 (WritingTarget)
+               280 LOAD_CONST              13 ('header')
+               282 LOAD_NAME               14 (raw)
+               284 LOAD_ATTR               36 (RawHeaderSpec)
+               294 BUILD_TUPLE              4
+               296 LOAD_CONST              14 (<code object write_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 30>)
+               298 MAKE_FUNCTION            4 (annotations)
+               300 STORE_NAME              37 (write_raw_header)
+   
+    76         302 LOAD_CONST              30 (('json',))
+               304 LOAD_CONST              13 ('header')
+               306 LOAD_NAME               14 (raw)
+               308 LOAD_ATTR               36 (RawHeaderSpec)
+               318 LOAD_CONST              16 ('dict_header_format')
+               320 LOAD_NAME               27 (DictHeaderFormatLiterals)
+               322 BUILD_TUPLE              4
+               324 LOAD_CONST              17 (<code object write_raw_header_dict, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 76>)
+               326 MAKE_FUNCTION            5 (defaults, annotations)
+               328 STORE_NAME              38 (write_raw_header_dict)
+   
+   102         330 LOAD_CONST              12 ('target')
+               332 LOAD_NAME               33 (WritingTarget)
+               334 LOAD_CONST              18 ('df')
+               336 LOAD_NAME               10 (pd)
+               338 LOAD_ATTR               39 (DataFrame)
+               348 BUILD_TUPLE              4
+               350 LOAD_CONST              19 (<code object write_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 102>)
+               352 MAKE_FUNCTION            4 (annotations)
+               354 STORE_NAME              40 (write_raw_data)
+   
+   109         356 LOAD_CONST              31 (('csv',))
+               358 LOAD_CONST              21 ('path')
+               360 LOAD_NAME               30 (str)
+               362 LOAD_NAME                3 (os)
+               364 LOAD_ATTR               31 (PathLike)
+               374 BINARY_OP                7 (|)
+               378 LOAD_CONST              22 ('md')
+               380 LOAD_NAME               15 (MachineData)
+               382 LOAD_CONST              23 ('header_format')
+               384 LOAD_NAME               25 (HeaderFormatLiterals)
+               386 BUILD_TUPLE              6
+               388 LOAD_CONST              24 (<code object write_machine_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 109>)
+               390 MAKE_FUNCTION            5 (defaults, annotations)
+               392 STORE_NAME              41 (write_machine_data)
+   
+   114         394 LOAD_CONST              25 ('header_target')
+               396 LOAD_NAME                6 (Optional)
+               398 LOAD_NAME               33 (WritingTarget)
+               400 BINARY_SUBSCR
+               410 LOAD_CONST              26 ('data_target')
+               412 LOAD_NAME                6 (Optional)
+               414 LOAD_NAME               33 (WritingTarget)
+               416 BINARY_SUBSCR
+               426 LOAD_CONST              22 ('md')
+   
+   115         428 LOAD_NAME               15 (MachineData)
+   
+   114         430 LOAD_CONST              23 ('header_format')
+   
+   116         432 LOAD_NAME               25 (HeaderFormatLiterals)
+   
+   114         434 BUILD_TUPLE              8
+               436 LOAD_CONST              27 (<code object write_machine_data_custom, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 114>)
+               438 MAKE_FUNCTION            4 (annotations)
+               440 STORE_NAME              42 (write_machine_data_custom)
+   
+   128         442 LOAD_CONST              31 (('csv',))
+               444 LOAD_CONST              21 ('path')
+               446 LOAD_NAME               30 (str)
+               448 LOAD_NAME                3 (os)
+               450 LOAD_ATTR               31 (PathLike)
+               460 BINARY_OP                7 (|)
+               464 LOAD_CONST              22 ('md')
+               466 LOAD_NAME               15 (MachineData)
+               468 LOAD_CONST              23 ('header_format')
+               470 LOAD_NAME               25 (HeaderFormatLiterals)
+               472 BUILD_TUPLE              6
+               474 LOAD_CONST              28 (<code object write_header_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 128>)
+               476 MAKE_FUNCTION            5 (defaults, annotations)
+               478 STORE_NAME              43 (write_header_file)
+   
+   138         480 LOAD_CONST              21 ('path')
+               482 LOAD_NAME               30 (str)
+               484 LOAD_NAME                3 (os)
+               486 LOAD_ATTR               31 (PathLike)
+               496 BINARY_OP                7 (|)
+               500 LOAD_CONST              22 ('md')
+               502 LOAD_NAME               15 (MachineData)
+               504 BUILD_TUPLE              4
+               506 LOAD_CONST              29 (<code object write_data_file, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 138>)
+               508 MAKE_FUNCTION            4 (annotations)
+               510 STORE_NAME              44 (write_data_file)
+               512 LOAD_CONST               1 (None)
+               514 RETURN_VALUE
    consts
       0
       None
-      ('Optional', 'TextIO')
-      ('machine_data_def',)
-      ('raw',)
+      ('Optional', 'TextIO', 'Any')
+      ('bmd', 'raw', 'MachineData', 'ObservationTypes', 'MDConcepts')
       ('metadata', 'registry')
       ('io_utils',)
       1
       ('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'DictHeaderFormatLiterals')
       code
          argcount  : 0
          nlocals   : 0
@@ -347,29 +349,29 @@
          stacksize : 6
          flags     : 3
          code
             0x8701970074010000000000000000000074030000000000000000000074
             04000000000000000000007c00a6020000ab020000000000000000a60100
             00ab0100000000000000008a0188016601640184087c004400a6000000ab
             0000000000000000005300
-                       0 MAKE_CELL                1 (mlen)
+                       0 MAKE_CELL                1 (max_len)
          
           25           2 RESUME                   0
          
           26           4 LOAD_GLOBAL              1 (NULL + max)
                       16 LOAD_GLOBAL              3 (NULL + map)
                       28 LOAD_GLOBAL              4 (len)
                       40 LOAD_FAST                0 (lol)
                       42 PRECALL                  2
                       46 CALL                     2
                       56 PRECALL                  1
                       60 CALL                     1
-                      70 STORE_DEREF              1 (mlen)
+                      70 STORE_DEREF              1 (max_len)
          
-          27          72 LOAD_CLOSURE             1 (mlen)
+          27          72 LOAD_CLOSURE             1 (max_len)
                       74 BUILD_TUPLE              1
                       76 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 27>)
                       78 MAKE_FUNCTION            8 (closure)
                       80 LOAD_FAST                0 (lol)
                       82 GET_ITER
                       84 PRECALL                  0
                       88 CALL                     0
@@ -387,43 +389,43 @@
                   0091028c1c5300
                              0 COPY_FREE_VARS           1
                
                 27           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                27 (to 64)
-                            10 STORE_FAST               1 (l)
-                            12 LOAD_FAST                1 (l)
+                            10 STORE_FAST               1 (li)
+                            12 LOAD_FAST                1 (li)
                             14 LOAD_CONST               0 ('')
                             16 BUILD_LIST               1
-                            18 LOAD_DEREF               2 (mlen)
+                            18 LOAD_DEREF               2 (max_len)
                             20 LOAD_GLOBAL              1 (NULL + len)
-                            32 LOAD_FAST                1 (l)
+                            32 LOAD_FAST                1 (li)
                             34 PRECALL                  1
                             38 CALL                     1
                             48 BINARY_OP               10 (-)
                             52 BINARY_OP                5 (*)
                             56 BINARY_OP                0 (+)
                             60 LIST_APPEND              2
                             62 JUMP_BACKWARD           28 (to 8)
                        >>   64 RETURN_VALUE
                consts
                   ''
                names      ('len',)
-               varnames   ('.0', 'l')
-               freevars   ('mlen',)
+               varnames   ('.0', 'li')
+               freevars   ('max_len',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                name       '<listcomp>'
                firstlineno 27
                lnotab 0x
          names      ('max', 'map', 'len')
          varnames   ('lol',)
          freevars   ()
-         cellvars   ('mlen',)
+         cellvars   ('max_len',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'pad_lengths'
          firstlineno 25
          lnotab 0x04014401
       'target'
       'header'
       code
@@ -454,58 +456,58 @@
          
           31           4 LOAD_CLOSURE             1 (header)
                        6 BUILD_TUPLE              1
                        8 LOAD_CONST               1 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 31>)
                       10 MAKE_FUNCTION            8 (closure)
                       12 STORE_FAST               2 (write_into)
          
-          64          14 LOAD_GLOBAL              1 (NULL + isinstance)
+          63          14 LOAD_GLOBAL              1 (NULL + isinstance)
                       26 LOAD_FAST                0 (target)
                       28 LOAD_GLOBAL              2 (str)
                       40 LOAD_GLOBAL              4 (os)
                       52 LOAD_ATTR                3 (PathLike)
                       62 BINARY_OP                7 (|)
                       66 PRECALL                  2
                       70 CALL                     2
                       80 POP_JUMP_FORWARD_IF_FALSE    98 (to 278)
          
-          65          82 LOAD_GLOBAL              9 (NULL + io_utils)
+          64          82 LOAD_GLOBAL              9 (NULL + io_utils)
                       94 LOAD_ATTR                5 (ensure_directory_exists)
                      104 LOAD_FAST                0 (target)
                      106 PRECALL                  1
                      110 CALL                     1
                      120 POP_TOP
          
-          66         122 LOAD_GLOBAL              9 (NULL + io_utils)
+          65         122 LOAD_GLOBAL              9 (NULL + io_utils)
                      134 LOAD_ATTR                6 (ensure_ext)
                      144 LOAD_FAST                0 (target)
                      146 LOAD_CONST               2 ('.csv')
                      148 PRECALL                  2
                      152 CALL                     2
                      162 STORE_FAST               0 (target)
          
-          67         164 LOAD_GLOBAL             15 (NULL + open)
+          66         164 LOAD_GLOBAL             15 (NULL + open)
                      176 LOAD_FAST                0 (target)
                      178 LOAD_CONST               3 ('w')
                      180 LOAD_CONST               4 ('')
                      182 LOAD_CONST               5 ('utf-8')
                      184 KW_NAMES                 6
                      186 PRECALL                  4
                      190 CALL                     4
                      200 BEFORE_WITH
                      202 STORE_FAST               3 (csvfile)
          
-          68         204 PUSH_NULL
+          67         204 PUSH_NULL
                      206 LOAD_FAST                2 (write_into)
                      208 LOAD_FAST                3 (csvfile)
                      210 PRECALL                  1
                      214 CALL                     1
                      224 POP_TOP
          
-          67         226 LOAD_CONST               0 (None)
+          66         226 LOAD_CONST               0 (None)
                      228 LOAD_CONST               0 (None)
                      230 LOAD_CONST               0 (None)
                      232 PRECALL                  2
                      236 CALL                     2
                      246 POP_TOP
                      248 LOAD_CONST               0 (None)
                      250 RETURN_VALUE
@@ -519,50 +521,50 @@
                  >>  266 POP_TOP
                      268 POP_EXCEPT
                      270 POP_TOP
                      272 POP_TOP
                      274 LOAD_CONST               0 (None)
                      276 RETURN_VALUE
          
-          70     >>  278 NOP
+          69     >>  278 NOP
          
-          71         280 PUSH_NULL
+          70         280 PUSH_NULL
                      282 LOAD_FAST                2 (write_into)
                      284 LOAD_FAST                0 (target)
                      286 PRECALL                  1
                      290 CALL                     1
                      300 POP_TOP
                      302 LOAD_CONST               0 (None)
                      304 RETURN_VALUE
                  >>  306 PUSH_EXC_INFO
          
-          72         308 LOAD_GLOBAL             16 (Exception)
+          71         308 LOAD_GLOBAL             16 (Exception)
                      320 CHECK_EXC_MATCH
                      322 POP_JUMP_FORWARD_IF_FALSE    60 (to 444)
                      324 POP_TOP
          
-          73         326 LOAD_GLOBAL             19 (NULL + sys)
+          72         326 LOAD_GLOBAL             19 (NULL + sys)
                      338 LOAD_ATTR               10 (exc_info)
                      348 PRECALL                  0
                      352 CALL                     0
                      362 LOAD_CONST               7 (2)
                      364 BINARY_SUBSCR
                      374 STORE_FAST               4 (tb)
          
-          74         376 LOAD_GLOBAL             23 (NULL + UnsupportedWritingTarget)
+          73         376 LOAD_GLOBAL             23 (NULL + UnsupportedWritingTarget)
                      388 LOAD_FAST                0 (target)
                      390 PRECALL                  1
                      394 CALL                     1
                      404 LOAD_METHOD             12 (with_traceback)
                      426 LOAD_FAST                4 (tb)
                      428 PRECALL                  1
                      432 CALL                     1
                      442 RAISE_VARARGS            1
          
-          72     >>  444 RERAISE                  0
+          71     >>  444 RERAISE                  0
                  >>  446 COPY                     3
                      448 POP_EXCEPT
                      450 RERAISE                  1
          ExceptionTable:
            202 to 224 -> 252 [1] lasti
            252 to 258 -> 260 [3] lasti
            266 to 266 -> 260 [3] lasti
@@ -579,39 +581,38 @@
                   0x9501870d97007401000000000000000000006a0100000000000000007c
                   00a6010000ab0100000000000000007d01890ea002000000000000000000
                   000000000000000000000064016700a6020000ab0200000000000000007d
                   0264027c0276007d0367007d04880e6601640384087d0574070000000000
                   00000000006404840002007c05a6000000ab0000000000000000004400a6
                   000000ab000000000000000000a6010000ab0100000000000000007d067c
                   04a0040000000000000000000000000000000000000000740a0000000000
-                  00000000006a0600000000000000006a070000000000000000740a000000
-                  000000000000006a0600000000000000006a080000000000000000670274
-                  13000000000000000000006a0a00000000000000007c06a6010000ab0100
-                  000000000000007a000000a6010000ab010000000000000000010002007c
-                  05a6000000ab00000000000000000044005d165c0200008a0d7d077c0488
-                  0d6601640584087c074400a6000000ab0000000000000000007a0d00007d
-                  048c177417000000000000000000007c02a6010000ab0100000000000000
-                  0064066b0400000000722d7c04a004000000000000000000000000000000
-                  00000000007418000000000000000000006a0d0000000000000000670164
-                  0784007c024400a6000000ab0000000000000000007a000000a6010000ab
-                  01000000000000000001007c0372af02007c05a6000000ab000000000000
-                  00000044005da45c0200008a0d7d077c0744005d9c5c0200007d087d097c
-                  0944005d947d0a741d000000000000000000007c0a741200000000000000
-                  0000006a0f0000000000000000a6020000ab02000000000000000072787c
-                  0aa00200000000000000000000000000000000000000006408a6010000ab
-                  01000000000000000078017d0b81257c04a0040000000000000000000000
-                  0000000000000000007420000000000000000000006a0d00000000000000
-                  006408890d7c087c0a7c0b6706a6010000ab01000000000000000001007c
-                  0aa00200000000000000000000000000000000000000006409a6010000ab
-                  01000000000000000078017d0c81257c04a0040000000000000000000000
-                  0000000000000000007420000000000000000000006a0d00000000000000
-                  006409890d7c087c0a7c0c6706a6010000ab01000000000000000001008c
-                  958c9d8ca57c01a011000000000000000000000000000000000000000074
-                  25000000000000000000007c04a6010000ab010000000000000000a60100
-                  00ab010000000000000000010064005300
+                  00000000006a060000000000000000740a000000000000000000006a0700
+                  0000000000000067027411000000000000000000006a0900000000000000
+                  007c06a6010000ab0100000000000000007a000000a6010000ab01000000
+                  0000000000010002007c05a6000000ab00000000000000000044005d165c
+                  0200008a0d7d077c04880d6601640584087c074400a6000000ab00000000
+                  00000000007a0d00007d048c177415000000000000000000007c02a60100
+                  00ab01000000000000000064066b0400000000722d7c04a0040000000000
+                  0000000000000000000000000000007416000000000000000000006a0c00
+                  000000000000006701640784007c024400a6000000ab0000000000000000
+                  007a000000a6010000ab01000000000000000001007c0372af02007c05a6
+                  000000ab00000000000000000044005da45c0200008a0d7d077c0744005d
+                  9c5c0200007d087d097c0944005d947d0a741b000000000000000000007c
+                  0a7410000000000000000000006a0e0000000000000000a6020000ab0200
+                  0000000000000072787c0aa0020000000000000000000000000000000000
+                  0000006408a6010000ab01000000000000000078017d0b81257c04a00400
+                  00000000000000000000000000000000000000741e000000000000000000
+                  006a0c00000000000000006408890d7c087c0a7c0b6706a6010000ab0100
+                  0000000000000001007c0aa0020000000000000000000000000000000000
+                  0000006409a6010000ab01000000000000000078017d0c81257c04a00400
+                  00000000000000000000000000000000000000741e000000000000000000
+                  006a0c00000000000000006409890d7c087c0a7c0c6706a6010000ab0100
+                  0000000000000001008c958c9d8ca57c01a0100000000000000000000000
+                  0000000000000000007423000000000000000000007c04a6010000ab0100
+                  00000000000000a6010000ab010000000000000000010064005300
                              0 COPY_FREE_VARS           1
                              2 MAKE_CELL               13 (typ)
                
                 31           4 RESUME                   0
                
                 32           6 LOAD_GLOBAL              1 (NULL + csv)
                             18 LOAD_ATTR                1 (writer)
@@ -622,18 +623,18 @@
                
                 33          46 LOAD_DEREF              14 (header)
                             48 LOAD_METHOD              2 (get)
                             70 LOAD_CONST               1 ('extensions')
                             72 BUILD_LIST               0
                             74 PRECALL                  2
                             78 CALL                     2
-                            88 STORE_FAST               2 (exts)
+                            88 STORE_FAST               2 (extensions)
                
                 34          90 LOAD_CONST               2 ('metadata')
-                            92 LOAD_FAST                2 (exts)
+                            92 LOAD_FAST                2 (extensions)
                             94 CONTAINS_OP              0
                             96 STORE_FAST               3 (use_metadata)
                
                 35          98 BUILD_LIST               0
                            100 STORE_FAST               4 (rows)
                
                 37         102 LOAD_CLOSURE            14 (header)
@@ -650,236 +651,232 @@
                            132 PRECALL                  0
                            136 CALL                     0
                            146 GET_ITER
                            148 PRECALL                  0
                            152 CALL                     0
                            162 PRECALL                  1
                            166 CALL                     1
-                           176 STORE_FAST               6 (mlen)
+                           176 STORE_FAST               6 (max_len)
                
                 43         178 LOAD_FAST                4 (rows)
                            180 LOAD_METHOD              4 (append)
-                           202 LOAD_GLOBAL             10 (mdd)
-                           214 LOAD_ATTR                6 (MDConcepts)
-                           224 LOAD_ATTR                7 (Type)
-                           234 LOAD_GLOBAL             10 (mdd)
-                           246 LOAD_ATTR                6 (MDConcepts)
-                           256 LOAD_ATTR                8 (Label)
-                           266 BUILD_LIST               2
-                           268 LOAD_GLOBAL             19 (NULL + raw)
-                           280 LOAD_ATTR               10 (gen_feature_column_names)
-                           290 LOAD_FAST                6 (mlen)
-                           292 PRECALL                  1
-                           296 CALL                     1
-                           306 BINARY_OP                0 (+)
-                           310 PRECALL                  1
-                           314 CALL                     1
-                           324 POP_TOP
-               
-                45         326 PUSH_NULL
-                           328 LOAD_FAST                5 (all_specs)
-                           330 PRECALL                  0
-                           334 CALL                     0
-                           344 GET_ITER
-                       >>  346 FOR_ITER                22 (to 392)
-                           348 UNPACK_SEQUENCE          2
-                           352 STORE_DEREF             13 (typ)
-                           354 STORE_FAST               7 (specs)
-               
-                46         356 LOAD_FAST                4 (rows)
-                           358 LOAD_CLOSURE            13 (typ)
-                           360 BUILD_TUPLE              1
-                           362 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 46>)
-                           364 MAKE_FUNCTION            8 (closure)
-                           366 LOAD_FAST                7 (specs)
-                           368 GET_ITER
-                           370 PRECALL                  0
-                           374 CALL                     0
-                           384 BINARY_OP               13 (+=)
-                           388 STORE_FAST               4 (rows)
-                           390 JUMP_BACKWARD           23 (to 346)
-               
-                48     >>  392 LOAD_GLOBAL             23 (NULL + len)
-                           404 LOAD_FAST                2 (exts)
-                           406 PRECALL                  1
-                           410 CALL                     1
-                           420 LOAD_CONST               6 (0)
-                           422 COMPARE_OP               4 (>)
-                           428 POP_JUMP_FORWARD_IF_FALSE    45 (to 520)
-               
-                49         430 LOAD_FAST                4 (rows)
-                           432 LOAD_METHOD              4 (append)
-                           454 LOAD_GLOBAL             24 (registry)
-                           466 LOAD_ATTR               13 (CSV_KEY)
-                           476 BUILD_LIST               1
-                           478 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 49>)
-                           480 MAKE_FUNCTION            0
-                           482 LOAD_FAST                2 (exts)
-                           484 GET_ITER
-                           486 PRECALL                  0
-                           490 CALL                     0
-                           500 BINARY_OP                0 (+)
-                           504 PRECALL                  1
-                           508 CALL                     1
-                           518 POP_TOP
-               
-                51     >>  520 LOAD_FAST                3 (use_metadata)
-                           522 POP_JUMP_FORWARD_IF_FALSE   175 (to 874)
-               
-                52         524 PUSH_NULL
-                           526 LOAD_FAST                5 (all_specs)
-                           528 PRECALL                  0
-                           532 CALL                     0
-                           542 GET_ITER
-                       >>  544 FOR_ITER               164 (to 874)
-                           546 UNPACK_SEQUENCE          2
-                           550 STORE_DEREF             13 (typ)
-                           552 STORE_FAST               7 (specs)
-               
-                53         554 LOAD_FAST                7 (specs)
-                           556 GET_ITER
-                       >>  558 FOR_ITER               156 (to 872)
-                           560 UNPACK_SEQUENCE          2
-                           564 STORE_FAST               8 (label)
-                           566 STORE_FAST               9 (spec)
-               
-                54         568 LOAD_FAST                9 (spec)
-                           570 GET_ITER
-                       >>  572 FOR_ITER               148 (to 870)
-                           574 STORE_FAST              10 (f)
-               
-                55         576 LOAD_GLOBAL             29 (NULL + isinstance)
-                           588 LOAD_FAST               10 (f)
-                           590 LOAD_GLOBAL             18 (raw)
-                           602 LOAD_ATTR               15 (RawMetadataFeatureSpec)
-                           612 PRECALL                  2
-                           616 CALL                     2
-                           626 POP_JUMP_FORWARD_IF_FALSE   120 (to 868)
-               
-                56         628 LOAD_FAST               10 (f)
-                           630 LOAD_METHOD              2 (get)
-                           652 LOAD_CONST               8 ('print_name')
-                           654 PRECALL                  1
-                           658 CALL                     1
-                           668 COPY                     1
-                           670 STORE_FAST              11 (pn)
-                           672 POP_JUMP_FORWARD_IF_NONE    37 (to 748)
-               
-                57         674 LOAD_FAST                4 (rows)
-                           676 LOAD_METHOD              4 (append)
-                           698 LOAD_GLOBAL             32 (metadata)
-                           710 LOAD_ATTR               13 (CSV_KEY)
-                           720 LOAD_CONST               8 ('print_name')
-                           722 LOAD_DEREF              13 (typ)
-                           724 LOAD_FAST                8 (label)
-                           726 LOAD_FAST               10 (f)
-                           728 LOAD_FAST               11 (pn)
-                           730 BUILD_LIST               6
-                           732 PRECALL                  1
-                           736 CALL                     1
-                           746 POP_TOP
-               
-                58     >>  748 LOAD_FAST               10 (f)
-                           750 LOAD_METHOD              2 (get)
-                           772 LOAD_CONST               9 ('data_type')
-                           774 PRECALL                  1
-                           778 CALL                     1
-                           788 COPY                     1
-                           790 STORE_FAST              12 (dt)
-                           792 POP_JUMP_FORWARD_IF_NONE    37 (to 868)
-               
-                59         794 LOAD_FAST                4 (rows)
-                           796 LOAD_METHOD              4 (append)
-                           818 LOAD_GLOBAL             32 (metadata)
-                           830 LOAD_ATTR               13 (CSV_KEY)
-                           840 LOAD_CONST               9 ('data_type')
-                           842 LOAD_DEREF              13 (typ)
-                           844 LOAD_FAST                8 (label)
-                           846 LOAD_FAST               10 (f)
-                           848 LOAD_FAST               12 (dt)
-                           850 BUILD_LIST               6
-                           852 PRECALL                  1
-                           856 CALL                     1
-                           866 POP_TOP
-                       >>  868 JUMP_BACKWARD          149 (to 572)
-               
-                54     >>  870 JUMP_BACKWARD          157 (to 558)
-               
-                53     >>  872 JUMP_BACKWARD          165 (to 544)
-               
-                62     >>  874 LOAD_FAST                1 (writer)
-                           876 LOAD_METHOD             17 (writerows)
-                           898 LOAD_GLOBAL             37 (NULL + pad_lengths)
-                           910 LOAD_FAST                4 (rows)
-                           912 PRECALL                  1
-                           916 CALL                     1
-                           926 PRECALL                  1
-                           930 CALL                     1
-                           940 POP_TOP
-                           942 LOAD_CONST               0 (None)
-                           944 RETURN_VALUE
+                           202 LOAD_GLOBAL             10 (MDConcepts)
+                           214 LOAD_ATTR                6 (Type)
+                           224 LOAD_GLOBAL             10 (MDConcepts)
+                           236 LOAD_ATTR                7 (Label)
+                           246 BUILD_LIST               2
+                           248 LOAD_GLOBAL             17 (NULL + raw)
+                           260 LOAD_ATTR                9 (gen_feature_column_names)
+                           270 LOAD_FAST                6 (max_len)
+                           272 PRECALL                  1
+                           276 CALL                     1
+                           286 BINARY_OP                0 (+)
+                           290 PRECALL                  1
+                           294 CALL                     1
+                           304 POP_TOP
+               
+                45         306 PUSH_NULL
+                           308 LOAD_FAST                5 (all_specs)
+                           310 PRECALL                  0
+                           314 CALL                     0
+                           324 GET_ITER
+                       >>  326 FOR_ITER                22 (to 372)
+                           328 UNPACK_SEQUENCE          2
+                           332 STORE_DEREF             13 (typ)
+                           334 STORE_FAST               7 (specs)
+               
+                46         336 LOAD_FAST                4 (rows)
+                           338 LOAD_CLOSURE            13 (typ)
+                           340 BUILD_TUPLE              1
+                           342 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 46>)
+                           344 MAKE_FUNCTION            8 (closure)
+                           346 LOAD_FAST                7 (specs)
+                           348 GET_ITER
+                           350 PRECALL                  0
+                           354 CALL                     0
+                           364 BINARY_OP               13 (+=)
+                           368 STORE_FAST               4 (rows)
+                           370 JUMP_BACKWARD           23 (to 326)
+               
+                48     >>  372 LOAD_GLOBAL             21 (NULL + len)
+                           384 LOAD_FAST                2 (extensions)
+                           386 PRECALL                  1
+                           390 CALL                     1
+                           400 LOAD_CONST               6 (0)
+                           402 COMPARE_OP               4 (>)
+                           408 POP_JUMP_FORWARD_IF_FALSE    45 (to 500)
+               
+                49         410 LOAD_FAST                4 (rows)
+                           412 LOAD_METHOD              4 (append)
+                           434 LOAD_GLOBAL             22 (registry)
+                           446 LOAD_ATTR               12 (CSV_KEY)
+                           456 BUILD_LIST               1
+                           458 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 49>)
+                           460 MAKE_FUNCTION            0
+                           462 LOAD_FAST                2 (extensions)
+                           464 GET_ITER
+                           466 PRECALL                  0
+                           470 CALL                     0
+                           480 BINARY_OP                0 (+)
+                           484 PRECALL                  1
+                           488 CALL                     1
+                           498 POP_TOP
+               
+                51     >>  500 LOAD_FAST                3 (use_metadata)
+                           502 POP_JUMP_FORWARD_IF_FALSE   175 (to 854)
+               
+                52         504 PUSH_NULL
+                           506 LOAD_FAST                5 (all_specs)
+                           508 PRECALL                  0
+                           512 CALL                     0
+                           522 GET_ITER
+                       >>  524 FOR_ITER               164 (to 854)
+                           526 UNPACK_SEQUENCE          2
+                           530 STORE_DEREF             13 (typ)
+                           532 STORE_FAST               7 (specs)
+               
+                53         534 LOAD_FAST                7 (specs)
+                           536 GET_ITER
+                       >>  538 FOR_ITER               156 (to 852)
+                           540 UNPACK_SEQUENCE          2
+                           544 STORE_FAST               8 (label)
+                           546 STORE_FAST               9 (spec)
+               
+                54         548 LOAD_FAST                9 (spec)
+                           550 GET_ITER
+                       >>  552 FOR_ITER               148 (to 850)
+                           554 STORE_FAST              10 (f)
+               
+                55         556 LOAD_GLOBAL             27 (NULL + isinstance)
+                           568 LOAD_FAST               10 (f)
+                           570 LOAD_GLOBAL             16 (raw)
+                           582 LOAD_ATTR               14 (RawMetadataFeatureSpec)
+                           592 PRECALL                  2
+                           596 CALL                     2
+                           606 POP_JUMP_FORWARD_IF_FALSE   120 (to 848)
+               
+                56         608 LOAD_FAST               10 (f)
+                           610 LOAD_METHOD              2 (get)
+                           632 LOAD_CONST               8 ('print_name')
+                           634 PRECALL                  1
+                           638 CALL                     1
+                           648 COPY                     1
+                           650 STORE_FAST              11 (pn)
+                           652 POP_JUMP_FORWARD_IF_NONE    37 (to 728)
+               
+                57         654 LOAD_FAST                4 (rows)
+                           656 LOAD_METHOD              4 (append)
+                           678 LOAD_GLOBAL             30 (metadata)
+                           690 LOAD_ATTR               12 (CSV_KEY)
+                           700 LOAD_CONST               8 ('print_name')
+                           702 LOAD_DEREF              13 (typ)
+                           704 LOAD_FAST                8 (label)
+                           706 LOAD_FAST               10 (f)
+                           708 LOAD_FAST               11 (pn)
+                           710 BUILD_LIST               6
+                           712 PRECALL                  1
+                           716 CALL                     1
+                           726 POP_TOP
+               
+                58     >>  728 LOAD_FAST               10 (f)
+                           730 LOAD_METHOD              2 (get)
+                           752 LOAD_CONST               9 ('data_type')
+                           754 PRECALL                  1
+                           758 CALL                     1
+                           768 COPY                     1
+                           770 STORE_FAST              12 (dt)
+                           772 POP_JUMP_FORWARD_IF_NONE    37 (to 848)
+               
+                59         774 LOAD_FAST                4 (rows)
+                           776 LOAD_METHOD              4 (append)
+                           798 LOAD_GLOBAL             30 (metadata)
+                           810 LOAD_ATTR               12 (CSV_KEY)
+                           820 LOAD_CONST               9 ('data_type')
+                           822 LOAD_DEREF              13 (typ)
+                           824 LOAD_FAST                8 (label)
+                           826 LOAD_FAST               10 (f)
+                           828 LOAD_FAST               12 (dt)
+                           830 BUILD_LIST               6
+                           832 PRECALL                  1
+                           836 CALL                     1
+                           846 POP_TOP
+                       >>  848 JUMP_BACKWARD          149 (to 552)
+               
+                54     >>  850 JUMP_BACKWARD          157 (to 538)
+               
+                53     >>  852 JUMP_BACKWARD          165 (to 524)
+               
+                61     >>  854 LOAD_FAST                1 (writer)
+                           856 LOAD_METHOD             16 (writerows)
+                           878 LOAD_GLOBAL             35 (NULL + pad_lengths)
+                           890 LOAD_FAST                4 (rows)
+                           892 PRECALL                  1
+                           896 CALL                     1
+                           906 PRECALL                  1
+                           910 CALL                     1
+                           920 POP_TOP
+                           922 LOAD_CONST               0 (None)
+                           924 RETURN_VALUE
                consts
                   None
                   'extensions'
                   'metadata'
                   code
                      argcount  : 0
                      nlocals   : 0
                      stacksize : 6
                      flags     : 19
                      code
                         0x950197007401000000000000000000007402000000000000000000006a
-                        0200000000000000006a0300000000000000007402000000000000000000
-                        006a0200000000000000006a040000000000000000670289006401190000
-                        00000000000000a0050000000000000000000000000000000000000000a6
-                        000000ab0000000000000000008900640219000000000000000000a00500
-                        00000000000000000000000000000000000000a6000000ab000000000000
-                        0000006702a6020000ab0200000000000000005300
+                        0200000000000000007402000000000000000000006a0300000000000000
+                        0067028900640119000000000000000000a0040000000000000000000000
+                        000000000000000000a6000000ab00000000000000000089006402190000
+                        00000000000000a0040000000000000000000000000000000000000000a6
+                        000000ab0000000000000000006702a6020000ab02000000000000000053
+                        00
                                    0 COPY_FREE_VARS           1
                      
                       37           2 RESUME                   0
                      
                       38           4 LOAD_GLOBAL              1 (NULL + zip)
-                                  16 LOAD_GLOBAL              2 (mdd)
-                                  28 LOAD_ATTR                2 (ObservationTypes)
-                                  38 LOAD_ATTR                3 (E)
-                                  48 LOAD_GLOBAL              2 (mdd)
-                                  60 LOAD_ATTR                2 (ObservationTypes)
-                                  70 LOAD_ATTR                4 (M)
-                                  80 BUILD_LIST               2
+                                  16 LOAD_GLOBAL              2 (ObservationTypes)
+                                  28 LOAD_ATTR                2 (E)
+                                  38 LOAD_GLOBAL              2 (ObservationTypes)
+                                  50 LOAD_ATTR                3 (M)
+                                  60 BUILD_LIST               2
                      
-                      39          82 LOAD_DEREF               0 (header)
-                                  84 LOAD_CONST               1 ('event_specs')
-                                  86 BINARY_SUBSCR
-                                  96 LOAD_METHOD              5 (items)
-                                 118 PRECALL                  0
-                                 122 CALL                     0
-                                 132 LOAD_DEREF               0 (header)
-                                 134 LOAD_CONST               2 ('measurement_specs')
-                                 136 BINARY_SUBSCR
-                                 146 LOAD_METHOD              5 (items)
-                                 168 PRECALL                  0
-                                 172 CALL                     0
-                                 182 BUILD_LIST               2
+                      39          62 LOAD_DEREF               0 (header)
+                                  64 LOAD_CONST               1 ('event_specs')
+                                  66 BINARY_SUBSCR
+                                  76 LOAD_METHOD              4 (items)
+                                  98 PRECALL                  0
+                                 102 CALL                     0
+                                 112 LOAD_DEREF               0 (header)
+                                 114 LOAD_CONST               2 ('measurement_specs')
+                                 116 BINARY_SUBSCR
+                                 126 LOAD_METHOD              4 (items)
+                                 148 PRECALL                  0
+                                 152 CALL                     0
+                                 162 BUILD_LIST               2
                      
-                      38         184 PRECALL                  2
-                                 188 CALL                     2
-                                 198 RETURN_VALUE
+                      38         164 PRECALL                  2
+                                 168 CALL                     2
+                                 178 RETURN_VALUE
                      consts
                         None
                         'event_specs'
                         'measurement_specs'
-                     names      ('zip', 'mdd', 'ObservationTypes', 'E', 'M', 'items')
+                     names      ('zip', 'ObservationTypes', 'E', 'M', 'items')
                      varnames   ()
                      freevars   ('header',)
                      cellvars   ()
                      filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                      name       'all_specs'
                      firstlineno 37
-                     lnotab 0x04014e0166ff
+                     lnotab 0x04013a0166ff
                   code
                      argcount  : 1
                      nlocals   : 5
                      stacksize : 5
                      flags     : 51
                      code
                         0x4b00010097007c005d1e5c0200007d017d027c0244005d165c0200007d
@@ -1021,38 +1018,38 @@
                      cellvars   ()
                      filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                      name       '<listcomp>'
                      firstlineno 49
                      lnotab 0x
                   'print_name'
                   'data_type'
-               names      ('csv', 'writer', 'get', 'max', 'append', 'mdd', 'MDConcepts', 'Type', 'Label', 'raw', 'gen_feature_column_names', 'len', 'registry', 'CSV_KEY', 'isinstance', 'RawMetadataFeatureSpec', 'metadata', 'writerows', 'pad_lengths')
-               varnames   ('into', 'writer', 'exts', 'use_metadata', 'rows', 'all_specs', 'mlen', 'specs', 'label', 'spec', 'f', 'pn', 'dt')
+               names      ('csv', 'writer', 'get', 'max', 'append', 'MDConcepts', 'Type', 'Label', 'raw', 'gen_feature_column_names', 'len', 'registry', 'CSV_KEY', 'isinstance', 'RawMetadataFeatureSpec', 'metadata', 'writerows', 'pad_lengths')
+               varnames   ('into', 'writer', 'extensions', 'use_metadata', 'rows', 'all_specs', 'max_len', 'specs', 'label', 'spec', 'f', 'pn', 'dt')
                freevars   ('header',)
                cellvars   ('typ',)
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                name       'write_into'
                firstlineno 31
                lnotab
-                  0x060128012c01080104020a05420194021e01240226015a0204011e010e
-                  01080134012e014a012e014cfb02ff0209
+                  0x060128012c01080104020a05420180021e01240226015a0204011e010e
+                  01080134012e014a012e014cfb02ff0208
             '.csv'
             'w'
             ''
             'utf-8'
             ('newline', 'encoding')
             2
          names      ('isinstance', 'str', 'os', 'PathLike', 'io_utils', 'ensure_directory_exists', 'ensure_ext', 'open', 'Exception', 'sys', 'exc_info', 'UnsupportedWritingTarget', 'with_traceback')
          varnames   ('target', 'header', 'write_into', 'csvfile', 'tb')
          freevars   ()
          cellvars   ('header',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_raw_header'
          firstlineno 30
-         lnotab 0x04010a21440128012a01280116ff340302011c011201320144fe
+         lnotab 0x04010a20440128012a01280116ff340302011c011201320144fe
       'json'
       'dict_header_format'
       code
          argcount  : 3
          nlocals   : 6
          stacksize : 6
          flags     : 3
@@ -1076,104 +1073,104 @@
             0000000000000000002400723c01007419000000000000000000006a0d00
             00000000000000a6000000ab000000000000000000640719000000000000
             0000007d05741d000000000000000000007c00a6010000ab010000000000
             000000a00f00000000000000000000000000000000000000007c05a60100
             00ab01000000000000000082017700780359007701
                        0 MAKE_CELL                1 (header)
          
-          77           2 RESUME                   0
+          76           2 RESUME                   0
          
-          78           4 LOAD_FAST                2 (dict_header_format)
+          77           4 LOAD_FAST                2 (dict_header_format)
                        6 LOAD_GLOBAL              0 (HeaderFileFormat)
                       18 LOAD_ATTR                1 (JSON)
                       28 LOAD_GLOBAL              0 (HeaderFileFormat)
                       40 LOAD_ATTR                2 (YAML)
                       50 BUILD_SET                2
                       52 CONTAINS_OP              0
                       54 POP_JUMP_FORWARD_IF_TRUE     2 (to 60)
                       56 LOAD_ASSERTION_ERROR
                       58 RAISE_VARARGS            1
          
-          80     >>   60 LOAD_CONST               1 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 80>)
+          79     >>   60 LOAD_CONST               1 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 79>)
                       62 MAKE_FUNCTION            0
                       64 STORE_FAST               3 (write_into)
          
-          83          66 LOAD_FAST                2 (dict_header_format)
+          82          66 LOAD_FAST                2 (dict_header_format)
                       68 LOAD_GLOBAL              0 (HeaderFileFormat)
                       80 LOAD_ATTR                1 (JSON)
                       90 COMPARE_OP               2 (==)
                       96 POP_JUMP_FORWARD_IF_FALSE     6 (to 110)
          
-          84          98 LOAD_CLOSURE             1 (header)
+          83          98 LOAD_CLOSURE             1 (header)
                      100 BUILD_TUPLE              1
-                     102 LOAD_CONST               2 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 84>)
+                     102 LOAD_CONST               2 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 83>)
                      104 MAKE_FUNCTION            8 (closure)
                      106 STORE_FAST               3 (write_into)
                      108 JUMP_FORWARD            21 (to 152)
          
-          86     >>  110 LOAD_FAST                2 (dict_header_format)
+          85     >>  110 LOAD_FAST                2 (dict_header_format)
                      112 LOAD_GLOBAL              0 (HeaderFileFormat)
                      124 LOAD_ATTR                2 (YAML)
                      134 COMPARE_OP               2 (==)
                      140 POP_JUMP_FORWARD_IF_FALSE     5 (to 152)
          
-          87         142 LOAD_CLOSURE             1 (header)
+          86         142 LOAD_CLOSURE             1 (header)
                      144 BUILD_TUPLE              1
-                     146 LOAD_CONST               3 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 87>)
+                     146 LOAD_CONST               3 (<code object write_into, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\exporting.py", line 86>)
                      148 MAKE_FUNCTION            8 (closure)
                      150 STORE_FAST               3 (write_into)
          
-          90     >>  152 LOAD_GLOBAL              7 (NULL + isinstance)
+          89     >>  152 LOAD_GLOBAL              7 (NULL + isinstance)
                      164 LOAD_FAST                0 (target)
                      166 LOAD_GLOBAL              8 (str)
                      178 LOAD_GLOBAL             10 (os)
                      190 LOAD_ATTR                6 (PathLike)
                      200 BINARY_OP                7 (|)
                      204 PRECALL                  2
                      208 CALL                     2
                      218 POP_JUMP_FORWARD_IF_FALSE   113 (to 446)
          
-          91         220 LOAD_GLOBAL             15 (NULL + io_utils)
+          90         220 LOAD_GLOBAL             15 (NULL + io_utils)
                      232 LOAD_ATTR                8 (ensure_directory_exists)
                      242 LOAD_FAST                0 (target)
                      244 PRECALL                  1
                      248 CALL                     1
                      258 POP_TOP
          
-          92         260 LOAD_GLOBAL             15 (NULL + io_utils)
+          91         260 LOAD_GLOBAL             15 (NULL + io_utils)
                      272 LOAD_ATTR                9 (ensure_ext)
                      282 LOAD_FAST                0 (target)
                      284 LOAD_FAST                2 (dict_header_format)
                      286 LOAD_GLOBAL              0 (HeaderFileFormat)
                      298 LOAD_ATTR                1 (JSON)
                      308 COMPARE_OP               2 (==)
                      314 POP_JUMP_FORWARD_IF_FALSE     2 (to 320)
                      316 LOAD_CONST               4 ('.json')
                      318 JUMP_FORWARD             1 (to 322)
                  >>  320 LOAD_CONST               5 ('.yaml')
                  >>  322 PRECALL                  2
                      326 CALL                     2
                      336 STORE_FAST               0 (target)
          
-          93         338 LOAD_GLOBAL             21 (NULL + open)
+          92         338 LOAD_GLOBAL             21 (NULL + open)
                      350 LOAD_FAST                0 (target)
                      352 LOAD_CONST               6 ('w')
                      354 PRECALL                  2
                      358 CALL                     2
                      368 BEFORE_WITH
                      370 STORE_FAST               4 (file)
          
-          94         372 PUSH_NULL
+          93         372 PUSH_NULL
                      374 LOAD_FAST                3 (write_into)
                      376 LOAD_FAST                4 (file)
                      378 PRECALL                  1
                      382 CALL                     1
                      392 POP_TOP
          
-          93         394 LOAD_CONST               0 (None)
+          92         394 LOAD_CONST               0 (None)
                      396 LOAD_CONST               0 (None)
                      398 LOAD_CONST               0 (None)
                      400 PRECALL                  2
                      404 CALL                     2
                      414 POP_TOP
                      416 LOAD_CONST               0 (None)
                      418 RETURN_VALUE
@@ -1187,94 +1184,94 @@
                  >>  434 POP_TOP
                      436 POP_EXCEPT
                      438 POP_TOP
                      440 POP_TOP
                      442 LOAD_CONST               0 (None)
                      444 RETURN_VALUE
          
-          96     >>  446 NOP
+          95     >>  446 NOP
          
-          97         448 PUSH_NULL
+          96         448 PUSH_NULL
                      450 LOAD_FAST                3 (write_into)
                      452 LOAD_FAST                0 (target)
                      454 PRECALL                  1
                      458 CALL                     1
                      468 POP_TOP
                      470 LOAD_CONST               0 (None)
                      472 RETURN_VALUE
                  >>  474 PUSH_EXC_INFO
          
-          98         476 LOAD_GLOBAL             22 (Exception)
+          97         476 LOAD_GLOBAL             22 (Exception)
                      488 CHECK_EXC_MATCH
                      490 POP_JUMP_FORWARD_IF_FALSE    60 (to 612)
                      492 POP_TOP
          
-          99         494 LOAD_GLOBAL             25 (NULL + sys)
+          98         494 LOAD_GLOBAL             25 (NULL + sys)
                      506 LOAD_ATTR               13 (exc_info)
                      516 PRECALL                  0
                      520 CALL                     0
                      530 LOAD_CONST               7 (2)
                      532 BINARY_SUBSCR
                      542 STORE_FAST               5 (tb)
          
-         100         544 LOAD_GLOBAL             29 (NULL + UnsupportedWritingTarget)
+          99         544 LOAD_GLOBAL             29 (NULL + UnsupportedWritingTarget)
                      556 LOAD_FAST                0 (target)
                      558 PRECALL                  1
                      562 CALL                     1
                      572 LOAD_METHOD             15 (with_traceback)
                      594 LOAD_FAST                5 (tb)
                      596 PRECALL                  1
                      600 CALL                     1
                      610 RAISE_VARARGS            1
          
-          98     >>  612 RERAISE                  0
+          97     >>  612 RERAISE                  0
                  >>  614 COPY                     3
                      616 POP_EXCEPT
                      618 RERAISE                  1
          ExceptionTable:
            370 to 392 -> 420 [1] lasti
            420 to 426 -> 428 [3] lasti
            434 to 434 -> 428 [3] lasti
            448 to 468 -> 474 [0]
            474 to 612 -> 614 [1] lasti
          consts
             None
             code
-               argcount  : 1
-               nlocals   : 1
+               argcount  : 0
+               nlocals   : 0
                stacksize : 1
                flags     : 19
                code 0x970064005300
-                80           0 RESUME                   0
+                79           0 RESUME                   0
                
-                81           2 LOAD_CONST               0 (None)
+                80           2 LOAD_CONST               0 (None)
                              4 RETURN_VALUE
                consts
                   None
                names      ()
-               varnames   ('into',)
+               varnames   ()
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                name       'write_into'
-               firstlineno 80
+               firstlineno 79
                lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 5
                flags     : 19
                code
                   0x950197007401000000000000000000006a01000000000000000089017c
                   006401ac02a6030000ab030000000000000000010064005300
                              0 COPY_FREE_VARS           1
                
-                84           2 RESUME                   0
+                83           2 RESUME                   0
                
-                85           4 LOAD_GLOBAL              1 (NULL + json)
+                84           4 LOAD_GLOBAL              1 (NULL + json)
                             16 LOAD_ATTR                1 (dump)
                             26 LOAD_DEREF               1 (header)
                             28 LOAD_FAST                0 (into)
                             30 LOAD_CONST               1 (2)
                             32 KW_NAMES                 2
                             34 PRECALL                  3
                             38 CALL                     3
@@ -1287,29 +1284,29 @@
                   ('indent',)
                names      ('json', 'dump')
                varnames   ('into',)
                freevars   ('header',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                name       'write_into'
-               firstlineno 84
+               firstlineno 83
                lnotab 0x0401
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 4
                flags     : 19
                code
                   0x950197007401000000000000000000006a01000000000000000089017c
                   00a6020000ab020000000000000000010064005300
                              0 COPY_FREE_VARS           1
                
-                87           2 RESUME                   0
+                86           2 RESUME                   0
                
-                88           4 LOAD_GLOBAL              1 (NULL + yaml)
+                87           4 LOAD_GLOBAL              1 (NULL + yaml)
                             16 LOAD_ATTR                1 (dump)
                             26 LOAD_DEREF               1 (header)
                             28 LOAD_FAST                0 (into)
                             30 PRECALL                  2
                             34 CALL                     2
                             44 POP_TOP
                             46 LOAD_CONST               0 (None)
@@ -1318,27 +1315,27 @@
                   None
                names      ('yaml', 'dump')
                varnames   ('into',)
                freevars   ('header',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
                name       'write_into'
-               firstlineno 87
+               firstlineno 86
                lnotab 0x0401
             '.json'
             '.yaml'
             'w'
             2
          names      ('HeaderFileFormat', 'JSON', 'YAML', 'isinstance', 'str', 'os', 'PathLike', 'io_utils', 'ensure_directory_exists', 'ensure_ext', 'open', 'Exception', 'sys', 'exc_info', 'UnsupportedWritingTarget', 'with_traceback')
          varnames   ('target', 'header', 'dict_header_format', 'write_into', 'file', 'tb')
          freevars   ()
          cellvars   ('header',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_raw_header_dict'
-         firstlineno 77
+         firstlineno 76
          lnotab
             0x04013802060320010c0220010a03440128014e01220116ff340302011c
             011201320144fe
       'df'
       code
          argcount  : 2
          nlocals   : 2
@@ -1348,42 +1345,42 @@
             0x97007401000000000000000000007c0074020000000000000000000074
             04000000000000000000006a0300000000000000007a070000a6020000ab
             02000000000000000072297409000000000000000000006a050000000000
             0000007c00a6010000ab0100000000000000000100740900000000000000
             0000006a0600000000000000007c006401a6020000ab0200000000000000
             007d007c01a00700000000000000000000000000000000000000007c0064
             02ac03a6020000ab020000000000000000010064005300
-         103           0 RESUME                   0
+         102           0 RESUME                   0
          
-         104           2 LOAD_GLOBAL              1 (NULL + isinstance)
+         103           2 LOAD_GLOBAL              1 (NULL + isinstance)
                       14 LOAD_FAST                0 (target)
                       16 LOAD_GLOBAL              2 (str)
                       28 LOAD_GLOBAL              4 (os)
                       40 LOAD_ATTR                3 (PathLike)
                       50 BINARY_OP                7 (|)
                       54 PRECALL                  2
                       58 CALL                     2
                       68 POP_JUMP_FORWARD_IF_FALSE    41 (to 152)
          
-         105          70 LOAD_GLOBAL              9 (NULL + io_utils)
+         104          70 LOAD_GLOBAL              9 (NULL + io_utils)
                       82 LOAD_ATTR                5 (ensure_directory_exists)
                       92 LOAD_FAST                0 (target)
                       94 PRECALL                  1
                       98 CALL                     1
                      108 POP_TOP
          
-         106         110 LOAD_GLOBAL              9 (NULL + io_utils)
+         105         110 LOAD_GLOBAL              9 (NULL + io_utils)
                      122 LOAD_ATTR                6 (ensure_ext)
                      132 LOAD_FAST                0 (target)
                      134 LOAD_CONST               1 ('.csv')
                      136 PRECALL                  2
                      140 CALL                     2
                      150 STORE_FAST               0 (target)
          
-         107     >>  152 LOAD_FAST                1 (df)
+         106     >>  152 LOAD_FAST                1 (df)
                      154 LOAD_METHOD              7 (to_csv)
                      176 LOAD_FAST                0 (target)
                      178 LOAD_CONST               2 (False)
                      180 KW_NAMES                 3
                      182 PRECALL                  2
                      186 CALL                     2
                      196 POP_TOP
@@ -1396,42 +1393,42 @@
             ('index',)
          names      ('isinstance', 'str', 'os', 'PathLike', 'io_utils', 'ensure_directory_exists', 'ensure_ext', 'to_csv')
          varnames   ('target', 'df')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_raw_data'
-         firstlineno 103
+         firstlineno 102
          lnotab 0x0201440128012a01
       'csv'
       'path'
       'md'
       'header_format'
       code
          argcount  : 3
          nlocals   : 5
          stacksize : 6
          flags     : 3
          code
             0x97007401000000000000000000007c007c02ac01a6020000ab02000000
             00000000005c0200007d037d047403000000000000000000007c037c047c
             017c02a6040000ab040000000000000000010064005300
-         110           0 RESUME                   0
+         109           0 RESUME                   0
          
-         111           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
+         110           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
                       14 LOAD_FAST                0 (path)
                       16 LOAD_FAST                2 (header_format)
                       18 KW_NAMES                 1
                       20 PRECALL                  2
                       24 CALL                     2
                       34 UNPACK_SEQUENCE          2
                       38 STORE_FAST               3 (header_file)
                       40 STORE_FAST               4 (data_file)
          
-         112          42 LOAD_GLOBAL              3 (NULL + write_machine_data_custom)
+         111          42 LOAD_GLOBAL              3 (NULL + write_machine_data_custom)
                       54 LOAD_FAST                3 (header_file)
                       56 LOAD_FAST                4 (data_file)
                       58 LOAD_FAST                1 (md)
                       60 LOAD_FAST                2 (header_format)
                       62 PRECALL                  4
                       66 CALL                     4
                       76 POP_TOP
@@ -1442,15 +1439,15 @@
             ('header_format',)
          names      ('mk_filename_pair', 'write_machine_data_custom')
          varnames   ('path', 'md', 'header_format', 'header_file', 'data_file')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_machine_data'
-         firstlineno 110
+         firstlineno 109
          lnotab 0x02012801
       'header_target'
       'data_target'
       code
          argcount  : 4
          nlocals   : 5
          stacksize : 6
@@ -1463,93 +1460,93 @@
             00ab02000000000000000001006e2c7c037404000000000000000000006a
             0500000000000000007404000000000000000000006a0600000000000000
             00680276007212740f000000000000000000007c007c047c03ac01a60300
             00ab03000000000000000001007c0181247411000000000000000000007c
             017401000000000000000000006a0900000000000000007c02a6010000ab
             010000000000000000a6020000ab02000000000000000001006400530064
             005300
-         115           0 RESUME                   0
+         114           0 RESUME                   0
          
-         118           2 LOAD_GLOBAL              1 (NULL + raw)
+         117           2 LOAD_GLOBAL              1 (NULL + raw)
                       14 LOAD_ATTR                1 (convert_to_raw_header)
                       24 LOAD_FAST                2 (md)
                       26 PRECALL                  1
                       30 CALL                     1
                       40 STORE_FAST               4 (raw_header)
          
-         119          42 LOAD_FAST                3 (header_format)
+         118          42 LOAD_FAST                3 (header_format)
                       44 LOAD_GLOBAL              4 (HeaderFileFormat)
                       56 CONTAINS_OP              0
                       58 POP_JUMP_FORWARD_IF_TRUE     2 (to 64)
                       60 LOAD_ASSERTION_ERROR
                       62 RAISE_VARARGS            1
          
-         120     >>   64 LOAD_FAST                0 (header_target)
+         119     >>   64 LOAD_FAST                0 (header_target)
                       66 POP_JUMP_FORWARD_IF_NONE    77 (to 222)
          
-         121          68 LOAD_FAST                3 (header_format)
+         120          68 LOAD_FAST                3 (header_format)
                       70 LOAD_GLOBAL              4 (HeaderFileFormat)
                       82 LOAD_ATTR                3 (CSV)
                       92 COMPARE_OP               2 (==)
                       98 POP_JUMP_FORWARD_IF_FALSE    17 (to 134)
          
-         122         100 LOAD_GLOBAL              9 (NULL + write_raw_header)
+         121         100 LOAD_GLOBAL              9 (NULL + write_raw_header)
                      112 LOAD_FAST                0 (header_target)
                      114 LOAD_FAST                4 (raw_header)
                      116 PRECALL                  2
                      120 CALL                     2
                      130 POP_TOP
                      132 JUMP_FORWARD            44 (to 222)
          
-         123     >>  134 LOAD_FAST                3 (header_format)
+         122     >>  134 LOAD_FAST                3 (header_format)
                      136 LOAD_GLOBAL              4 (HeaderFileFormat)
                      148 LOAD_ATTR                5 (JSON)
                      158 LOAD_GLOBAL              4 (HeaderFileFormat)
                      170 LOAD_ATTR                6 (YAML)
                      180 BUILD_SET                2
                      182 CONTAINS_OP              0
                      184 POP_JUMP_FORWARD_IF_FALSE    18 (to 222)
          
-         124         186 LOAD_GLOBAL             15 (NULL + write_raw_header_dict)
+         123         186 LOAD_GLOBAL             15 (NULL + write_raw_header_dict)
                      198 LOAD_FAST                0 (header_target)
                      200 LOAD_FAST                4 (raw_header)
                      202 LOAD_FAST                3 (header_format)
                      204 KW_NAMES                 1
                      206 PRECALL                  3
                      210 CALL                     3
                      220 POP_TOP
          
-         125     >>  222 LOAD_FAST                1 (data_target)
+         124     >>  222 LOAD_FAST                1 (data_target)
                      224 POP_JUMP_FORWARD_IF_NONE    36 (to 298)
          
-         126         226 LOAD_GLOBAL             17 (NULL + write_raw_data)
+         125         226 LOAD_GLOBAL             17 (NULL + write_raw_data)
                      238 LOAD_FAST                1 (data_target)
                      240 LOAD_GLOBAL              1 (NULL + raw)
                      252 LOAD_ATTR                9 (convert_to_raw_data)
                      262 LOAD_FAST                2 (md)
                      264 PRECALL                  1
                      268 CALL                     1
                      278 PRECALL                  2
                      282 CALL                     2
                      292 POP_TOP
                      294 LOAD_CONST               0 (None)
                      296 RETURN_VALUE
          
-         125     >>  298 LOAD_CONST               0 (None)
+         124     >>  298 LOAD_CONST               0 (None)
                      300 RETURN_VALUE
          consts
             None
             ('dict_header_format',)
          names      ('raw', 'convert_to_raw_header', 'HeaderFileFormat', 'CSV', 'write_raw_header', 'JSON', 'YAML', 'write_raw_header_dict', 'write_raw_data', 'convert_to_raw_data')
          varnames   ('header_target', 'data_target', 'md', 'header_format', 'raw_header')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_machine_data_custom'
-         firstlineno 115
+         firstlineno 114
          lnotab 0x02032801160104012001220134012401040148ff
       code
          argcount  : 3
          nlocals   : 6
          stacksize : 5
          flags     : 3
          code
@@ -1558,110 +1555,110 @@
             00000000007c01a6010000ab0100000000000000007d057c027406000000
             00000000000000760073024a0082017c027406000000000000000000006a
             0400000000000000006b02000000007212740b000000000000000000007c
             037c05a6020000ab0200000000000000000100640053007c027406000000
             000000000000006a0600000000000000007406000000000000000000006a
             0700000000000000006802760072147411000000000000000000007c037c
             057c02ac02a6030000ab03000000000000000001006400530064005300
-         129           0 RESUME                   0
+         128           0 RESUME                   0
          
-         130           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
+         129           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
                       14 LOAD_FAST                0 (path)
                       16 LOAD_FAST                2 (header_format)
                       18 KW_NAMES                 1
                       20 PRECALL                  2
                       24 CALL                     2
                       34 UNPACK_SEQUENCE          2
                       38 STORE_FAST               3 (header_file)
                       40 STORE_FAST               4 (_)
          
-         131          42 LOAD_GLOBAL              3 (NULL + raw)
+         130          42 LOAD_GLOBAL              3 (NULL + raw)
                       54 LOAD_ATTR                2 (convert_to_raw_header)
                       64 LOAD_FAST                1 (md)
                       66 PRECALL                  1
                       70 CALL                     1
                       80 STORE_FAST               5 (raw_header)
          
-         132          82 LOAD_FAST                2 (header_format)
+         131          82 LOAD_FAST                2 (header_format)
                       84 LOAD_GLOBAL              6 (HeaderFileFormat)
                       96 CONTAINS_OP              0
                       98 POP_JUMP_FORWARD_IF_TRUE     2 (to 104)
                      100 LOAD_ASSERTION_ERROR
                      102 RAISE_VARARGS            1
          
-         133     >>  104 LOAD_FAST                2 (header_format)
+         132     >>  104 LOAD_FAST                2 (header_format)
                      106 LOAD_GLOBAL              6 (HeaderFileFormat)
                      118 LOAD_ATTR                4 (CSV)
                      128 COMPARE_OP               2 (==)
                      134 POP_JUMP_FORWARD_IF_FALSE    18 (to 172)
          
-         134         136 LOAD_GLOBAL             11 (NULL + write_raw_header)
+         133         136 LOAD_GLOBAL             11 (NULL + write_raw_header)
                      148 LOAD_FAST                3 (header_file)
                      150 LOAD_FAST                5 (raw_header)
                      152 PRECALL                  2
                      156 CALL                     2
                      166 POP_TOP
                      168 LOAD_CONST               0 (None)
                      170 RETURN_VALUE
          
-         135     >>  172 LOAD_FAST                2 (header_format)
+         134     >>  172 LOAD_FAST                2 (header_format)
                      174 LOAD_GLOBAL              6 (HeaderFileFormat)
                      186 LOAD_ATTR                6 (JSON)
                      196 LOAD_GLOBAL              6 (HeaderFileFormat)
                      208 LOAD_ATTR                7 (YAML)
                      218 BUILD_SET                2
                      220 CONTAINS_OP              0
                      222 POP_JUMP_FORWARD_IF_FALSE    20 (to 264)
          
-         136         224 LOAD_GLOBAL             17 (NULL + write_raw_header_dict)
+         135         224 LOAD_GLOBAL             17 (NULL + write_raw_header_dict)
                      236 LOAD_FAST                3 (header_file)
                      238 LOAD_FAST                5 (raw_header)
                      240 LOAD_FAST                2 (header_format)
                      242 KW_NAMES                 2
                      244 PRECALL                  3
                      248 CALL                     3
                      258 POP_TOP
                      260 LOAD_CONST               0 (None)
                      262 RETURN_VALUE
          
-         135     >>  264 LOAD_CONST               0 (None)
+         134     >>  264 LOAD_CONST               0 (None)
                      266 RETURN_VALUE
          consts
             None
             ('header_format',)
             ('dict_header_format',)
          names      ('mk_filename_pair', 'raw', 'convert_to_raw_header', 'HeaderFileFormat', 'CSV', 'write_raw_header', 'JSON', 'YAML', 'write_raw_header_dict')
          varnames   ('path', 'md', 'header_format', 'header_file', '_', 'raw_header')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_header_file'
-         firstlineno 129
+         firstlineno 128
          lnotab 0x020128012801160120012401340128ff
       code
          argcount  : 2
          nlocals   : 4
          stacksize : 6
          flags     : 3
          code
             0x97007401000000000000000000007c00a6010000ab0100000000000000
             005c0200007d027d037403000000000000000000007c0374050000000000
             00000000006a0300000000000000007c01a6010000ab0100000000000000
             00a6020000ab020000000000000000010064005300
-         139           0 RESUME                   0
+         138           0 RESUME                   0
          
-         140           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
+         139           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
                       14 LOAD_FAST                0 (path)
                       16 PRECALL                  1
                       20 CALL                     1
                       30 UNPACK_SEQUENCE          2
                       34 STORE_FAST               2 (_)
                       36 STORE_FAST               3 (data_file)
          
-         141          38 LOAD_GLOBAL              3 (NULL + write_raw_data)
+         140          38 LOAD_GLOBAL              3 (NULL + write_raw_data)
                       50 LOAD_FAST                3 (data_file)
                       52 LOAD_GLOBAL              5 (NULL + raw)
                       64 LOAD_ATTR                3 (convert_to_raw_data)
                       74 LOAD_FAST                1 (md)
                       76 PRECALL                  1
                       80 CALL                     1
                       90 PRECALL                  2
@@ -1673,21 +1670,21 @@
             None
          names      ('mk_filename_pair', 'write_raw_data', 'raw', 'convert_to_raw_data')
          varnames   ('path', 'md', '_', 'data_file')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
          name       'write_data_file'
-         firstlineno 139
+         firstlineno 138
          lnotab 0x02012401
       ('json',)
       ('csv',)
-   names      ('csv', 'io', 'json', 'os', 'sys', 'typing', 'Optional', 'TextIO', 'yaml', 'mdata.core', 'machine_data_def', 'mdd', 'raw', 'mdata.core.extensions', 'metadata', 'registry', 'mdata.file_formats', 'io_utils', 'shared', 'mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'DictHeaderFormatLiterals', 'Exception', 'UnsupportedWritingTarget', 'str', 'PathLike', 'StringIO', 'WritingTarget', 'list', 'pad_lengths', 'RawHeaderSpec', 'write_raw_header', 'write_raw_header_dict', 'RawDataType', 'write_raw_data', 'MachineData', 'write_machine_data', 'write_machine_data_custom', 'write_header_file', 'write_data_file')
+   names      ('csv', 'io', 'json', 'os', 'sys', 'typing', 'Optional', 'TextIO', 'Any', 'pandas', 'pd', 'yaml', 'mdata.core', 'bmd', 'raw', 'MachineData', 'ObservationTypes', 'MDConcepts', 'mdata.core.extensions', 'metadata', 'registry', 'mdata.file_formats', 'io_utils', 'shared', 'mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'DictHeaderFormatLiterals', 'Exception', 'UnsupportedWritingTarget', 'str', 'PathLike', 'StringIO', 'WritingTarget', 'list', 'pad_lengths', 'RawHeaderSpec', 'write_raw_header', 'write_raw_header_dict', 'DataFrame', 'write_raw_data', 'write_machine_data', 'write_machine_data_custom', 'write_header_file', 'write_data_file')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\exporting.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff020108010801080108010801100208020c010c0110010c0118031c
-      05360324051a2f1c1a1a07300522010cff020202fe080e300a
+      0x00ff0201080108010801080108011402080108021c0110010c0118031c
+      05360324051a2e1c1a1a072605220102ff020202fe080e260a
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/importing.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/importing.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/importing.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/importing.cpython-311.pyc`

 * *Files 9% similar despite different names*

#### Python bytecode

```diff
@@ -1,24 +1,24 @@
 magic:    0xa70d0d0a
-moddate:  0x91f5c064 (Wed Jul 26 10:29:37 2023 UTC)
-files sz: 5963
+moddate:  0xa3f8d064 (Mon Aug  7 13:58:59 2023 UTC)
+files sz: 6150
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 3
    flags     : 16777216
    code
       0x9700640064016c006d015a010100640064026c025a02640064026c035a
-      04640064036c056d065a066d075a076d085a080100640064026c095a0a64
-      0064046c0b6d0c5a0d0100640064056c0b6d0e5a0e0100640064066c0f6d
-      105a116d015a126d135a130100640064076c146d155a150100640064086c
-      166d175a176d185a186d195a190100640064096c1a6d1b5a1b0100641e64
-      0e84045a1c09000900641f6420641684055a1d0900090064216422641984
-      055a1e6423641b84045a1f6423641c84045a206423641d84045a21640253
-      00
+      04640064036c056d065a066d075a076d085a086d095a090100640064026c
+      0a5a0b640064046c0c6d0d5a0d6d0e5a0e6d0f5a0f0100640064056c106d
+      115a110100640064066c126d135a146d015a156d165a160100640064076c
+      176d185a180100640064086c196d1a5a1a6d1b5a1b6d1c5a1c0100640064
+      096c1d6d1e5a1e0100641e640e84045a1f09000900641f6420641684055a
+      200900090064216422641984055a216423641b84045a226423641c84045a
+      236423641d84045a2464025300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('annotations',))
                  6 IMPORT_NAME              0 (__future__)
                  8 IMPORT_FROM              1 (annotations)
                 10 STORE_NAME               1 (annotations)
@@ -31,155 +31,161 @@
    
      4          22 LOAD_CONST               0 (0)
                 24 LOAD_CONST               2 (None)
                 26 IMPORT_NAME              3 (os.path)
                 28 STORE_NAME               4 (os)
    
      5          30 LOAD_CONST               0 (0)
-                32 LOAD_CONST               3 (('Literal', 'Union', 'Mapping'))
+                32 LOAD_CONST               3 (('Literal', 'Union', 'Mapping', 'Optional'))
                 34 IMPORT_NAME              5 (typing)
                 36 IMPORT_FROM              6 (Literal)
                 38 STORE_NAME               6 (Literal)
                 40 IMPORT_FROM              7 (Union)
                 42 STORE_NAME               7 (Union)
                 44 IMPORT_FROM              8 (Mapping)
                 46 STORE_NAME               8 (Mapping)
-                48 POP_TOP
-   
-     7          50 LOAD_CONST               0 (0)
-                52 LOAD_CONST               2 (None)
-                54 IMPORT_NAME              9 (pandas)
-                56 STORE_NAME              10 (pd)
-   
-     9          58 LOAD_CONST               0 (0)
-                60 LOAD_CONST               4 (('machine_data_def',))
-                62 IMPORT_NAME             11 (mdata.core)
-                64 IMPORT_FROM             12 (machine_data_def)
-                66 STORE_NAME              13 (mdd)
-                68 POP_TOP
-   
-    10          70 LOAD_CONST               0 (0)
-                72 LOAD_CONST               5 (('raw',))
-                74 IMPORT_NAME             11 (mdata.core)
-                76 IMPORT_FROM             14 (raw)
-                78 STORE_NAME              14 (raw)
+                48 IMPORT_FROM              9 (Optional)
+                50 STORE_NAME               9 (Optional)
+                52 POP_TOP
+   
+     7          54 LOAD_CONST               0 (0)
+                56 LOAD_CONST               2 (None)
+                58 IMPORT_NAME             10 (pandas)
+                60 STORE_NAME              11 (pd)
+   
+     9          62 LOAD_CONST               0 (0)
+                64 LOAD_CONST               4 (('raw', 'MDConcepts', 'MachineData'))
+                66 IMPORT_NAME             12 (mdata.core)
+                68 IMPORT_FROM             13 (raw)
+                70 STORE_NAME              13 (raw)
+                72 IMPORT_FROM             14 (MDConcepts)
+                74 STORE_NAME              14 (MDConcepts)
+                76 IMPORT_FROM             15 (MachineData)
+                78 STORE_NAME              15 (MachineData)
                 80 POP_TOP
    
-    11          82 LOAD_CONST               0 (0)
-                84 LOAD_CONST               6 (('metadata', 'annotations', 'registry'))
-                86 IMPORT_NAME             15 (mdata.core.extensions)
-                88 IMPORT_FROM             16 (metadata)
-                90 STORE_NAME              17 (metadata_ext)
-                92 IMPORT_FROM              1 (annotations)
-                94 STORE_NAME              18 (annotations_ext)
-                96 IMPORT_FROM             19 (registry)
-                98 STORE_NAME              19 (registry)
-               100 POP_TOP
-   
-    12         102 LOAD_CONST               0 (0)
-               104 LOAD_CONST               7 (('io_utils',))
-               106 IMPORT_NAME             20 (mdata.file_formats)
-               108 IMPORT_FROM             21 (io_utils)
-               110 STORE_NAME              21 (io_utils)
+    10          82 LOAD_CONST               0 (0)
+                84 LOAD_CONST               5 (('ObservationTypes',))
+                86 IMPORT_NAME             16 (mdata.core.shared_defs)
+                88 IMPORT_FROM             17 (ObservationTypes)
+                90 STORE_NAME              17 (ObservationTypes)
+                92 POP_TOP
+   
+    11          94 LOAD_CONST               0 (0)
+                96 LOAD_CONST               6 (('metadata', 'annotations', 'registry'))
+                98 IMPORT_NAME             18 (mdata.core.extensions)
+               100 IMPORT_FROM             19 (metadata)
+               102 STORE_NAME              20 (metadata_ext)
+               104 IMPORT_FROM              1 (annotations)
+               106 STORE_NAME              21 (annotations_ext)
+               108 IMPORT_FROM             22 (registry)
+               110 STORE_NAME              22 (registry)
                112 POP_TOP
    
-    13         114 LOAD_CONST               0 (0)
-               116 LOAD_CONST               8 (('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat'))
-               118 IMPORT_NAME             22 (mdata.file_formats.csv.shared)
-               120 IMPORT_FROM             23 (mk_filename_pair)
-               122 STORE_NAME              23 (mk_filename_pair)
-               124 IMPORT_FROM             24 (HeaderFormatLiterals)
-               126 STORE_NAME              24 (HeaderFormatLiterals)
-               128 IMPORT_FROM             25 (HeaderFileFormat)
-               130 STORE_NAME              25 (HeaderFileFormat)
-               132 POP_TOP
-   
-    14         134 LOAD_CONST               0 (0)
-               136 LOAD_CONST               9 (('DataSource',))
-               138 IMPORT_NAME             26 (mdata.file_formats.io_utils)
-               140 IMPORT_FROM             27 (DataSource)
-               142 STORE_NAME              27 (DataSource)
+    12         114 LOAD_CONST               0 (0)
+               116 LOAD_CONST               7 (('io_utils',))
+               118 IMPORT_NAME             23 (mdata.file_formats)
+               120 IMPORT_FROM             24 (io_utils)
+               122 STORE_NAME              24 (io_utils)
+               124 POP_TOP
+   
+    13         126 LOAD_CONST               0 (0)
+               128 LOAD_CONST               8 (('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat'))
+               130 IMPORT_NAME             25 (mdata.file_formats.csv.shared)
+               132 IMPORT_FROM             26 (mk_filename_pair)
+               134 STORE_NAME              26 (mk_filename_pair)
+               136 IMPORT_FROM             27 (HeaderFormatLiterals)
+               138 STORE_NAME              27 (HeaderFormatLiterals)
+               140 IMPORT_FROM             28 (HeaderFileFormat)
+               142 STORE_NAME              28 (HeaderFileFormat)
                144 POP_TOP
    
-    17         146 LOAD_CONST              30 (('source', 'DataSource', 'return', 'raw.RawDataType'))
-               148 LOAD_CONST              14 (<code object read_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 17>)
-               150 MAKE_FUNCTION            4 (annotations)
-               152 STORE_NAME              28 (read_raw_data)
-   
-    29         154 NOP
-   
-    30         156 NOP
-   
-    29         158 LOAD_CONST              31 ((True, 'infer'))
-               160 LOAD_CONST              32 (('header_source', 'DataSource', 'data_source', 'DataSource', 'header_format', "Union[Literal['infer'], HeaderFormatLiterals]", 'return', 'mdd.MachineData'))
-               162 LOAD_CONST              22 (<code object read_machine_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 29>)
-               164 MAKE_FUNCTION            5 (defaults, annotations)
-               166 STORE_NAME              29 (read_machine_data)
-   
-    80         168 NOP
-   
-    81         170 NOP
-   
-    80         172 LOAD_CONST              33 ((True, 'csv'))
-               174 LOAD_CONST              34 (('header_format', 'HeaderFormatLiterals', 'return', 'mdd.MachineData'))
-               176 LOAD_CONST              25 (<code object read_machine_data_canonical, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 80>)
-               178 MAKE_FUNCTION            5 (defaults, annotations)
-               180 STORE_NAME              30 (read_machine_data_canonical)
-   
-    86         182 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
-               184 LOAD_CONST              27 (<code object read_raw_header_json, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 86>)
-               186 MAKE_FUNCTION            4 (annotations)
-               188 STORE_NAME              31 (read_raw_header_json)
-   
-    90         190 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
-               192 LOAD_CONST              28 (<code object read_raw_header_yaml, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 90>)
-               194 MAKE_FUNCTION            4 (annotations)
-               196 STORE_NAME              32 (read_raw_header_yaml)
-   
-    94         198 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
-               200 LOAD_CONST              29 (<code object read_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 94>)
-               202 MAKE_FUNCTION            4 (annotations)
-               204 STORE_NAME              33 (read_raw_header)
-               206 LOAD_CONST               2 (None)
-               208 RETURN_VALUE
+    14         146 LOAD_CONST               0 (0)
+               148 LOAD_CONST               9 (('DataSource',))
+               150 IMPORT_NAME             29 (mdata.file_formats.io_utils)
+               152 IMPORT_FROM             30 (DataSource)
+               154 STORE_NAME              30 (DataSource)
+               156 POP_TOP
+   
+    17         158 LOAD_CONST              30 (('source', 'DataSource', 'return', 'pd.DataFrame'))
+               160 LOAD_CONST              14 (<code object read_raw_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 17>)
+               162 MAKE_FUNCTION            4 (annotations)
+               164 STORE_NAME              31 (read_raw_data)
+   
+    29         166 NOP
+   
+    30         168 NOP
+   
+    29         170 LOAD_CONST              31 ((True, 'infer'))
+               172 LOAD_CONST              32 (('header_source', 'DataSource', 'data_source', 'DataSource', 'header_format', "Union[Literal['infer'], HeaderFormatLiterals]", 'return', 'MachineData'))
+               174 LOAD_CONST              22 (<code object read_machine_data, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 29>)
+               176 MAKE_FUNCTION            5 (defaults, annotations)
+               178 STORE_NAME              32 (read_machine_data)
+   
+    81         180 NOP
+   
+    82         182 NOP
+   
+    81         184 LOAD_CONST              33 ((True, 'csv'))
+               186 LOAD_CONST              34 (('header_format', 'HeaderFormatLiterals', 'return', 'MachineData'))
+               188 LOAD_CONST              25 (<code object read_machine_data_canonical, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 81>)
+               190 MAKE_FUNCTION            5 (defaults, annotations)
+               192 STORE_NAME              33 (read_machine_data_canonical)
+   
+    87         194 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
+               196 LOAD_CONST              27 (<code object read_raw_header_json, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 87>)
+               198 MAKE_FUNCTION            4 (annotations)
+               200 STORE_NAME              34 (read_raw_header_json)
+   
+    91         202 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
+               204 LOAD_CONST              28 (<code object read_raw_header_yaml, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 91>)
+               206 MAKE_FUNCTION            4 (annotations)
+               208 STORE_NAME              35 (read_raw_header_yaml)
+   
+    95         210 LOAD_CONST              35 (('source', 'DataSource', 'return', 'raw.RawHeaderSpec'))
+               212 LOAD_CONST              29 (<code object read_raw_header, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 95>)
+               214 MAKE_FUNCTION            4 (annotations)
+               216 STORE_NAME              36 (read_raw_header)
+               218 LOAD_CONST               2 (None)
+               220 RETURN_VALUE
    consts
       0
       ('annotations',)
       None
-      ('Literal', 'Union', 'Mapping')
-      ('machine_data_def',)
-      ('raw',)
+      ('Literal', 'Union', 'Mapping', 'Optional')
+      ('raw', 'MDConcepts', 'MachineData')
+      ('ObservationTypes',)
       ('metadata', 'annotations', 'registry')
       ('io_utils',)
       ('mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat')
       ('DataSource',)
       'source'
       'DataSource'
       'return'
-      'raw.RawDataType'
+      'pd.DataFrame'
       code
          argcount  : 1
          nlocals   : 3
          stacksize : 6
          flags     : 16777219
          code
             0x97007401000000000000000000007c00740200000000000000000000a6
             020000ab02000000000000000072147c00a0020000000000000000000000
             000000000000000000a6000000ab0000000000000000007d007401000000
             000000000000007c00740600000000000000000000a6020000ab02000000
-            000000000072417409000000000000000000006a0500000000000000007c
+            000000000072437409000000000000000000006a0500000000000000007c
             00a6010000ab01000000000000000035007d01740d000000000000000000
-            006a0700000000000000007c01a6010000ab0100000000000000007d0264
-            0064006400a6020000ab02000000000000000001006e0b23003100730477
-            0278035900770101005900010001006e14740d000000000000000000006a
-            0700000000000000007c00a6010000ab0100000000000000007d02740d00
-            0000000000000000006a0800000000000000007c02741200000000000000
-            0000006a0a00000000000000006a0b000000000000000019000000000000
-            000000a6010000ab0100000000000000007c027412000000000000000000
-            006a0a00000000000000006a0b00000000000000003c0000007c025300
+            006a0700000000000000007c016401ac02a6020000ab0200000000000000
+            007d02640064006400a6020000ab02000000000000000001006e0b230031
+            007304770278035900770101005900010001006e16740d00000000000000
+            0000006a0700000000000000007c006401ac02a6020000ab020000000000
+            0000007d02740d000000000000000000006a0800000000000000007c0274
+            12000000000000000000006a0a0000000000000000190000000000000000
+            006403ac04a6020000ab0200000000000000007c02741200000000000000
+            0000006a0a00000000000000003c0000007c025300
           17           0 RESUME                   0
          
           18           2 LOAD_GLOBAL              1 (NULL + isinstance)
                       14 LOAD_FAST                0 (source)
                       16 LOAD_GLOBAL              2 (memoryview)
                       28 PRECALL                  2
                       32 CALL                     2
@@ -192,96 +198,104 @@
                       82 STORE_FAST               0 (source)
          
           20     >>   84 LOAD_GLOBAL              1 (NULL + isinstance)
                       96 LOAD_FAST                0 (source)
                       98 LOAD_GLOBAL              6 (bytes)
                      110 PRECALL                  2
                      114 CALL                     2
-                     124 POP_JUMP_FORWARD_IF_FALSE    65 (to 256)
+                     124 POP_JUMP_FORWARD_IF_FALSE    67 (to 260)
          
           21         126 LOAD_GLOBAL              9 (NULL + io)
                      138 LOAD_ATTR                5 (BytesIO)
                      148 LOAD_FAST                0 (source)
                      150 PRECALL                  1
                      154 CALL                     1
                      164 BEFORE_WITH
                      166 STORE_FAST               1 (buf)
          
           22         168 LOAD_GLOBAL             13 (NULL + pd)
                      180 LOAD_ATTR                7 (read_csv)
                      190 LOAD_FAST                1 (buf)
-                     192 PRECALL                  1
-                     196 CALL                     1
-                     206 STORE_FAST               2 (df)
-         
-          21         208 LOAD_CONST               0 (None)
-                     210 LOAD_CONST               0 (None)
-                     212 LOAD_CONST               0 (None)
-                     214 PRECALL                  2
-                     218 CALL                     2
-                     228 POP_TOP
-                     230 JUMP_FORWARD            11 (to 254)
-                 >>  232 PUSH_EXC_INFO
-                     234 WITH_EXCEPT_START
-                     236 POP_JUMP_FORWARD_IF_TRUE     4 (to 246)
-                     238 RERAISE                  2
-                 >>  240 COPY                     3
-                     242 POP_EXCEPT
-                     244 RERAISE                  1
-                 >>  246 POP_TOP
-                     248 POP_EXCEPT
-                     250 POP_TOP
-                     252 POP_TOP
-                 >>  254 JUMP_FORWARD            20 (to 296)
-         
-          24     >>  256 LOAD_GLOBAL             13 (NULL + pd)
-                     268 LOAD_ATTR                7 (read_csv)
-                     278 LOAD_FAST                0 (source)
-                     280 PRECALL                  1
-                     284 CALL                     1
-                     294 STORE_FAST               2 (df)
-         
-          25     >>  296 LOAD_GLOBAL             13 (NULL + pd)
-                     308 LOAD_ATTR                8 (to_datetime)
-                     318 LOAD_FAST                2 (df)
-                     320 LOAD_GLOBAL             18 (mdd)
-                     332 LOAD_ATTR               10 (MDConcepts)
-                     342 LOAD_ATTR               11 (Time)
-                     352 BINARY_SUBSCR
-                     362 PRECALL                  1
-                     366 CALL                     1
-                     376 LOAD_FAST                2 (df)
-                     378 LOAD_GLOBAL             18 (mdd)
-                     390 LOAD_ATTR               10 (MDConcepts)
-                     400 LOAD_ATTR               11 (Time)
-                     410 STORE_SUBSCR
+                     192 LOAD_CONST               1 (False)
+                     194 KW_NAMES                 2
+                     196 PRECALL                  2
+                     200 CALL                     2
+                     210 STORE_FAST               2 (df)
+         
+          21         212 LOAD_CONST               0 (None)
+                     214 LOAD_CONST               0 (None)
+                     216 LOAD_CONST               0 (None)
+                     218 PRECALL                  2
+                     222 CALL                     2
+                     232 POP_TOP
+                     234 JUMP_FORWARD            11 (to 258)
+                 >>  236 PUSH_EXC_INFO
+                     238 WITH_EXCEPT_START
+                     240 POP_JUMP_FORWARD_IF_TRUE     4 (to 250)
+                     242 RERAISE                  2
+                 >>  244 COPY                     3
+                     246 POP_EXCEPT
+                     248 RERAISE                  1
+                 >>  250 POP_TOP
+                     252 POP_EXCEPT
+                     254 POP_TOP
+                     256 POP_TOP
+                 >>  258 JUMP_FORWARD            22 (to 304)
+         
+          24     >>  260 LOAD_GLOBAL             13 (NULL + pd)
+                     272 LOAD_ATTR                7 (read_csv)
+                     282 LOAD_FAST                0 (source)
+                     284 LOAD_CONST               1 (False)
+                     286 KW_NAMES                 2
+                     288 PRECALL                  2
+                     292 CALL                     2
+                     302 STORE_FAST               2 (df)
+         
+          25     >>  304 LOAD_GLOBAL             13 (NULL + pd)
+                     316 LOAD_ATTR                8 (to_datetime)
+                     326 LOAD_FAST                2 (df)
+                     328 LOAD_GLOBAL             18 (MDConcepts)
+                     340 LOAD_ATTR               10 (Time)
+                     350 BINARY_SUBSCR
+                     360 LOAD_CONST               3 ('ISO8601')
+                     362 KW_NAMES                 4
+                     364 PRECALL                  2
+                     368 CALL                     2
+                     378 LOAD_FAST                2 (df)
+                     380 LOAD_GLOBAL             18 (MDConcepts)
+                     392 LOAD_ATTR               10 (Time)
+                     402 STORE_SUBSCR
          
-          26         414 LOAD_FAST                2 (df)
-                     416 RETURN_VALUE
+          26         406 LOAD_FAST                2 (df)
+                     408 RETURN_VALUE
          ExceptionTable:
-           166 to 206 -> 232 [1] lasti
-           232 to 238 -> 240 [3] lasti
-           246 to 246 -> 240 [3] lasti
+           166 to 210 -> 236 [1] lasti
+           236 to 242 -> 244 [3] lasti
+           250 to 250 -> 244 [3] lasti
          consts
             None
-         names      ('isinstance', 'memoryview', 'tobytes', 'bytes', 'io', 'BytesIO', 'pd', 'read_csv', 'to_datetime', 'mdd', 'MDConcepts', 'Time')
+            False
+            ('parse_dates',)
+            'ISO8601'
+            ('format',)
+         names      ('isinstance', 'memoryview', 'tobytes', 'bytes', 'io', 'BytesIO', 'pd', 'read_csv', 'to_datetime', 'MDConcepts', 'Time')
          varnames   ('source', 'buf', 'df')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_raw_data'
          firstlineno 17
-         lnotab 0x02012a0128012a012a0128ff300328017601
+         lnotab 0x02012a0128012a012a012cff30032c016601
       True
       'infer'
       'header_source'
       'data_source'
       'header_format'
       "Union[Literal['infer'], HeaderFormatLiterals]"
-      'mdd.MachineData'
+      'MachineData'
       code
          argcount  : 4
          nlocals   : 11
          stacksize : 4
          flags     : 16777219
          code
             0x870087039700890364016b020000000072427401000000000000000000
@@ -300,21 +314,22 @@
             010000ab01000000000000000001006e0a02007c05a6000000ab00000000
             0000000000010064007d068903740a000000000000000000006a0d000000
             00000000006b02000000007210741d000000000000000000008900a60100
             00ab0100000000000000007d066e3f8903740a000000000000000000006a
             0f00000000000000006b0200000000721074210000000000000000000089
             00a6010000ab0100000000000000007d066e1f8903740a00000000000000
             0000006a1100000000000000006b0200000000720f742500000000000000
-            0000008900a6010000ab0100000000000000007d067c027211640264076c
-            136d147d07010002007c077c06a6010000ab010000000000000000010074
-            2b000000000000000000007c01a6010000ab0100000000000000007d087c
-            027223640264086c136d167d090100640364096c066d177d0a010002007c
-            097c08a6010000ab010000000000000000010002007c0a7c067c08a60200
-            00ab02000000000000000001007431000000000000000000006a19000000
-            00000000007c087c06a6020000ab0200000000000000005300
+            0000008900a6010000ab0100000000000000007d067c0272157c0680024a
+            008201640264076c136d147d07010002007c077c06a6010000ab01000000
+            00000000000100742b000000000000000000007c01a6010000ab01000000
+            00000000007d087c027223640264086c136d167d090100640364096c066d
+            177d0a010002007c097c08a6010000ab010000000000000000010002007c
+            0a7c067c08a6020000ab0200000000000000000100743100000000000000
+            0000006a1900000000000000007c087c06a6020000ab0200000000000000
+            005300
                        0 MAKE_CELL                0 (header_source)
                        2 MAKE_CELL                3 (header_format)
          
           29           4 RESUME                   0
          
           31           6 LOAD_DEREF               3 (header_format)
                        8 LOAD_CONST               1 ('infer')
@@ -449,75 +464,80 @@
           63         590 LOAD_GLOBAL             37 (NULL + read_raw_header_yaml)
                      602 LOAD_DEREF               0 (header_source)
                      604 PRECALL                  1
                      608 CALL                     1
                      618 STORE_FAST               6 (raw_header)
          
           65     >>  620 LOAD_FAST                2 (validity_checking)
-                     622 POP_JUMP_FORWARD_IF_FALSE    17 (to 658)
+                     622 POP_JUMP_FORWARD_IF_FALSE    21 (to 666)
          
-          66         624 LOAD_CONST               2 (1)
-                     626 LOAD_CONST               7 (('check_if_valid_raw_header',))
-                     628 IMPORT_NAME             19 (checking)
-                     630 IMPORT_FROM             20 (check_if_valid_raw_header)
-                     632 STORE_FAST               7 (check_if_valid_raw_header)
-                     634 POP_TOP
-         
-          67         636 PUSH_NULL
-                     638 LOAD_FAST                7 (check_if_valid_raw_header)
-                     640 LOAD_FAST                6 (raw_header)
-                     642 PRECALL                  1
-                     646 CALL                     1
-                     656 POP_TOP
-         
-          69     >>  658 LOAD_GLOBAL             43 (NULL + read_raw_data)
-                     670 LOAD_FAST                1 (data_source)
-                     672 PRECALL                  1
-                     676 CALL                     1
-                     686 STORE_FAST               8 (raw_data)
-         
-          71         688 LOAD_FAST                2 (validity_checking)
-                     690 POP_JUMP_FORWARD_IF_FALSE    35 (to 762)
-         
-          72         692 LOAD_CONST               2 (1)
-                     694 LOAD_CONST               8 (('check_if_valid_raw_data',))
-                     696 IMPORT_NAME             19 (checking)
-                     698 IMPORT_FROM             22 (check_if_valid_raw_data)
-                     700 STORE_FAST               9 (check_if_valid_raw_data)
-                     702 POP_TOP
-         
-          73         704 LOAD_CONST               3 (0)
-                     706 LOAD_CONST               9 (('check_header_data_compatibility',))
-                     708 IMPORT_NAME              6 (mdata.file_formats.validity_checking_utils)
-                     710 IMPORT_FROM             23 (check_header_data_compatibility)
-                     712 STORE_FAST              10 (check_header_data_compatibility)
-                     714 POP_TOP
-         
-          74         716 PUSH_NULL
-                     718 LOAD_FAST                9 (check_if_valid_raw_data)
-                     720 LOAD_FAST                8 (raw_data)
-                     722 PRECALL                  1
-                     726 CALL                     1
-                     736 POP_TOP
-         
-          75         738 PUSH_NULL
-                     740 LOAD_FAST               10 (check_header_data_compatibility)
-                     742 LOAD_FAST                6 (raw_header)
-                     744 LOAD_FAST                8 (raw_data)
-                     746 PRECALL                  2
-                     750 CALL                     2
-                     760 POP_TOP
-         
-          77     >>  762 LOAD_GLOBAL             49 (NULL + raw)
-                     774 LOAD_ATTR               25 (create_machine_data_from_raw)
-                     784 LOAD_FAST                8 (raw_data)
-                     786 LOAD_FAST                6 (raw_header)
-                     788 PRECALL                  2
-                     792 CALL                     2
-                     802 RETURN_VALUE
+          66         624 LOAD_FAST                6 (raw_header)
+                     626 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 632)
+                     628 LOAD_ASSERTION_ERROR
+                     630 RAISE_VARARGS            1
+         
+          67     >>  632 LOAD_CONST               2 (1)
+                     634 LOAD_CONST               7 (('check_if_valid_raw_header',))
+                     636 IMPORT_NAME             19 (checking)
+                     638 IMPORT_FROM             20 (check_if_valid_raw_header)
+                     640 STORE_FAST               7 (check_if_valid_raw_header)
+                     642 POP_TOP
+         
+          68         644 PUSH_NULL
+                     646 LOAD_FAST                7 (check_if_valid_raw_header)
+                     648 LOAD_FAST                6 (raw_header)
+                     650 PRECALL                  1
+                     654 CALL                     1
+                     664 POP_TOP
+         
+          70     >>  666 LOAD_GLOBAL             43 (NULL + read_raw_data)
+                     678 LOAD_FAST                1 (data_source)
+                     680 PRECALL                  1
+                     684 CALL                     1
+                     694 STORE_FAST               8 (raw_data)
+         
+          72         696 LOAD_FAST                2 (validity_checking)
+                     698 POP_JUMP_FORWARD_IF_FALSE    35 (to 770)
+         
+          73         700 LOAD_CONST               2 (1)
+                     702 LOAD_CONST               8 (('check_if_valid_raw_data',))
+                     704 IMPORT_NAME             19 (checking)
+                     706 IMPORT_FROM             22 (check_if_valid_raw_data)
+                     708 STORE_FAST               9 (check_if_valid_raw_data)
+                     710 POP_TOP
+         
+          74         712 LOAD_CONST               3 (0)
+                     714 LOAD_CONST               9 (('check_header_data_compatibility',))
+                     716 IMPORT_NAME              6 (mdata.file_formats.validity_checking_utils)
+                     718 IMPORT_FROM             23 (check_header_data_compatibility)
+                     720 STORE_FAST              10 (check_header_data_compatibility)
+                     722 POP_TOP
+         
+          75         724 PUSH_NULL
+                     726 LOAD_FAST                9 (check_if_valid_raw_data)
+                     728 LOAD_FAST                8 (raw_data)
+                     730 PRECALL                  1
+                     734 CALL                     1
+                     744 POP_TOP
+         
+          76         746 PUSH_NULL
+                     748 LOAD_FAST               10 (check_header_data_compatibility)
+                     750 LOAD_FAST                6 (raw_header)
+                     752 LOAD_FAST                8 (raw_data)
+                     754 PRECALL                  2
+                     758 CALL                     2
+                     768 POP_TOP
+         
+          78     >>  770 LOAD_GLOBAL             49 (NULL + raw)
+                     782 LOAD_ATTR               25 (create_machine_data_from_raw)
+                     792 LOAD_FAST                8 (raw_data)
+                     794 LOAD_FAST                6 (raw_header)
+                     796 PRECALL                  2
+                     800 CALL                     2
+                     810 RETURN_VALUE
          consts
             None
             'infer'
             1
             0
             ('UnsupportedHeaderFileFormat',)
             code
@@ -629,40 +649,40 @@
          freevars   ()
          cellvars   ('header_source', 'header_format')
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_machine_data'
          firstlineno 29
          lnotab
             0x060236015a0112010c01160104010c0b3401280114012c022002140204
-            01200120012001200120011e0204010c0116021e0204010c010c01160118
-            02
+            01200120012001200120011e02040108010c0116021e0204010c010c0116
+            011802
       'csv'
       'HeaderFormatLiterals'
       code
          argcount  : 3
          nlocals   : 5
          stacksize : 6
          flags     : 16777219
          code
             0x97007401000000000000000000007c007c02ac01a6020000ab02000000
             00000000005c0200007d037d047403000000000000000000007c037c047c
             017c02ac02a6040000ab0400000000000000005300
-          80           0 RESUME                   0
+          81           0 RESUME                   0
          
-          82           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
+          83           2 LOAD_GLOBAL              1 (NULL + mk_filename_pair)
                       14 LOAD_FAST                0 (basepath)
                       16 LOAD_FAST                2 (header_format)
                       18 KW_NAMES                 1
                       20 PRECALL                  2
                       24 CALL                     2
                       34 UNPACK_SEQUENCE          2
                       38 STORE_FAST               3 (header_file)
                       40 STORE_FAST               4 (data_file)
          
-          83          42 LOAD_GLOBAL              3 (NULL + read_machine_data)
+          84          42 LOAD_GLOBAL              3 (NULL + read_machine_data)
                       54 LOAD_FAST                3 (header_file)
                       56 LOAD_FAST                4 (data_file)
                       58 LOAD_FAST                1 (validity_checking)
                       60 LOAD_FAST                2 (header_format)
                       62 KW_NAMES                 2
                       64 PRECALL                  4
                       68 CALL                     4
@@ -673,446 +693,444 @@
             ('validity_checking', 'header_format')
          names      ('mk_filename_pair', 'read_machine_data')
          varnames   ('basepath', 'validity_checking', 'header_format', 'header_file', 'data_file')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_machine_data_canonical'
-         firstlineno 80
+         firstlineno 81
          lnotab 0x02022801
       'raw.RawHeaderSpec'
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 3
          flags     : 16777219
          code
             0x97007401000000000000000000006a0100000000000000007c00a60100
             00ab0100000000000000005300
-          86           0 RESUME                   0
+          87           0 RESUME                   0
          
-          87           2 LOAD_GLOBAL              1 (NULL + io_utils)
+          88           2 LOAD_GLOBAL              1 (NULL + io_utils)
                       14 LOAD_ATTR                1 (read_json_dict_from)
                       24 LOAD_FAST                0 (source)
                       26 PRECALL                  1
                       30 CALL                     1
                       40 RETURN_VALUE
          consts
             None
          names      ('io_utils', 'read_json_dict_from')
          varnames   ('source',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_raw_header_json'
-         firstlineno 86
+         firstlineno 87
          lnotab 0x0201
       code
          argcount  : 1
          nlocals   : 1
          stacksize : 3
          flags     : 16777219
          code
             0x97007401000000000000000000006a0100000000000000007c00a60100
             00ab0100000000000000005300
-          90           0 RESUME                   0
+          91           0 RESUME                   0
          
-          91           2 LOAD_GLOBAL              1 (NULL + io_utils)
+          92           2 LOAD_GLOBAL              1 (NULL + io_utils)
                       14 LOAD_ATTR                1 (read_yaml_dict_from)
                       24 LOAD_FAST                0 (source)
                       26 PRECALL                  1
                       30 CALL                     1
                       40 RETURN_VALUE
          consts
             None
          names      ('io_utils', 'read_yaml_dict_from')
          varnames   ('source',)
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_raw_header_yaml'
-         firstlineno 90
+         firstlineno 91
          lnotab 0x0201
       code
          argcount  : 1
          nlocals   : 13
          stacksize : 6
          flags     : 16777219
          code
             0x870d97007401000000000000000000006a010000000000000000a60000
             00ab0000000000000000008a0d6900890d64013c0000006900890d64023c
             000000640b880d66016405840c7d017405000000000000000000006a0300
-            000000000000007c00a6010000ab010000000000000000440090015d7d7d
+            000000000000007c00a6010000ab010000000000000000440090015d737d
             027c026406190000000000000000007d037c037408000000000000000000
             006a0500000000000000006b02000000007217640784007c026408640085
             02190000000000000000004400a6000000ab000000000000000000890d64
-            093c0000007c03740c000000000000000000006a0700000000000000006a
-            080000000000000000740c000000000000000000006a0700000000000000
-            006a0900000000000000007414000000000000000000006a050000000000
-            00000068037600723002007c017c02a6010000ab0100000000000000007d
-            047c02a00b00000000000000000000000000000000000000006406a60100
-            00ab0100000000000000007d05640a84007c024400a6000000ab00000000
-            00000000007c047c053c0000008c917c037418000000000000000000006a
-            0500000000000000006b020000000072dc7c02a00b000000000000000000
-            00000000000000000000006406a6010000ab01000000000000000001007c
-            02a00b00000000000000000000000000000000000000006406a6010000ab
-            0100000000000000007d0602007c017c02a6010000ab0100000000000000
-            007d077c077c02a00b000000000000000000000000000000000000000064
-            06a6010000ab010000000000000000190000000000000000007d087c02a0
-            0b00000000000000000000000000000000000000006406a6010000ab0100
-            000000000000007d097c02a00b0000000000000000000000000000000000
-            0000006406a6010000ab0100000000000000007d0a741b00000000000000
-            0000007c08a6010000ab01000000000000000044005d525c0200007d0b7d
-            0c741d000000000000000000007c0ca6010000ab01000000000000000074
-            1e00000000000000000000750072117c097c0c6b0200000000720b7c097c
-            067c0a690169017c087c0b3c00000001006e277421000000000000000000
-            007c0c742200000000000000000000a6020000ab02000000000000000072
-            117c097c0c7600720d7c0a7c0c7c09190000000000000000007c063c0000
-            0001006e018c5390018c7f890d5300
+            093c0000007c03740c000000000000000000006a07000000000000000074
+            0c000000000000000000006a080000000000000000741200000000000000
+            0000006a05000000000000000068037600723002007c017c02a6010000ab
+            0100000000000000007d047c02a00a000000000000000000000000000000
+            00000000006406a6010000ab0100000000000000007d05640a84007c0244
+            00a6000000ab0000000000000000007c047c053c0000008c877c03741600
+            0000000000000000006a0500000000000000006b020000000072dc7c02a0
+            0a00000000000000000000000000000000000000006406a6010000ab0100
+            0000000000000001007c02a00a0000000000000000000000000000000000
+            0000006406a6010000ab0100000000000000007d0602007c017c02a60100
+            00ab0100000000000000007d077c077c02a00a0000000000000000000000
+            0000000000000000006406a6010000ab0100000000000000001900000000
+            00000000007d087c02a00a00000000000000000000000000000000000000
+            006406a6010000ab0100000000000000007d097c02a00a00000000000000
+            000000000000000000000000006406a6010000ab0100000000000000007d
+            0a7419000000000000000000007c08a6010000ab01000000000000000044
+            005d525c0200007d0b7d0c741b000000000000000000007c0ca6010000ab
+            010000000000000000741c00000000000000000000750072117c097c0c6b
+            0200000000720b7c097c067c0a690169017c087c0b3c00000001006e2774
+            1f000000000000000000007c0c742000000000000000000000a6020000ab
+            02000000000000000072117c097c0c7600720d7c0a7c0c7c091900000000
+            00000000007c063c00000001006e018c5390018c75890d5300
                        0 MAKE_CELL               13 (result)
          
-          94           2 RESUME                   0
+          95           2 RESUME                   0
          
-          95           4 LOAD_GLOBAL              1 (NULL + raw)
+          96           4 LOAD_GLOBAL              1 (NULL + raw)
                       16 LOAD_ATTR                1 (RawHeaderSpec)
                       26 PRECALL                  0
                       30 CALL                     0
                       40 STORE_DEREF             13 (result)
          
-          96          42 BUILD_MAP                0
+          97          42 BUILD_MAP                0
                       44 LOAD_DEREF              13 (result)
                       46 LOAD_CONST               1 ('event_specs')
                       48 STORE_SUBSCR
          
-          97          52 BUILD_MAP                0
+          98          52 BUILD_MAP                0
                       54 LOAD_DEREF              13 (result)
                       56 LOAD_CONST               2 ('measurement_specs')
                       58 STORE_SUBSCR
          
-          99          62 LOAD_CONST              11 (('row', 'list[str]'))
+         100          62 LOAD_CONST              11 (('row', 'list[str]'))
                       64 LOAD_CLOSURE            13 (result)
                       66 BUILD_TUPLE              1
-                      68 LOAD_CONST               5 (<code object get_type_spec_dict, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 99>)
+                      68 LOAD_CONST               5 (<code object get_type_spec_dict, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 100>)
                       70 MAKE_FUNCTION           12 (annotations, closure)
                       72 STORE_FAST               1 (get_type_spec_dict)
          
-         114          74 LOAD_GLOBAL              5 (NULL + io_utils)
+         116          74 LOAD_GLOBAL              5 (NULL + io_utils)
                       86 LOAD_ATTR                3 (read_csv_lines_from)
                       96 LOAD_FAST                0 (source)
                       98 PRECALL                  1
                      102 CALL                     1
                      112 GET_ITER
                  >>  114 EXTENDED_ARG             1
-                     116 FOR_ITER               381 (to 880)
+                     116 FOR_ITER               371 (to 860)
                      118 STORE_FAST               2 (row)
          
-         115         120 LOAD_FAST                2 (row)
+         117         120 LOAD_FAST                2 (row)
                      122 LOAD_CONST               6 (0)
                      124 BINARY_SUBSCR
                      134 STORE_FAST               3 (statement_identifier)
          
-         116         136 LOAD_FAST                3 (statement_identifier)
+         118         136 LOAD_FAST                3 (statement_identifier)
                      138 LOAD_GLOBAL              8 (registry)
                      150 LOAD_ATTR                5 (CSV_KEY)
                      160 COMPARE_OP               2 (==)
                      166 POP_JUMP_FORWARD_IF_FALSE    23 (to 214)
          
-         117         168 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 117>)
+         119         168 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 119>)
                      170 MAKE_FUNCTION            0
                      172 LOAD_FAST                2 (row)
                      174 LOAD_CONST               8 (1)
                      176 LOAD_CONST               0 (None)
                      178 BUILD_SLICE              2
                      180 BINARY_SUBSCR
                      190 GET_ITER
                      192 PRECALL                  0
                      196 CALL                     0
                      206 LOAD_DEREF              13 (result)
                      208 LOAD_CONST               9 ('extensions')
                      210 STORE_SUBSCR
          
-         118     >>  214 LOAD_FAST                3 (statement_identifier)
-                     216 LOAD_GLOBAL             12 (mdd)
-                     228 LOAD_ATTR                7 (ObservationTypes)
-                     238 LOAD_ATTR                8 (E)
-                     248 LOAD_GLOBAL             12 (mdd)
-                     260 LOAD_ATTR                7 (ObservationTypes)
-                     270 LOAD_ATTR                9 (M)
-                     280 LOAD_GLOBAL             20 (annotations_ext)
-                     292 LOAD_ATTR                5 (CSV_KEY)
-                     302 BUILD_SET                3
-                     304 CONTAINS_OP              0
-                     306 POP_JUMP_FORWARD_IF_FALSE    48 (to 404)
-         
-         119         308 PUSH_NULL
-                     310 LOAD_FAST                1 (get_type_spec_dict)
-                     312 LOAD_FAST                2 (row)
-                     314 PRECALL                  1
-                     318 CALL                     1
-                     328 STORE_FAST               4 (specs)
-         
-         120         330 LOAD_FAST                2 (row)
-                     332 LOAD_METHOD             11 (pop)
-                     354 LOAD_CONST               6 (0)
-                     356 PRECALL                  1
-                     360 CALL                     1
-                     370 STORE_FAST               5 (label)
-         
-         121         372 LOAD_CONST              10 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 121>)
-                     374 MAKE_FUNCTION            0
-                     376 LOAD_FAST                2 (row)
-                     378 GET_ITER
-                     380 PRECALL                  0
-                     384 CALL                     0
-                     394 LOAD_FAST                4 (specs)
-                     396 LOAD_FAST                5 (label)
-                     398 STORE_SUBSCR
-                     402 JUMP_BACKWARD          145 (to 114)
-         
-         122     >>  404 LOAD_FAST                3 (statement_identifier)
-                     406 LOAD_GLOBAL             24 (metadata_ext)
-                     418 LOAD_ATTR                5 (CSV_KEY)
-                     428 COMPARE_OP               2 (==)
-                     434 POP_JUMP_FORWARD_IF_FALSE   220 (to 876)
-         
-         123         436 LOAD_FAST                2 (row)
-                     438 LOAD_METHOD             11 (pop)
-                     460 LOAD_CONST               6 (0)
-                     462 PRECALL                  1
-                     466 CALL                     1
-                     476 POP_TOP
-         
-         124         478 LOAD_FAST                2 (row)
-                     480 LOAD_METHOD             11 (pop)
-                     502 LOAD_CONST               6 (0)
-                     504 PRECALL                  1
-                     508 CALL                     1
-                     518 STORE_FAST               6 (key)
+         120     >>  214 LOAD_FAST                3 (statement_identifier)
+                     216 LOAD_GLOBAL             12 (ObservationTypes)
+                     228 LOAD_ATTR                7 (E)
+                     238 LOAD_GLOBAL             12 (ObservationTypes)
+                     250 LOAD_ATTR                8 (M)
+                     260 LOAD_GLOBAL             18 (annotations_ext)
+                     272 LOAD_ATTR                5 (CSV_KEY)
+                     282 BUILD_SET                3
+                     284 CONTAINS_OP              0
+                     286 POP_JUMP_FORWARD_IF_FALSE    48 (to 384)
+         
+         121         288 PUSH_NULL
+                     290 LOAD_FAST                1 (get_type_spec_dict)
+                     292 LOAD_FAST                2 (row)
+                     294 PRECALL                  1
+                     298 CALL                     1
+                     308 STORE_FAST               4 (specs)
+         
+         122         310 LOAD_FAST                2 (row)
+                     312 LOAD_METHOD             10 (pop)
+                     334 LOAD_CONST               6 (0)
+                     336 PRECALL                  1
+                     340 CALL                     1
+                     350 STORE_FAST               5 (label)
+         
+         123         352 LOAD_CONST              10 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\csv\importing.py", line 123>)
+                     354 MAKE_FUNCTION            0
+                     356 LOAD_FAST                2 (row)
+                     358 GET_ITER
+                     360 PRECALL                  0
+                     364 CALL                     0
+                     374 LOAD_FAST                4 (specs)
+                     376 LOAD_FAST                5 (label)
+                     378 STORE_SUBSCR
+                     382 JUMP_BACKWARD          135 (to 114)
+         
+         124     >>  384 LOAD_FAST                3 (statement_identifier)
+                     386 LOAD_GLOBAL             22 (metadata_ext)
+                     398 LOAD_ATTR                5 (CSV_KEY)
+                     408 COMPARE_OP               2 (==)
+                     414 POP_JUMP_FORWARD_IF_FALSE   220 (to 856)
+         
+         125         416 LOAD_FAST                2 (row)
+                     418 LOAD_METHOD             10 (pop)
+                     440 LOAD_CONST               6 (0)
+                     442 PRECALL                  1
+                     446 CALL                     1
+                     456 POP_TOP
+         
+         126         458 LOAD_FAST                2 (row)
+                     460 LOAD_METHOD             10 (pop)
+                     482 LOAD_CONST               6 (0)
+                     484 PRECALL                  1
+                     488 CALL                     1
+                     498 STORE_FAST               6 (key)
+         
+         127         500 PUSH_NULL
+                     502 LOAD_FAST                1 (get_type_spec_dict)
+                     504 LOAD_FAST                2 (row)
+                     506 PRECALL                  1
+                     510 CALL                     1
+                     520 STORE_FAST               7 (spec_dict)
          
-         125         520 PUSH_NULL
-                     522 LOAD_FAST                1 (get_type_spec_dict)
+         128         522 LOAD_FAST                7 (spec_dict)
                      524 LOAD_FAST                2 (row)
-                     526 PRECALL                  1
-                     530 CALL                     1
-                     540 STORE_FAST               7 (spec_dict)
-         
-         126         542 LOAD_FAST                7 (spec_dict)
-                     544 LOAD_FAST                2 (row)
-                     546 LOAD_METHOD             11 (pop)
-                     568 LOAD_CONST               6 (0)
-                     570 PRECALL                  1
-                     574 CALL                     1
-                     584 BINARY_SUBSCR
-                     594 STORE_FAST               8 (features)
-         
-         127         596 LOAD_FAST                2 (row)
-                     598 LOAD_METHOD             11 (pop)
-                     620 LOAD_CONST               6 (0)
-                     622 PRECALL                  1
-                     626 CALL                     1
-                     636 STORE_FAST               9 (target_feature)
-         
-         128         638 LOAD_FAST                2 (row)
-                     640 LOAD_METHOD             11 (pop)
-                     662 LOAD_CONST               6 (0)
-                     664 PRECALL                  1
-                     668 CALL                     1
-                     678 STORE_FAST              10 (value)
-         
-         129         680 LOAD_GLOBAL             27 (NULL + enumerate)
-                     692 LOAD_FAST                8 (features)
-                     694 PRECALL                  1
-                     698 CALL                     1
-                     708 GET_ITER
-                 >>  710 FOR_ITER                82 (to 876)
-                     712 UNPACK_SEQUENCE          2
-                     716 STORE_FAST              11 (j)
-                     718 STORE_FAST              12 (f_spec)
-         
-         130         720 LOAD_GLOBAL             29 (NULL + type)
-                     732 LOAD_FAST               12 (f_spec)
-                     734 PRECALL                  1
-                     738 CALL                     1
-                     748 LOAD_GLOBAL             30 (str)
-                     760 IS_OP                    0
-                     762 POP_JUMP_FORWARD_IF_FALSE    17 (to 798)
-                     764 LOAD_FAST                9 (target_feature)
-                     766 LOAD_FAST               12 (f_spec)
-                     768 COMPARE_OP               2 (==)
-                     774 POP_JUMP_FORWARD_IF_FALSE    11 (to 798)
-         
-         131         776 LOAD_FAST                9 (target_feature)
-                     778 LOAD_FAST                6 (key)
-                     780 LOAD_FAST               10 (value)
-                     782 BUILD_MAP                1
-                     784 BUILD_MAP                1
-                     786 LOAD_FAST                8 (features)
-                     788 LOAD_FAST               11 (j)
-                     790 STORE_SUBSCR
-         
-         132         794 POP_TOP
-                     796 JUMP_FORWARD            39 (to 876)
-         
-         133     >>  798 LOAD_GLOBAL             33 (NULL + isinstance)
-                     810 LOAD_FAST               12 (f_spec)
-                     812 LOAD_GLOBAL             34 (Mapping)
-                     824 PRECALL                  2
-                     828 CALL                     2
-                     838 POP_JUMP_FORWARD_IF_FALSE    17 (to 874)
-                     840 LOAD_FAST                9 (target_feature)
-                     842 LOAD_FAST               12 (f_spec)
-                     844 CONTAINS_OP              0
-                     846 POP_JUMP_FORWARD_IF_FALSE    13 (to 874)
-         
-         134         848 LOAD_FAST               10 (value)
-                     850 LOAD_FAST               12 (f_spec)
-                     852 LOAD_FAST                9 (target_feature)
-                     854 BINARY_SUBSCR
-                     864 LOAD_FAST                6 (key)
-                     866 STORE_SUBSCR
-         
-         135         870 POP_TOP
-                     872 JUMP_FORWARD             1 (to 876)
-                 >>  874 JUMP_BACKWARD           83 (to 710)
-                 >>  876 EXTENDED_ARG             1
-                     878 JUMP_BACKWARD          383 (to 114)
+                     526 LOAD_METHOD             10 (pop)
+                     548 LOAD_CONST               6 (0)
+                     550 PRECALL                  1
+                     554 CALL                     1
+                     564 BINARY_SUBSCR
+                     574 STORE_FAST               8 (features)
+         
+         129         576 LOAD_FAST                2 (row)
+                     578 LOAD_METHOD             10 (pop)
+                     600 LOAD_CONST               6 (0)
+                     602 PRECALL                  1
+                     606 CALL                     1
+                     616 STORE_FAST               9 (target_feature)
+         
+         130         618 LOAD_FAST                2 (row)
+                     620 LOAD_METHOD             10 (pop)
+                     642 LOAD_CONST               6 (0)
+                     644 PRECALL                  1
+                     648 CALL                     1
+                     658 STORE_FAST              10 (value)
+         
+         131         660 LOAD_GLOBAL             25 (NULL + enumerate)
+                     672 LOAD_FAST                8 (features)
+                     674 PRECALL                  1
+                     678 CALL                     1
+                     688 GET_ITER
+                 >>  690 FOR_ITER                82 (to 856)
+                     692 UNPACK_SEQUENCE          2
+                     696 STORE_FAST              11 (j)
+                     698 STORE_FAST              12 (f_spec)
+         
+         132         700 LOAD_GLOBAL             27 (NULL + type)
+                     712 LOAD_FAST               12 (f_spec)
+                     714 PRECALL                  1
+                     718 CALL                     1
+                     728 LOAD_GLOBAL             28 (str)
+                     740 IS_OP                    0
+                     742 POP_JUMP_FORWARD_IF_FALSE    17 (to 778)
+                     744 LOAD_FAST                9 (target_feature)
+                     746 LOAD_FAST               12 (f_spec)
+                     748 COMPARE_OP               2 (==)
+                     754 POP_JUMP_FORWARD_IF_FALSE    11 (to 778)
+         
+         133         756 LOAD_FAST                9 (target_feature)
+                     758 LOAD_FAST                6 (key)
+                     760 LOAD_FAST               10 (value)
+                     762 BUILD_MAP                1
+                     764 BUILD_MAP                1
+                     766 LOAD_FAST                8 (features)
+                     768 LOAD_FAST               11 (j)
+                     770 STORE_SUBSCR
+         
+         134         774 POP_TOP
+                     776 JUMP_FORWARD            39 (to 856)
+         
+         135     >>  778 LOAD_GLOBAL             31 (NULL + isinstance)
+                     790 LOAD_FAST               12 (f_spec)
+                     792 LOAD_GLOBAL             32 (Mapping)
+                     804 PRECALL                  2
+                     808 CALL                     2
+                     818 POP_JUMP_FORWARD_IF_FALSE    17 (to 854)
+                     820 LOAD_FAST                9 (target_feature)
+                     822 LOAD_FAST               12 (f_spec)
+                     824 CONTAINS_OP              0
+                     826 POP_JUMP_FORWARD_IF_FALSE    13 (to 854)
+         
+         136         828 LOAD_FAST               10 (value)
+                     830 LOAD_FAST               12 (f_spec)
+                     832 LOAD_FAST                9 (target_feature)
+                     834 BINARY_SUBSCR
+                     844 LOAD_FAST                6 (key)
+                     846 STORE_SUBSCR
+         
+         137         850 POP_TOP
+                     852 JUMP_FORWARD             1 (to 856)
+                 >>  854 JUMP_BACKWARD           83 (to 690)
+                 >>  856 EXTENDED_ARG             1
+                     858 JUMP_BACKWARD          373 (to 114)
          
-         136     >>  880 LOAD_DEREF              13 (result)
-                     882 RETURN_VALUE
+         138     >>  860 LOAD_DEREF              13 (result)
+                     862 RETURN_VALUE
          consts
             None
             'event_specs'
             'measurement_specs'
             'row'
             'list[str]'
             code
                argcount  : 1
                nlocals   : 4
                stacksize : 4
                flags     : 16777235
                code
                   0x9501970069007d017c00a0000000000000000000000000000000000000
                   0000006401a6010000ab0100000000000000007d027c0274020000000000
-                  00000000006a0200000000000000006a0300000000000000006b02000000
-                  00720989046402190000000000000000007d016e747c0274020000000000
-                  00000000006a0200000000000000006a0400000000000000006b02000000
-                  00720989046403190000000000000000007d016e567c02740a0000000000
-                  00000000006a0600000000000000006b02000000007246740a0000000000
-                  00000000006a0700000000000000006a0800000000000000007c00a00000
-                  000000000000000000000000000000000000006401a6010000ab01000000
-                  0000000000190000000000000000007d0364048904760172086900690064
-                  059c02890464043c00000089046404190000000000000000007d017c017c
-                  03190000000000000000007d017c015300
+                  00000000006a0200000000000000006b0200000000720989046402190000
+                  000000000000007d016e6f7c027402000000000000000000006a03000000
+                  00000000006b0200000000720989046403190000000000000000007d016e
+                  567c027408000000000000000000006a0500000000000000006b02000000
+                  0072467408000000000000000000006a0600000000000000006a07000000
+                  00000000007c00a000000000000000000000000000000000000000000064
+                  01a6010000ab010000000000000000190000000000000000007d03640489
+                  04760172086900690064059c02890464043c000000890464041900000000
+                  00000000007d017c017c03190000000000000000007d017c015300
                              0 COPY_FREE_VARS           1
                
-                99           2 RESUME                   0
+               100           2 RESUME                   0
                
-               100           4 BUILD_MAP                0
+               101           4 BUILD_MAP                0
                              6 STORE_FAST               1 (subdict)
                
-               101           8 LOAD_FAST                0 (row)
+               102           8 LOAD_FAST                0 (row)
                             10 LOAD_METHOD              0 (pop)
                             32 LOAD_CONST               1 (0)
                             34 PRECALL                  1
                             38 CALL                     1
                             48 STORE_FAST               2 (type_spec_key)
                
-               102          50 LOAD_FAST                2 (type_spec_key)
-                            52 LOAD_GLOBAL              2 (mdd)
-                            64 LOAD_ATTR                2 (ObservationTypes)
-                            74 LOAD_ATTR                3 (E)
-                            84 COMPARE_OP               2 (==)
-                            90 POP_JUMP_FORWARD_IF_FALSE     9 (to 110)
-               
-               103          92 LOAD_DEREF               4 (result)
-                            94 LOAD_CONST               2 ('event_specs')
-                            96 BINARY_SUBSCR
-                           106 STORE_FAST               1 (subdict)
-                           108 JUMP_FORWARD           116 (to 342)
-               
-               104     >>  110 LOAD_FAST                2 (type_spec_key)
-                           112 LOAD_GLOBAL              2 (mdd)
-                           124 LOAD_ATTR                2 (ObservationTypes)
-                           134 LOAD_ATTR                4 (M)
-                           144 COMPARE_OP               2 (==)
-                           150 POP_JUMP_FORWARD_IF_FALSE     9 (to 170)
-               
-               105         152 LOAD_DEREF               4 (result)
-                           154 LOAD_CONST               3 ('measurement_specs')
-                           156 BINARY_SUBSCR
-                           166 STORE_FAST               1 (subdict)
-                           168 JUMP_FORWARD            86 (to 342)
-               
-               106     >>  170 LOAD_FAST                2 (type_spec_key)
-                           172 LOAD_GLOBAL             10 (annotations_ext)
-                           184 LOAD_ATTR                6 (CSV_KEY)
-                           194 COMPARE_OP               2 (==)
-                           200 POP_JUMP_FORWARD_IF_FALSE    70 (to 342)
-               
-               107         202 LOAD_GLOBAL             10 (annotations_ext)
-                           214 LOAD_ATTR                7 (AnnotationTypes)
-                           224 LOAD_ATTR                8 (long_names)
-                           234 LOAD_FAST                0 (row)
-                           236 LOAD_METHOD              0 (pop)
-                           258 LOAD_CONST               1 (0)
-                           260 PRECALL                  1
-                           264 CALL                     1
-                           274 BINARY_SUBSCR
-                           284 STORE_FAST               3 (ioro)
-               
-               108         286 LOAD_CONST               4 ('annotation_specs')
-                           288 LOAD_DEREF               4 (result)
-                           290 CONTAINS_OP              1
-                           292 POP_JUMP_FORWARD_IF_FALSE     8 (to 310)
-               
-               109         294 BUILD_MAP                0
-                           296 BUILD_MAP                0
-                           298 LOAD_CONST               5 (('input', 'output'))
-                           300 BUILD_CONST_KEY_MAP      2
-                           302 LOAD_DEREF               4 (result)
-                           304 LOAD_CONST               4 ('annotation_specs')
-                           306 STORE_SUBSCR
-               
-               110     >>  310 LOAD_DEREF               4 (result)
-                           312 LOAD_CONST               4 ('annotation_specs')
-                           314 BINARY_SUBSCR
-                           324 STORE_FAST               1 (subdict)
-               
-               111         326 LOAD_FAST                1 (subdict)
-                           328 LOAD_FAST                3 (ioro)
-                           330 BINARY_SUBSCR
-                           340 STORE_FAST               1 (subdict)
+               103          50 LOAD_FAST                2 (type_spec_key)
+                            52 LOAD_GLOBAL              2 (ObservationTypes)
+                            64 LOAD_ATTR                2 (E)
+                            74 COMPARE_OP               2 (==)
+                            80 POP_JUMP_FORWARD_IF_FALSE     9 (to 100)
+               
+               104          82 LOAD_DEREF               4 (result)
+                            84 LOAD_CONST               2 ('event_specs')
+                            86 BINARY_SUBSCR
+                            96 STORE_FAST               1 (subdict)
+                            98 JUMP_FORWARD           111 (to 322)
+               
+               105     >>  100 LOAD_FAST                2 (type_spec_key)
+                           102 LOAD_GLOBAL              2 (ObservationTypes)
+                           114 LOAD_ATTR                3 (M)
+                           124 COMPARE_OP               2 (==)
+                           130 POP_JUMP_FORWARD_IF_FALSE     9 (to 150)
+               
+               106         132 LOAD_DEREF               4 (result)
+                           134 LOAD_CONST               3 ('measurement_specs')
+                           136 BINARY_SUBSCR
+                           146 STORE_FAST               1 (subdict)
+                           148 JUMP_FORWARD            86 (to 322)
+               
+               107     >>  150 LOAD_FAST                2 (type_spec_key)
+                           152 LOAD_GLOBAL              8 (annotations_ext)
+                           164 LOAD_ATTR                5 (CSV_KEY)
+                           174 COMPARE_OP               2 (==)
+                           180 POP_JUMP_FORWARD_IF_FALSE    70 (to 322)
+               
+               108         182 LOAD_GLOBAL              8 (annotations_ext)
+                           194 LOAD_ATTR                6 (AnnotationTypes)
+                           204 LOAD_ATTR                7 (long_names)
+               
+               109         214 LOAD_FAST                0 (row)
+                           216 LOAD_METHOD              0 (pop)
+                           238 LOAD_CONST               1 (0)
+                           240 PRECALL                  1
+                           244 CALL                     1
+               
+               108         254 BINARY_SUBSCR
+                           264 STORE_FAST               3 (in_or_out_key)
+               
+               110         266 LOAD_CONST               4 ('annotation_specs')
+                           268 LOAD_DEREF               4 (result)
+                           270 CONTAINS_OP              1
+                           272 POP_JUMP_FORWARD_IF_FALSE     8 (to 290)
+               
+               111         274 BUILD_MAP                0
+                           276 BUILD_MAP                0
+                           278 LOAD_CONST               5 (('input', 'output'))
+                           280 BUILD_CONST_KEY_MAP      2
+                           282 LOAD_DEREF               4 (result)
+                           284 LOAD_CONST               4 ('annotation_specs')
+                           286 STORE_SUBSCR
+               
+               112     >>  290 LOAD_DEREF               4 (result)
+                           292 LOAD_CONST               4 ('annotation_specs')
+                           294 BINARY_SUBSCR
+                           304 STORE_FAST               1 (subdict)
+               
+               113         306 LOAD_FAST                1 (subdict)
+                           308 LOAD_FAST                3 (in_or_out_key)
+                           310 BINARY_SUBSCR
+                           320 STORE_FAST               1 (subdict)
                
-               112     >>  342 LOAD_FAST                1 (subdict)
-                           344 RETURN_VALUE
+               114     >>  322 LOAD_FAST                1 (subdict)
+                           324 RETURN_VALUE
                consts
                   None
                   0
                   'event_specs'
                   'measurement_specs'
                   'annotation_specs'
                   ('input', 'output')
-               names      ('pop', 'mdd', 'ObservationTypes', 'E', 'M', 'annotations_ext', 'CSV_KEY', 'AnnotationTypes', 'long_names')
-               varnames   ('row', 'subdict', 'type_spec_key', 'ioro')
+               names      ('pop', 'ObservationTypes', 'E', 'M', 'annotations_ext', 'CSV_KEY', 'AnnotationTypes', 'long_names')
+               varnames   ('row', 'subdict', 'type_spec_key', 'in_or_out_key')
                freevars   ('result',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
                name       'get_type_spec_dict'
-               firstlineno 99
-               lnotab 0x040104012a012a0112012a011201200154010801100110011001
+               firstlineno 100
+               lnotab
+                  0x040104012a0120011201200112012001200128ff0c0208011001100110
+                  01
             0
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 16777235
                code
                   0x970067007c005d0a7d017c0164006b0300000000af087c0191028c0b53
                   00
-               117           0 RESUME                   0
+               119           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                10 (to 28)
                              8 STORE_FAST               1 (e)
                             10 LOAD_FAST                1 (e)
                             12 LOAD_CONST               0 ('')
                             14 COMPARE_OP               3 (!=)
@@ -1125,27 +1143,27 @@
                   ''
                names      ()
                varnames   ('.0', 'e')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
                name       '<listcomp>'
-               firstlineno 117
+               firstlineno 119
                lnotab 0x
             1
             'extensions'
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 16777235
                code
                   0x970067007c005d0a7d017c0164006b0300000000af087c0191028c0b53
                   00
-               121           0 RESUME                   0
+               123           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                10 (to 28)
                              8 STORE_FAST               1 (f)
                             10 LOAD_FAST                1 (f)
                             12 LOAD_CONST               0 ('')
                             14 COMPARE_OP               3 (!=)
@@ -1158,36 +1176,36 @@
                   ''
                names      ()
                varnames   ('.0', 'f')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
                name       '<listcomp>'
-               firstlineno 121
+               firstlineno 123
                lnotab 0x
             ('row', 'list[str]')
-         names      ('raw', 'RawHeaderSpec', 'io_utils', 'read_csv_lines_from', 'registry', 'CSV_KEY', 'mdd', 'ObservationTypes', 'E', 'M', 'annotations_ext', 'pop', 'metadata_ext', 'enumerate', 'type', 'str', 'isinstance', 'Mapping')
+         names      ('raw', 'RawHeaderSpec', 'io_utils', 'read_csv_lines_from', 'registry', 'CSV_KEY', 'ObservationTypes', 'E', 'M', 'annotations_ext', 'pop', 'metadata_ext', 'enumerate', 'type', 'str', 'isinstance', 'Mapping')
          varnames   ('source', 'get_type_spec_dict', 'row', 'statement_identifier', 'specs', 'label', 'key', 'spec_dict', 'features', 'target_feature', 'value', 'j', 'f_spec')
          freevars   ()
          cellvars   ('result',)
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
          name       'read_raw_header'
-         firstlineno 94
+         firstlineno 95
          lnotab
-            0x040126010a010a020c0f2e01100120012e015e0116012a01200120012a
+            0x040126010a010a020c102e01100120012e014a0116012a01200120012a
             012a01160136012a012a012801380112010401320116010a01
-      ('source', 'DataSource', 'return', 'raw.RawDataType')
+      ('source', 'DataSource', 'return', 'pd.DataFrame')
       (True, 'infer')
-      ('header_source', 'DataSource', 'data_source', 'DataSource', 'header_format', "Union[Literal['infer'], HeaderFormatLiterals]", 'return', 'mdd.MachineData')
+      ('header_source', 'DataSource', 'data_source', 'DataSource', 'header_format', "Union[Literal['infer'], HeaderFormatLiterals]", 'return', 'MachineData')
       (True, 'csv')
-      ('header_format', 'HeaderFormatLiterals', 'return', 'mdd.MachineData')
+      ('header_format', 'HeaderFormatLiterals', 'return', 'MachineData')
       ('source', 'DataSource', 'return', 'raw.RawHeaderSpec')
-   names      ('__future__', 'annotations', 'io', 'os.path', 'os', 'typing', 'Literal', 'Union', 'Mapping', 'pandas', 'pd', 'mdata.core', 'machine_data_def', 'mdd', 'raw', 'mdata.core.extensions', 'metadata', 'metadata_ext', 'annotations_ext', 'registry', 'mdata.file_formats', 'io_utils', 'mdata.file_formats.csv.shared', 'mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'mdata.file_formats.io_utils', 'DataSource', 'read_raw_data', 'read_machine_data', 'read_machine_data_canonical', 'read_raw_header_json', 'read_raw_header_yaml', 'read_raw_header')
+   names      ('__future__', 'annotations', 'io', 'os.path', 'os', 'typing', 'Literal', 'Union', 'Mapping', 'Optional', 'pandas', 'pd', 'mdata.core', 'raw', 'MDConcepts', 'MachineData', 'mdata.core.shared_defs', 'ObservationTypes', 'mdata.core.extensions', 'metadata', 'metadata_ext', 'annotations_ext', 'registry', 'mdata.file_formats', 'io_utils', 'mdata.file_formats.csv.shared', 'mk_filename_pair', 'HeaderFormatLiterals', 'HeaderFileFormat', 'mdata.file_formats.io_utils', 'DataSource', 'read_raw_data', 'read_machine_data', 'read_machine_data_canonical', 'read_raw_header_json', 'read_raw_header_yaml', 'read_raw_header')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\csv\\importing.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c0208010801140208020c010c0114010c0114010c03080c02
-      0102ff0a33020102ff0a0608040804
+      0x00ff02010c02080108011802080214010c0114010c0114010c03080c02
+      0102ff0a34020102ff0a0608040804
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/shared.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/shared.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/__pycache__/shared.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/csv/__pycache__/shared.cpython-311.pyc`

 * *Files 2% similar despite different names*

#### Python bytecode

```diff
@@ -1,9 +1,9 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
+moddate:  0xe273c764 (Mon Jul 31 08:42:10 2023 UTC)
 files sz: 483
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 5
    flags     : 0
    code
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/exporting.py` & `mdata-0.1.3/src/mdata/file_formats/csv/exporting.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,87 +1,86 @@
 import csv
 import io
 import json
 import os
 import sys
-from typing import Optional, TextIO
+from typing import Optional, TextIO, Any
 
+import pandas as pd
 import yaml
 
-from mdata.core import machine_data_def as mdd
-from mdata.core import raw
+from mdata.core import bmd, raw, MachineData, ObservationTypes, MDConcepts
 from mdata.core.extensions import metadata, registry
 from mdata.file_formats import io_utils
 from .shared import mk_filename_pair, HeaderFormatLiterals, HeaderFileFormat, DictHeaderFormatLiterals
 
 
 class UnsupportedWritingTarget(Exception):
     def __init__(self, arg) -> None:
         super().__init__(f'Cannot write to {arg} of type {type(arg)}.')
 
 
 WritingTarget = str | os.PathLike[str] | TextIO | io.StringIO
 
 
 def pad_lengths(lol: list[list[str]]):
-    mlen = max(map(len, lol))
-    return [l + [''] * (mlen - len(l)) for l in lol]
+    max_len = max(map(len, lol))
+    return [li + [''] * (max_len - len(li)) for li in lol]
 
 
 def write_raw_header(target: WritingTarget, header: raw.RawHeaderSpec):
     def write_into(into):
         writer = csv.writer(into)
-        exts = header.get('extensions', [])
-        use_metadata = 'metadata' in exts
+        extensions = header.get('extensions', [])
+        use_metadata = 'metadata' in extensions
         rows = []
 
         def all_specs():
-            return zip([mdd.ObservationTypes.E, mdd.ObservationTypes.M],
+            return zip([ObservationTypes.E, ObservationTypes.M],
                        [header['event_specs'].items(), header['measurement_specs'].items()])
 
         # add header row
-        mlen = max(len(s) for typ, specs in all_specs() for _, s in specs)
-        rows.append([mdd.MDConcepts.Type, mdd.MDConcepts.Label] + raw.gen_feature_column_names(mlen))
+        max_len = max(len(s) for typ, specs in all_specs() for _, s in specs)
+        rows.append([MDConcepts.Type, MDConcepts.Label] + raw.gen_feature_column_names(max_len))
 
         for typ, specs in all_specs():
             rows += [[typ, label] + [f if type(f) is str else f['name'] for f in spec] for label, spec in specs]
 
-        if len(exts) > 0:
-            rows.append([registry.CSV_KEY] + [e for e in exts])
+        if len(extensions) > 0:
+            rows.append([registry.CSV_KEY] + [e for e in extensions])
 
         if use_metadata:
             for typ, specs in all_specs():
                 for label, spec in specs:
                     for f in spec:
                         if isinstance(f, raw.RawMetadataFeatureSpec):
                             if (pn := f.get('print_name')) is not None:
                                 rows.append([metadata.CSV_KEY, 'print_name', typ, label, f, pn])
                             if (dt := f.get('data_type')) is not None:
                                 rows.append([metadata.CSV_KEY, 'data_type', typ, label, f, dt])
 
-        # TODO annotations
         writer.writerows(pad_lengths(rows))
 
     if isinstance(target, str | os.PathLike):
         io_utils.ensure_directory_exists(target)
         target = io_utils.ensure_ext(target, '.csv')
         with open(target, 'w', newline='', encoding='utf-8') as csvfile:
             write_into(csvfile)
     else:
         try:
             write_into(target)
         except Exception:
-            tb = sys.exc_info()[2]
+            tb: Any = sys.exc_info()[2]
             raise UnsupportedWritingTarget(target).with_traceback(tb)
 
 
 def write_raw_header_dict(target, header: raw.RawHeaderSpec, dict_header_format: DictHeaderFormatLiterals = 'json'):
     assert dict_header_format in {HeaderFileFormat.JSON, HeaderFileFormat.YAML}
 
-    def write_into(into):
+    def write_into():
         pass
 
     if dict_header_format == HeaderFileFormat.JSON:
         def write_into(into):
             json.dump(header, into, indent=2)
     elif dict_header_format == HeaderFileFormat.YAML:
         def write_into(into):
@@ -92,50 +91,50 @@
         target = io_utils.ensure_ext(target, '.json' if dict_header_format == HeaderFileFormat.JSON else '.yaml')
         with open(target, 'w') as file:
             write_into(file)
     else:
         try:
             write_into(target)
         except Exception:
-            tb = sys.exc_info()[2]
+            tb: Any = sys.exc_info()[2]
             raise UnsupportedWritingTarget(target).with_traceback(tb)
 
 
-def write_raw_data(target: WritingTarget, df: raw.RawDataType):
+def write_raw_data(target: WritingTarget, df: pd.DataFrame):
     if isinstance(target, str | os.PathLike):
         io_utils.ensure_directory_exists(target)
         target = io_utils.ensure_ext(target, '.csv')
     df.to_csv(target, index=False)
 
 
-def write_machine_data(path: str | os.PathLike, md: mdd.MachineData, header_format: HeaderFormatLiterals = 'csv'):
+def write_machine_data(path: str | os.PathLike, md: MachineData, header_format: HeaderFormatLiterals = 'csv'):
     header_file, data_file = mk_filename_pair(path, header_format=header_format)
     write_machine_data_custom(header_file, data_file, md, header_format)
 
 
 def write_machine_data_custom(header_target: Optional[WritingTarget], data_target: Optional[WritingTarget],
-                              md: mdd.MachineData,
+                              md: MachineData,
                               header_format: HeaderFormatLiterals):
     raw_header = raw.convert_to_raw_header(md)
     assert header_format in HeaderFileFormat
     if header_target is not None:
         if header_format == HeaderFileFormat.CSV:
             write_raw_header(header_target, raw_header)
         elif header_format in {HeaderFileFormat.JSON, HeaderFileFormat.YAML}:
             write_raw_header_dict(header_target, raw_header, dict_header_format=header_format)
     if data_target is not None:
         write_raw_data(data_target, raw.convert_to_raw_data(md))
 
 
-def write_header_file(path: str | os.PathLike, md: mdd.MachineData, header_format: HeaderFormatLiterals = 'csv'):
+def write_header_file(path: str | os.PathLike, md: MachineData, header_format: HeaderFormatLiterals = 'csv'):
     header_file, _ = mk_filename_pair(path, header_format=header_format)
     raw_header = raw.convert_to_raw_header(md)
     assert header_format in HeaderFileFormat
     if header_format == HeaderFileFormat.CSV:
         write_raw_header(header_file, raw_header)
     elif header_format in {HeaderFileFormat.JSON, HeaderFileFormat.YAML}:
         write_raw_header_dict(header_file, raw_header, dict_header_format=header_format)
 
 
-def write_data_file(path: str | os.PathLike, md: mdd.MachineData):
+def write_data_file(path: str | os.PathLike, md: MachineData):
     _, data_file = mk_filename_pair(path)
     write_raw_data(data_file, raw.convert_to_raw_data(md))
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/csv/importing.py` & `mdata-0.1.3/src/mdata/file_formats/csv/importing.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,37 +1,37 @@
 from __future__ import annotations
 
 import io
 import os.path
-from typing import Literal, Union, Mapping
+from typing import Literal, Union, Mapping, Optional
 
 import pandas as pd
 
-from mdata.core import machine_data_def as mdd
-from mdata.core import raw
+from mdata.core import raw, MDConcepts, MachineData
+from mdata.core.shared_defs import ObservationTypes
 from mdata.core.extensions import metadata as metadata_ext, annotations as annotations_ext, registry
 from mdata.file_formats import io_utils
 from mdata.file_formats.csv.shared import mk_filename_pair, HeaderFormatLiterals, HeaderFileFormat
 from mdata.file_formats.io_utils import DataSource
 
 
-def read_raw_data(source: DataSource) -> raw.RawDataType:
+def read_raw_data(source: DataSource) -> pd.DataFrame:
     if isinstance(source, memoryview):
         source = source.tobytes()
     if isinstance(source, bytes):
         with io.BytesIO(source) as buf:
-            df = pd.read_csv(buf)
+            df = pd.read_csv(buf, parse_dates=False)
     else:
-        df = pd.read_csv(source)
-    df[mdd.MDConcepts.Time] = pd.to_datetime(df[mdd.MDConcepts.Time])
+        df = pd.read_csv(source, parse_dates=False)
+    df[MDConcepts.Time] = pd.to_datetime(df[MDConcepts.Time], format='ISO8601')
     return df
 
 
 def read_machine_data(header_source: DataSource, data_source: DataSource, validity_checking=True,
-                      header_format: Union[Literal['infer'], HeaderFormatLiterals] = 'infer') -> mdd.MachineData:
+                      header_format: Union[Literal['infer'], HeaderFormatLiterals] = 'infer') -> MachineData:
     if header_format == 'infer' and isinstance(header_source, str):
         header_format = os.path.splitext(header_source)[1][1:]
     if header_format not in HeaderFileFormat:
         from mdata.file_formats.validity_checking_utils import UnsupportedHeaderFileFormat
         raise UnsupportedHeaderFileFormat(header_format)
     if validity_checking:
         def do_file_checks():
@@ -50,23 +50,24 @@
                 do_file_checks()
                 header_source.seek(0)
             else:
                 print('skipped file validity checking due to working on non-seekable buffer')
         else:
             do_file_checks()
 
-    raw_header: raw.RawHeaderSpec = None
+    raw_header: Optional[raw.RawHeaderSpec] = None
     if header_format == HeaderFileFormat.CSV:
         raw_header = read_raw_header(header_source)
     elif header_format == HeaderFileFormat.JSON:
         raw_header = read_raw_header_json(header_source)
     elif header_format == HeaderFileFormat.YAML:
         raw_header = read_raw_header_yaml(header_source)
 
     if validity_checking:
+        assert raw_header is not None
         from .checking import check_if_valid_raw_header
         check_if_valid_raw_header(raw_header)
 
     raw_data = read_raw_data(data_source)
 
     if validity_checking:
         from .checking import check_if_valid_raw_data
@@ -74,15 +75,15 @@
         check_if_valid_raw_data(raw_data)
         check_header_data_compatibility(raw_header, raw_data)
 
     return raw.create_machine_data_from_raw(raw_data, raw_header)
 
 
 def read_machine_data_canonical(basepath, validity_checking=True,
-                                header_format: HeaderFormatLiterals = 'csv') -> mdd.MachineData:
+                                header_format: HeaderFormatLiterals = 'csv') -> MachineData:
     header_file, data_file = mk_filename_pair(basepath, header_format=header_format)
     return read_machine_data(header_file, data_file, validity_checking=validity_checking, header_format=header_format)
 
 
 def read_raw_header_json(source: DataSource) -> raw.RawHeaderSpec:
     return io_utils.read_json_dict_from(source)
 
@@ -95,31 +96,32 @@
     result = raw.RawHeaderSpec()
     result['event_specs'] = {}
     result['measurement_specs'] = {}
 
     def get_type_spec_dict(row: list[str]):
         subdict = {}
         type_spec_key = row.pop(0)
-        if type_spec_key == mdd.ObservationTypes.E:
+        if type_spec_key == ObservationTypes.E:
             subdict = result['event_specs']
-        elif type_spec_key == mdd.ObservationTypes.M:
+        elif type_spec_key == ObservationTypes.M:
             subdict = result['measurement_specs']
         elif type_spec_key == annotations_ext.CSV_KEY:
-            ioro = annotations_ext.AnnotationTypes.long_names[row.pop(0)]
+            in_or_out_key: annotations_ext.AnnotationTypeLongNames = annotations_ext.AnnotationTypes.long_names[
+                row.pop(0)]
             if 'annotation_specs' not in result:
                 result['annotation_specs'] = {'input': {}, 'output': {}}
             subdict = result['annotation_specs']
-            subdict = subdict[ioro]
+            subdict = subdict[in_or_out_key]
         return subdict
 
     for row in io_utils.read_csv_lines_from(source):
         statement_identifier = row[0]
         if statement_identifier == registry.CSV_KEY:
             result['extensions'] = [e for e in row[1:] if e != '']
-        if statement_identifier in {mdd.ObservationTypes.E, mdd.ObservationTypes.M, annotations_ext.CSV_KEY}:
+        if statement_identifier in {ObservationTypes.E, ObservationTypes.M, annotations_ext.CSV_KEY}:
             specs = get_type_spec_dict(row)
             label = row.pop(0)
             specs[label] = [f for f in row if f != '']
         elif statement_identifier == metadata_ext.CSV_KEY:
             row.pop(0)
             key = row.pop(0)
             spec_dict = get_type_spec_dict(row)
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-311.pyc` & `mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/exporting.cpython-311.pyc`

 * *Files 10% similar despite different names*

#### Python bytecode

```diff
@@ -1,136 +1,134 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
+moddate:  0xaaebd064 (Mon Aug  7 13:03:38 2023 UTC)
 files sz: 2493
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 7
    flags     : 0
    code
-      0x9700640064016c005a00640064016c015a02640064026c036d045a0501
-      00640064036c066d075a070100640064046c086d095a0901006409640565
-      056a0a00000000000000006406650b640764016606640884055a0c640153
-      00
+      0x9700640064016c005a00640064016c015a02640064026c036d045a046d
+      055a050100640064036c066d075a070100640064046c086d095a09010064
+      09640565056406650a640764016606640884055a0b64015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (None)
                  6 IMPORT_NAME              0 (os)
                  8 STORE_NAME               0 (os)
    
      3          10 LOAD_CONST               0 (0)
                 12 LOAD_CONST               1 (None)
                 14 IMPORT_NAME              1 (pandas)
                 16 STORE_NAME               2 (pd)
    
      5          18 LOAD_CONST               0 (0)
-                20 LOAD_CONST               2 (('machine_data_def',))
+                20 LOAD_CONST               2 (('MDConcepts', 'MachineData'))
                 22 IMPORT_NAME              3 (mdata.core)
-                24 IMPORT_FROM              4 (machine_data_def)
-                26 STORE_NAME               5 (mdd)
-                28 POP_TOP
+                24 IMPORT_FROM              4 (MDConcepts)
+                26 STORE_NAME               4 (MDConcepts)
+                28 IMPORT_FROM              5 (MachineData)
+                30 STORE_NAME               5 (MachineData)
+                32 POP_TOP
    
-     6          30 LOAD_CONST               0 (0)
-                32 LOAD_CONST               3 (('registry',))
-                34 IMPORT_NAME              6 (mdata.core.extensions)
-                36 IMPORT_FROM              7 (registry)
-                38 STORE_NAME               7 (registry)
-                40 POP_TOP
+     6          34 LOAD_CONST               0 (0)
+                36 LOAD_CONST               3 (('Extension',))
+                38 IMPORT_NAME              6 (mdata.core.extensions)
+                40 IMPORT_FROM              7 (Extension)
+                42 STORE_NAME               7 (Extension)
+                44 POP_TOP
    
-     7          42 LOAD_CONST               0 (0)
-                44 LOAD_CONST               4 (('io_utils',))
-                46 IMPORT_NAME              8 (mdata.file_formats)
-                48 IMPORT_FROM              9 (io_utils)
-                50 STORE_NAME               9 (io_utils)
-                52 POP_TOP
+     7          46 LOAD_CONST               0 (0)
+                48 LOAD_CONST               4 (('io_utils',))
+                50 IMPORT_NAME              8 (mdata.file_formats)
+                52 IMPORT_FROM              9 (io_utils)
+                54 STORE_NAME               9 (io_utils)
+                56 POP_TOP
    
-    10          54 LOAD_CONST               9 ((0,))
-                56 LOAD_CONST               5 ('md')
-                58 LOAD_NAME                5 (mdd)
-                60 LOAD_ATTR               10 (MachineData)
-                70 LOAD_CONST               6 ('complevel')
-                72 LOAD_NAME               11 (int)
-                74 LOAD_CONST               7 ('return')
-                76 LOAD_CONST               1 (None)
-                78 BUILD_TUPLE              6
-                80 LOAD_CONST               8 (<code object write_machine_data_h5, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 10>)
-                82 MAKE_FUNCTION            5 (defaults, annotations)
-                84 STORE_NAME              12 (write_machine_data_h5)
-                86 LOAD_CONST               1 (None)
-                88 RETURN_VALUE
+    10          58 LOAD_CONST               9 ((0,))
+                60 LOAD_CONST               5 ('md')
+                62 LOAD_NAME                5 (MachineData)
+                64 LOAD_CONST               6 ('complevel')
+                66 LOAD_NAME               10 (int)
+                68 LOAD_CONST               7 ('return')
+                70 LOAD_CONST               1 (None)
+                72 BUILD_TUPLE              6
+                74 LOAD_CONST               8 (<code object write_machine_data_h5, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 10>)
+                76 MAKE_FUNCTION            5 (defaults, annotations)
+                78 STORE_NAME              11 (write_machine_data_h5)
+                80 LOAD_CONST               1 (None)
+                82 RETURN_VALUE
    consts
       0
       None
-      ('machine_data_def',)
-      ('registry',)
+      ('MDConcepts', 'MachineData')
+      ('Extension',)
       ('io_utils',)
       'md'
       'complevel'
       'return'
       code
          argcount  : 3
-         nlocals   : 18
+         nlocals   : 17
          stacksize : 12
          flags     : 11
          code
-            0x87038712970064018903760172056402890364013c0000007401000000
+            0x87038711970064018903760172056402890364013c0000007401000000
             000000000000007c00740200000000000000000000740400000000000000
             0000006a0300000000000000007a070000a6020000ab0200000000000000
             0072297409000000000000000000006a0500000000000000007c00a60100
             00ab01000000000000000001007409000000000000000000006a06000000
             00000000007c006403a6020000ab0200000000000000007d00740f000000
             000000000000006a0800000000000000007c00640464057c02ac06a60400
-            00ab04000000000000000035008a12020089126a09000000000000000064
+            00ab04000000000000000035008a11020089116a09000000000000000064
             077c016a0a0000000000000000660264087416000000000000000000006a
-            0c00000000000000006a0d00000000000000006409640a9c038903a4018e
-            0101008912a00e0000000000000000000000000000000000000000640764
-            077416000000000000000000006a0c00000000000000006a0f0000000000
-            0000007416000000000000000000006a0c00000000000000006a10000000
+            0c00000000000000006409640a9c038903a4018e0101008911a00d000000
+            000000000000000000000000000000000064076407741600000000000000
+            0000006a0e00000000000000007416000000000000000000006a0f000000
             00000000006703640bac0ca6030000ab0300000000000000000100880388
-            126602640d84087d047c016a110000000000000000a01200000000000000
+            116602640d84087d047c016a100000000000000000a01100000000000000
             00000000000000000000000000a6000000ab00000000000000000044005d
-            195c0200007d057d0602007c04640e7c059b009d027c066a130000000000
-            000000a6020000ab02000000000000000001008c1a7c016a140000000000
-            000000a0120000000000000000000000000000000000000000a6000000ab
+            195c0200007d057d0602007c04640e7c059b009d027c066a120000000000
+            000000a6020000ab02000000000000000001008c1a7c016a130000000000
+            000000a0110000000000000000000000000000000000000000a6000000ab
             00000000000000000044005d195c0200007d057d0702007c04640f7c059b
-            009d027c076a130000000000000000a6020000ab02000000000000000001
-            008c1a742b000000000000000000007c016a1600000000000000006a1700
+            009d027c076a120000000000000000a6020000ab02000000000000000001
+            008c1a7429000000000000000000007c016a1500000000000000006a1600
             00000000000000a6010000ab01000000000000000064106b040000000072
-            308912a00900000000000000000000000000000000000000006411743100
-            0000000000000000007c016a1600000000000000006a1700000000000000
+            308911a00900000000000000000000000000000000000000006411742f00
+            0000000000000000007c016a1500000000000000006a1600000000000000
             00a6010000ab01000000000000000064126409ac13a6040000ab04000000
-            000000000001007432000000000000000000006a1a00000000000000006a
-            1b00000000000000007c016a1600000000000000006a1700000000000000
-            007600900172467439000000000000000000007430000000000000000000
-            00743b00000000000000000000641484007c016a1600000000000000006a
-            1e0000000000000000a01200000000000000000000000000000000000000
-            00a6000000ab0000000000000000004400a6000000ab0000000000000000
-            008e00a6020000ab0200000000000000005c0200007d087d09740f000000
-            000000000000006a1f00000000000000007c09740f000000000000000000
-            006a2000000000000000007c086415ac16a6020000ab0200000000000000
-            0064176701ac18a6030000ab0300000000000000007d0a8912a009000000
-            000000000000000000000000000000000064197c0aa6020000ab02000000
-            0000000000010067007d0b7c016a21000000000000000044005d687d0c7c
-            0c6a2200000000000000007d0d7c0d6a2300000000000000005c0200007d
-            0e7d0f7c0d6a2400000000000000006a25000000000000000044005d337d
-            107c0e7c0f7c106a2600000000000000007c106a2600000000000000007c
-            106a2700000000000000006b030000000072077c106a2700000000000000
-            006e0167007c106a28000000000000000081077c106a2800000000000000
-            006e01670067057d118c347c0ba029000000000000000000000000000000
-            00000000007c11a6010000ab01000000000000000001008c698912a00900
-            00000000000000000000000000000000000000641a740f00000000000000
-            0000006a1f00000000000000007c0b7416000000000000000000006a0c00
-            000000000000006a2a00000000000000007416000000000000000000006a
-            0c00000000000000006a100000000000000000641b641c641d6705ac1ea6
+            000000000001007430000000000000000000006a1900000000000000007c
+            016a1500000000000000006a16000000000000000076009001723c743500
+            000000000000000000742e00000000000000000000743700000000000000
+            000000641484007c016a1500000000000000006a1c0000000000000000a0
+            110000000000000000000000000000000000000000a6000000ab00000000
+            00000000004400a6000000ab0000000000000000008e00a6020000ab0200
+            000000000000005c0200007d087d09740f000000000000000000006a1d00
+            000000000000007c09740f000000000000000000006a1e00000000000000
+            007c086415ac16a6020000ab02000000000000000064176701ac18a60300
+            00ab0300000000000000007d0a8911a00900000000000000000000000000
+            0000000000000064197c0aa6020000ab020000000000000000010067007d
+            0b7c016a1f000000000000000044005d687d0c7c0c6a2000000000000000
+            007d0d7c0d6a2100000000000000005c0200007d0e7d057c0d6a22000000
+            00000000006a23000000000000000044005d337d0f7c0e7c057c0f6a2400
+            000000000000007c0f6a2400000000000000007c0f6a2500000000000000
+            006b030000000072077c0f6a2500000000000000006e0167007c0f6a2600
+            0000000000000081077c0f6a2600000000000000006e01670067057d108c
+            347c0ba02700000000000000000000000000000000000000007c10a60100
+            00ab01000000000000000001008c698911a0090000000000000000000000
+            000000000000000000641a740f000000000000000000006a1d0000000000
+            0000007c0b7416000000000000000000006a280000000000000000741600
+            0000000000000000006a0f0000000000000000641b641c641d6705ac1ea6
             020000ab020000000000000000a6020000ab020000000000000000010064
             0064006400a6020000ab0200000000000000000100640053002300310073
             047702780359007701010059000100010064005300
                        0 MAKE_CELL                3 (kwargs)
-                       2 MAKE_CELL               18 (store)
+                       2 MAKE_CELL               17 (store)
          
           10           4 RESUME                   0
          
           11           6 LOAD_CONST               1 ('format')
                        8 LOAD_DEREF               3 (kwargs)
                       10 CONTAINS_OP              1
                       12 POP_JUMP_FORWARD_IF_FALSE     5 (to 24)
@@ -171,306 +169,300 @@
                      198 LOAD_CONST               4 ('w')
                      200 LOAD_CONST               5 ('blosc')
                      202 LOAD_FAST                2 (complevel)
                      204 KW_NAMES                 6
                      206 PRECALL                  4
                      210 CALL                     4
                      220 BEFORE_WITH
-                     222 STORE_DEREF             18 (store)
+                     222 STORE_DEREF             17 (store)
          
           17         224 PUSH_NULL
-                     226 LOAD_DEREF              18 (store)
+                     226 LOAD_DEREF              17 (store)
                      228 LOAD_ATTR                9 (put)
                      238 LOAD_CONST               7 ('index')
                      240 LOAD_FAST                1 (md)
                      242 LOAD_ATTR               10 (index_frame)
                      252 BUILD_TUPLE              2
                      254 LOAD_CONST               8 (True)
-                     256 LOAD_GLOBAL             22 (mdd)
-                     268 LOAD_ATTR               12 (MDConcepts)
-                     278 LOAD_ATTR               13 (base_columns)
-         
-          18         288 LOAD_CONST               9 (False)
-         
-          17         290 LOAD_CONST              10 (('index', 'data_columns', 'dropna'))
-                     292 BUILD_CONST_KEY_MAP      3
-         
-          18         294 LOAD_DEREF               3 (kwargs)
-         
-          17         296 DICT_MERGE               1
-                     298 CALL_FUNCTION_EX         1
-                     300 POP_TOP
-         
-          19         302 LOAD_DEREF              18 (store)
-                     304 LOAD_METHOD             14 (create_table_index)
-                     326 LOAD_CONST               7 ('index')
-                     328 LOAD_CONST               7 ('index')
-                     330 LOAD_GLOBAL             22 (mdd)
-                     342 LOAD_ATTR               12 (MDConcepts)
-                     352 LOAD_ATTR               15 (Time)
-                     362 LOAD_GLOBAL             22 (mdd)
-                     374 LOAD_ATTR               12 (MDConcepts)
-                     384 LOAD_ATTR               16 (Label)
-                     394 BUILD_LIST               3
-                     396 LOAD_CONST              11 ('full')
-                     398 KW_NAMES                12
-                     400 PRECALL                  3
-                     404 CALL                     3
-                     414 POP_TOP
-         
-          21         416 LOAD_CLOSURE             3 (kwargs)
-                     418 LOAD_CLOSURE            18 (store)
-                     420 BUILD_TUPLE              2
-                     422 LOAD_CONST              13 (<code object put_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 21>)
-                     424 MAKE_FUNCTION            8 (closure)
-                     426 STORE_FAST               4 (put_series)
-         
-          26         428 LOAD_FAST                1 (md)
-                     430 LOAD_ATTR               17 (event_series)
-                     440 LOAD_METHOD             18 (items)
-                     462 PRECALL                  0
-                     466 CALL                     0
-                     476 GET_ITER
-                 >>  478 FOR_ITER                25 (to 530)
-                     480 UNPACK_SEQUENCE          2
-                     484 STORE_FAST               5 (label)
-                     486 STORE_FAST               6 (ess)
-         
-          27         488 PUSH_NULL
-                     490 LOAD_FAST                4 (put_series)
-                     492 LOAD_CONST              14 ('events/')
-                     494 LOAD_FAST                5 (label)
-                     496 FORMAT_VALUE             0
-                     498 BUILD_STRING             2
-                     500 LOAD_FAST                6 (ess)
-                     502 LOAD_ATTR               19 (df)
-                     512 PRECALL                  2
-                     516 CALL                     2
-                     526 POP_TOP
-                     528 JUMP_BACKWARD           26 (to 478)
-         
-          28     >>  530 LOAD_FAST                1 (md)
-                     532 LOAD_ATTR               20 (measurement_series)
-                     542 LOAD_METHOD             18 (items)
-                     564 PRECALL                  0
-                     568 CALL                     0
-                     578 GET_ITER
-                 >>  580 FOR_ITER                25 (to 632)
-                     582 UNPACK_SEQUENCE          2
-                     586 STORE_FAST               5 (label)
-                     588 STORE_FAST               7 (mss)
-         
-          29         590 PUSH_NULL
-                     592 LOAD_FAST                4 (put_series)
-                     594 LOAD_CONST              15 ('measurements/')
-                     596 LOAD_FAST                5 (label)
-                     598 FORMAT_VALUE             0
-                     600 BUILD_STRING             2
-                     602 LOAD_FAST                7 (mss)
-                     604 LOAD_ATTR               19 (df)
-                     614 PRECALL                  2
-                     618 CALL                     2
-                     628 POP_TOP
-                     630 JUMP_BACKWARD           26 (to 580)
-         
-          31     >>  632 LOAD_GLOBAL             43 (NULL + len)
-                     644 LOAD_FAST                1 (md)
-                     646 LOAD_ATTR               22 (meta)
-                     656 LOAD_ATTR               23 (extensions)
-                     666 PRECALL                  1
-                     670 CALL                     1
-                     680 LOAD_CONST              16 (0)
-                     682 COMPARE_OP               4 (>)
-                     688 POP_JUMP_FORWARD_IF_FALSE    48 (to 786)
-         
-          32         690 LOAD_DEREF              18 (store)
-                     692 LOAD_METHOD              9 (put)
-                     714 LOAD_CONST              17 ('meta/extensions')
-                     716 LOAD_GLOBAL             49 (NULL + list)
-                     728 LOAD_FAST                1 (md)
-                     730 LOAD_ATTR               22 (meta)
-                     740 LOAD_ATTR               23 (extensions)
-                     750 PRECALL                  1
-                     754 CALL                     1
-                     764 LOAD_CONST              18 ('table')
-                     766 LOAD_CONST               9 (False)
-                     768 KW_NAMES                19
-                     770 PRECALL                  4
-                     774 CALL                     4
-                     784 POP_TOP
-         
-          33     >>  786 LOAD_GLOBAL             50 (registry)
-                     798 LOAD_ATTR               26 (Extension)
-                     808 LOAD_ATTR               27 (Metadata)
-                     818 LOAD_FAST                1 (md)
-                     820 LOAD_ATTR               22 (meta)
-                     830 LOAD_ATTR               23 (extensions)
-                     840 CONTAINS_OP              0
-                     842 EXTENDED_ARG             1
-                     844 POP_JUMP_FORWARD_IF_FALSE   326 (to 1498)
-         
-          34         846 LOAD_GLOBAL             57 (NULL + map)
-                     858 LOAD_GLOBAL             48 (list)
-                     870 LOAD_GLOBAL             59 (NULL + zip)
-                     882 LOAD_CONST              20 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 34>)
-                     884 MAKE_FUNCTION            0
-                     886 LOAD_FAST                1 (md)
-                     888 LOAD_ATTR               22 (meta)
-                     898 LOAD_ATTR               30 (metadata)
-                     908 LOAD_METHOD             18 (items)
-                     930 PRECALL                  0
-                     934 CALL                     0
-                     944 GET_ITER
-                     946 PRECALL                  0
-                     950 CALL                     0
-                     960 CALL_FUNCTION_EX         0
-                     962 PRECALL                  2
-                     966 CALL                     2
-                     976 UNPACK_SEQUENCE          2
-                     980 STORE_FAST               8 (keys)
-                     982 STORE_FAST               9 (values)
-         
-          35         984 LOAD_GLOBAL             15 (NULL + pd)
-                     996 LOAD_ATTR               31 (DataFrame)
-                    1006 LOAD_FAST                9 (values)
-                    1008 LOAD_GLOBAL             15 (NULL + pd)
-                    1020 LOAD_ATTR               32 (Index)
-                    1030 LOAD_FAST                8 (keys)
-                    1032 LOAD_CONST              21 ('key')
-                    1034 KW_NAMES                22
-                    1036 PRECALL                  2
-                    1040 CALL                     2
-                    1050 LOAD_CONST              23 ('value')
-                    1052 BUILD_LIST               1
-                    1054 KW_NAMES                24
-                    1056 PRECALL                  3
-                    1060 CALL                     3
-                    1070 STORE_FAST              10 (metadata_df)
-         
-          36        1072 LOAD_DEREF              18 (store)
-                    1074 LOAD_METHOD              9 (put)
-                    1096 LOAD_CONST              25 ('meta/metadata')
-                    1098 LOAD_FAST               10 (metadata_df)
-                    1100 PRECALL                  2
-                    1104 CALL                     2
-                    1114 POP_TOP
-         
-          38        1116 BUILD_LIST               0
-                    1118 STORE_FAST              11 (specmeta)
-         
-          39        1120 LOAD_FAST                1 (md)
-                    1122 LOAD_ATTR               33 (series_containers)
-                    1132 GET_ITER
-                 >> 1134 FOR_ITER               104 (to 1344)
-                    1136 STORE_FAST              12 (tsc)
-         
-          40        1138 LOAD_FAST               12 (tsc)
-                    1140 LOAD_ATTR               34 (timeseries_spec)
-                    1150 STORE_FAST              13 (tt)
-         
-          41        1152 LOAD_FAST               13 (tt)
-                    1154 LOAD_ATTR               35 (identifier)
-                    1164 UNPACK_SEQUENCE          2
-                    1168 STORE_FAST              14 (t)
-                    1170 STORE_FAST              15 (l)
-         
-          42        1172 LOAD_FAST               13 (tt)
-                    1174 LOAD_ATTR               36 (base)
-                    1184 LOAD_ATTR               37 (features)
-                    1194 GET_ITER
-                 >> 1196 FOR_ITER                51 (to 1300)
-                    1198 STORE_FAST              16 (fspec)
-         
-          43        1200 LOAD_FAST               14 (t)
-                    1202 LOAD_FAST               15 (l)
-                    1204 LOAD_FAST               16 (fspec)
-                    1206 LOAD_ATTR               38 (name)
-                    1216 LOAD_FAST               16 (fspec)
-                    1218 LOAD_ATTR               38 (name)
-                    1228 LOAD_FAST               16 (fspec)
-                    1230 LOAD_ATTR               39 (print_name)
-                    1240 COMPARE_OP               3 (!=)
-                    1246 POP_JUMP_FORWARD_IF_FALSE     7 (to 1262)
-                    1248 LOAD_FAST               16 (fspec)
-                    1250 LOAD_ATTR               39 (print_name)
-                    1260 JUMP_FORWARD             1 (to 1264)
-                 >> 1262 BUILD_LIST               0
-         
-          44     >> 1264 LOAD_FAST               16 (fspec)
-                    1266 LOAD_ATTR               40 (data_type)
-                    1276 POP_JUMP_FORWARD_IF_NONE     7 (to 1292)
-                    1278 LOAD_FAST               16 (fspec)
-                    1280 LOAD_ATTR               40 (data_type)
-                    1290 JUMP_FORWARD             1 (to 1294)
-                 >> 1292 BUILD_LIST               0
-         
-          43     >> 1294 BUILD_LIST               5
-                    1296 STORE_FAST              17 (row)
-                    1298 JUMP_BACKWARD           52 (to 1196)
-         
-          45     >> 1300 LOAD_FAST               11 (specmeta)
-                    1302 LOAD_METHOD             41 (append)
-                    1324 LOAD_FAST               17 (row)
-                    1326 PRECALL                  1
-                    1330 CALL                     1
-                    1340 POP_TOP
-                    1342 JUMP_BACKWARD          105 (to 1134)
-         
-          46     >> 1344 LOAD_DEREF              18 (store)
-                    1346 LOAD_METHOD              9 (put)
-                    1368 LOAD_CONST              26 ('meta/specs')
-                    1370 LOAD_GLOBAL             15 (NULL + pd)
-                    1382 LOAD_ATTR               31 (DataFrame)
-                    1392 LOAD_FAST               11 (specmeta)
-         
-          47        1394 LOAD_GLOBAL             22 (mdd)
-                    1406 LOAD_ATTR               12 (MDConcepts)
-                    1416 LOAD_ATTR               42 (Type)
-                    1426 LOAD_GLOBAL             22 (mdd)
-                    1438 LOAD_ATTR               12 (MDConcepts)
-                    1448 LOAD_ATTR               16 (Label)
-                    1458 LOAD_CONST              27 ('feature')
-         
-          48        1460 LOAD_CONST              28 ('print_name')
-                    1462 LOAD_CONST              29 ('data_type')
-         
-          47        1464 BUILD_LIST               5
-         
-          46        1466 KW_NAMES                30
-                    1468 PRECALL                  2
-                    1472 CALL                     2
-                    1482 PRECALL                  2
-                    1486 CALL                     2
-                    1496 POP_TOP
-         
-          16     >> 1498 LOAD_CONST               0 (None)
-                    1500 LOAD_CONST               0 (None)
-                    1502 LOAD_CONST               0 (None)
-                    1504 PRECALL                  2
-                    1508 CALL                     2
-                    1518 POP_TOP
-                    1520 LOAD_CONST               0 (None)
-                    1522 RETURN_VALUE
-                 >> 1524 PUSH_EXC_INFO
-                    1526 WITH_EXCEPT_START
-                    1528 POP_JUMP_FORWARD_IF_TRUE     4 (to 1538)
-                    1530 RERAISE                  2
-                 >> 1532 COPY                     3
-                    1534 POP_EXCEPT
-                    1536 RERAISE                  1
-                 >> 1538 POP_TOP
-                    1540 POP_EXCEPT
-                    1542 POP_TOP
-                    1544 POP_TOP
-                    1546 LOAD_CONST               0 (None)
-                    1548 RETURN_VALUE
+                     256 LOAD_GLOBAL             22 (MDConcepts)
+                     268 LOAD_ATTR               12 (base_columns)
+         
+          18         278 LOAD_CONST               9 (False)
+         
+          17         280 LOAD_CONST              10 (('index', 'data_columns', 'dropna'))
+                     282 BUILD_CONST_KEY_MAP      3
+         
+          18         284 LOAD_DEREF               3 (kwargs)
+         
+          17         286 DICT_MERGE               1
+                     288 CALL_FUNCTION_EX         1
+                     290 POP_TOP
+         
+          19         292 LOAD_DEREF              17 (store)
+                     294 LOAD_METHOD             13 (create_table_index)
+                     316 LOAD_CONST               7 ('index')
+                     318 LOAD_CONST               7 ('index')
+                     320 LOAD_GLOBAL             22 (MDConcepts)
+                     332 LOAD_ATTR               14 (Time)
+                     342 LOAD_GLOBAL             22 (MDConcepts)
+                     354 LOAD_ATTR               15 (Label)
+                     364 BUILD_LIST               3
+                     366 LOAD_CONST              11 ('full')
+                     368 KW_NAMES                12
+                     370 PRECALL                  3
+                     374 CALL                     3
+                     384 POP_TOP
+         
+          21         386 LOAD_CLOSURE             3 (kwargs)
+                     388 LOAD_CLOSURE            17 (store)
+                     390 BUILD_TUPLE              2
+                     392 LOAD_CONST              13 (<code object put_series, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 21>)
+                     394 MAKE_FUNCTION            8 (closure)
+                     396 STORE_FAST               4 (put_series)
+         
+          26         398 LOAD_FAST                1 (md)
+                     400 LOAD_ATTR               16 (event_series)
+                     410 LOAD_METHOD             17 (items)
+                     432 PRECALL                  0
+                     436 CALL                     0
+                     446 GET_ITER
+                 >>  448 FOR_ITER                25 (to 500)
+                     450 UNPACK_SEQUENCE          2
+                     454 STORE_FAST               5 (label)
+                     456 STORE_FAST               6 (ess)
+         
+          27         458 PUSH_NULL
+                     460 LOAD_FAST                4 (put_series)
+                     462 LOAD_CONST              14 ('events/')
+                     464 LOAD_FAST                5 (label)
+                     466 FORMAT_VALUE             0
+                     468 BUILD_STRING             2
+                     470 LOAD_FAST                6 (ess)
+                     472 LOAD_ATTR               18 (df)
+                     482 PRECALL                  2
+                     486 CALL                     2
+                     496 POP_TOP
+                     498 JUMP_BACKWARD           26 (to 448)
+         
+          28     >>  500 LOAD_FAST                1 (md)
+                     502 LOAD_ATTR               19 (measurement_series)
+                     512 LOAD_METHOD             17 (items)
+                     534 PRECALL                  0
+                     538 CALL                     0
+                     548 GET_ITER
+                 >>  550 FOR_ITER                25 (to 602)
+                     552 UNPACK_SEQUENCE          2
+                     556 STORE_FAST               5 (label)
+                     558 STORE_FAST               7 (mss)
+         
+          29         560 PUSH_NULL
+                     562 LOAD_FAST                4 (put_series)
+                     564 LOAD_CONST              15 ('measurements/')
+                     566 LOAD_FAST                5 (label)
+                     568 FORMAT_VALUE             0
+                     570 BUILD_STRING             2
+                     572 LOAD_FAST                7 (mss)
+                     574 LOAD_ATTR               18 (df)
+                     584 PRECALL                  2
+                     588 CALL                     2
+                     598 POP_TOP
+                     600 JUMP_BACKWARD           26 (to 550)
+         
+          31     >>  602 LOAD_GLOBAL             41 (NULL + len)
+                     614 LOAD_FAST                1 (md)
+                     616 LOAD_ATTR               21 (meta)
+                     626 LOAD_ATTR               22 (extensions)
+                     636 PRECALL                  1
+                     640 CALL                     1
+                     650 LOAD_CONST              16 (0)
+                     652 COMPARE_OP               4 (>)
+                     658 POP_JUMP_FORWARD_IF_FALSE    48 (to 756)
+         
+          32         660 LOAD_DEREF              17 (store)
+                     662 LOAD_METHOD              9 (put)
+                     684 LOAD_CONST              17 ('meta/extensions')
+                     686 LOAD_GLOBAL             47 (NULL + list)
+                     698 LOAD_FAST                1 (md)
+                     700 LOAD_ATTR               21 (meta)
+                     710 LOAD_ATTR               22 (extensions)
+                     720 PRECALL                  1
+                     724 CALL                     1
+                     734 LOAD_CONST              18 ('table')
+                     736 LOAD_CONST               9 (False)
+                     738 KW_NAMES                19
+                     740 PRECALL                  4
+                     744 CALL                     4
+                     754 POP_TOP
+         
+          33     >>  756 LOAD_GLOBAL             48 (Extension)
+                     768 LOAD_ATTR               25 (Metadata)
+                     778 LOAD_FAST                1 (md)
+                     780 LOAD_ATTR               21 (meta)
+                     790 LOAD_ATTR               22 (extensions)
+                     800 CONTAINS_OP              0
+                     802 EXTENDED_ARG             1
+                     804 POP_JUMP_FORWARD_IF_FALSE   316 (to 1438)
+         
+          34         806 LOAD_GLOBAL             53 (NULL + map)
+                     818 LOAD_GLOBAL             46 (list)
+                     830 LOAD_GLOBAL             55 (NULL + zip)
+                     842 LOAD_CONST              20 (<code object <genexpr>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\file_formats\hdf\exporting.py", line 34>)
+                     844 MAKE_FUNCTION            0
+                     846 LOAD_FAST                1 (md)
+                     848 LOAD_ATTR               21 (meta)
+                     858 LOAD_ATTR               28 (metadata)
+                     868 LOAD_METHOD             17 (items)
+                     890 PRECALL                  0
+                     894 CALL                     0
+                     904 GET_ITER
+                     906 PRECALL                  0
+                     910 CALL                     0
+                     920 CALL_FUNCTION_EX         0
+                     922 PRECALL                  2
+                     926 CALL                     2
+                     936 UNPACK_SEQUENCE          2
+                     940 STORE_FAST               8 (keys)
+                     942 STORE_FAST               9 (values)
+         
+          35         944 LOAD_GLOBAL             15 (NULL + pd)
+                     956 LOAD_ATTR               29 (DataFrame)
+                     966 LOAD_FAST                9 (values)
+                     968 LOAD_GLOBAL             15 (NULL + pd)
+                     980 LOAD_ATTR               30 (Index)
+                     990 LOAD_FAST                8 (keys)
+                     992 LOAD_CONST              21 ('key')
+                     994 KW_NAMES                22
+                     996 PRECALL                  2
+                    1000 CALL                     2
+                    1010 LOAD_CONST              23 ('value')
+                    1012 BUILD_LIST               1
+                    1014 KW_NAMES                24
+                    1016 PRECALL                  3
+                    1020 CALL                     3
+                    1030 STORE_FAST              10 (metadata_df)
+         
+          36        1032 LOAD_DEREF              17 (store)
+                    1034 LOAD_METHOD              9 (put)
+                    1056 LOAD_CONST              25 ('meta/metadata')
+                    1058 LOAD_FAST               10 (metadata_df)
+                    1060 PRECALL                  2
+                    1064 CALL                     2
+                    1074 POP_TOP
+         
+          38        1076 BUILD_LIST               0
+                    1078 STORE_FAST              11 (specs_extra_metadata)
+         
+          39        1080 LOAD_FAST                1 (md)
+                    1082 LOAD_ATTR               31 (series_containers)
+                    1092 GET_ITER
+                 >> 1094 FOR_ITER               104 (to 1304)
+                    1096 STORE_FAST              12 (tsc)
+         
+          40        1098 LOAD_FAST               12 (tsc)
+                    1100 LOAD_ATTR               32 (timeseries_spec)
+                    1110 STORE_FAST              13 (tt)
+         
+          41        1112 LOAD_FAST               13 (tt)
+                    1114 LOAD_ATTR               33 (identifier)
+                    1124 UNPACK_SEQUENCE          2
+                    1128 STORE_FAST              14 (t)
+                    1130 STORE_FAST               5 (label)
+         
+          42        1132 LOAD_FAST               13 (tt)
+                    1134 LOAD_ATTR               34 (base)
+                    1144 LOAD_ATTR               35 (features)
+                    1154 GET_ITER
+                 >> 1156 FOR_ITER                51 (to 1260)
+                    1158 STORE_FAST              15 (fspec)
+         
+          43        1160 LOAD_FAST               14 (t)
+                    1162 LOAD_FAST                5 (label)
+                    1164 LOAD_FAST               15 (fspec)
+                    1166 LOAD_ATTR               36 (name)
+                    1176 LOAD_FAST               15 (fspec)
+                    1178 LOAD_ATTR               36 (name)
+                    1188 LOAD_FAST               15 (fspec)
+                    1190 LOAD_ATTR               37 (print_name)
+                    1200 COMPARE_OP               3 (!=)
+                    1206 POP_JUMP_FORWARD_IF_FALSE     7 (to 1222)
+                    1208 LOAD_FAST               15 (fspec)
+                    1210 LOAD_ATTR               37 (print_name)
+                    1220 JUMP_FORWARD             1 (to 1224)
+                 >> 1222 BUILD_LIST               0
+         
+          44     >> 1224 LOAD_FAST               15 (fspec)
+                    1226 LOAD_ATTR               38 (data_type)
+                    1236 POP_JUMP_FORWARD_IF_NONE     7 (to 1252)
+                    1238 LOAD_FAST               15 (fspec)
+                    1240 LOAD_ATTR               38 (data_type)
+                    1250 JUMP_FORWARD             1 (to 1254)
+                 >> 1252 BUILD_LIST               0
+         
+          43     >> 1254 BUILD_LIST               5
+                    1256 STORE_FAST              16 (row)
+                    1258 JUMP_BACKWARD           52 (to 1156)
+         
+          45     >> 1260 LOAD_FAST               11 (specs_extra_metadata)
+                    1262 LOAD_METHOD             39 (append)
+                    1284 LOAD_FAST               16 (row)
+                    1286 PRECALL                  1
+                    1290 CALL                     1
+                    1300 POP_TOP
+                    1302 JUMP_BACKWARD          105 (to 1094)
+         
+          46     >> 1304 LOAD_DEREF              17 (store)
+                    1306 LOAD_METHOD              9 (put)
+                    1328 LOAD_CONST              26 ('meta/specs')
+                    1330 LOAD_GLOBAL             15 (NULL + pd)
+                    1342 LOAD_ATTR               29 (DataFrame)
+                    1352 LOAD_FAST               11 (specs_extra_metadata)
+         
+          47        1354 LOAD_GLOBAL             22 (MDConcepts)
+                    1366 LOAD_ATTR               40 (Type)
+                    1376 LOAD_GLOBAL             22 (MDConcepts)
+                    1388 LOAD_ATTR               15 (Label)
+                    1398 LOAD_CONST              27 ('feature')
+         
+          48        1400 LOAD_CONST              28 ('print_name')
+                    1402 LOAD_CONST              29 ('data_type')
+         
+          47        1404 BUILD_LIST               5
+         
+          46        1406 KW_NAMES                30
+                    1408 PRECALL                  2
+                    1412 CALL                     2
+                    1422 PRECALL                  2
+                    1426 CALL                     2
+                    1436 POP_TOP
+         
+          16     >> 1438 LOAD_CONST               0 (None)
+                    1440 LOAD_CONST               0 (None)
+                    1442 LOAD_CONST               0 (None)
+                    1444 PRECALL                  2
+                    1448 CALL                     2
+                    1458 POP_TOP
+                    1460 LOAD_CONST               0 (None)
+                    1462 RETURN_VALUE
+                 >> 1464 PUSH_EXC_INFO
+                    1466 WITH_EXCEPT_START
+                    1468 POP_JUMP_FORWARD_IF_TRUE     4 (to 1478)
+                    1470 RERAISE                  2
+                 >> 1472 COPY                     3
+                    1474 POP_EXCEPT
+                    1476 RERAISE                  1
+                 >> 1478 POP_TOP
+                    1480 POP_EXCEPT
+                    1482 POP_TOP
+                    1484 POP_TOP
+                    1486 LOAD_CONST               0 (None)
+                    1488 RETURN_VALUE
          ExceptionTable:
-           222 to 1496 -> 1524 [1] lasti
-           1524 to 1530 -> 1532 [3] lasti
-           1538 to 1538 -> 1532 [3] lasti
+           222 to 1436 -> 1464 [1] lasti
+           1464 to 1470 -> 1472 [3] lasti
+           1478 to 1478 -> 1472 [3] lasti
          consts
             None
             'format'
             't'
             '.h5'
             'w'
             'blosc'
@@ -484,78 +476,74 @@
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 7
                flags     : 19
                code
                   0x95029700020089036a0000000000000000007c007c0166026401740200
-                  0000000000000000006a0200000000000000006a03000000000000000064
-                  0264039c038902a4018e0101008903a00400000000000000000000000000
-                  000000000000007c0064047402000000000000000000006a020000000000
-                  0000006a0500000000000000007402000000000000000000006a02000000
-                  00000000006a06000000000000000067036405ac06a6030000ab03000000
+                  0000000000000000006a020000000000000000640264039c038902a4018e
+                  0101008903a00300000000000000000000000000000000000000007c0064
+                  047402000000000000000000006a04000000000000000074020000000000
+                  00000000006a05000000000000000067036405ac06a6030000ab03000000
                   0000000000010064005300
                              0 COPY_FREE_VARS           2
                
                 21           2 RESUME                   0
                
                 22           4 PUSH_NULL
                              6 LOAD_DEREF               3 (store)
                              8 LOAD_ATTR                0 (put)
                             18 LOAD_FAST                0 (key)
                             20 LOAD_FAST                1 (df)
                             22 BUILD_TUPLE              2
                             24 LOAD_CONST               1 (True)
-                            26 LOAD_GLOBAL              2 (mdd)
-                            38 LOAD_ATTR                2 (MDConcepts)
-                            48 LOAD_ATTR                3 (base_columns)
-                            58 LOAD_CONST               2 (False)
-                            60 LOAD_CONST               3 (('index', 'data_columns', 'dropna'))
-                            62 BUILD_CONST_KEY_MAP      3
+                            26 LOAD_GLOBAL              2 (MDConcepts)
+                            38 LOAD_ATTR                2 (base_columns)
+                            48 LOAD_CONST               2 (False)
+                            50 LOAD_CONST               3 (('index', 'data_columns', 'dropna'))
+                            52 BUILD_CONST_KEY_MAP      3
                
-                23          64 LOAD_DEREF               2 (kwargs)
+                23          54 LOAD_DEREF               2 (kwargs)
                
-                22          66 DICT_MERGE               1
-                            68 CALL_FUNCTION_EX         1
-                            70 POP_TOP
+                22          56 DICT_MERGE               1
+                            58 CALL_FUNCTION_EX         1
+                            60 POP_TOP
                
-                24          72 LOAD_DEREF               3 (store)
-                            74 LOAD_METHOD              4 (create_table_index)
-                            96 LOAD_FAST                0 (key)
-                            98 LOAD_CONST               4 ('index')
-                           100 LOAD_GLOBAL              2 (mdd)
-                           112 LOAD_ATTR                2 (MDConcepts)
-                           122 LOAD_ATTR                5 (Time)
-                           132 LOAD_GLOBAL              2 (mdd)
-                           144 LOAD_ATTR                2 (MDConcepts)
-                           154 LOAD_ATTR                6 (Label)
-                           164 BUILD_LIST               3
-                           166 LOAD_CONST               5 ('full')
-                           168 KW_NAMES                 6
-                           170 PRECALL                  3
-                           174 CALL                     3
-                           184 POP_TOP
-                           186 LOAD_CONST               0 (None)
-                           188 RETURN_VALUE
+                24          62 LOAD_DEREF               3 (store)
+                            64 LOAD_METHOD              3 (create_table_index)
+                            86 LOAD_FAST                0 (key)
+                            88 LOAD_CONST               4 ('index')
+                            90 LOAD_GLOBAL              2 (MDConcepts)
+                           102 LOAD_ATTR                4 (Time)
+                           112 LOAD_GLOBAL              2 (MDConcepts)
+                           124 LOAD_ATTR                5 (Label)
+                           134 BUILD_LIST               3
+                           136 LOAD_CONST               5 ('full')
+                           138 KW_NAMES                 6
+                           140 PRECALL                  3
+                           144 CALL                     3
+                           154 POP_TOP
+                           156 LOAD_CONST               0 (None)
+                           158 RETURN_VALUE
                consts
                   None
                   True
                   False
                   ('index', 'data_columns', 'dropna')
                   'index'
                   'full'
                   ('columns', 'kind')
-               names      ('put', 'mdd', 'MDConcepts', 'base_columns', 'create_table_index', 'Time', 'Label')
+               names      ('put', 'MDConcepts', 'base_columns', 'create_table_index', 'Time', 'Label')
                varnames   ('key', 'df')
                freevars   ('kwargs', 'store')
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\exporting.py'
                name       'put_series'
                firstlineno 21
-               lnotab 0x04013c0102ff0602
+               lnotab 0x0401320102ff0602
             'events/'
             'measurements/'
             0
             'meta/extensions'
             'table'
             ('format', 'index')
             code
@@ -599,27 +587,27 @@
             ('data', 'index', 'columns')
             'meta/metadata'
             'meta/specs'
             'feature'
             'print_name'
             'data_type'
             ('columns',)
-         names      ('isinstance', 'str', 'os', 'PathLike', 'io_utils', 'ensure_directory_exists', 'ensure_ext', 'pd', 'HDFStore', 'put', 'index_frame', 'mdd', 'MDConcepts', 'base_columns', 'create_table_index', 'Time', 'Label', 'event_series', 'items', 'df', 'measurement_series', 'len', 'meta', 'extensions', 'list', 'registry', 'Extension', 'Metadata', 'map', 'zip', 'metadata', 'DataFrame', 'Index', 'series_containers', 'timeseries_spec', 'identifier', 'base', 'features', 'name', 'print_name', 'data_type', 'append', 'Type')
-         varnames   ('filename', 'md', 'complevel', 'kwargs', 'put_series', 'label', 'ess', 'mss', 'keys', 'values', 'metadata_df', 'specmeta', 'tsc', 'tt', 't', 'l', 'fspec', 'row')
+         names      ('isinstance', 'str', 'os', 'PathLike', 'io_utils', 'ensure_directory_exists', 'ensure_ext', 'pd', 'HDFStore', 'put', 'index_frame', 'MDConcepts', 'base_columns', 'create_table_index', 'Time', 'Label', 'event_series', 'items', 'df', 'measurement_series', 'len', 'meta', 'extensions', 'list', 'Extension', 'Metadata', 'map', 'zip', 'metadata', 'DataFrame', 'Index', 'series_containers', 'timeseries_spec', 'identifier', 'base', 'features', 'name', 'print_name', 'data_type', 'append', 'Type')
+         varnames   ('filename', 'md', 'complevel', 'kwargs', 'put_series', 'label', 'ess', 'mss', 'keys', 'values', 'metadata_df', 'specs_extra_metadata', 'tsc', 'tt', 't', 'fspec', 'row')
          freevars   ()
          cellvars   ('kwargs', 'store')
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\exporting.py'
          name       'write_machine_data_h5'
          firstlineno 10
          lnotab
-            0x060108010a01440128012a013201400102ff040102ff060272020c053c
-            012a013c012a023a0160013c018a0158012c02040112010e0114011c0140
-            011eff06022c013201420104ff02ff20e2
+            0x060108010a01440128012a013201360102ff040102ff06025e020c053c
+            012a013c012a023a01600132018a0158012c02040112010e0114011c0140
+            011eff06022c0132012e0104ff02ff20e2
       (0,)
-   names      ('os', 'pandas', 'pd', 'mdata.core', 'machine_data_def', 'mdd', 'mdata.core.extensions', 'registry', 'mdata.file_formats', 'io_utils', 'MachineData', 'int', 'write_machine_data_h5')
+   names      ('os', 'pandas', 'pd', 'mdata.core', 'MDConcepts', 'MachineData', 'mdata.core.extensions', 'Extension', 'mdata.file_formats', 'io_utils', 'int', 'write_machine_data_h5')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\file_formats\\hdf\\exporting.py'
    name       '<module>'
    firstlineno 1
-   lnotab 0x00ff0201080208020c010c010c03
+   lnotab 0x00ff02010802080210010c010c03
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/hdf/__pycache__/importing.cpython-310.pyc` & `mdata-0.1.3/src/mdata/file_formats/hdf/__pycache__/importing.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/hdf/exporting.py` & `mdata-0.1.3/src/mdata/file_formats/hdf/exporting.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,48 +1,48 @@
 import os
 
 import pandas as pd
 
-from mdata.core import machine_data_def as mdd
-from mdata.core.extensions import registry
+from mdata.core import MDConcepts, MachineData
+from mdata.core.extensions import Extension
 from mdata.file_formats import io_utils
 
 
-def write_machine_data_h5(filename, md: mdd.MachineData, complevel: int = 0, **kwargs) -> None:
+def write_machine_data_h5(filename, md: MachineData, complevel: int = 0, **kwargs) -> None:
     if 'format' not in kwargs:
         kwargs['format'] = 't'
     if isinstance(filename, str | os.PathLike):
         io_utils.ensure_directory_exists(filename)
         filename = io_utils.ensure_ext(filename, '.h5')
     with pd.HDFStore(filename, mode='w', complib='blosc', complevel=complevel) as store:
-        store.put('index', md.index_frame, index=True, data_columns=mdd.MDConcepts.base_columns,
+        store.put('index', md.index_frame, index=True, data_columns=MDConcepts.base_columns,
                   dropna=False, **kwargs)
-        store.create_table_index('index', columns=['index', mdd.MDConcepts.Time, mdd.MDConcepts.Label], kind='full')
+        store.create_table_index('index', columns=['index', MDConcepts.Time, MDConcepts.Label], kind='full')
 
         def put_series(key, df):
-            store.put(key, df, index=True, data_columns=mdd.MDConcepts.base_columns, dropna=False,
+            store.put(key, df, index=True, data_columns=MDConcepts.base_columns, dropna=False,
                       **kwargs)
-            store.create_table_index(key, columns=['index', mdd.MDConcepts.Time, mdd.MDConcepts.Label], kind='full')
+            store.create_table_index(key, columns=['index', MDConcepts.Time, MDConcepts.Label], kind='full')
 
         for label, ess in md.event_series.items():
             put_series(f'events/{label}', ess.df)
         for label, mss in md.measurement_series.items():
             put_series(f'measurements/{label}', mss.df)
 
         if len(md.meta.extensions) > 0:
             store.put('meta/extensions', list(md.meta.extensions), format='table', index=False)
-        if registry.Extension.Metadata in md.meta.extensions:
+        if Extension.Metadata in md.meta.extensions:
             keys, values = map(list, zip(*((k, v) for k, v in md.meta.metadata.items())))
             metadata_df = pd.DataFrame(data=values, index=pd.Index(keys, name='key'), columns=['value'])
             store.put('meta/metadata', metadata_df)
 
-            specmeta = []
+            specs_extra_metadata = []
             for tsc in md.series_containers:
                 tt = tsc.timeseries_spec
-                t, l = tt.identifier
+                t, label = tt.identifier
                 for fspec in tt.base.features:
-                    row = [t, l, fspec.name, fspec.print_name if fspec.name != fspec.print_name else [],
+                    row = [t, label, fspec.name, fspec.print_name if fspec.name != fspec.print_name else [],
                            fspec.data_type if fspec.data_type is not None else []]
-                specmeta.append(row)
-            store.put('meta/specs', pd.DataFrame(specmeta,
-                                                 columns=[mdd.MDConcepts.Type, mdd.MDConcepts.Label, 'feature',
+                specs_extra_metadata.append(row)
+            store.put('meta/specs', pd.DataFrame(specs_extra_metadata,
+                                                 columns=[MDConcepts.Type, MDConcepts.Label, 'feature',
                                                           'print_name', 'data_type']))
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/hdf/importing.py` & `mdata-0.1.3/src/mdata/file_formats/hdf/importing.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,20 +1,21 @@
 import pandas as pd
 
-from mdata.core import factory
-from mdata.core import machine_data_def as mdd
+from mdata.core import MDConcepts, MachineData, ObservationTypes
 from mdata.core.header import Meta
 from mdata.core.raw import RawMetadataFeatureSpec
 
 
 class InvalidHeaderException(Exception): pass
 
 
-def read_machine_data_h5(filename) -> mdd.MachineData:
+# noinspection PyTypeChecker
+def read_machine_data_h5(filename) -> MachineData:
     # ext = io_utils.ensure_ext(filename, '.h5', override_ext=False)
+    from mdata.core.factory import get_factory
 
     with pd.HDFStore(filename, mode='r') as store:
         measurements, events = [], []
         rel_groups = next(store.walk('/'))[1]
 
         extensions = set()
         use_metadata = False
@@ -26,46 +27,49 @@
         if use_metadata and store.get_node('meta/metadata') is not None:
             metadata_df: pd.DataFrame = store.get('meta/metadata')
             for key, row in metadata_df.iterrows():
                 value = row['value']
                 metadata[str(key)] = value
 
         if use_metadata and store.get_node('meta/specs') is not None:
-            specmeta = store.get('meta/specs')
+            spec_extra_metadata: pd.DataFrame = store.get('meta/specs')
 
-            def get_meta(t, l):
-                specmeta: pd.DataFrame
-                results = specmeta.loc[
-                    (specmeta[mdd.MDConcepts.Type] == t) & (specmeta[mdd.MDConcepts.Label] == l), ['feature',
-                                                                                                   'print_name',
-                                                                                                   'data_type']]
+            def get_meta(t, label) -> list[RawMetadataFeatureSpec]:
+                results = spec_extra_metadata.loc[
+                    (spec_extra_metadata[MDConcepts.Type] == t) & (
+                            spec_extra_metadata[MDConcepts.Label] == label), ['feature',
+                                                                                  'print_name',
+                                                                                  'data_type']]
                 specs = []
                 for f, idx in results.groupby('feature').groups.items():
                     g = results.loc[idx][['print_name', 'data_type']]
                     if len(g) != 1:
                         raise InvalidHeaderException(f'Duplicate feature metadata for {f}.')
                     pn, dt = g.iloc[0]
                     specs.append(RawMetadataFeatureSpec({f: {'print_name': pn, 'data_type': dt}}))
                 return specs
 
-        meta = Meta(extensions, metadata)
+        meta = Meta.of(extensions, metadata)
 
-        if 'events' in rel_groups:
-            (path, groups, leaves) = next(store.walk('/events'))
-            for label in leaves:
-                key = '/'.join([path, label])
-                df: pd.DataFrame = store.get(key)
-                specs = get_meta(mdd.ObservationTypes.E, label) if use_metadata else ()
-                ets = factory.ts_from_df(df, specmeta=specs)
-                events.append(ets)
-        if 'measurements' in rel_groups:
-            (path, groups, leaves) = next(store.walk('/measurements'))
-            for label in leaves:
-                key = '/'.join([path, label])
-                df: pd.DataFrame = store.get(key)
-                specs = get_meta(mdd.ObservationTypes.M, label) if use_metadata else ()
-                mts = factory.ts_from_df(df, specmeta=specs)
-                measurements.append(mts)
+        factory = get_factory(meta.extensions)
+
+        def make_series_cont(path, o_type, label):
+            key = '/'.join([path, label])
+            df: pd.DataFrame = store.get(key)
+            specs = get_meta(o_type, label) if use_metadata else ()
+            ts_spec = factory.make_ts_spec_from_data(spec_id=(o_type, label), df=df, extra_metadata=specs)
+            return factory.make_ts_container(ts_spec, df)
+
+        series_containers = []
+
+        def add_series_containers(base_key, o_type):
+            if base_key in rel_groups:
+                (path, groups, leaves) = next(store.walk(f'/{base_key}'))
+                for label in leaves:
+                    series_containers.append(make_series_cont(path, o_type, label))
+
+        add_series_containers('events', ObservationTypes.E)
+        add_series_containers('measurements', ObservationTypes.M)
 
         index_frame: pd.DataFrame = store.get('index')
 
-        return mdd.MachineData(meta, events, measurements, index_frame=index_frame)
+        return factory.make(meta, events, measurements, index_frame=index_frame)
```

### Comparing `mdata-0.1.2/src/mdata/file_formats/header_schema.json` & `mdata-0.1.3/src/mdata/file_formats/header_schema.json`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/io_utils.py` & `mdata-0.1.3/src/mdata/file_formats/io_utils.py`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/schema_template.json` & `mdata-0.1.3/src/mdata/file_formats/schema_template.json`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/file_formats/validity_checking_utils.py` & `mdata-0.1.3/src/mdata/file_formats/validity_checking_utils.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,12 +1,16 @@
-from mdata.core import mdd
+import pandas as pd
+
+import mdata.core.shared_defs
+from mdata.core import MachineData, MDConcepts
 from mdata.core.extensions.metadata import is_series_convertible
 from mdata.core.header import create_header_from_raw, FeatureSpec, ObservationSpec
-from mdata.core.raw import RawDataType, gen_feature_column_names, \
-    MDConcepts, RawHeaderSpec
+from mdata.core.raw import gen_feature_column_names, \
+    RawHeaderSpec
+from mdata.core.shared_defs import MDConcepts
 
 
 class ValidityCheckingException(Exception):
     pass
 
 
 class SyntacticValidityException(ValidityCheckingException):
@@ -37,19 +41,19 @@
     pass
 
 
 def get_placeholder_cols(df):
     return [c for c in df.columns if c not in MDConcepts.base_columns]
 
 
-def check_header_data_compatibility(header: RawHeaderSpec, data: RawDataType, do_typechecking=False):
+def check_header_data_compatibility(header: RawHeaderSpec, data: pd.DataFrame, do_typechecking=False):
     header = create_header_from_raw(header)
     placeholder_cols = get_placeholder_cols(data)
     to_be_cols = gen_feature_column_names(len(placeholder_cols))
-    for group, idx in data.groupby([mdd.MDConcepts.Type, mdd.MDConcepts.Label]).groups.items():
+    for group, idx in data.groupby([MDConcepts.Type, MDConcepts.Label]).groups.items():
         tpy, label = group
         spec: ObservationSpec = header.lookup_spec(tpy, label)
         if spec is None:
             raise InsufficientHeader
         f_len = len(spec)
         for i, c in enumerate(placeholder_cols):
             assert c == to_be_cols[i]
@@ -58,11 +62,11 @@
                 if do_typechecking and f.data_type is not None:
                     is_series_convertible(data.loc[idx, f.name], f.data_type)
             if i >= f_len and not data.loc[idx, c].isna().all():
                 raise InconsistentTimeseriesType
     return True
 
 
-def check_time_column(data: RawDataType):
+def check_time_column(data: pd.DataFrame):
     import pandas.core.dtypes.common
     if not pandas.core.dtypes.common.is_datetime64_any_dtype(data['time']):
         raise MalformedDataFileException('Time column could not be parsed as datetime.')
```

### Comparing `mdata-0.1.2/src/mdata/visualization/__pycache__/matplot.cpython-310.pyc` & `mdata-0.1.3/src/mdata/visualization/__pycache__/matplot.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/visualization/__pycache__/matplot.cpython-311.pyc` & `mdata-0.1.3/src/mdata/visualization/__pycache__/matplot.cpython-311.pyc`

 * *Files 13% similar despite different names*

#### Python bytecode

```diff
@@ -1,278 +1,258 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
-files sz: 1102
+moddate:  0xefe9d064 (Mon Aug  7 12:56:15 2023 UTC)
+files sz: 1030
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 10
    flags     : 0
    code
-      0x9700640064016c006d015a016d025a026d035a030100640064026c046d
-      055a060100640064026c075a08640064036c096d0a5a0a01006409640465
-      0a6a0b00000000000000006405650c6406650d650c190000000000000000
-      006407650e650c190000000000000000006608640884055a0f64025300
+      0x9700640064016c006d015a020100640064016c035a04640064026c056d
+      065a0601006408640365066a070000000000000000640465086405650965
+      08190000000000000000006406650a650819000000000000000000660864
+      0784055a0b64015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
-                 4 LOAD_CONST               1 (('TypedDict', 'Collection', 'Optional'))
-                 6 IMPORT_NAME              0 (typing)
-                 8 IMPORT_FROM              1 (TypedDict)
-                10 STORE_NAME               1 (TypedDict)
-                12 IMPORT_FROM              2 (Collection)
-                14 STORE_NAME               2 (Collection)
-                16 IMPORT_FROM              3 (Optional)
-                18 STORE_NAME               3 (Optional)
-                20 POP_TOP
+                 4 LOAD_CONST               1 (None)
+                 6 IMPORT_NAME              0 (matplotlib.pyplot)
+                 8 IMPORT_FROM              1 (pyplot)
+                10 STORE_NAME               2 (plt)
+                12 POP_TOP
    
-     3          22 LOAD_CONST               0 (0)
-                24 LOAD_CONST               2 (None)
-                26 IMPORT_NAME              4 (matplotlib.pyplot)
-                28 IMPORT_FROM              5 (pyplot)
-                30 STORE_NAME               6 (plt)
-                32 POP_TOP
-   
-     4          34 LOAD_CONST               0 (0)
-                36 LOAD_CONST               2 (None)
-                38 IMPORT_NAME              7 (seaborn)
-                40 STORE_NAME               8 (sns)
+     2          14 LOAD_CONST               0 (0)
+                16 LOAD_CONST               1 (None)
+                18 IMPORT_NAME              3 (seaborn)
+                20 STORE_NAME               4 (sns)
    
-     6          42 LOAD_CONST               0 (0)
-                44 LOAD_CONST               3 (('mdd',))
-                46 IMPORT_NAME              9 (mdata.core)
-                48 IMPORT_FROM             10 (mdd)
-                50 STORE_NAME              10 (mdd)
-                52 POP_TOP
+     4          22 LOAD_CONST               0 (0)
+                24 LOAD_CONST               2 (('mdd',))
+                26 IMPORT_NAME              5 (mdata.core)
+                28 IMPORT_FROM              6 (mdd)
+                30 STORE_NAME               6 (mdd)
+                32 POP_TOP
    
-     8          54 LOAD_CONST               9 ((None, None, None))
-                56 LOAD_CONST               4 ('md')
-                58 LOAD_NAME               10 (mdd)
-                60 LOAD_ATTR               11 (MachineData)
-                70 LOAD_CONST               5 ('measurement_type')
-                72 LOAD_NAME               12 (str)
-                74 LOAD_CONST               6 ('objects')
-                76 LOAD_NAME               13 (set)
-                78 LOAD_NAME               12 (str)
-                80 BINARY_SUBSCR
-                90 LOAD_CONST               7 ('features')
-                92 LOAD_NAME               14 (list)
-                94 LOAD_NAME               12 (str)
-                96 BINARY_SUBSCR
-               106 BUILD_TUPLE              8
-               108 LOAD_CONST               8 (<code object create_basic_stacked_subplots, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 8>)
-               110 MAKE_FUNCTION            5 (defaults, annotations)
-               112 STORE_NAME              15 (create_basic_stacked_subplots)
-               114 LOAD_CONST               2 (None)
-               116 RETURN_VALUE
+     6          34 LOAD_CONST               8 ((None, None, None))
+                36 LOAD_CONST               3 ('md')
+                38 LOAD_NAME                6 (mdd)
+                40 LOAD_ATTR                7 (BaseMachineData)
+                50 LOAD_CONST               4 ('measurement_type')
+                52 LOAD_NAME                8 (str)
+                54 LOAD_CONST               5 ('objects')
+                56 LOAD_NAME                9 (set)
+                58 LOAD_NAME                8 (str)
+                60 BINARY_SUBSCR
+                70 LOAD_CONST               6 ('features')
+                72 LOAD_NAME               10 (list)
+                74 LOAD_NAME                8 (str)
+                76 BINARY_SUBSCR
+                86 BUILD_TUPLE              8
+                88 LOAD_CONST               7 (<code object create_basic_stacked_subplots, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 6>)
+                90 MAKE_FUNCTION            5 (defaults, annotations)
+                92 STORE_NAME              11 (create_basic_stacked_subplots)
+                94 LOAD_CONST               1 (None)
+                96 RETURN_VALUE
    consts
       0
-      ('TypedDict', 'Collection', 'Optional')
       None
       ('mdd',)
       'md'
       'measurement_type'
       'objects'
       'features'
       code
          argcount  : 5
          nlocals   : 12
          stacksize : 9
          flags     : 3
          code
             0x870c870d97007c006a0000000000000000007c01190000000000000000
-            008a0d7c028a0c7c037d05890c8027740300000000000000000000890d6a
-            020000000000000000a00300000000000000000000000000000000000000
-            00a6000000ab000000000000000000a6010000ab0100000000000000008a
-            0c6e3f890c740900000000000000000000890d6a020000000000000000a0
-            030000000000000000000000000000000000000000a6000000ab00000000
-            0000000000a6010000ab0100000000000000006b010000000073024a0082
-            01880c660164018408890d6a0200000000000000004400a6000000ab0000
-            000000000000008a0c7c05801a740300000000000000000000890d6a0500
-            000000000000006a060000000000000000a6010000ab0100000000000000
-            007d056e3a7409000000000000000000007c05a6010000ab010000000000
-            000000740900000000000000000000890d6a0500000000000000006a0600
-            00000000000000a6010000ab0100000000000000006b010000000073024a
-            008201880d6601640284087c054400a6000000ab0000000000000000007d
-            05740f000000000000000000006a08000000000000000074130000000000
-            00000000007c05a6010000ab010000000000000000640364047c04ac05a6
-            040000ab0400000000000000005c0200007d067d07741500000000000000
-            0000007c05a6010000ab01000000000000000044005d425c0200007d087d
-            09890c44005d3a7d0a890da00b0000000000000000000000000000000000
-            0000007c0aa6010000ab0100000000000000007d0b741900000000000000
-            0000006a0d00000000000000007c0b6a0e000000000000000064067c097c
-            077c0819000000000000000000ac07a6040000ab04000000000000000001
-            008c3b8c437c06a00f0000000000000000000000000000000000000000a6
-            000000ab00000000000000000001007c065300
+            008a0d7c028a0c7c037d05890c8015740300000000000000000000890d6a
+            020000000000000000a6010000ab0100000000000000008a0c6e2d890c74
+            0700000000000000000000890d6a020000000000000000a6010000ab0100
+            000000000000006b010000000073024a008201880c660164018408890d6a
+            0200000000000000004400a6000000ab0000000000000000008a0c7c0580
+            1a740300000000000000000000890d6a0400000000000000006a05000000
+            0000000000a6010000ab0100000000000000007d056e3a74070000000000
+            00000000007c05a6010000ab010000000000000000740700000000000000
+            000000890d6a0400000000000000006a050000000000000000a6010000ab
+            0100000000000000006b010000000073024a008201880d6601640284087c
+            054400a6000000ab0000000000000000007d05740d000000000000000000
+            006a0700000000000000007411000000000000000000007c05a6010000ab
+            010000000000000000640364047c04ac05a6040000ab0400000000000000
+            005c0200007d067d077413000000000000000000007c05a6010000ab0100
+            0000000000000044005d425c0200007d087d09890c44005d3a7d0a890da0
+            0a00000000000000000000000000000000000000007c0aa6010000ab0100
+            000000000000007d0b7417000000000000000000006a0c00000000000000
+            007c0b6a0d000000000000000064067c097c077c08190000000000000000
+            00ac07a6040000ab04000000000000000001008c3b8c437c06a00e000000
+            0000000000000000000000000000000000a6000000ab0000000000000000
+            0001007c065300
                        0 MAKE_CELL               12 (os)
                        2 MAKE_CELL               13 (tsc)
          
-           8           4 RESUME                   0
+           6           4 RESUME                   0
          
-           9           6 LOAD_FAST                0 (md)
+           7           6 LOAD_FAST                0 (md)
                        8 LOAD_ATTR                0 (measurement_series)
                       18 LOAD_FAST                1 (measurement_type)
                       20 BINARY_SUBSCR
                       30 STORE_DEREF             13 (tsc)
          
-          10          32 LOAD_FAST                2 (objects)
+           8          32 LOAD_FAST                2 (objects)
                       34 STORE_DEREF             12 (os)
          
-          11          36 LOAD_FAST                3 (features)
+           9          36 LOAD_FAST                3 (features)
                       38 STORE_FAST               5 (fs)
          
-          12          40 LOAD_DEREF              12 (os)
-                      42 POP_JUMP_FORWARD_IF_NOT_NONE    39 (to 122)
+          10          40 LOAD_DEREF              12 (os)
+                      42 POP_JUMP_FORWARD_IF_NOT_NONE    21 (to 86)
          
-          13          44 LOAD_GLOBAL              3 (NULL + list)
+          11          44 LOAD_GLOBAL              3 (NULL + list)
                       56 LOAD_DEREF              13 (tsc)
-                      58 LOAD_ATTR                2 (object_map)
-                      68 LOAD_METHOD              3 (keys)
-                      90 PRECALL                  0
-                      94 CALL                     0
-                     104 PRECALL                  1
-                     108 CALL                     1
-                     118 STORE_DEREF             12 (os)
-                     120 JUMP_FORWARD            63 (to 248)
-         
-          15     >>  122 LOAD_DEREF              12 (os)
-                     124 LOAD_GLOBAL              9 (NULL + set)
-                     136 LOAD_DEREF              13 (tsc)
-                     138 LOAD_ATTR                2 (object_map)
-                     148 LOAD_METHOD              3 (keys)
-                     170 PRECALL                  0
-                     174 CALL                     0
-                     184 PRECALL                  1
-                     188 CALL                     1
-                     198 COMPARE_OP               1 (<=)
-                     204 POP_JUMP_FORWARD_IF_TRUE     2 (to 210)
-                     206 LOAD_ASSERTION_ERROR
-                     208 RAISE_VARARGS            1
-         
-          16     >>  210 LOAD_CLOSURE            12 (os)
-                     212 BUILD_TUPLE              1
-                     214 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 16>)
-                     216 MAKE_FUNCTION            8 (closure)
-                     218 LOAD_DEREF              13 (tsc)
-                     220 LOAD_ATTR                2 (object_map)
-                     230 GET_ITER
-                     232 PRECALL                  0
-                     236 CALL                     0
-                     246 STORE_DEREF             12 (os)
-         
-          17     >>  248 LOAD_FAST                5 (fs)
-                     250 POP_JUMP_FORWARD_IF_NOT_NONE    26 (to 304)
-         
-          18         252 LOAD_GLOBAL              3 (NULL + list)
-                     264 LOAD_DEREF              13 (tsc)
-                     266 LOAD_ATTR                5 (timeseries_spec)
-                     276 LOAD_ATTR                6 (features)
-                     286 PRECALL                  1
-                     290 CALL                     1
-                     300 STORE_FAST               5 (fs)
-                     302 JUMP_FORWARD            58 (to 420)
-         
-          20     >>  304 LOAD_GLOBAL              9 (NULL + set)
-                     316 LOAD_FAST                5 (fs)
-                     318 PRECALL                  1
-                     322 CALL                     1
-                     332 LOAD_GLOBAL              9 (NULL + set)
-                     344 LOAD_DEREF              13 (tsc)
-                     346 LOAD_ATTR                5 (timeseries_spec)
-                     356 LOAD_ATTR                6 (features)
-                     366 PRECALL                  1
-                     370 CALL                     1
-                     380 COMPARE_OP               1 (<=)
-                     386 POP_JUMP_FORWARD_IF_TRUE     2 (to 392)
-                     388 LOAD_ASSERTION_ERROR
-                     390 RAISE_VARARGS            1
-         
-          21     >>  392 LOAD_CLOSURE            13 (tsc)
-                     394 BUILD_TUPLE              1
-                     396 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 21>)
-                     398 MAKE_FUNCTION            8 (closure)
-                     400 LOAD_FAST                5 (fs)
-                     402 GET_ITER
-                     404 PRECALL                  0
-                     408 CALL                     0
-                     418 STORE_FAST               5 (fs)
-         
-          23     >>  420 LOAD_GLOBAL             15 (NULL + plt)
-                     432 LOAD_ATTR                8 (subplots)
-                     442 LOAD_GLOBAL             19 (NULL + len)
-                     454 LOAD_FAST                5 (fs)
-                     456 PRECALL                  1
-                     460 CALL                     1
-                     470 LOAD_CONST               3 (1)
-                     472 LOAD_CONST               4 (True)
-                     474 LOAD_FAST                4 (figsize)
-                     476 KW_NAMES                 5
-                     478 PRECALL                  4
-                     482 CALL                     4
-                     492 UNPACK_SEQUENCE          2
-                     496 STORE_FAST               6 (fig)
-                     498 STORE_FAST               7 (axs)
-         
-          25         500 LOAD_GLOBAL             21 (NULL + enumerate)
-                     512 LOAD_FAST                5 (fs)
-                     514 PRECALL                  1
-                     518 CALL                     1
-                     528 GET_ITER
-                 >>  530 FOR_ITER                66 (to 664)
-                     532 UNPACK_SEQUENCE          2
-                     536 STORE_FAST               8 (i)
-                     538 STORE_FAST               9 (f)
-         
-          26         540 LOAD_DEREF              12 (os)
-                     542 GET_ITER
-                 >>  544 FOR_ITER                58 (to 662)
-                     546 STORE_FAST              10 (o)
-         
-          27         548 LOAD_DEREF              13 (tsc)
-                     550 LOAD_METHOD             11 (view)
-                     572 LOAD_FAST               10 (o)
-                     574 PRECALL                  1
-                     578 CALL                     1
-                     588 STORE_FAST              11 (ts)
-         
-          28         590 LOAD_GLOBAL             25 (NULL + sns)
-                     602 LOAD_ATTR               13 (lineplot)
-                     612 LOAD_FAST               11 (ts)
-                     614 LOAD_ATTR               14 (df)
-                     624 LOAD_CONST               6 ('time')
-                     626 LOAD_FAST                9 (f)
-                     628 LOAD_FAST                7 (axs)
-                     630 LOAD_FAST                8 (i)
-                     632 BINARY_SUBSCR
-                     642 KW_NAMES                 7
-                     644 PRECALL                  4
-                     648 CALL                     4
-                     658 POP_TOP
-                     660 JUMP_BACKWARD           59 (to 544)
-         
-          26     >>  662 JUMP_BACKWARD           67 (to 530)
-         
-          31     >>  664 LOAD_FAST                6 (fig)
-                     666 LOAD_METHOD             15 (tight_layout)
-                     688 PRECALL                  0
-                     692 CALL                     0
-                     702 POP_TOP
+                      58 LOAD_ATTR                2 (objects)
+                      68 PRECALL                  1
+                      72 CALL                     1
+                      82 STORE_DEREF             12 (os)
+                      84 JUMP_FORWARD            45 (to 176)
+         
+          13     >>   86 LOAD_DEREF              12 (os)
+                      88 LOAD_GLOBAL              7 (NULL + set)
+                     100 LOAD_DEREF              13 (tsc)
+                     102 LOAD_ATTR                2 (objects)
+                     112 PRECALL                  1
+                     116 CALL                     1
+                     126 COMPARE_OP               1 (<=)
+                     132 POP_JUMP_FORWARD_IF_TRUE     2 (to 138)
+                     134 LOAD_ASSERTION_ERROR
+                     136 RAISE_VARARGS            1
+         
+          14     >>  138 LOAD_CLOSURE            12 (os)
+                     140 BUILD_TUPLE              1
+                     142 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 14>)
+                     144 MAKE_FUNCTION            8 (closure)
+                     146 LOAD_DEREF              13 (tsc)
+                     148 LOAD_ATTR                2 (objects)
+                     158 GET_ITER
+                     160 PRECALL                  0
+                     164 CALL                     0
+                     174 STORE_DEREF             12 (os)
+         
+          15     >>  176 LOAD_FAST                5 (fs)
+                     178 POP_JUMP_FORWARD_IF_NOT_NONE    26 (to 232)
+         
+          16         180 LOAD_GLOBAL              3 (NULL + list)
+                     192 LOAD_DEREF              13 (tsc)
+                     194 LOAD_ATTR                4 (timeseries_spec)
+                     204 LOAD_ATTR                5 (features)
+                     214 PRECALL                  1
+                     218 CALL                     1
+                     228 STORE_FAST               5 (fs)
+                     230 JUMP_FORWARD            58 (to 348)
+         
+          18     >>  232 LOAD_GLOBAL              7 (NULL + set)
+                     244 LOAD_FAST                5 (fs)
+                     246 PRECALL                  1
+                     250 CALL                     1
+                     260 LOAD_GLOBAL              7 (NULL + set)
+                     272 LOAD_DEREF              13 (tsc)
+                     274 LOAD_ATTR                4 (timeseries_spec)
+                     284 LOAD_ATTR                5 (features)
+                     294 PRECALL                  1
+                     298 CALL                     1
+                     308 COMPARE_OP               1 (<=)
+                     314 POP_JUMP_FORWARD_IF_TRUE     2 (to 320)
+                     316 LOAD_ASSERTION_ERROR
+                     318 RAISE_VARARGS            1
+         
+          19     >>  320 LOAD_CLOSURE            13 (tsc)
+                     322 BUILD_TUPLE              1
+                     324 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\matplot.py", line 19>)
+                     326 MAKE_FUNCTION            8 (closure)
+                     328 LOAD_FAST                5 (fs)
+                     330 GET_ITER
+                     332 PRECALL                  0
+                     336 CALL                     0
+                     346 STORE_FAST               5 (fs)
+         
+          21     >>  348 LOAD_GLOBAL             13 (NULL + plt)
+                     360 LOAD_ATTR                7 (subplots)
+                     370 LOAD_GLOBAL             17 (NULL + len)
+                     382 LOAD_FAST                5 (fs)
+                     384 PRECALL                  1
+                     388 CALL                     1
+                     398 LOAD_CONST               3 (1)
+                     400 LOAD_CONST               4 ('all')
+                     402 LOAD_FAST                4 (figsize)
+                     404 KW_NAMES                 5
+                     406 PRECALL                  4
+                     410 CALL                     4
+                     420 UNPACK_SEQUENCE          2
+                     424 STORE_FAST               6 (fig)
+                     426 STORE_FAST               7 (axs)
+         
+          23         428 LOAD_GLOBAL             19 (NULL + enumerate)
+                     440 LOAD_FAST                5 (fs)
+                     442 PRECALL                  1
+                     446 CALL                     1
+                     456 GET_ITER
+                 >>  458 FOR_ITER                66 (to 592)
+                     460 UNPACK_SEQUENCE          2
+                     464 STORE_FAST               8 (i)
+                     466 STORE_FAST               9 (f)
+         
+          24         468 LOAD_DEREF              12 (os)
+                     470 GET_ITER
+                 >>  472 FOR_ITER                58 (to 590)
+                     474 STORE_FAST              10 (o)
+         
+          25         476 LOAD_DEREF              13 (tsc)
+                     478 LOAD_METHOD             10 (view)
+                     500 LOAD_FAST               10 (o)
+                     502 PRECALL                  1
+                     506 CALL                     1
+                     516 STORE_FAST              11 (ts)
+         
+          26         518 LOAD_GLOBAL             23 (NULL + sns)
+                     530 LOAD_ATTR               12 (lineplot)
+                     540 LOAD_FAST               11 (ts)
+                     542 LOAD_ATTR               13 (df)
+                     552 LOAD_CONST               6 ('time')
+                     554 LOAD_FAST                9 (f)
+                     556 LOAD_FAST                7 (axs)
+                     558 LOAD_FAST                8 (i)
+                     560 BINARY_SUBSCR
+                     570 KW_NAMES                 7
+                     572 PRECALL                  4
+                     576 CALL                     4
+                     586 POP_TOP
+                     588 JUMP_BACKWARD           59 (to 472)
+         
+          24     >>  590 JUMP_BACKWARD           67 (to 458)
+         
+          29     >>  592 LOAD_FAST                6 (fig)
+                     594 LOAD_METHOD             14 (tight_layout)
+                     616 PRECALL                  0
+                     620 CALL                     0
+                     630 POP_TOP
          
-          32         704 LOAD_FAST                6 (fig)
-                     706 RETURN_VALUE
+          30         632 LOAD_FAST                6 (fig)
+                     634 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 19
                code 0x9501970067007c005d087d017c0189027600af067c0191028c095300
                              0 COPY_FREE_VARS           1
                
-                16           2 RESUME                   0
+                14           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                 8 (to 26)
                             10 STORE_FAST               1 (o)
                             12 LOAD_FAST                1 (o)
                             14 LOAD_DEREF               2 (os)
                             16 CONTAINS_OP              0
@@ -284,27 +264,27 @@
                consts
                names      ()
                varnames   ('.0', 'o')
                freevars   ('os',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\matplot.py'
                name       '<listcomp>'
-               firstlineno 16
+               firstlineno 14
                lnotab 0x
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 19
                code
                   0x9501970067007c005d127d017c0189026a0000000000000000006a0100
                   000000000000007600af107c0191028c135300
                              0 COPY_FREE_VARS           1
                
-                21           2 RESUME                   0
+                19           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                18 (to 46)
                             10 STORE_FAST               1 (f)
                             12 LOAD_FAST                1 (f)
                             14 LOAD_DEREF               2 (tsc)
                             16 LOAD_ATTR                0 (timeseries_spec)
@@ -318,33 +298,33 @@
                consts
                names      ('timeseries_spec', 'features')
                varnames   ('.0', 'f')
                freevars   ('tsc',)
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\matplot.py'
                name       '<listcomp>'
-               firstlineno 21
+               firstlineno 19
                lnotab 0x
             1
-            True
+            'all'
             ('sharex', 'figsize')
             'time'
             ('data', 'x', 'y', 'ax')
-         names      ('measurement_series', 'list', 'object_map', 'keys', 'set', 'timeseries_spec', 'features', 'plt', 'subplots', 'len', 'enumerate', 'view', 'sns', 'lineplot', 'df', 'tight_layout')
+         names      ('measurement_series', 'list', 'objects', 'set', 'timeseries_spec', 'features', 'plt', 'subplots', 'len', 'enumerate', 'view', 'sns', 'lineplot', 'df', 'tight_layout')
          varnames   ('md', 'measurement_type', 'objects', 'features', 'figsize', 'fs', 'fig', 'axs', 'i', 'f', 'o', 'ts')
          freevars   ()
          cellvars   ('os', 'tsc')
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\matplot.py'
          name       'create_basic_stacked_subplots'
-         firstlineno 8
+         firstlineno 6
          lnotab
-            0x06011a010401040104014e02580126010401340258011c025002280108
+            0x06011a010401040104012a02340126010401340258011c025002280108
             012a0148fe02052801
       (None, None, None)
-   names      ('typing', 'TypedDict', 'Collection', 'Optional', 'matplotlib.pyplot', 'pyplot', 'plt', 'seaborn', 'sns', 'mdata.core', 'mdd', 'MachineData', 'str', 'set', 'list', 'create_basic_stacked_subplots')
+   names      ('matplotlib.pyplot', 'pyplot', 'plt', 'seaborn', 'sns', 'mdata.core', 'mdd', 'BaseMachineData', 'str', 'set', 'list', 'create_basic_stacked_subplots')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\matplot.py'
    name       '<module>'
    firstlineno 1
-   lnotab 0x00ff020114020c0108020c02
+   lnotab 0x00ff02010c0108020c02
```

### Comparing `mdata-0.1.2/src/mdata/visualization/__pycache__/plotting.cpython-310.pyc` & `mdata-0.1.3/src/mdata/visualization/__pycache__/plotting.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `mdata-0.1.2/src/mdata/visualization/__pycache__/plotting.cpython-311.pyc` & `mdata-0.1.3/src/mdata/visualization/__pycache__/plotting.cpython-311.pyc`

 * *Files 9% similar despite different names*

#### Python bytecode

```diff
@@ -1,26 +1,25 @@
 magic:    0xa70d0d0a
-moddate:  0xbcd2bf64 (Tue Jul 25 13:48:44 2023 UTC)
-files sz: 7738
+moddate:  0xefe9d064 (Mon Aug  7 12:56:15 2023 UTC)
+files sz: 7794
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 12
    flags     : 0
    code
       0x9700640064016c006d015a010100640064026c026d035a036d045a0401
       00640064036c055a06640064036c075a08640064036c095a09640064036c
-      0a6d0b5a0c0100640064046c0d6d0e5a0e0100640064056c0f6d105a1101
-      00640064066c126d135a136d145a146d155a1501006415640965116a1600
-      000000000000006602640a84055a1702004700640b8400640c6503a60300
-      00ab0300000000000000005a18090009006416640965116a160000000000
-      000000640f65196410651964116504651919000000000000000000651a7a
-      07000064126504651919000000000000000000651a7a070000660a641384
-      055a1b6417640965116a1600000000000000006602641484055a1c640353
-      00
+      0a6d0b5a0c0100640064046c0d6d0e5a0e0100640064056c0f6d105a106d
+      115a116d125a120100640064066c136d145a140100640064076c156d165a
+      166d175a176d185a1801006416640a65116602640b84055a190200470064
+      0c8400640d6503a6030000ab0300000000000000005a1a09000900641764
+      0a65116410651b6411651b64126504651b19000000000000000000651c7a
+      07000064136504651b19000000000000000000651c7a070000660a641484
+      055a1d6418640a65116602641584055a1e64035300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('cycle',))
                  6 IMPORT_NAME              0 (itertools)
                  8 IMPORT_FROM              1 (cycle)
                 10 STORE_NAME               1 (cycle)
@@ -61,544 +60,533 @@
                 68 LOAD_CONST               4 (('make_subplots',))
                 70 IMPORT_NAME             13 (plotly.subplots)
                 72 IMPORT_FROM             14 (make_subplots)
                 74 STORE_NAME              14 (make_subplots)
                 76 POP_TOP
    
     10          78 LOAD_CONST               0 (0)
-                80 LOAD_CONST               5 (('machine_data_def',))
+                80 LOAD_CONST               5 (('MDConcepts', 'MachineData', 'ObservationTypes'))
                 82 IMPORT_NAME             15 (mdata.core)
-                84 IMPORT_FROM             16 (machine_data_def)
-                86 STORE_NAME              17 (mdd)
-                88 POP_TOP
+                84 IMPORT_FROM             16 (MDConcepts)
+                86 STORE_NAME              16 (MDConcepts)
+                88 IMPORT_FROM             17 (MachineData)
+                90 STORE_NAME              17 (MachineData)
+                92 IMPORT_FROM             18 (ObservationTypes)
+                94 STORE_NAME              18 (ObservationTypes)
+                96 POP_TOP
    
-    11          90 LOAD_CONST               0 (0)
-                92 LOAD_CONST               6 (('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list'))
-                94 IMPORT_NAME             18 (mdata.core.util)
-                96 IMPORT_FROM             19 (mangle_arg_to_set)
-                98 STORE_NAME              19 (mangle_arg_to_set)
-               100 IMPORT_FROM             20 (mangle_arg_with_bool_fallback)
-               102 STORE_NAME              20 (mangle_arg_with_bool_fallback)
-               104 IMPORT_FROM             21 (mangle_arg_to_list)
-               106 STORE_NAME              21 (mangle_arg_to_list)
+    11          98 LOAD_CONST               0 (0)
+               100 LOAD_CONST               6 (('project_on_feature_columns',))
+               102 IMPORT_NAME             19 (mdata.core.shared_defs)
+               104 IMPORT_FROM             20 (project_on_feature_columns)
+               106 STORE_NAME              20 (project_on_feature_columns)
                108 POP_TOP
    
-    14         110 LOAD_CONST              21 ((10000, True))
-               112 LOAD_CONST               9 ('md')
-               114 LOAD_NAME               17 (mdd)
-               116 LOAD_ATTR               22 (MachineData)
-               126 BUILD_TUPLE              2
-               128 LOAD_CONST              10 (<code object create_overview_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 14>)
-               130 MAKE_FUNCTION            5 (defaults, annotations)
-               132 STORE_NAME              23 (create_overview_plot)
+    12         110 LOAD_CONST               0 (0)
+               112 LOAD_CONST               7 (('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list'))
+               114 IMPORT_NAME             21 (mdata.core.util)
+               116 IMPORT_FROM             22 (mangle_arg_to_set)
+               118 STORE_NAME              22 (mangle_arg_to_set)
+               120 IMPORT_FROM             23 (mangle_arg_with_bool_fallback)
+               122 STORE_NAME              23 (mangle_arg_with_bool_fallback)
+               124 IMPORT_FROM             24 (mangle_arg_to_list)
+               126 STORE_NAME              24 (mangle_arg_to_list)
+               128 POP_TOP
    
-    84         134 PUSH_NULL
-               136 LOAD_BUILD_CLASS
-               138 LOAD_CONST              11 (<code object Selection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 84>)
-               140 MAKE_FUNCTION            0
-               142 LOAD_CONST              12 ('Selection')
-               144 LOAD_NAME                3 (TypedDict)
-               146 PRECALL                  3
-               150 CALL                     3
-               160 STORE_NAME              24 (Selection)
+    15         130 LOAD_CONST              22 ((10000, True))
+               132 LOAD_CONST              10 ('md')
+               134 LOAD_NAME               17 (MachineData)
+               136 BUILD_TUPLE              2
+               138 LOAD_CONST              11 (<code object create_overview_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 15>)
+               140 MAKE_FUNCTION            5 (defaults, annotations)
+               142 STORE_NAME              25 (create_overview_plot)
    
-    92         162 NOP
+    85         144 PUSH_NULL
+               146 LOAD_BUILD_CLASS
+               148 LOAD_CONST              12 (<code object Selection, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 85>)
+               150 MAKE_FUNCTION            0
+               152 LOAD_CONST              13 ('Selection')
+               154 LOAD_NAME                3 (TypedDict)
+               156 PRECALL                  3
+               160 CALL                     3
+               170 STORE_NAME              26 (Selection)
    
-    93         164 NOP
+    93         172 NOP
    
-    91         166 LOAD_CONST              22 ((True, True, 15000, False))
-               168 LOAD_CONST               9 ('md')
-               170 LOAD_NAME               17 (mdd)
-               172 LOAD_ATTR               22 (MachineData)
-               182 LOAD_CONST              15 ('measurement_type')
-               184 LOAD_NAME               25 (str)
-               186 LOAD_CONST              16 ('object')
-               188 LOAD_NAME               25 (str)
-               190 LOAD_CONST              17 ('features')
+    94         174 NOP
    
-    92         192 LOAD_NAME                4 (Collection)
-               194 LOAD_NAME               25 (str)
+    92         176 LOAD_CONST              23 ((True, True, 15000, False))
+               178 LOAD_CONST              10 ('md')
+               180 LOAD_NAME               17 (MachineData)
+               182 LOAD_CONST              16 ('measurement_type')
+               184 LOAD_NAME               27 (str)
+               186 LOAD_CONST              17 ('object')
+               188 LOAD_NAME               27 (str)
+               190 LOAD_CONST              18 ('features')
+   
+    93         192 LOAD_NAME                4 (Collection)
+               194 LOAD_NAME               27 (str)
                196 BINARY_SUBSCR
-               206 LOAD_NAME               26 (bool)
+               206 LOAD_NAME               28 (bool)
                208 BINARY_OP                7 (|)
    
-    91         212 LOAD_CONST              18 ('events')
+    92         212 LOAD_CONST              19 ('events')
    
-    93         214 LOAD_NAME                4 (Collection)
-               216 LOAD_NAME               25 (str)
+    94         214 LOAD_NAME                4 (Collection)
+               216 LOAD_NAME               27 (str)
                218 BINARY_SUBSCR
-               228 LOAD_NAME               26 (bool)
+               228 LOAD_NAME               28 (bool)
                230 BINARY_OP                7 (|)
    
-    91         234 BUILD_TUPLE             10
-               236 LOAD_CONST              19 (<code object create_timeseries_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 91>)
+    92         234 BUILD_TUPLE             10
+               236 LOAD_CONST              20 (<code object create_timeseries_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 92>)
                238 MAKE_FUNCTION            5 (defaults, annotations)
-               240 STORE_NAME              27 (create_timeseries_plot)
+               240 STORE_NAME              29 (create_timeseries_plot)
    
-   152         242 LOAD_CONST              23 ((True,))
-               244 LOAD_CONST               9 ('md')
-               246 LOAD_NAME               17 (mdd)
-               248 LOAD_ATTR               22 (MachineData)
-               258 BUILD_TUPLE              2
-               260 LOAD_CONST              20 (<code object create_measurement_frequency_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 152>)
-               262 MAKE_FUNCTION            5 (defaults, annotations)
-               264 STORE_NAME              28 (create_measurement_frequency_plot)
-               266 LOAD_CONST               3 (None)
-               268 RETURN_VALUE
+   154         242 LOAD_CONST              24 ((True,))
+               244 LOAD_CONST              10 ('md')
+               246 LOAD_NAME               17 (MachineData)
+               248 BUILD_TUPLE              2
+               250 LOAD_CONST              21 (<code object create_measurement_frequency_plot, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 154>)
+               252 MAKE_FUNCTION            5 (defaults, annotations)
+               254 STORE_NAME              30 (create_measurement_frequency_plot)
+               256 LOAD_CONST               3 (None)
+               258 RETURN_VALUE
    consts
       0
       ('cycle',)
       ('TypedDict', 'Collection')
       None
       ('make_subplots',)
-      ('machine_data_def',)
+      ('MDConcepts', 'MachineData', 'ObservationTypes')
+      ('project_on_feature_columns',)
       ('mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list')
       10000
       True
       'md'
       code
          argcount  : 3
-         nlocals   : 31
+         nlocals   : 29
          stacksize : 14
          flags     : 3
          code
             0x97007401000000000000000000006401640264036404ac05a6040000ab
-            0400000000000000007d03640684007d047402000000000000000000006a
-            0200000000000000006a0300000000000000006a04000000000000000066
-            01640784017d0564087d067402000000000000000000006a020000000000
-            0000006a0300000000000000006a0400000000000000007d077c006a0500
-            000000000000007d0864098400740d000000000000000000007c08740f00
-            0000000000000000007c07a6010000ab010000000000000000a6020000ab
-            0200000000000000004400a6000000ab0000000000000000007d097c00a0
-            080000000000000000000000000000000000000000a6000000ab00000000
-            0000000000440090015db17d0a7c0a6a0900000000000000007d0b7c0b6a
-            0a00000000000000007d0c7c0c7416000000000000000000006a0c000000
-            00000000006a0d00000000000000006b0200000000720264026e0164017d
-            0d7c0b6a0e00000000000000007d0e7c0a6a0f0000000000000000a01000
-            000000000000000000000000000000000000007416000000000000000000
-            006a1100000000000000006a120000000000000000a6010000ab01000000
-            00000000006a130000000000000000a01400000000000000000000000000
-            00000000000000a6000000ab000000000000000000440090015d3e5c0200
-            007d0f7d107c0f7d117c0a6a0f00000000000000006a1500000000000000
-            007c10190000000000000000007d127c097c0f190000000000000000007d
-            13742d000000000000000000007c12a6010000ab0100000000000000007d
-            147c0172567c147c016b040000000072507c14640a6b040000000073024a
-            008201742f0000000000000000000064027431000000000000000000007c
-            147c017a0b0000640b7a000000a6010000ab010000000000000000a60200
-            00ab0200000000000000007d157433000000000000000000006a1a000000
-            0000000000640a7c147c15a6030000ab0300000000000000007d167c126a
-            1b00000000000000007c16190000000000000000007d1264037d067c1274
-            16000000000000000000006a1100000000000000006a1c00000000000000
-            00190000000000000000007c127416000000000000000000006a11000000
-            00000000006a1d0000000000000000190000000000000000007d187d1774
-            17000000000000000000006a1e00000000000000007c12a6010000ab0100
-            000000000000007d197c02720c743e000000000000000000006a20000000
-            00000000006e0b743e000000000000000000006a2100000000000000007d
-            1a7445000000000000000000007c13ac0ca6010000ab0100000000000000
-            007d1b7c0b6a0a00000000000000009b00640d7c0b6a2300000000000000
-            009b00640d7c119b009d057d1c02007c1a7c1c7c197c177c18640e02007c
-            047c0ea6010000ab0100000000000000007c1b7c116408ac0fa6090000ab
-            0900000000000000007d0f7c03a024000000000000000000000000000000
-            00000000007c0f7c0d6402ac10a6030000ab030000000000000000010090
-            018c4090018cb37c0844005d4d7d1d7c03a0240000000000000000000000
-            000000000000000000743f000000000000000000006a2100000000000000
-            0064006701640067017445000000000000000000007c097c1d1900000000
-            0000000000ac0ca6010000ab010000000000000000640e7c1d6411641269
-            017c1d64036413ac14a6090000ab09000000000000000064026402ac10a6
-            030000ab03000000000000000001008c4e7c03a025000000000000000000
-            000000000000000000000064156416ac17a6020000ab0200000000000000
-            0001007c03a0250000000000000000000000000000000000000000641864
-            03641964026402ac1aa6050000ab05000000000000000001007c03a02500
-            00000000000000000000000000000000000000641b6403641964016402ac
-            1aa6050000ab0500000000000000000100641c7d1e7c0672097c1e641d7c
-            019b00641e9d037a0d00007d1e7c03a02600000000000000000000000000
-            000000000000007445000000000000000000007c1e641f640b6420ac21a6
-            040000ab0400000000000000007445000000000000000000006422640a64
-            236424ac25a6040000ab040000000000000000ac26a6020000ab02000000
-            000000000001007c035300
-          14           0 RESUME                   0
+            0400000000000000007d03640684007d0464077d05740200000000000000
+            0000006a0200000000000000006a0300000000000000006a040000000000
+            0000007d067c006a0500000000000000007d0764088400740d0000000000
+            00000000007c07740f000000000000000000007c06a6010000ab01000000
+            0000000000a6020000ab0200000000000000004400a6000000ab00000000
+            00000000007d087c006a080000000000000000440090015d987d097c096a
+            0900000000000000007d0a7c0a6a0a00000000000000007d0b7c0b741600
+            0000000000000000006a0c00000000000000006b0200000000720264026e
+            0164017d0c7c0a6a0d00000000000000007d0d7c096a0e00000000000000
+            00a00f000000000000000000000000000000000000000074200000000000
+            00000000006a110000000000000000a6010000ab0100000000000000006a
+            120000000000000000a01300000000000000000000000000000000000000
+            00a6000000ab000000000000000000440090015d2f5c0200007d0e7d0f7c
+            0e7d107c096a0e00000000000000006a1400000000000000007c0f190000
+            000000000000007d117c087c0e190000000000000000007d12742b000000
+            000000000000007c11a6010000ab0100000000000000007d137c0172567c
+            137c016b040000000072507c1364096b040000000073024a008201742d00
+            0000000000000000006402742f000000000000000000007c137c017a0b00
+            00640a7a000000a6010000ab010000000000000000a6020000ab02000000
+            00000000007d147431000000000000000000006a19000000000000000064
+            097c137c14a6030000ab0300000000000000007d0f7c116a1a0000000000
+            0000007c0f190000000000000000007d1164037d057c1174200000000000
+            00000000006a1b0000000000000000190000000000000000007c11742000
+            0000000000000000006a1c0000000000000000190000000000000000007d
+            167d15743b000000000000000000007c11a6010000ab0100000000000000
+            007d177c02720c743c000000000000000000006a1f00000000000000006e
+            0b743c000000000000000000006a2000000000000000007d187443000000
+            000000000000007c12ac0ba6010000ab0100000000000000007d197c0a6a
+            0a00000000000000009b00640c7c0a6a2200000000000000009b00640c7c
+            109b009d057d1a02007c187c1a7c177c157c16640d02007c047c0da60100
+            00ab0100000000000000007c197c106407ac0ea6090000ab090000000000
+            0000007d0e7c03a02300000000000000000000000000000000000000007c
+            0e7c0c6402ac0fa6030000ab030000000000000000010090018c3190018c
+            9a7c0744005d4d7d1b7c03a0230000000000000000000000000000000000
+            000000743d000000000000000000006a2000000000000000006400670164
+            0067017443000000000000000000007c087c1b19000000000000000000ac
+            0ba6010000ab010000000000000000640d7c1b6410641169017c1b640364
+            12ac13a6090000ab09000000000000000064026402ac0fa6030000ab0300
+            0000000000000001008c4e7c03a024000000000000000000000000000000
+            000000000064146415ac16a6020000ab02000000000000000001007c03a0
+            240000000000000000000000000000000000000000641764036418640264
+            02ac19a6050000ab05000000000000000001007c03a02400000000000000
+            00000000000000000000000000641a6403641864016402ac19a6050000ab
+            0500000000000000000100641b7d1c7c0572097c1c641c7c019b00641d9d
+            037a0d00007d1c7c03a02500000000000000000000000000000000000000
+            007443000000000000000000007c1c641e640a641fac20a6040000ab0400
+            000000000000007443000000000000000000006421640964226423ac24a6
+            040000ab040000000000000000ac25a6020000ab02000000000000000001
+            007c035300
+          15           0 RESUME                   0
          
-          15           2 LOAD_GLOBAL              1 (NULL + make_subplots)
+          16           2 LOAD_GLOBAL              1 (NULL + make_subplots)
                       14 LOAD_CONST               1 (2)
                       16 LOAD_CONST               2 (1)
                       18 LOAD_CONST               3 (True)
          
-          16          20 LOAD_CONST               4 (0.1)
+          17          20 LOAD_CONST               4 (0.1)
          
-          15          22 KW_NAMES                 5
+          16          22 KW_NAMES                 5
                       24 PRECALL                  4
                       28 CALL                     4
                       38 STORE_FAST               3 (fig)
          
-          18          40 LOAD_CONST               6 (<code object create_hovertemplate, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 18>)
+          19          40 LOAD_CONST               6 (<code object create_hovertemplate, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 19>)
                       42 MAKE_FUNCTION            0
                       44 STORE_FAST               4 (create_hovertemplate)
          
-          23          46 LOAD_GLOBAL              2 (plotly)
-                      58 LOAD_ATTR                2 (colors)
-                      68 LOAD_ATTR                3 (qualitative)
-                      78 LOAD_ATTR                4 (Plotly)
-                      88 BUILD_TUPLE              1
-                      90 LOAD_CONST               7 (<code object derive_colors, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 23>)
-                      92 MAKE_FUNCTION            1 (defaults)
-                      94 STORE_FAST               5 (derive_colors)
-         
-          28          96 LOAD_CONST               8 (False)
-                      98 STORE_FAST               6 (did_downsample)
-         
-          29         100 LOAD_GLOBAL              2 (plotly)
-                     112 LOAD_ATTR                2 (colors)
-                     122 LOAD_ATTR                3 (qualitative)
-                     132 LOAD_ATTR                4 (Plotly)
-                     142 STORE_FAST               7 (colorscale)
-         
-          30         144 LOAD_FAST                0 (md)
-                     146 LOAD_ATTR                5 (occurring_objects)
-                     156 STORE_FAST               8 (objs)
-         
-          31         158 LOAD_CONST               9 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 31>)
-                     160 MAKE_FUNCTION            0
-                     162 LOAD_GLOBAL             13 (NULL + zip)
-                     174 LOAD_FAST                8 (objs)
-                     176 LOAD_GLOBAL             15 (NULL + cycle)
-                     188 LOAD_FAST                7 (colorscale)
-                     190 PRECALL                  1
-                     194 CALL                     1
-                     204 PRECALL                  2
-                     208 CALL                     2
-                     218 GET_ITER
-                     220 PRECALL                  0
-                     224 CALL                     0
-                     234 STORE_FAST               9 (color_dict)
-         
-          33         236 LOAD_FAST                0 (md)
-                     238 LOAD_METHOD              8 (iter_all_timeseries)
-                     260 PRECALL                  0
-                     264 CALL                     0
-                     274 GET_ITER
-                 >>  276 EXTENDED_ARG             1
-                     278 FOR_ITER               433 (to 1146)
-                     280 STORE_FAST              10 (tsc)
-         
-          34         282 LOAD_FAST               10 (tsc)
-                     284 LOAD_ATTR                9 (timeseries_spec)
-                     294 STORE_FAST              11 (timeseries_type)
-         
-          35         296 LOAD_FAST               11 (timeseries_type)
-                     298 LOAD_ATTR               10 (type)
-                     308 STORE_FAST              12 (typ)
-         
-          36         310 LOAD_FAST               12 (typ)
-                     312 LOAD_GLOBAL             22 (mdd)
-                     324 LOAD_ATTR               12 (ObservationTypes)
-                     334 LOAD_ATTR               13 (E)
-                     344 COMPARE_OP               2 (==)
-                     350 POP_JUMP_FORWARD_IF_FALSE     2 (to 356)
-                     352 LOAD_CONST               2 (1)
-                     354 JUMP_FORWARD             1 (to 358)
-                 >>  356 LOAD_CONST               1 (2)
-                 >>  358 STORE_FAST              13 (row)
-         
-          37         360 LOAD_FAST               11 (timeseries_type)
-                     362 LOAD_ATTR               14 (features)
-                     372 STORE_FAST              14 (fs)
-         
-          38         374 LOAD_FAST               10 (tsc)
-                     376 LOAD_ATTR               15 (df)
-                     386 LOAD_METHOD             16 (groupby)
-                     408 LOAD_GLOBAL             22 (mdd)
-                     420 LOAD_ATTR               17 (MDConcepts)
-                     430 LOAD_ATTR               18 (Object)
-                     440 PRECALL                  1
-                     444 CALL                     1
-                     454 LOAD_ATTR               19 (groups)
-                     464 LOAD_METHOD             20 (items)
-                     486 PRECALL                  0
-                     490 CALL                     0
-                     500 GET_ITER
-                 >>  502 EXTENDED_ARG             1
-                     504 FOR_ITER               318 (to 1142)
-                     506 UNPACK_SEQUENCE          2
-                     510 STORE_FAST              15 (g)
-                     512 STORE_FAST              16 (gidx)
-         
-          39         514 LOAD_FAST               15 (g)
-                     516 STORE_FAST              17 (obj)
-         
-          40         518 LOAD_FAST               10 (tsc)
-                     520 LOAD_ATTR               15 (df)
-                     530 LOAD_ATTR               21 (loc)
-                     540 LOAD_FAST               16 (gidx)
-                     542 BINARY_SUBSCR
-                     552 STORE_FAST              18 (df)
-         
-          41         554 LOAD_FAST                9 (color_dict)
-                     556 LOAD_FAST               15 (g)
-                     558 BINARY_SUBSCR
-                     568 STORE_FAST              19 (c)
-         
-          43         570 LOAD_GLOBAL             45 (NULL + len)
-                     582 LOAD_FAST               18 (df)
-                     584 PRECALL                  1
-                     588 CALL                     1
-                     598 STORE_FAST              20 (length)
-         
-          44         600 LOAD_FAST                1 (downsample_to)
-                     602 POP_JUMP_FORWARD_IF_FALSE    86 (to 776)
-                     604 LOAD_FAST               20 (length)
-                     606 LOAD_FAST                1 (downsample_to)
-                     608 COMPARE_OP               4 (>)
-                     614 POP_JUMP_FORWARD_IF_FALSE    80 (to 776)
-         
-          45         616 LOAD_FAST               20 (length)
-                     618 LOAD_CONST              10 (0)
-                     620 COMPARE_OP               4 (>)
-                     626 POP_JUMP_FORWARD_IF_TRUE     2 (to 632)
-                     628 LOAD_ASSERTION_ERROR
-                     630 RAISE_VARARGS            1
-         
-          46     >>  632 LOAD_GLOBAL             47 (NULL + max)
-                     644 LOAD_CONST               2 (1)
-                     646 LOAD_GLOBAL             49 (NULL + int)
-                     658 LOAD_FAST               20 (length)
-                     660 LOAD_FAST                1 (downsample_to)
-                     662 BINARY_OP               11 (/)
-                     666 LOAD_CONST              11 (0.5)
-                     668 BINARY_OP                0 (+)
-                     672 PRECALL                  1
-                     676 CALL                     1
-                     686 PRECALL                  2
-                     690 CALL                     2
-                     700 STORE_FAST              21 (step)
-         
-          47         702 LOAD_GLOBAL             51 (NULL + np)
-                     714 LOAD_ATTR               26 (arange)
-                     724 LOAD_CONST              10 (0)
-                     726 LOAD_FAST               20 (length)
-                     728 LOAD_FAST               21 (step)
-                     730 PRECALL                  3
-                     734 CALL                     3
-                     744 STORE_FAST              22 (idx)
-         
-          48         746 LOAD_FAST               18 (df)
-                     748 LOAD_ATTR               27 (iloc)
-                     758 LOAD_FAST               22 (idx)
-                     760 BINARY_SUBSCR
-                     770 STORE_FAST              18 (df)
-         
-          49         772 LOAD_CONST               3 (True)
-                     774 STORE_FAST               6 (did_downsample)
-         
-          51     >>  776 LOAD_FAST               18 (df)
-                     778 LOAD_GLOBAL             22 (mdd)
-                     790 LOAD_ATTR               17 (MDConcepts)
-                     800 LOAD_ATTR               28 (Time)
-                     810 BINARY_SUBSCR
-                     820 LOAD_FAST               18 (df)
-                     822 LOAD_GLOBAL             22 (mdd)
-                     834 LOAD_ATTR               17 (MDConcepts)
-                     844 LOAD_ATTR               29 (Label)
-                     854 BINARY_SUBSCR
-                     864 STORE_FAST              24 (y)
-                     866 STORE_FAST              23 (x)
-         
-          52         868 LOAD_GLOBAL             23 (NULL + mdd)
-                     880 LOAD_ATTR               30 (project_on_feature_columns)
-                     890 LOAD_FAST               18 (df)
-                     892 PRECALL                  1
-                     896 CALL                     1
-                     906 STORE_FAST              25 (f_df)
-         
-          53         908 LOAD_FAST                2 (use_gl)
-                     910 POP_JUMP_FORWARD_IF_FALSE    12 (to 936)
-                     912 LOAD_GLOBAL             62 (go)
-                     924 LOAD_ATTR               32 (Scattergl)
-                     934 JUMP_FORWARD            11 (to 958)
-                 >>  936 LOAD_GLOBAL             62 (go)
-                     948 LOAD_ATTR               33 (Scatter)
-                 >>  958 STORE_FAST              26 (cls)
-         
-          54         960 LOAD_GLOBAL             69 (NULL + dict)
-                     972 LOAD_FAST               19 (c)
-                     974 KW_NAMES                12
-                     976 PRECALL                  1
-                     980 CALL                     1
-                     990 STORE_FAST              27 (marker)
-         
-          55         992 LOAD_FAST               11 (timeseries_type)
-                     994 LOAD_ATTR               10 (type)
-                    1004 FORMAT_VALUE             0
-                    1006 LOAD_CONST              13 ('_')
-                    1008 LOAD_FAST               11 (timeseries_type)
-                    1010 LOAD_ATTR               35 (label)
-                    1020 FORMAT_VALUE             0
-                    1022 LOAD_CONST              13 ('_')
-                    1024 LOAD_FAST               17 (obj)
-                    1026 FORMAT_VALUE             0
-                    1028 BUILD_STRING             5
-                    1030 STORE_FAST              28 (n)
-         
-          56        1032 PUSH_NULL
-                    1034 LOAD_FAST               26 (cls)
-                    1036 LOAD_FAST               28 (n)
-                    1038 LOAD_FAST               25 (f_df)
-                    1040 LOAD_FAST               23 (x)
-                    1042 LOAD_FAST               24 (y)
-                    1044 LOAD_CONST              14 ('markers')
-         
-          57        1046 PUSH_NULL
-                    1048 LOAD_FAST                4 (create_hovertemplate)
-                    1050 LOAD_FAST               14 (fs)
-                    1052 PRECALL                  1
-                    1056 CALL                     1
-                    1066 LOAD_FAST               27 (marker)
-                    1068 LOAD_FAST               17 (obj)
-         
-          58        1070 LOAD_CONST               8 (False)
-         
-          56        1072 KW_NAMES                15
-                    1074 PRECALL                  9
-                    1078 CALL                     9
-                    1088 STORE_FAST              15 (g)
-         
-          59        1090 LOAD_FAST                3 (fig)
-                    1092 LOAD_METHOD             36 (add_trace)
-                    1114 LOAD_FAST               15 (g)
-                    1116 LOAD_FAST               13 (row)
-                    1118 LOAD_CONST               2 (1)
-                    1120 KW_NAMES                16
-                    1122 PRECALL                  3
-                    1126 CALL                     3
-                    1136 POP_TOP
-                    1138 EXTENDED_ARG             1
-                    1140 JUMP_BACKWARD          320 (to 502)
-         
-          38     >> 1142 EXTENDED_ARG             1
-                    1144 JUMP_BACKWARD          435 (to 276)
-         
-          61     >> 1146 LOAD_FAST                8 (objs)
-                    1148 GET_ITER
-                 >> 1150 FOR_ITER                77 (to 1306)
-                    1152 STORE_FAST              29 (o)
-         
-          63        1154 LOAD_FAST                3 (fig)
-                    1156 LOAD_METHOD             36 (add_trace)
-         
-          64        1178 LOAD_GLOBAL             63 (NULL + go)
-                    1190 LOAD_ATTR               33 (Scatter)
-                    1200 LOAD_CONST               0 (None)
-                    1202 BUILD_LIST               1
-                    1204 LOAD_CONST               0 (None)
-                    1206 BUILD_LIST               1
-                    1208 LOAD_GLOBAL             69 (NULL + dict)
-                    1220 LOAD_FAST                9 (color_dict)
-                    1222 LOAD_FAST               29 (o)
-                    1224 BINARY_SUBSCR
-                    1234 KW_NAMES                12
-                    1236 PRECALL                  1
-                    1240 CALL                     1
-                    1250 LOAD_CONST              14 ('markers')
-                    1252 LOAD_FAST               29 (o)
-         
-          65        1254 LOAD_CONST              17 ('color')
-                    1256 LOAD_CONST              18 ('rgba(0, 0, 0, 0)')
-                    1258 BUILD_MAP                1
-                    1260 LOAD_FAST               29 (o)
-                    1262 LOAD_CONST               3 (True)
-                    1264 LOAD_CONST              19 ('none')
-         
-          64        1266 KW_NAMES                20
-                    1268 PRECALL                  9
-                    1272 CALL                     9
-         
-          65        1282 LOAD_CONST               2 (1)
-         
-          66        1284 LOAD_CONST               2 (1)
-         
-          63        1286 KW_NAMES                16
-                    1288 PRECALL                  3
-                    1292 CALL                     3
-                    1302 POP_TOP
-                    1304 JUMP_BACKWARD           78 (to 1150)
-         
-          68     >> 1306 LOAD_FAST                3 (fig)
-                    1308 LOAD_METHOD             37 (update_yaxes)
-                    1330 LOAD_CONST              21 ('category descending')
-                    1332 LOAD_CONST              22 ('left')
-                    1334 KW_NAMES                23
-                    1336 PRECALL                  2
-                    1340 CALL                     2
-                    1350 POP_TOP
-         
-          69        1352 LOAD_FAST                3 (fig)
-                    1354 LOAD_METHOD             37 (update_yaxes)
-                    1376 LOAD_CONST              24 ('Events')
-                    1378 LOAD_CONST               3 (True)
-                    1380 LOAD_CONST              25 ('category')
-                    1382 LOAD_CONST               2 (1)
-                    1384 LOAD_CONST               2 (1)
-                    1386 KW_NAMES                26
-                    1388 PRECALL                  5
-                    1392 CALL                     5
-                    1402 POP_TOP
-         
-          70        1404 LOAD_FAST                3 (fig)
-                    1406 LOAD_METHOD             37 (update_yaxes)
-                    1428 LOAD_CONST              27 ('Measurements')
-                    1430 LOAD_CONST               3 (True)
-                    1432 LOAD_CONST              25 ('category')
-                    1434 LOAD_CONST               1 (2)
-                    1436 LOAD_CONST               2 (1)
-                    1438 KW_NAMES                26
-                    1440 PRECALL                  5
-                    1444 CALL                     5
-                    1454 POP_TOP
-         
-          74        1456 LOAD_CONST              28 ('Overview')
-                    1458 STORE_FAST              30 (title_text)
-         
-          75        1460 LOAD_FAST                6 (did_downsample)
-                    1462 POP_JUMP_FORWARD_IF_FALSE     9 (to 1482)
-         
-          76        1464 LOAD_FAST               30 (title_text)
-                    1466 LOAD_CONST              29 ('<br><sup>(sampled to ')
-                    1468 LOAD_FAST                1 (downsample_to)
-                    1470 FORMAT_VALUE             0
-                    1472 LOAD_CONST              30 (' data points per series)</sup>')
-                    1474 BUILD_STRING             3
-                    1476 BINARY_OP               13 (+=)
-                    1480 STORE_FAST              30 (title_text)
-         
-          77     >> 1482 LOAD_FAST                3 (fig)
-                    1484 LOAD_METHOD             38 (update_layout)
-                    1506 LOAD_GLOBAL             69 (NULL + dict)
-                    1518 LOAD_FAST               30 (title_text)
-                    1520 LOAD_CONST              31 ('center')
-                    1522 LOAD_CONST              11 (0.5)
-                    1524 LOAD_CONST              32 (24)
-                    1526 KW_NAMES                33
-                    1528 PRECALL                  4
-                    1532 CALL                     4
-         
-          78        1542 LOAD_GLOBAL             69 (NULL + dict)
-                    1554 LOAD_CONST              34 ('Objects')
-                    1556 LOAD_CONST              10 (0)
-                    1558 LOAD_CONST              35 (1.2)
-                    1560 LOAD_CONST              36 ('h')
-                    1562 KW_NAMES                37
-                    1564 PRECALL                  4
-                    1568 CALL                     4
-         
-          77        1578 KW_NAMES                38
-                    1580 PRECALL                  2
-                    1584 CALL                     2
-                    1594 POP_TOP
+          29          46 LOAD_CONST               7 (False)
+                      48 STORE_FAST               5 (did_downsample)
+         
+          30          50 LOAD_GLOBAL              2 (plotly)
+                      62 LOAD_ATTR                2 (colors)
+                      72 LOAD_ATTR                3 (qualitative)
+                      82 LOAD_ATTR                4 (Plotly)
+                      92 STORE_FAST               6 (colorscale)
+         
+          31          94 LOAD_FAST                0 (md)
+                      96 LOAD_ATTR                5 (objects)
+                     106 STORE_FAST               7 (objs)
+         
+          32         108 LOAD_CONST               8 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 32>)
+                     110 MAKE_FUNCTION            0
+                     112 LOAD_GLOBAL             13 (NULL + zip)
+                     124 LOAD_FAST                7 (objs)
+                     126 LOAD_GLOBAL             15 (NULL + cycle)
+                     138 LOAD_FAST                6 (colorscale)
+                     140 PRECALL                  1
+                     144 CALL                     1
+                     154 PRECALL                  2
+                     158 CALL                     2
+                     168 GET_ITER
+                     170 PRECALL                  0
+                     174 CALL                     0
+                     184 STORE_FAST               8 (color_dict)
+         
+          34         186 LOAD_FAST                0 (md)
+                     188 LOAD_ATTR                8 (series_containers)
+                     198 GET_ITER
+                 >>  200 EXTENDED_ARG             1
+                     202 FOR_ITER               408 (to 1020)
+                     204 STORE_FAST               9 (tsc)
+         
+          35         206 LOAD_FAST                9 (tsc)
+                     208 LOAD_ATTR                9 (timeseries_spec)
+                     218 STORE_FAST              10 (timeseries_type)
+         
+          36         220 LOAD_FAST               10 (timeseries_type)
+                     222 LOAD_ATTR               10 (type)
+                     232 STORE_FAST              11 (typ)
+         
+          37         234 LOAD_FAST               11 (typ)
+                     236 LOAD_GLOBAL             22 (ObservationTypes)
+                     248 LOAD_ATTR               12 (E)
+                     258 COMPARE_OP               2 (==)
+                     264 POP_JUMP_FORWARD_IF_FALSE     2 (to 270)
+                     266 LOAD_CONST               2 (1)
+                     268 JUMP_FORWARD             1 (to 272)
+                 >>  270 LOAD_CONST               1 (2)
+                 >>  272 STORE_FAST              12 (row)
+         
+          38         274 LOAD_FAST               10 (timeseries_type)
+                     276 LOAD_ATTR               13 (features)
+                     286 STORE_FAST              13 (fs)
+         
+          39         288 LOAD_FAST                9 (tsc)
+                     290 LOAD_ATTR               14 (df)
+                     300 LOAD_METHOD             15 (groupby)
+                     322 LOAD_GLOBAL             32 (MDConcepts)
+                     334 LOAD_ATTR               17 (Object)
+                     344 PRECALL                  1
+                     348 CALL                     1
+                     358 LOAD_ATTR               18 (groups)
+                     368 LOAD_METHOD             19 (items)
+                     390 PRECALL                  0
+                     394 CALL                     0
+                     404 GET_ITER
+                 >>  406 EXTENDED_ARG             1
+                     408 FOR_ITER               303 (to 1016)
+                     410 UNPACK_SEQUENCE          2
+                     414 STORE_FAST              14 (g)
+                     416 STORE_FAST              15 (idx)
+         
+          40         418 LOAD_FAST               14 (g)
+                     420 STORE_FAST              16 (obj)
+         
+          41         422 LOAD_FAST                9 (tsc)
+                     424 LOAD_ATTR               14 (df)
+                     434 LOAD_ATTR               20 (loc)
+                     444 LOAD_FAST               15 (idx)
+                     446 BINARY_SUBSCR
+                     456 STORE_FAST              17 (df)
+         
+          42         458 LOAD_FAST                8 (color_dict)
+                     460 LOAD_FAST               14 (g)
+                     462 BINARY_SUBSCR
+                     472 STORE_FAST              18 (c)
+         
+          44         474 LOAD_GLOBAL             43 (NULL + len)
+                     486 LOAD_FAST               17 (df)
+                     488 PRECALL                  1
+                     492 CALL                     1
+                     502 STORE_FAST              19 (length)
+         
+          45         504 LOAD_FAST                1 (downsample_to)
+                     506 POP_JUMP_FORWARD_IF_FALSE    86 (to 680)
+                     508 LOAD_FAST               19 (length)
+                     510 LOAD_FAST                1 (downsample_to)
+                     512 COMPARE_OP               4 (>)
+                     518 POP_JUMP_FORWARD_IF_FALSE    80 (to 680)
+         
+          46         520 LOAD_FAST               19 (length)
+                     522 LOAD_CONST               9 (0)
+                     524 COMPARE_OP               4 (>)
+                     530 POP_JUMP_FORWARD_IF_TRUE     2 (to 536)
+                     532 LOAD_ASSERTION_ERROR
+                     534 RAISE_VARARGS            1
+         
+          47     >>  536 LOAD_GLOBAL             45 (NULL + max)
+                     548 LOAD_CONST               2 (1)
+                     550 LOAD_GLOBAL             47 (NULL + int)
+                     562 LOAD_FAST               19 (length)
+                     564 LOAD_FAST                1 (downsample_to)
+                     566 BINARY_OP               11 (/)
+                     570 LOAD_CONST              10 (0.5)
+                     572 BINARY_OP                0 (+)
+                     576 PRECALL                  1
+                     580 CALL                     1
+                     590 PRECALL                  2
+                     594 CALL                     2
+                     604 STORE_FAST              20 (step)
+         
+          48         606 LOAD_GLOBAL             49 (NULL + np)
+                     618 LOAD_ATTR               25 (arange)
+                     628 LOAD_CONST               9 (0)
+                     630 LOAD_FAST               19 (length)
+                     632 LOAD_FAST               20 (step)
+                     634 PRECALL                  3
+                     638 CALL                     3
+                     648 STORE_FAST              15 (idx)
+         
+          49         650 LOAD_FAST               17 (df)
+                     652 LOAD_ATTR               26 (iloc)
+                     662 LOAD_FAST               15 (idx)
+                     664 BINARY_SUBSCR
+                     674 STORE_FAST              17 (df)
+         
+          50         676 LOAD_CONST               3 (True)
+                     678 STORE_FAST               5 (did_downsample)
+         
+          52     >>  680 LOAD_FAST               17 (df)
+                     682 LOAD_GLOBAL             32 (MDConcepts)
+                     694 LOAD_ATTR               27 (Time)
+                     704 BINARY_SUBSCR
+                     714 LOAD_FAST               17 (df)
+                     716 LOAD_GLOBAL             32 (MDConcepts)
+                     728 LOAD_ATTR               28 (Label)
+                     738 BINARY_SUBSCR
+                     748 STORE_FAST              22 (y)
+                     750 STORE_FAST              21 (x)
+         
+          53         752 LOAD_GLOBAL             59 (NULL + project_on_feature_columns)
+                     764 LOAD_FAST               17 (df)
+                     766 PRECALL                  1
+                     770 CALL                     1
+                     780 STORE_FAST              23 (f_df)
+         
+          54         782 LOAD_FAST                2 (use_gl)
+                     784 POP_JUMP_FORWARD_IF_FALSE    12 (to 810)
+                     786 LOAD_GLOBAL             60 (go)
+                     798 LOAD_ATTR               31 (Scattergl)
+                     808 JUMP_FORWARD            11 (to 832)
+                 >>  810 LOAD_GLOBAL             60 (go)
+                     822 LOAD_ATTR               32 (Scatter)
+                 >>  832 STORE_FAST              24 (cls)
+         
+          55         834 LOAD_GLOBAL             67 (NULL + dict)
+                     846 LOAD_FAST               18 (c)
+                     848 KW_NAMES                11
+                     850 PRECALL                  1
+                     854 CALL                     1
+                     864 STORE_FAST              25 (marker)
+         
+          56         866 LOAD_FAST               10 (timeseries_type)
+                     868 LOAD_ATTR               10 (type)
+                     878 FORMAT_VALUE             0
+                     880 LOAD_CONST              12 ('_')
+                     882 LOAD_FAST               10 (timeseries_type)
+                     884 LOAD_ATTR               34 (label)
+                     894 FORMAT_VALUE             0
+                     896 LOAD_CONST              12 ('_')
+                     898 LOAD_FAST               16 (obj)
+                     900 FORMAT_VALUE             0
+                     902 BUILD_STRING             5
+                     904 STORE_FAST              26 (n)
+         
+          57         906 PUSH_NULL
+                     908 LOAD_FAST               24 (cls)
+                     910 LOAD_FAST               26 (n)
+                     912 LOAD_FAST               23 (f_df)
+                     914 LOAD_FAST               21 (x)
+                     916 LOAD_FAST               22 (y)
+                     918 LOAD_CONST              13 ('markers')
+         
+          58         920 PUSH_NULL
+                     922 LOAD_FAST                4 (create_hovertemplate)
+                     924 LOAD_FAST               13 (fs)
+                     926 PRECALL                  1
+                     930 CALL                     1
+                     940 LOAD_FAST               25 (marker)
+                     942 LOAD_FAST               16 (obj)
+         
+          59         944 LOAD_CONST               7 (False)
+         
+          57         946 KW_NAMES                14
+                     948 PRECALL                  9
+                     952 CALL                     9
+                     962 STORE_FAST              14 (g)
+         
+          60         964 LOAD_FAST                3 (fig)
+                     966 LOAD_METHOD             35 (add_trace)
+                     988 LOAD_FAST               14 (g)
+                     990 LOAD_FAST               12 (row)
+                     992 LOAD_CONST               2 (1)
+                     994 KW_NAMES                15
+                     996 PRECALL                  3
+                    1000 CALL                     3
+                    1010 POP_TOP
+                    1012 EXTENDED_ARG             1
+                    1014 JUMP_BACKWARD          305 (to 406)
+         
+          39     >> 1016 EXTENDED_ARG             1
+                    1018 JUMP_BACKWARD          410 (to 200)
+         
+          62     >> 1020 LOAD_FAST                7 (objs)
+                    1022 GET_ITER
+                 >> 1024 FOR_ITER                77 (to 1180)
+                    1026 STORE_FAST              27 (o)
+         
+          64        1028 LOAD_FAST                3 (fig)
+                    1030 LOAD_METHOD             35 (add_trace)
+         
+          65        1052 LOAD_GLOBAL             61 (NULL + go)
+                    1064 LOAD_ATTR               32 (Scatter)
+                    1074 LOAD_CONST               0 (None)
+                    1076 BUILD_LIST               1
+                    1078 LOAD_CONST               0 (None)
+                    1080 BUILD_LIST               1
+                    1082 LOAD_GLOBAL             67 (NULL + dict)
+                    1094 LOAD_FAST                8 (color_dict)
+                    1096 LOAD_FAST               27 (o)
+                    1098 BINARY_SUBSCR
+                    1108 KW_NAMES                11
+                    1110 PRECALL                  1
+                    1114 CALL                     1
+                    1124 LOAD_CONST              13 ('markers')
+                    1126 LOAD_FAST               27 (o)
+         
+          66        1128 LOAD_CONST              16 ('color')
+                    1130 LOAD_CONST              17 ('rgba(0, 0, 0, 0)')
+                    1132 BUILD_MAP                1
+                    1134 LOAD_FAST               27 (o)
+                    1136 LOAD_CONST               3 (True)
+                    1138 LOAD_CONST              18 ('none')
+         
+          65        1140 KW_NAMES                19
+                    1142 PRECALL                  9
+                    1146 CALL                     9
+         
+          66        1156 LOAD_CONST               2 (1)
+         
+          67        1158 LOAD_CONST               2 (1)
+         
+          64        1160 KW_NAMES                15
+                    1162 PRECALL                  3
+                    1166 CALL                     3
+                    1176 POP_TOP
+                    1178 JUMP_BACKWARD           78 (to 1024)
+         
+          69     >> 1180 LOAD_FAST                3 (fig)
+                    1182 LOAD_METHOD             36 (update_yaxes)
+                    1204 LOAD_CONST              20 ('category descending')
+                    1206 LOAD_CONST              21 ('left')
+                    1208 KW_NAMES                22
+                    1210 PRECALL                  2
+                    1214 CALL                     2
+                    1224 POP_TOP
+         
+          70        1226 LOAD_FAST                3 (fig)
+                    1228 LOAD_METHOD             36 (update_yaxes)
+                    1250 LOAD_CONST              23 ('Events')
+                    1252 LOAD_CONST               3 (True)
+                    1254 LOAD_CONST              24 ('category')
+                    1256 LOAD_CONST               2 (1)
+                    1258 LOAD_CONST               2 (1)
+                    1260 KW_NAMES                25
+                    1262 PRECALL                  5
+                    1266 CALL                     5
+                    1276 POP_TOP
+         
+          71        1278 LOAD_FAST                3 (fig)
+                    1280 LOAD_METHOD             36 (update_yaxes)
+                    1302 LOAD_CONST              26 ('Measurements')
+                    1304 LOAD_CONST               3 (True)
+                    1306 LOAD_CONST              24 ('category')
+                    1308 LOAD_CONST               1 (2)
+                    1310 LOAD_CONST               2 (1)
+                    1312 KW_NAMES                25
+                    1314 PRECALL                  5
+                    1318 CALL                     5
+                    1328 POP_TOP
+         
+          75        1330 LOAD_CONST              27 ('Overview')
+                    1332 STORE_FAST              28 (title_text)
+         
+          76        1334 LOAD_FAST                5 (did_downsample)
+                    1336 POP_JUMP_FORWARD_IF_FALSE     9 (to 1356)
+         
+          77        1338 LOAD_FAST               28 (title_text)
+                    1340 LOAD_CONST              28 ('<br><sup>(sampled to ')
+                    1342 LOAD_FAST                1 (downsample_to)
+                    1344 FORMAT_VALUE             0
+                    1346 LOAD_CONST              29 (' data points per series)</sup>')
+                    1348 BUILD_STRING             3
+                    1350 BINARY_OP               13 (+=)
+                    1354 STORE_FAST              28 (title_text)
+         
+          78     >> 1356 LOAD_FAST                3 (fig)
+                    1358 LOAD_METHOD             37 (update_layout)
+                    1380 LOAD_GLOBAL             67 (NULL + dict)
+                    1392 LOAD_FAST               28 (title_text)
+                    1394 LOAD_CONST              30 ('center')
+                    1396 LOAD_CONST              10 (0.5)
+                    1398 LOAD_CONST              31 (24)
+                    1400 KW_NAMES                32
+                    1402 PRECALL                  4
+                    1406 CALL                     4
+         
+          79        1416 LOAD_GLOBAL             67 (NULL + dict)
+                    1428 LOAD_CONST              33 ('Objects')
+                    1430 LOAD_CONST               9 (0)
+                    1432 LOAD_CONST              34 (1.2)
+                    1434 LOAD_CONST              35 ('h')
+                    1436 KW_NAMES                36
+                    1438 PRECALL                  4
+                    1442 CALL                     4
+         
+          78        1452 KW_NAMES                37
+                    1454 PRECALL                  2
+                    1458 CALL                     2
+                    1468 POP_TOP
          
-          81        1596 LOAD_FAST                3 (fig)
-                    1598 RETURN_VALUE
+          82        1470 LOAD_FAST                3 (fig)
+                    1472 RETURN_VALUE
          consts
             None
             2
             1
             True
             0.1
             ('rows', 'cols', 'shared_xaxes', 'vertical_spacing')
@@ -608,51 +596,51 @@
                stacksize : 7
                flags     : 19
                code
                   0x970064016402a000000000000000000000000000000000000000000064
                   0384007403000000000000000000007c00a6010000ab0100000000000000
                   004400a6000000ab000000000000000000a6010000ab0100000000000000
                   007a00000064047a0000005300
-                18           0 RESUME                   0
+                19           0 RESUME                   0
                
-                19           2 LOAD_CONST               1 ('<b>time: %{x:%X}</b><br>')
+                20           2 LOAD_CONST               1 ('<b>time: %{x:%X}</b><br>')
                
-                21           4 LOAD_CONST               2 ('<br>')
+                22           4 LOAD_CONST               2 ('<br>')
                              6 LOAD_METHOD              0 (join)
-                            28 LOAD_CONST               3 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 21>)
+                            28 LOAD_CONST               3 (<code object <listcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 22>)
                             30 MAKE_FUNCTION            0
                             32 LOAD_GLOBAL              3 (NULL + enumerate)
                             44 LOAD_FAST                0 (fs)
                             46 PRECALL                  1
                             50 CALL                     1
                             60 GET_ITER
                             62 PRECALL                  0
                             66 CALL                     0
                             76 PRECALL                  1
                             80 CALL                     1
                
-                19          90 BINARY_OP                0 (+)
+                20          90 BINARY_OP                0 (+)
                
-                21          94 LOAD_CONST               4 ('<extra></extra>')
+                22          94 LOAD_CONST               4 ('<extra></extra>')
                
-                19          96 BINARY_OP                0 (+)
+                20          96 BINARY_OP                0 (+)
                            100 RETURN_VALUE
                consts
                   None
                   '<b>time: %{x:%X}</b><br>'
                   '<br>'
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 7
                      flags     : 19
                      code
                         0x970067007c005d0e5c0200007d017d0264007c029b0064017c019b0064
                         029d0591028c0f5300
-                      21           0 RESUME                   0
+                      22           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                14 (to 36)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (i)
                                   14 STORE_FAST               2 (f)
                                   16 LOAD_CONST               0 ('<i>')
@@ -672,80 +660,33 @@
                         ']}</i>'
                      names      ()
                      varnames   ('.0', 'i', 'f')
                      freevars   ()
                      cellvars   ()
                      filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
                      name       '<listcomp>'
-                     firstlineno 21
+                     firstlineno 22
                      lnotab 0x
                   '<extra></extra>'
                names      ('join', 'enumerate')
                varnames   ('fs',)
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
                name       'create_hovertemplate'
-               firstlineno 18
+               firstlineno 19
                lnotab 0x0201020256fe040202fe
-            code
-               argcount  : 2
-               nlocals   : 4
-               stacksize : 4
-               flags     : 19
-               code
-                  0x97007401000000000000000000006a0100000000000000007c00a60100
-                  00ab0100000000000000005c0200007d027d037c02740500000000000000
-                  0000007c01a6010000ab0100000000000000007a0600007d027407000000
-                  000000000000006a0400000000000000007c017c02a6020000ab02000000
-                  00000000005300
-                23           0 RESUME                   0
-               
-                24           2 LOAD_GLOBAL              1 (NULL + pd)
-                            14 LOAD_ATTR                1 (factorize)
-                            24 LOAD_FAST                0 (series)
-                            26 PRECALL                  1
-                            30 CALL                     1
-                            40 UNPACK_SEQUENCE          2
-                            44 STORE_FAST               2 (codes)
-                            46 STORE_FAST               3 (_)
-               
-                25          48 LOAD_FAST                2 (codes)
-                            50 LOAD_GLOBAL              5 (NULL + len)
-                            62 LOAD_FAST                1 (colorscale)
-                            64 PRECALL                  1
-                            68 CALL                     1
-                            78 BINARY_OP                6 (%)
-                            82 STORE_FAST               2 (codes)
-               
-                26          84 LOAD_GLOBAL              7 (NULL + np)
-                            96 LOAD_ATTR                4 (take)
-                           106 LOAD_FAST                1 (colorscale)
-                           108 LOAD_FAST                2 (codes)
-                           110 PRECALL                  2
-                           114 CALL                     2
-                           124 RETURN_VALUE
-               consts
-                  None
-               names      ('pd', 'factorize', 'len', 'np', 'take')
-               varnames   ('series', 'colorscale', 'codes', '_')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
-               name       'derive_colors'
-               firstlineno 23
-               lnotab 0x02012e012401
             False
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 4
                flags     : 19
                code 0x970069007c005d085c0200007d017d027c017c0293028c095300
-                31           0 RESUME                   0
+                32           0 RESUME                   0
                              2 BUILD_MAP                0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 8 (to 24)
                              8 UNPACK_SEQUENCE          2
                             12 STORE_FAST               1 (o)
                             14 STORE_FAST               2 (c)
                             16 LOAD_FAST                1 (o)
@@ -756,15 +697,15 @@
                consts
                names      ()
                varnames   ('.0', 'o', 'c')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
                name       '<dictcomp>'
-               firstlineno 31
+               firstlineno 32
                lnotab 0x
             0
             0.5
             ('color',)
             '_'
             'markers'
             ('name', 'customdata', 'x', 'y', 'mode', 'hovertemplate', 'marker', 'legendgroup', 'showlegend')
@@ -787,63 +728,63 @@
             24
             ('text', 'xanchor', 'x', 'font_size')
             'Objects'
             1.2
             'h'
             ('title_text', 'x', 'y', 'orientation')
             ('title', 'legend')
-         names      ('make_subplots', 'plotly', 'colors', 'qualitative', 'Plotly', 'occurring_objects', 'zip', 'cycle', 'iter_all_timeseries', 'timeseries_spec', 'type', 'mdd', 'ObservationTypes', 'E', 'features', 'df', 'groupby', 'MDConcepts', 'Object', 'groups', 'items', 'loc', 'len', 'max', 'int', 'np', 'arange', 'iloc', 'Time', 'Label', 'project_on_feature_columns', 'go', 'Scattergl', 'Scatter', 'dict', 'label', 'add_trace', 'update_yaxes', 'update_layout')
-         varnames   ('md', 'downsample_to', 'use_gl', 'fig', 'create_hovertemplate', 'derive_colors', 'did_downsample', 'colorscale', 'objs', 'color_dict', 'tsc', 'timeseries_type', 'typ', 'row', 'fs', 'g', 'gidx', 'obj', 'df', 'c', 'length', 'step', 'idx', 'x', 'y', 'f_df', 'cls', 'marker', 'n', 'o', 'title_text')
+         names      ('make_subplots', 'plotly', 'colors', 'qualitative', 'Plotly', 'objects', 'zip', 'cycle', 'series_containers', 'timeseries_spec', 'type', 'ObservationTypes', 'E', 'features', 'df', 'groupby', 'MDConcepts', 'Object', 'groups', 'items', 'loc', 'len', 'max', 'int', 'np', 'arange', 'iloc', 'Time', 'Label', 'project_on_feature_columns', 'go', 'Scattergl', 'Scatter', 'dict', 'label', 'add_trace', 'update_yaxes', 'update_layout')
+         varnames   ('md', 'downsample_to', 'use_gl', 'fig', 'create_hovertemplate', 'did_downsample', 'colorscale', 'objs', 'color_dict', 'tsc', 'timeseries_type', 'typ', 'row', 'fs', 'g', 'idx', 'obj', 'df', 'c', 'length', 'step', 'x', 'y', 'f_df', 'cls', 'marker', 'n', 'o', 'title_text')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
          name       'create_overview_plot'
-         firstlineno 14
+         firstlineno 15
          lnotab
-            0x0201120102ff12030605320504012c010e014e022e010e010e0132010e
-            018c010401240110021e011001100146012c011a0104025c012801340120
-            0128010e01180102fe120334eb0417080218014c010cff1001020102fd14
-            052e01340134040401040112013c0124ff1204
+            0x0201120102ff1203060a04012c010e014e0214010e010e0128010e0182
+            010401240110021e011001100146012c011a01040248011e013401200128
+            010e01180102fe120334eb0417080218014c010cff1001020102fd14052e
+            01340134040401040112013c0124ff1204
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 3
          flags     : 0
          code
             0x970065005a0164005a0255006503650464013c0000006503650464023c
             000000650565031900000000000000000065067a070000650464033c0000
             00650765031900000000000000000065067a070000650464043c00000064
             055300
-          84           0 RESUME                   0
+          85           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('Selection')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          85          12 LOAD_NAME                3 (str)
+          86          12 LOAD_NAME                3 (str)
                       14 LOAD_NAME                4 (__annotations__)
                       16 LOAD_CONST               1 ('object')
                       18 STORE_SUBSCR
          
-          86          22 LOAD_NAME                3 (str)
+          87          22 LOAD_NAME                3 (str)
                       24 LOAD_NAME                4 (__annotations__)
                       26 LOAD_CONST               2 ('measurement')
                       28 STORE_SUBSCR
          
-          87          32 LOAD_NAME                5 (list)
+          88          32 LOAD_NAME                5 (list)
                       34 LOAD_NAME                3 (str)
                       36 BINARY_SUBSCR
                       46 LOAD_NAME                6 (bool)
                       48 BINARY_OP                7 (|)
                       52 LOAD_NAME                4 (__annotations__)
                       54 LOAD_CONST               3 ('features')
                       56 STORE_SUBSCR
          
-          88          60 LOAD_NAME                7 (set)
+          89          60 LOAD_NAME                7 (set)
                       62 LOAD_NAME                3 (str)
                       64 BINARY_SUBSCR
                       74 LOAD_NAME                6 (bool)
                       76 BINARY_OP                7 (|)
                       80 LOAD_NAME                4 (__annotations__)
                       82 LOAD_CONST               4 ('events')
                       84 STORE_SUBSCR
@@ -858,15 +799,15 @@
             None
          names      ('__name__', '__module__', '__qualname__', 'str', '__annotations__', 'list', 'bool', 'set')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
          name       'Selection'
-         firstlineno 84
+         firstlineno 85
          lnotab 0x0c010a010a011c01
       'Selection'
       15000
       False
       'measurement_type'
       'object'
       'features'
@@ -886,409 +827,407 @@
             00000000007d037411000000000000000000007c03a6010000ab01000000
             00000000007411000000000000000000007c076a0600000000000000006a
             070000000000000000a6010000ab0100000000000000006b010000000073
             024a0082017c076a0900000000000000007d0864007d0974150000000000
             00000000007c08a6010000ab0100000000000000007d0a7c0a7c056b0400
             0000007210640264036c0b6d0c7d0b010002007c0ba6000000ab00000000
             00000000007d097c086a0d00000000000000007c08741c00000000000000
-            0000006a0f00000000000000006a10000000000000000019000000000000
-            0000007c026b0200000000741c000000000000000000006a0f0000000000
-            0000006a11000000000000000067017c037a000000660219000000000000
-            0000007d087c06722b742500000000000000000000640474150000000000
-            00000000007c03a6010000ab010000000000000000a6020000ab02000000
-            00000000007d0c64057c0c7a0b000067017c0c7a050000640667017a0000
-            007d0d6e046405640667027d0d7427000000000000000000007415000000
-            000000000000007c0da6010000ab01000000000000000064047c0d640764
-            08ac09a6050000ab0500000000000000007d0e7429000000000000000000
-            007c036404ac0aa6020000ab02000000000000000044005db55c0200007d
-            0f7d107c08741c000000000000000000006a0f00000000000000006a1100
+            0000006a0f0000000000000000190000000000000000007c026b02000000
+            00741c000000000000000000006a10000000000000000067017c037a0000
+            006602190000000000000000007d087c06722b7423000000000000000000
+            0064047415000000000000000000007c03a6010000ab0100000000000000
+            00a6020000ab0200000000000000007d0c64057c0c7a0b000067017c0c7a
+            050000640667017a0000007d0d6e046405640667027d0d74250000000000
+            00000000007415000000000000000000007c0da6010000ab010000000000
+            00000064047c0d64076408ac09a6050000ab0500000000000000007d0e74
+            27000000000000000000007c036404ac0aa6020000ab0200000000000000
+            0044005db05c0200007d0f7d107c08741c000000000000000000006a1000
             00000000000000190000000000000000007c087c10190000000000000000
-            007d127d117c12a0150000000000000000000000000000000000000000a6
+            007d127d117c12a0140000000000000000000000000000000000000000a6
             000000ab0000000000000000000f007d137c117c13190000000000000000
-            007c127c13190000000000000000007d127d117c0981367c116a16000000
-            00000000007d117c126a1600000000000000007d127c09a0170000000000
+            007c127c13190000000000000000007d127d117c0981367c116a15000000
+            00000000007d117c126a1500000000000000007d127c09a0160000000000
             0000000000000000000000000000007c117c127c05ac0ba6030000ab0300
             000000000000007d147c117c14190000000000000000007d117c127c1419
-            0000000000000000007d127c0672027c0f6e0164047d157c0ea018000000
-            00000000000000000000000000000000007433000000000000000000006a
-            1a00000000000000007c107c117c12640cac0da6040000ab040000000000
-            0000007c156404ac0ea6030000ab03000000000000000001008cb6741500
+            0000000000000000007d127c0672027c0f6e0164047d157c0ea017000000
+            00000000000000000000000000000000007431000000000000000000006a
+            1900000000000000007c107c117c12640cac0da6040000ab040000000000
+            0000007c156404ac0ea6030000ab03000000000000000001008cb1741500
             0000000000000000007c0da6010000ab0100000000000000007d167c0444
-            005d927d177c006a1b00000000000000007c17190000000000000000006a
-            0900000000000000007d187c186a0d00000000000000007c186a1c000000
+            005d8d7d177c006a1a00000000000000007c17190000000000000000006a
+            0900000000000000007d187c186a0d00000000000000007c186a1b000000
             00000000007c026b0200000000190000000000000000007d187c18741c00
-            0000000000000000006a0f00000000000000006a11000000000000000019
-            0000000000000000007d117c0ea018000000000000000000000000000000
-            00000000007433000000000000000000006a1d00000000000000007c177c
-            11743d000000000000000000006a1f00000000000000007c11a6010000ab
-            010000000000000000640f744100000000000000000000641064116412ac
-            13a6030000ab030000000000000000ac14a6050000ab0500000000000000
-            007c166404ac0ea6030000ab03000000000000000001008c937c0ea02100
-            000000000000000000000000000000000000007c1664046415ac16a60300
-            00ab030000000000000000010064177d197c09810c7c1964187c059b0064
-            197c0a9b00641a9d057a0d00007d197c0ea0220000000000000000000000
-            0000000000000000007c1964077441000000000000000000006402641b64
-            1cac1da6030000ab030000000000000000ac1ea6030000ab030000000000
-            00000001007c0e5300
-          91           0 RESUME                   0
+            0000000000000000006a100000000000000000190000000000000000007d
+            117c0ea01700000000000000000000000000000000000000007431000000
+            000000000000006a1c00000000000000007c177c11743b00000000000000
+            0000006a1e00000000000000007c11a6010000ab01000000000000000064
+            0f743f00000000000000000000641064116412ac13a6030000ab03000000
+            0000000000ac14a6050000ab0500000000000000007c166404ac0ea60300
+            00ab03000000000000000001008c8e7c0ea0200000000000000000000000
+            0000000000000000007c1664046415ac16a6030000ab0300000000000000
+            00010064177d197c09810c7c1964187c059b0064197c0a9b00641a9d057a
+            0d00007d197c0ea02100000000000000000000000000000000000000007c
+            196407743f000000000000000000006402641b641cac1da6030000ab0300
+            00000000000000ac1ea6030000ab03000000000000000001007c0e5300
+          92           0 RESUME                   0
          
-          94           2 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
+          95           2 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
                       14 LOAD_GLOBAL              2 (mangle_arg_to_set)
                       26 LOAD_FAST                4 (events)
                       28 LOAD_FAST                0 (md)
                       30 LOAD_ATTR                2 (event_specs)
                       40 LOAD_METHOD              3 (keys)
                       62 PRECALL                  0
                       66 CALL                     0
                       76 KW_NAMES                 1
                       78 PRECALL                  3
                       82 CALL                     3
                       92 STORE_FAST               4 (events)
          
-          95          94 LOAD_FAST                0 (md)
+          96          94 LOAD_FAST                0 (md)
                       96 LOAD_ATTR                4 (measurement_series)
                      106 LOAD_FAST                1 (measurement_type)
                      108 BINARY_SUBSCR
                      118 STORE_FAST               7 (tsc)
          
-          96         120 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
+          97         120 LOAD_GLOBAL              1 (NULL + mangle_arg_with_bool_fallback)
                      132 LOAD_GLOBAL             10 (mangle_arg_to_list)
                      144 LOAD_FAST                3 (features)
                      146 LOAD_FAST                7 (tsc)
                      148 LOAD_ATTR                6 (timeseries_spec)
                      158 LOAD_ATTR                7 (features)
                      168 KW_NAMES                 1
                      170 PRECALL                  3
                      174 CALL                     3
                      184 STORE_FAST               3 (features)
          
-          98         186 LOAD_GLOBAL             17 (NULL + set)
+          99         186 LOAD_GLOBAL             17 (NULL + set)
                      198 LOAD_FAST                3 (features)
                      200 PRECALL                  1
                      204 CALL                     1
                      214 LOAD_GLOBAL             17 (NULL + set)
                      226 LOAD_FAST                7 (tsc)
                      228 LOAD_ATTR                6 (timeseries_spec)
                      238 LOAD_ATTR                7 (features)
                      248 PRECALL                  1
                      252 CALL                     1
                      262 COMPARE_OP               1 (<=)
                      268 POP_JUMP_FORWARD_IF_TRUE     2 (to 274)
                      270 LOAD_ASSERTION_ERROR
                      272 RAISE_VARARGS            1
          
-          99     >>  274 LOAD_FAST                7 (tsc)
+         100     >>  274 LOAD_FAST                7 (tsc)
                      276 LOAD_ATTR                9 (df)
                      286 STORE_FAST               8 (df)
          
-         101         288 LOAD_CONST               0 (None)
+         102         288 LOAD_CONST               0 (None)
                      290 STORE_FAST               9 (sampler)
          
-         102         292 LOAD_GLOBAL             21 (NULL + len)
+         103         292 LOAD_GLOBAL             21 (NULL + len)
                      304 LOAD_FAST                8 (df)
                      306 PRECALL                  1
                      310 CALL                     1
                      320 STORE_FAST              10 (full_length)
          
-         103         322 LOAD_FAST               10 (full_length)
+         104         322 LOAD_FAST               10 (full_length)
                      324 LOAD_FAST                5 (downsample_to)
                      326 COMPARE_OP               4 (>)
                      332 POP_JUMP_FORWARD_IF_FALSE    16 (to 366)
          
-         104         334 LOAD_CONST               2 (0)
+         105         334 LOAD_CONST               2 (0)
                      336 LOAD_CONST               3 (('MinMaxLTTBDownsampler',))
                      338 IMPORT_NAME             11 (tsdownsample)
                      340 IMPORT_FROM             12 (MinMaxLTTBDownsampler)
                      342 STORE_FAST              11 (MinMaxLTTBDownsampler)
                      344 POP_TOP
          
-         105         346 PUSH_NULL
+         106         346 PUSH_NULL
                      348 LOAD_FAST               11 (MinMaxLTTBDownsampler)
                      350 PRECALL                  0
                      354 CALL                     0
                      364 STORE_FAST               9 (sampler)
          
-         107     >>  366 LOAD_FAST                8 (df)
+         108     >>  366 LOAD_FAST                8 (df)
                      368 LOAD_ATTR               13 (loc)
                      378 LOAD_FAST                8 (df)
-                     380 LOAD_GLOBAL             28 (mdd)
-                     392 LOAD_ATTR               15 (MDConcepts)
-                     402 LOAD_ATTR               16 (Object)
-                     412 BINARY_SUBSCR
-                     422 LOAD_FAST                2 (object)
-                     424 COMPARE_OP               2 (==)
-                     430 LOAD_GLOBAL             28 (mdd)
-                     442 LOAD_ATTR               15 (MDConcepts)
-                     452 LOAD_ATTR               17 (Time)
-                     462 BUILD_LIST               1
-                     464 LOAD_FAST                3 (features)
-                     466 BINARY_OP                0 (+)
-                     470 BUILD_TUPLE              2
-                     472 BINARY_SUBSCR
-                     482 STORE_FAST               8 (df)
-         
-         109         484 LOAD_FAST                6 (split_into_subplots)
-                     486 POP_JUMP_FORWARD_IF_FALSE    43 (to 574)
-         
-         110         488 LOAD_GLOBAL             37 (NULL + max)
-                     500 LOAD_CONST               4 (1)
-                     502 LOAD_GLOBAL             21 (NULL + len)
-                     514 LOAD_FAST                3 (features)
-                     516 PRECALL                  1
-                     520 CALL                     1
-                     530 PRECALL                  2
-                     534 CALL                     2
-                     544 STORE_FAST              12 (f_count)
-         
-         111         546 LOAD_CONST               5 (0.9)
-                     548 LOAD_FAST               12 (f_count)
-                     550 BINARY_OP               11 (/)
-                     554 BUILD_LIST               1
-                     556 LOAD_FAST               12 (f_count)
-                     558 BINARY_OP                5 (*)
-                     562 LOAD_CONST               6 (0.1)
-                     564 BUILD_LIST               1
-                     566 BINARY_OP                0 (+)
-                     570 STORE_FAST              13 (row_heights)
-                     572 JUMP_FORWARD             4 (to 582)
-         
-         113     >>  574 LOAD_CONST               5 (0.9)
-                     576 LOAD_CONST               6 (0.1)
-                     578 BUILD_LIST               2
-                     580 STORE_FAST              13 (row_heights)
-         
-         114     >>  582 LOAD_GLOBAL             39 (NULL + make_subplots)
-                     594 LOAD_GLOBAL             21 (NULL + len)
-                     606 LOAD_FAST               13 (row_heights)
-                     608 PRECALL                  1
-                     612 CALL                     1
-                     622 LOAD_CONST               4 (1)
-                     624 LOAD_FAST               13 (row_heights)
-                     626 LOAD_CONST               7 (True)
-         
-         115         628 LOAD_CONST               8 (0.05)
-         
-         114         630 KW_NAMES                 9
-                     632 PRECALL                  5
-                     636 CALL                     5
-                     646 STORE_FAST              14 (fig)
-         
-         117         648 LOAD_GLOBAL             41 (NULL + enumerate)
-                     660 LOAD_FAST                3 (features)
-                     662 LOAD_CONST               4 (1)
-                     664 KW_NAMES                10
-                     666 PRECALL                  2
-                     670 CALL                     2
-                     680 GET_ITER
-                 >>  682 FOR_ITER               181 (to 1046)
-                     684 UNPACK_SEQUENCE          2
-                     688 STORE_FAST              15 (i)
-                     690 STORE_FAST              16 (f)
-         
-         119         692 LOAD_FAST                8 (df)
-                     694 LOAD_GLOBAL             28 (mdd)
-                     706 LOAD_ATTR               15 (MDConcepts)
-                     716 LOAD_ATTR               17 (Time)
-                     726 BINARY_SUBSCR
-                     736 LOAD_FAST                8 (df)
-                     738 LOAD_FAST               16 (f)
-                     740 BINARY_SUBSCR
-                     750 STORE_FAST              18 (y)
-                     752 STORE_FAST              17 (x)
-         
-         120         754 LOAD_FAST               18 (y)
-                     756 LOAD_METHOD             21 (isna)
-                     778 PRECALL                  0
-                     782 CALL                     0
-                     792 UNARY_INVERT
-                     794 STORE_FAST              19 (isna_)
-         
-         121         796 LOAD_FAST               17 (x)
-                     798 LOAD_FAST               19 (isna_)
-                     800 BINARY_SUBSCR
-                     810 LOAD_FAST               18 (y)
-                     812 LOAD_FAST               19 (isna_)
-                     814 BINARY_SUBSCR
-                     824 STORE_FAST              18 (y)
-                     826 STORE_FAST              17 (x)
-         
-         122         828 LOAD_FAST                9 (sampler)
-                     830 POP_JUMP_FORWARD_IF_NONE    54 (to 940)
-         
-         123         832 LOAD_FAST               17 (x)
-                     834 LOAD_ATTR               22 (values)
-                     844 STORE_FAST              17 (x)
-         
-         124         846 LOAD_FAST               18 (y)
-                     848 LOAD_ATTR               22 (values)
-                     858 STORE_FAST              18 (y)
-         
-         125         860 LOAD_FAST                9 (sampler)
-                     862 LOAD_METHOD             23 (downsample)
-                     884 LOAD_FAST               17 (x)
-                     886 LOAD_FAST               18 (y)
-                     888 LOAD_FAST                5 (downsample_to)
-                     890 KW_NAMES                11
-                     892 PRECALL                  3
-                     896 CALL                     3
-                     906 STORE_FAST              20 (sidx)
-         
-         126         908 LOAD_FAST               17 (x)
-                     910 LOAD_FAST               20 (sidx)
-                     912 BINARY_SUBSCR
-                     922 STORE_FAST              17 (x)
-         
-         127         924 LOAD_FAST               18 (y)
-                     926 LOAD_FAST               20 (sidx)
-                     928 BINARY_SUBSCR
-                     938 STORE_FAST              18 (y)
-         
-         129     >>  940 LOAD_FAST                6 (split_into_subplots)
-                     942 POP_JUMP_FORWARD_IF_FALSE     2 (to 948)
-                     944 LOAD_FAST               15 (i)
-                     946 JUMP_FORWARD             1 (to 950)
-                 >>  948 LOAD_CONST               4 (1)
-                 >>  950 STORE_FAST              21 (row)
-         
-         130         952 LOAD_FAST               14 (fig)
-                     954 LOAD_METHOD             24 (add_trace)
-                     976 LOAD_GLOBAL             51 (NULL + go)
-                     988 LOAD_ATTR               26 (Scattergl)
-                     998 LOAD_FAST               16 (f)
-                    1000 LOAD_FAST               17 (x)
-                    1002 LOAD_FAST               18 (y)
-                    1004 LOAD_CONST              12 ('lines')
-                    1006 KW_NAMES                13
-                    1008 PRECALL                  4
-                    1012 CALL                     4
-                    1022 LOAD_FAST               21 (row)
-                    1024 LOAD_CONST               4 (1)
-                    1026 KW_NAMES                14
-                    1028 PRECALL                  3
-                    1032 CALL                     3
-                    1042 POP_TOP
-                    1044 JUMP_BACKWARD          182 (to 682)
-         
-         132     >> 1046 LOAD_GLOBAL             21 (NULL + len)
-                    1058 LOAD_FAST               13 (row_heights)
-                    1060 PRECALL                  1
-                    1064 CALL                     1
-                    1074 STORE_FAST              22 (last_row_idx)
-         
-         133        1076 LOAD_FAST                4 (events)
-                    1078 GET_ITER
-                 >> 1080 FOR_ITER               146 (to 1374)
-                    1082 STORE_FAST              23 (e)
-         
-         134        1084 LOAD_FAST                0 (md)
-                    1086 LOAD_ATTR               27 (event_series)
-                    1096 LOAD_FAST               23 (e)
-                    1098 BINARY_SUBSCR
-                    1108 LOAD_ATTR                9 (df)
-                    1118 STORE_FAST              24 (edf)
+                     380 LOAD_GLOBAL             28 (MDConcepts)
+                     392 LOAD_ATTR               15 (Object)
+                     402 BINARY_SUBSCR
+                     412 LOAD_FAST                2 (object)
+                     414 COMPARE_OP               2 (==)
+         
+         109         420 LOAD_GLOBAL             28 (MDConcepts)
+                     432 LOAD_ATTR               16 (Time)
          
-         135        1120 LOAD_FAST               24 (edf)
-                    1122 LOAD_ATTR               13 (loc)
-                    1132 LOAD_FAST               24 (edf)
-                    1134 LOAD_ATTR               28 (object)
-                    1144 LOAD_FAST                2 (object)
-                    1146 COMPARE_OP               2 (==)
-                    1152 BINARY_SUBSCR
-                    1162 STORE_FAST              24 (edf)
-         
-         136        1164 LOAD_FAST               24 (edf)
-                    1166 LOAD_GLOBAL             28 (mdd)
-                    1178 LOAD_ATTR               15 (MDConcepts)
-                    1188 LOAD_ATTR               17 (Time)
-                    1198 BINARY_SUBSCR
-                    1208 STORE_FAST              17 (x)
-         
-         137        1210 LOAD_FAST               14 (fig)
-                    1212 LOAD_METHOD             24 (add_trace)
-         
-         138        1234 LOAD_GLOBAL             51 (NULL + go)
-                    1246 LOAD_ATTR               29 (Scatter)
-                    1256 LOAD_FAST               23 (e)
-                    1258 LOAD_FAST               17 (x)
-                    1260 LOAD_GLOBAL             61 (NULL + np)
-                    1272 LOAD_ATTR               31 (zeros_like)
-                    1282 LOAD_FAST               17 (x)
-                    1284 PRECALL                  1
-                    1288 CALL                     1
-                    1298 LOAD_CONST              15 ('markers')
-         
-         139        1300 LOAD_GLOBAL             65 (NULL + dict)
-                    1312 LOAD_CONST              16 (10)
-                    1314 LOAD_CONST              17 (4)
-                    1316 LOAD_CONST              18 ('line-ns-open')
-                    1318 KW_NAMES                19
-                    1320 PRECALL                  3
-                    1324 CALL                     3
-         
-         138        1334 KW_NAMES                20
-                    1336 PRECALL                  5
-                    1340 CALL                     5
-         
-         139        1350 LOAD_FAST               22 (last_row_idx)
-                    1352 LOAD_CONST               4 (1)
-         
-         137        1354 KW_NAMES                14
-                    1356 PRECALL                  3
-                    1360 CALL                     3
-                    1370 POP_TOP
-                    1372 JUMP_BACKWARD          147 (to 1080)
-         
-         141     >> 1374 LOAD_FAST               14 (fig)
-                    1376 LOAD_METHOD             33 (update_yaxes)
-                    1398 LOAD_FAST               22 (last_row_idx)
-                    1400 LOAD_CONST               4 (1)
-                    1402 LOAD_CONST              21 (False)
-                    1404 KW_NAMES                22
-                    1406 PRECALL                  3
-                    1410 CALL                     3
-                    1420 POP_TOP
-         
-         143        1422 LOAD_CONST              23 ('Timeseries')
-                    1424 STORE_FAST              25 (title_text)
-         
-         144        1426 LOAD_FAST                9 (sampler)
-                    1428 POP_JUMP_FORWARD_IF_NONE    12 (to 1454)
-         
-         145        1430 LOAD_FAST               25 (title_text)
-                    1432 LOAD_CONST              24 ('<br><sup>(sampled to ')
-                    1434 LOAD_FAST                5 (downsample_to)
-                    1436 FORMAT_VALUE             0
-                    1438 LOAD_CONST              25 (' out of ')
-                    1440 LOAD_FAST               10 (full_length)
-                    1442 FORMAT_VALUE             0
-                    1444 LOAD_CONST              26 (' data points)</sup>')
-                    1446 BUILD_STRING             5
-                    1448 BINARY_OP               13 (+=)
-                    1452 STORE_FAST              25 (title_text)
-         
-         146     >> 1454 LOAD_FAST               14 (fig)
-                    1456 LOAD_METHOD             34 (update_layout)
-                    1478 LOAD_FAST               25 (title_text)
-                    1480 LOAD_CONST               7 (True)
-         
-         147        1482 LOAD_GLOBAL             65 (NULL + dict)
-                    1494 LOAD_CONST               2 (0)
-                    1496 LOAD_CONST              27 (-0.2)
-                    1498 LOAD_CONST              28 ('h')
-                    1500 KW_NAMES                29
-                    1502 PRECALL                  3
-                    1506 CALL                     3
-         
-         146        1516 KW_NAMES                30
-                    1518 PRECALL                  3
-                    1522 CALL                     3
-                    1532 POP_TOP
+         108         442 BUILD_LIST               1
          
-         149        1534 LOAD_FAST               14 (fig)
-                    1536 RETURN_VALUE
+         109         444 LOAD_FAST                3 (features)
+         
+         108         446 BINARY_OP                0 (+)
+                     450 BUILD_TUPLE              2
+                     452 BINARY_SUBSCR
+                     462 STORE_FAST               8 (df)
+         
+         111         464 LOAD_FAST                6 (split_into_subplots)
+                     466 POP_JUMP_FORWARD_IF_FALSE    43 (to 554)
+         
+         112         468 LOAD_GLOBAL             35 (NULL + max)
+                     480 LOAD_CONST               4 (1)
+                     482 LOAD_GLOBAL             21 (NULL + len)
+                     494 LOAD_FAST                3 (features)
+                     496 PRECALL                  1
+                     500 CALL                     1
+                     510 PRECALL                  2
+                     514 CALL                     2
+                     524 STORE_FAST              12 (f_count)
+         
+         113         526 LOAD_CONST               5 (0.9)
+                     528 LOAD_FAST               12 (f_count)
+                     530 BINARY_OP               11 (/)
+                     534 BUILD_LIST               1
+                     536 LOAD_FAST               12 (f_count)
+                     538 BINARY_OP                5 (*)
+                     542 LOAD_CONST               6 (0.1)
+                     544 BUILD_LIST               1
+                     546 BINARY_OP                0 (+)
+                     550 STORE_FAST              13 (row_heights)
+                     552 JUMP_FORWARD             4 (to 562)
+         
+         115     >>  554 LOAD_CONST               5 (0.9)
+                     556 LOAD_CONST               6 (0.1)
+                     558 BUILD_LIST               2
+                     560 STORE_FAST              13 (row_heights)
+         
+         116     >>  562 LOAD_GLOBAL             37 (NULL + make_subplots)
+                     574 LOAD_GLOBAL             21 (NULL + len)
+                     586 LOAD_FAST               13 (row_heights)
+                     588 PRECALL                  1
+                     592 CALL                     1
+                     602 LOAD_CONST               4 (1)
+                     604 LOAD_FAST               13 (row_heights)
+                     606 LOAD_CONST               7 (True)
+         
+         117         608 LOAD_CONST               8 (0.05)
+         
+         116         610 KW_NAMES                 9
+                     612 PRECALL                  5
+                     616 CALL                     5
+                     626 STORE_FAST              14 (fig)
+         
+         119         628 LOAD_GLOBAL             39 (NULL + enumerate)
+                     640 LOAD_FAST                3 (features)
+                     642 LOAD_CONST               4 (1)
+                     644 KW_NAMES                10
+                     646 PRECALL                  2
+                     650 CALL                     2
+                     660 GET_ITER
+                 >>  662 FOR_ITER               176 (to 1016)
+                     664 UNPACK_SEQUENCE          2
+                     668 STORE_FAST              15 (i)
+                     670 STORE_FAST              16 (f)
+         
+         121         672 LOAD_FAST                8 (df)
+                     674 LOAD_GLOBAL             28 (MDConcepts)
+                     686 LOAD_ATTR               16 (Time)
+                     696 BINARY_SUBSCR
+                     706 LOAD_FAST                8 (df)
+                     708 LOAD_FAST               16 (f)
+                     710 BINARY_SUBSCR
+                     720 STORE_FAST              18 (y)
+                     722 STORE_FAST              17 (x)
+         
+         122         724 LOAD_FAST               18 (y)
+                     726 LOAD_METHOD             20 (isna)
+                     748 PRECALL                  0
+                     752 CALL                     0
+                     762 UNARY_INVERT
+                     764 STORE_FAST              19 (isna_)
+         
+         123         766 LOAD_FAST               17 (x)
+                     768 LOAD_FAST               19 (isna_)
+                     770 BINARY_SUBSCR
+                     780 LOAD_FAST               18 (y)
+                     782 LOAD_FAST               19 (isna_)
+                     784 BINARY_SUBSCR
+                     794 STORE_FAST              18 (y)
+                     796 STORE_FAST              17 (x)
+         
+         124         798 LOAD_FAST                9 (sampler)
+                     800 POP_JUMP_FORWARD_IF_NONE    54 (to 910)
+         
+         125         802 LOAD_FAST               17 (x)
+                     804 LOAD_ATTR               21 (values)
+                     814 STORE_FAST              17 (x)
+         
+         126         816 LOAD_FAST               18 (y)
+                     818 LOAD_ATTR               21 (values)
+                     828 STORE_FAST              18 (y)
+         
+         127         830 LOAD_FAST                9 (sampler)
+                     832 LOAD_METHOD             22 (downsample)
+                     854 LOAD_FAST               17 (x)
+                     856 LOAD_FAST               18 (y)
+                     858 LOAD_FAST                5 (downsample_to)
+                     860 KW_NAMES                11
+                     862 PRECALL                  3
+                     866 CALL                     3
+                     876 STORE_FAST              20 (sampled_idx)
+         
+         128         878 LOAD_FAST               17 (x)
+                     880 LOAD_FAST               20 (sampled_idx)
+                     882 BINARY_SUBSCR
+                     892 STORE_FAST              17 (x)
+         
+         129         894 LOAD_FAST               18 (y)
+                     896 LOAD_FAST               20 (sampled_idx)
+                     898 BINARY_SUBSCR
+                     908 STORE_FAST              18 (y)
+         
+         131     >>  910 LOAD_FAST                6 (split_into_subplots)
+                     912 POP_JUMP_FORWARD_IF_FALSE     2 (to 918)
+                     914 LOAD_FAST               15 (i)
+                     916 JUMP_FORWARD             1 (to 920)
+                 >>  918 LOAD_CONST               4 (1)
+                 >>  920 STORE_FAST              21 (row)
+         
+         132         922 LOAD_FAST               14 (fig)
+                     924 LOAD_METHOD             23 (add_trace)
+                     946 LOAD_GLOBAL             49 (NULL + go)
+                     958 LOAD_ATTR               25 (Scattergl)
+                     968 LOAD_FAST               16 (f)
+                     970 LOAD_FAST               17 (x)
+                     972 LOAD_FAST               18 (y)
+                     974 LOAD_CONST              12 ('lines')
+                     976 KW_NAMES                13
+                     978 PRECALL                  4
+                     982 CALL                     4
+                     992 LOAD_FAST               21 (row)
+                     994 LOAD_CONST               4 (1)
+                     996 KW_NAMES                14
+                     998 PRECALL                  3
+                    1002 CALL                     3
+                    1012 POP_TOP
+                    1014 JUMP_BACKWARD          177 (to 662)
+         
+         134     >> 1016 LOAD_GLOBAL             21 (NULL + len)
+                    1028 LOAD_FAST               13 (row_heights)
+                    1030 PRECALL                  1
+                    1034 CALL                     1
+                    1044 STORE_FAST              22 (last_row_idx)
+         
+         135        1046 LOAD_FAST                4 (events)
+                    1048 GET_ITER
+                 >> 1050 FOR_ITER               141 (to 1334)
+                    1052 STORE_FAST              23 (e)
+         
+         136        1054 LOAD_FAST                0 (md)
+                    1056 LOAD_ATTR               26 (event_series)
+                    1066 LOAD_FAST               23 (e)
+                    1068 BINARY_SUBSCR
+                    1078 LOAD_ATTR                9 (df)
+                    1088 STORE_FAST              24 (edf)
+         
+         137        1090 LOAD_FAST               24 (edf)
+                    1092 LOAD_ATTR               13 (loc)
+                    1102 LOAD_FAST               24 (edf)
+                    1104 LOAD_ATTR               27 (object)
+                    1114 LOAD_FAST                2 (object)
+                    1116 COMPARE_OP               2 (==)
+                    1122 BINARY_SUBSCR
+                    1132 STORE_FAST              24 (edf)
+         
+         138        1134 LOAD_FAST               24 (edf)
+                    1136 LOAD_GLOBAL             28 (MDConcepts)
+                    1148 LOAD_ATTR               16 (Time)
+                    1158 BINARY_SUBSCR
+                    1168 STORE_FAST              17 (x)
+         
+         139        1170 LOAD_FAST               14 (fig)
+                    1172 LOAD_METHOD             23 (add_trace)
+         
+         140        1194 LOAD_GLOBAL             49 (NULL + go)
+                    1206 LOAD_ATTR               28 (Scatter)
+                    1216 LOAD_FAST               23 (e)
+                    1218 LOAD_FAST               17 (x)
+                    1220 LOAD_GLOBAL             59 (NULL + np)
+                    1232 LOAD_ATTR               30 (zeros_like)
+                    1242 LOAD_FAST               17 (x)
+                    1244 PRECALL                  1
+                    1248 CALL                     1
+                    1258 LOAD_CONST              15 ('markers')
+         
+         141        1260 LOAD_GLOBAL             63 (NULL + dict)
+                    1272 LOAD_CONST              16 (10)
+                    1274 LOAD_CONST              17 (4)
+                    1276 LOAD_CONST              18 ('line-ns-open')
+                    1278 KW_NAMES                19
+                    1280 PRECALL                  3
+                    1284 CALL                     3
+         
+         140        1294 KW_NAMES                20
+                    1296 PRECALL                  5
+                    1300 CALL                     5
+         
+         141        1310 LOAD_FAST               22 (last_row_idx)
+                    1312 LOAD_CONST               4 (1)
+         
+         139        1314 KW_NAMES                14
+                    1316 PRECALL                  3
+                    1320 CALL                     3
+                    1330 POP_TOP
+                    1332 JUMP_BACKWARD          142 (to 1050)
+         
+         143     >> 1334 LOAD_FAST               14 (fig)
+                    1336 LOAD_METHOD             32 (update_yaxes)
+                    1358 LOAD_FAST               22 (last_row_idx)
+                    1360 LOAD_CONST               4 (1)
+                    1362 LOAD_CONST              21 (False)
+                    1364 KW_NAMES                22
+                    1366 PRECALL                  3
+                    1370 CALL                     3
+                    1380 POP_TOP
+         
+         145        1382 LOAD_CONST              23 ('Timeseries')
+                    1384 STORE_FAST              25 (title_text)
+         
+         146        1386 LOAD_FAST                9 (sampler)
+                    1388 POP_JUMP_FORWARD_IF_NONE    12 (to 1414)
+         
+         147        1390 LOAD_FAST               25 (title_text)
+                    1392 LOAD_CONST              24 ('<br><sup>(sampled to ')
+                    1394 LOAD_FAST                5 (downsample_to)
+                    1396 FORMAT_VALUE             0
+                    1398 LOAD_CONST              25 (' out of ')
+                    1400 LOAD_FAST               10 (full_length)
+                    1402 FORMAT_VALUE             0
+                    1404 LOAD_CONST              26 (' data points)</sup>')
+                    1406 BUILD_STRING             5
+                    1408 BINARY_OP               13 (+=)
+                    1412 STORE_FAST              25 (title_text)
+         
+         148     >> 1414 LOAD_FAST               14 (fig)
+                    1416 LOAD_METHOD             33 (update_layout)
+                    1438 LOAD_FAST               25 (title_text)
+                    1440 LOAD_CONST               7 (True)
+         
+         149        1442 LOAD_GLOBAL             63 (NULL + dict)
+                    1454 LOAD_CONST               2 (0)
+                    1456 LOAD_CONST              27 (-0.2)
+                    1458 LOAD_CONST              28 ('h')
+                    1460 KW_NAMES                29
+                    1462 PRECALL                  3
+                    1466 CALL                     3
+         
+         148        1476 KW_NAMES                30
+                    1478 PRECALL                  3
+                    1482 CALL                     3
+                    1492 POP_TOP
+         
+         151        1494 LOAD_FAST               14 (fig)
+                    1496 RETURN_VALUE
          consts
             None
             ('if_true',)
             0
             ('MinMaxLTTBDownsampler',)
             1
             0.9
@@ -1313,321 +1252,320 @@
             '<br><sup>(sampled to '
             ' out of '
             ' data points)</sup>'
             -0.2
             'h'
             ('x', 'y', 'orientation')
             ('title_text', 'showlegend', 'legend')
-         names      ('mangle_arg_with_bool_fallback', 'mangle_arg_to_set', 'event_specs', 'keys', 'measurement_series', 'mangle_arg_to_list', 'timeseries_spec', 'features', 'set', 'df', 'len', 'tsdownsample', 'MinMaxLTTBDownsampler', 'loc', 'mdd', 'MDConcepts', 'Object', 'Time', 'max', 'make_subplots', 'enumerate', 'isna', 'values', 'downsample', 'add_trace', 'go', 'Scattergl', 'event_series', 'object', 'Scatter', 'np', 'zeros_like', 'dict', 'update_yaxes', 'update_layout')
-         varnames   ('md', 'measurement_type', 'object', 'features', 'events', 'downsample_to', 'split_into_subplots', 'tsc', 'df', 'sampler', 'full_length', 'MinMaxLTTBDownsampler', 'f_count', 'row_heights', 'fig', 'i', 'f', 'x', 'y', 'isna_', 'sidx', 'row', 'last_row_idx', 'e', 'edf', 'title_text')
+         names      ('mangle_arg_with_bool_fallback', 'mangle_arg_to_set', 'event_specs', 'keys', 'measurement_series', 'mangle_arg_to_list', 'timeseries_spec', 'features', 'set', 'df', 'len', 'tsdownsample', 'MinMaxLTTBDownsampler', 'loc', 'MDConcepts', 'Object', 'Time', 'max', 'make_subplots', 'enumerate', 'isna', 'values', 'downsample', 'add_trace', 'go', 'Scattergl', 'event_series', 'object', 'Scatter', 'np', 'zeros_like', 'dict', 'update_yaxes', 'update_layout')
+         varnames   ('md', 'measurement_type', 'object', 'features', 'events', 'downsample_to', 'split_into_subplots', 'tsc', 'df', 'sampler', 'full_length', 'MinMaxLTTBDownsampler', 'f_count', 'row_heights', 'fig', 'i', 'f', 'x', 'y', 'isna_', 'sampled_idx', 'row', 'last_row_idx', 'e', 'edf', 'title_text')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
          name       'create_timeseries_plot'
-         firstlineno 91
+         firstlineno 92
          lnotab
-            0x02035c011a01420258010e0204011e010c010c011402760204013a011c
-            0208012e0102ff12032c023e012a01200104010e010e013001100110020c
-            015e021e01080124012c012e011801420122ff100104fe14043002040104
-            0118011c0122ff1203
+            0x02035c011a01420258010e0204011e010c010c011402360116ff020102
+            ff120304013a011c0208012e0102ff12032c0234012a01200104010e010e
+            013001100110020c015e021e01080124012c0124011801420122ff100104
+            fe140430020401040118011c0122ff1203
       code
          argcount  : 2
          nlocals   : 14
          stacksize : 14
          flags     : 3
          code
             0x97007401000000000000000000006a010000000000000000a6000000ab
             0000000000000000007d027404000000000000000000006a030000000000
             0000006a0400000000000000006a0500000000000000007d037c006a0600
             000000000000007d0464018400740f000000000000000000007c04741100
             0000000000000000007c03a6010000ab010000000000000000a6020000ab
             0200000000000000004400a6000000ab0000000000000000007d057c006a
             090000000000000000a00a00000000000000000000000000000000000000
-            00a6000000ab000000000000000000440090015d4e5c0200007d067d077c
-            076a0b0000000000000000a00a0000000000000000000000000000000000
-            000000a6000000ab000000000000000000440090015d2d5c0200007d087d
-            097c096a0c0000000000000000640219000000000000000000a00d000000
-            0000000000000000000000000000000000a6000000ab0000000000000000
-            00a00e0000000000000000000000000000000000000000a6000000ab0000
-            0000000000000064036400850219000000000000000000a00f0000000000
-            0000000000000000000000000000007420000000000000000000006a1100
-            000000000000006a120000000000000000a6010000ab0100000000000000
-            007d0a7c01721064037c0a7c0a64046b0300000000190000000000000000
-            007a0b00007d0b6e057c0a64057a0500007d0b7427000000000000000000
-            007c0aa6010000ab01000000000000000064046b0400000000724b7c0a7c
-            0a64046b020000000019000000000000000000a014000000000000000000
-            0000000000000000000000a6000000ab0000000000000000007427000000
-            000000000000007c0aa6010000ab0100000000000000007a0b00007d0c7c
-            0c64046b04000000007217742b00000000000000000000640664077c0c7a
-            05000064089b0464099d03a6010000ab0100000000000000000100740100
-            0000000000000000006a1600000000000000007c06670174270000000000
-            00000000007c0ba6010000ab0100000000000000007a0500007c0b7c0874
-            2f000000000000000000007c057c0819000000000000000000ac0aa60100
-            00ab010000000000000000640b640c7c08640d7c08ac0ea6090000ab0900
-            000000000000007d0d7c02a0180000000000000000000000000000000000
-            0000007c0da6010000ab010000000000000000010090018c2f90018c507c
-            0444005d4a7d087c02a01800000000000000000000000000000000000000
-            007401000000000000000000006a19000000000000000064006701640067
-            01742f000000000000000000007c057c0819000000000000000000ac0aa6
-            010000ab010000000000000000640f7c086410641169017c08640c6412ac
-            13a6090000ab090000000000000000a6010000ab01000000000000000001
-            008c4b7c02a01a000000000000000000000000000000000000000064147c
-            01720264156e016416641764186419ac1aa6050000ab0500000000000000
-            0001007c025300
-         152           0 RESUME                   0
+            00a6000000ab000000000000000000440090015d415c0200007d067d077c
+            076a060000000000000000440090015d327d087c077c0819000000000000
+            0000007d097c096a0b0000000000000000640219000000000000000000a0
+            0c0000000000000000000000000000000000000000a6000000ab00000000
+            0000000000a00d0000000000000000000000000000000000000000a60000
+            00ab00000000000000000064036400850219000000000000000000a00e00
+            00000000000000000000000000000000000000741e000000000000000000
+            006a1000000000000000006a110000000000000000a6010000ab01000000
+            00000000007d0a7c01721064037c0a7c0a64046b03000000001900000000
+            00000000007a0b00007d0b6e057c0a64057a0500007d0b74250000000000
+            00000000007c0aa6010000ab01000000000000000064046b040000000072
+            4b7c0a7c0a64046b020000000019000000000000000000a0130000000000
+            000000000000000000000000000000a6000000ab00000000000000000074
+            25000000000000000000007c0aa6010000ab0100000000000000007a0b00
+            007d0c7c0c64046b04000000007217742900000000000000000000640664
+            077c0c7a05000064089b0464099d03a6010000ab01000000000000000001
+            007401000000000000000000006a1500000000000000007c066701742500
+            0000000000000000007c0ba6010000ab0100000000000000007a0500007c
+            0b7c08742d000000000000000000007c057c0819000000000000000000ac
+            0aa6010000ab010000000000000000640b640c7c08640d7c08ac0ea60900
+            00ab0900000000000000007d0d7c02a01700000000000000000000000000
+            000000000000007c0da6010000ab010000000000000000010090018c3490
+            018c437c0444005d4a7d087c02a017000000000000000000000000000000
+            00000000007401000000000000000000006a180000000000000000640067
+            0164006701742d000000000000000000007c057c08190000000000000000
+            00ac0aa6010000ab010000000000000000640f7c086410641169017c0864
+            0c6412ac13a6090000ab090000000000000000a6010000ab010000000000
+            00000001008c4b7c02a01900000000000000000000000000000000000000
+            0064147c01720264156e016416641764186419ac1aa6050000ab05000000
+            000000000001007c025300
+         154           0 RESUME                   0
          
-         153           2 LOAD_GLOBAL              1 (NULL + go)
+         155           2 LOAD_GLOBAL              1 (NULL + go)
                       14 LOAD_ATTR                1 (Figure)
                       24 PRECALL                  0
                       28 CALL                     0
                       38 STORE_FAST               2 (fig)
          
-         154          40 LOAD_GLOBAL              4 (plotly)
+         156          40 LOAD_GLOBAL              4 (plotly)
                       52 LOAD_ATTR                3 (colors)
                       62 LOAD_ATTR                4 (qualitative)
                       72 LOAD_ATTR                5 (Plotly)
                       82 STORE_FAST               3 (colorscale)
          
-         155          84 LOAD_FAST                0 (md)
-                      86 LOAD_ATTR                6 (occurring_objects)
+         157          84 LOAD_FAST                0 (md)
+                      86 LOAD_ATTR                6 (objects)
                       96 STORE_FAST               4 (objs)
          
-         156          98 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 156>)
+         158          98 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\Leah\PycharmProjects\mdata\src\mdata\visualization\plotting.py", line 158>)
                      100 MAKE_FUNCTION            0
                      102 LOAD_GLOBAL             15 (NULL + zip)
                      114 LOAD_FAST                4 (objs)
                      116 LOAD_GLOBAL             17 (NULL + cycle)
                      128 LOAD_FAST                3 (colorscale)
                      130 PRECALL                  1
                      134 CALL                     1
                      144 PRECALL                  2
                      148 CALL                     2
                      158 GET_ITER
                      160 PRECALL                  0
                      164 CALL                     0
                      174 STORE_FAST               5 (color_dict)
          
-         157         176 LOAD_FAST                0 (md)
+         159         176 LOAD_FAST                0 (md)
                      178 LOAD_ATTR                9 (measurement_series)
                      188 LOAD_METHOD             10 (items)
                      210 PRECALL                  0
                      214 CALL                     0
                      224 GET_ITER
                  >>  226 EXTENDED_ARG             1
-                     228 FOR_ITER               334 (to 898)
+                     228 FOR_ITER               321 (to 872)
                      230 UNPACK_SEQUENCE          2
                      234 STORE_FAST               6 (m)
                      236 STORE_FAST               7 (msc)
          
-         158         238 LOAD_FAST                7 (msc)
-                     240 LOAD_ATTR               11 (object_map)
-                     250 LOAD_METHOD             10 (items)
-                     272 PRECALL                  0
-                     276 CALL                     0
-                     286 GET_ITER
-                 >>  288 EXTENDED_ARG             1
-                     290 FOR_ITER               301 (to 894)
-                     292 UNPACK_SEQUENCE          2
-                     296 STORE_FAST               8 (o)
-                     298 STORE_FAST               9 (ts)
-         
-         159         300 LOAD_FAST                9 (ts)
-                     302 LOAD_ATTR               12 (df)
-                     312 LOAD_CONST               2 ('time')
-                     314 BINARY_SUBSCR
-                     324 LOAD_METHOD             13 (sort_values)
-                     346 PRECALL                  0
-                     350 CALL                     0
-                     360 LOAD_METHOD             14 (diff)
-                     382 PRECALL                  0
-                     386 CALL                     0
-                     396 LOAD_CONST               3 (1)
-                     398 LOAD_CONST               0 (None)
-                     400 BUILD_SLICE              2
-                     402 BINARY_SUBSCR
-                     412 LOAD_METHOD             15 (map)
-                     434 LOAD_GLOBAL             32 (pd)
-                     446 LOAD_ATTR               17 (Timedelta)
-                     456 LOAD_ATTR               18 (total_seconds)
-                     466 PRECALL                  1
-                     470 CALL                     1
-                     480 STORE_FAST              10 (diffs)
-         
-         161         482 LOAD_FAST                1 (use_hz)
-                     484 POP_JUMP_FORWARD_IF_FALSE    16 (to 518)
-         
-         162         486 LOAD_CONST               3 (1)
-                     488 LOAD_FAST               10 (diffs)
-                     490 LOAD_FAST               10 (diffs)
-                     492 LOAD_CONST               4 (0)
-                     494 COMPARE_OP               3 (!=)
-                     500 BINARY_SUBSCR
-                     510 BINARY_OP               11 (/)
-                     514 STORE_FAST              11 (series)
-                     516 JUMP_FORWARD             5 (to 528)
-         
-         164     >>  518 LOAD_FAST               10 (diffs)
-                     520 LOAD_CONST               5 (1000)
-                     522 BINARY_OP                5 (*)
-                     526 STORE_FAST              11 (series)
-         
-         165     >>  528 LOAD_GLOBAL             39 (NULL + len)
-                     540 LOAD_FAST               10 (diffs)
-                     542 PRECALL                  1
-                     546 CALL                     1
-                     556 LOAD_CONST               4 (0)
-                     558 COMPARE_OP               4 (>)
-                     564 POP_JUMP_FORWARD_IF_FALSE    75 (to 716)
-         
-         166         566 LOAD_FAST               10 (diffs)
-                     568 LOAD_FAST               10 (diffs)
-                     570 LOAD_CONST               4 (0)
-                     572 COMPARE_OP               2 (==)
-                     578 BINARY_SUBSCR
-                     588 LOAD_METHOD             20 (count)
-                     610 PRECALL                  0
-                     614 CALL                     0
-                     624 LOAD_GLOBAL             39 (NULL + len)
-                     636 LOAD_FAST               10 (diffs)
-                     638 PRECALL                  1
-                     642 CALL                     1
-                     652 BINARY_OP               11 (/)
-                     656 STORE_FAST              12 (zero_fraction)
-         
-         167         658 LOAD_FAST               12 (zero_fraction)
-                     660 LOAD_CONST               4 (0)
-                     662 COMPARE_OP               4 (>)
-                     668 POP_JUMP_FORWARD_IF_FALSE    23 (to 716)
-         
-         168         670 LOAD_GLOBAL             43 (NULL + print)
-                     682 LOAD_CONST               6 ('Overlapping timestamps: ')
-                     684 LOAD_CONST               7 (100)
-                     686 LOAD_FAST               12 (zero_fraction)
-                     688 BINARY_OP                5 (*)
-                     692 LOAD_CONST               8 ('.2f')
-                     694 FORMAT_VALUE             4 (with format)
-                     696 LOAD_CONST               9 ('%')
-                     698 BUILD_STRING             3
-                     700 PRECALL                  1
-                     704 CALL                     1
-                     714 POP_TOP
-         
-         169     >>  716 LOAD_GLOBAL              1 (NULL + go)
-                     728 LOAD_ATTR               22 (Box)
-                     738 LOAD_FAST                6 (m)
-                     740 BUILD_LIST               1
-                     742 LOAD_GLOBAL             39 (NULL + len)
-                     754 LOAD_FAST               11 (series)
-                     756 PRECALL                  1
-                     760 CALL                     1
-                     770 BINARY_OP                5 (*)
-                     774 LOAD_FAST               11 (series)
-                     776 LOAD_FAST                8 (o)
-                     778 LOAD_GLOBAL             47 (NULL + dict)
-                     790 LOAD_FAST                5 (color_dict)
-                     792 LOAD_FAST                8 (o)
-                     794 BINARY_SUBSCR
-                     804 KW_NAMES                10
-                     806 PRECALL                  1
-                     810 CALL                     1
-         
-         170         820 LOAD_CONST              11 ('suspectedoutliers')
-         
-         171         822 LOAD_CONST              12 (True)
-                     824 LOAD_FAST                8 (o)
-                     826 LOAD_CONST              13 (False)
-                     828 LOAD_FAST                8 (o)
-         
-         169         830 KW_NAMES                14
-                     832 PRECALL                  9
-                     836 CALL                     9
-                     846 STORE_FAST              13 (b)
-         
-         173         848 LOAD_FAST                2 (fig)
-                     850 LOAD_METHOD             24 (add_trace)
-                     872 LOAD_FAST               13 (b)
-                     874 PRECALL                  1
-                     878 CALL                     1
-                     888 POP_TOP
-                     890 EXTENDED_ARG             1
-                     892 JUMP_BACKWARD          303 (to 288)
-         
-         158     >>  894 EXTENDED_ARG             1
-                     896 JUMP_BACKWARD          336 (to 226)
-         
-         175     >>  898 LOAD_FAST                4 (objs)
-                     900 GET_ITER
-                 >>  902 FOR_ITER                74 (to 1052)
-                     904 STORE_FAST               8 (o)
-         
-         177         906 LOAD_FAST                2 (fig)
-                     908 LOAD_METHOD             24 (add_trace)
-         
-         178         930 LOAD_GLOBAL              1 (NULL + go)
-                     942 LOAD_ATTR               25 (Scatter)
-                     952 LOAD_CONST               0 (None)
-                     954 BUILD_LIST               1
-                     956 LOAD_CONST               0 (None)
-                     958 BUILD_LIST               1
-                     960 LOAD_GLOBAL             47 (NULL + dict)
-                     972 LOAD_FAST                5 (color_dict)
-                     974 LOAD_FAST                8 (o)
-                     976 BINARY_SUBSCR
-                     986 KW_NAMES                10
-                     988 PRECALL                  1
-                     992 CALL                     1
-                    1002 LOAD_CONST              15 ('markers')
-                    1004 LOAD_FAST                8 (o)
-         
-         179        1006 LOAD_CONST              16 ('color')
-                    1008 LOAD_CONST              17 ('rgba(0, 0, 0, 0)')
-                    1010 BUILD_MAP                1
-                    1012 LOAD_FAST                8 (o)
-                    1014 LOAD_CONST              12 (True)
-                    1016 LOAD_CONST              18 ('none')
-         
-         178        1018 KW_NAMES                19
-                    1020 PRECALL                  9
-                    1024 CALL                     9
-         
-         177        1034 PRECALL                  1
-                    1038 CALL                     1
-                    1048 POP_TOP
-                    1050 JUMP_BACKWARD           75 (to 902)
-         
-         180     >> 1052 LOAD_FAST                2 (fig)
-                    1054 LOAD_METHOD             26 (update_layout)
-                    1076 LOAD_CONST              20 ('Empirical Frequency of Measurement Types per Object')
-         
-         181        1078 LOAD_FAST                1 (use_hz)
-                    1080 POP_JUMP_FORWARD_IF_FALSE     2 (to 1086)
-                    1082 LOAD_CONST              21 ('[Hz]')
-                    1084 JUMP_FORWARD             1 (to 1088)
-                 >> 1086 LOAD_CONST              22 ('[ms]')
-         
-         182     >> 1088 LOAD_CONST              23 ('Measurement Type')
-                    1090 LOAD_CONST              24 ('Objects')
-                    1092 LOAD_CONST              25 ('group')
-         
-         180        1094 KW_NAMES                26
-                    1096 PRECALL                  5
-                    1100 CALL                     5
-                    1110 POP_TOP
+         160         238 LOAD_FAST                7 (msc)
+                     240 LOAD_ATTR                6 (objects)
+                     250 GET_ITER
+                 >>  252 EXTENDED_ARG             1
+                     254 FOR_ITER               306 (to 868)
+                     256 STORE_FAST               8 (o)
+         
+         161         258 LOAD_FAST                7 (msc)
+                     260 LOAD_FAST                8 (o)
+                     262 BINARY_SUBSCR
+                     272 STORE_FAST               9 (ts)
+         
+         162         274 LOAD_FAST                9 (ts)
+                     276 LOAD_ATTR               11 (df)
+                     286 LOAD_CONST               2 ('time')
+                     288 BINARY_SUBSCR
+                     298 LOAD_METHOD             12 (sort_values)
+                     320 PRECALL                  0
+                     324 CALL                     0
+                     334 LOAD_METHOD             13 (diff)
+                     356 PRECALL                  0
+                     360 CALL                     0
+                     370 LOAD_CONST               3 (1)
+                     372 LOAD_CONST               0 (None)
+                     374 BUILD_SLICE              2
+                     376 BINARY_SUBSCR
+                     386 LOAD_METHOD             14 (map)
+                     408 LOAD_GLOBAL             30 (pd)
+                     420 LOAD_ATTR               16 (Timedelta)
+                     430 LOAD_ATTR               17 (total_seconds)
+                     440 PRECALL                  1
+                     444 CALL                     1
+                     454 STORE_FAST              10 (diffs)
+         
+         164         456 LOAD_FAST                1 (use_hz)
+                     458 POP_JUMP_FORWARD_IF_FALSE    16 (to 492)
+         
+         165         460 LOAD_CONST               3 (1)
+                     462 LOAD_FAST               10 (diffs)
+                     464 LOAD_FAST               10 (diffs)
+                     466 LOAD_CONST               4 (0)
+                     468 COMPARE_OP               3 (!=)
+                     474 BINARY_SUBSCR
+                     484 BINARY_OP               11 (/)
+                     488 STORE_FAST              11 (series)
+                     490 JUMP_FORWARD             5 (to 502)
+         
+         167     >>  492 LOAD_FAST               10 (diffs)
+                     494 LOAD_CONST               5 (1000)
+                     496 BINARY_OP                5 (*)
+                     500 STORE_FAST              11 (series)
+         
+         168     >>  502 LOAD_GLOBAL             37 (NULL + len)
+                     514 LOAD_FAST               10 (diffs)
+                     516 PRECALL                  1
+                     520 CALL                     1
+                     530 LOAD_CONST               4 (0)
+                     532 COMPARE_OP               4 (>)
+                     538 POP_JUMP_FORWARD_IF_FALSE    75 (to 690)
+         
+         169         540 LOAD_FAST               10 (diffs)
+                     542 LOAD_FAST               10 (diffs)
+                     544 LOAD_CONST               4 (0)
+                     546 COMPARE_OP               2 (==)
+                     552 BINARY_SUBSCR
+                     562 LOAD_METHOD             19 (count)
+                     584 PRECALL                  0
+                     588 CALL                     0
+                     598 LOAD_GLOBAL             37 (NULL + len)
+                     610 LOAD_FAST               10 (diffs)
+                     612 PRECALL                  1
+                     616 CALL                     1
+                     626 BINARY_OP               11 (/)
+                     630 STORE_FAST              12 (zero_fraction)
+         
+         170         632 LOAD_FAST               12 (zero_fraction)
+                     634 LOAD_CONST               4 (0)
+                     636 COMPARE_OP               4 (>)
+                     642 POP_JUMP_FORWARD_IF_FALSE    23 (to 690)
+         
+         171         644 LOAD_GLOBAL             41 (NULL + print)
+                     656 LOAD_CONST               6 ('Overlapping timestamps: ')
+                     658 LOAD_CONST               7 (100)
+                     660 LOAD_FAST               12 (zero_fraction)
+                     662 BINARY_OP                5 (*)
+                     666 LOAD_CONST               8 ('.2f')
+                     668 FORMAT_VALUE             4 (with format)
+                     670 LOAD_CONST               9 ('%')
+                     672 BUILD_STRING             3
+                     674 PRECALL                  1
+                     678 CALL                     1
+                     688 POP_TOP
+         
+         172     >>  690 LOAD_GLOBAL              1 (NULL + go)
+                     702 LOAD_ATTR               21 (Box)
+                     712 LOAD_FAST                6 (m)
+                     714 BUILD_LIST               1
+                     716 LOAD_GLOBAL             37 (NULL + len)
+                     728 LOAD_FAST               11 (series)
+                     730 PRECALL                  1
+                     734 CALL                     1
+                     744 BINARY_OP                5 (*)
+                     748 LOAD_FAST               11 (series)
+                     750 LOAD_FAST                8 (o)
+                     752 LOAD_GLOBAL             45 (NULL + dict)
+                     764 LOAD_FAST                5 (color_dict)
+                     766 LOAD_FAST                8 (o)
+                     768 BINARY_SUBSCR
+                     778 KW_NAMES                10
+                     780 PRECALL                  1
+                     784 CALL                     1
+         
+         173         794 LOAD_CONST              11 ('suspectedoutliers')
+         
+         174         796 LOAD_CONST              12 (True)
+                     798 LOAD_FAST                8 (o)
+                     800 LOAD_CONST              13 (False)
+                     802 LOAD_FAST                8 (o)
+         
+         172         804 KW_NAMES                14
+                     806 PRECALL                  9
+                     810 CALL                     9
+                     820 STORE_FAST              13 (b)
+         
+         176         822 LOAD_FAST                2 (fig)
+                     824 LOAD_METHOD             23 (add_trace)
+                     846 LOAD_FAST               13 (b)
+                     848 PRECALL                  1
+                     852 CALL                     1
+                     862 POP_TOP
+                     864 EXTENDED_ARG             1
+                     866 JUMP_BACKWARD          308 (to 252)
+         
+         160     >>  868 EXTENDED_ARG             1
+                     870 JUMP_BACKWARD          323 (to 226)
+         
+         178     >>  872 LOAD_FAST                4 (objs)
+                     874 GET_ITER
+                 >>  876 FOR_ITER                74 (to 1026)
+                     878 STORE_FAST               8 (o)
+         
+         180         880 LOAD_FAST                2 (fig)
+                     882 LOAD_METHOD             23 (add_trace)
+         
+         181         904 LOAD_GLOBAL              1 (NULL + go)
+                     916 LOAD_ATTR               24 (Scatter)
+                     926 LOAD_CONST               0 (None)
+                     928 BUILD_LIST               1
+                     930 LOAD_CONST               0 (None)
+                     932 BUILD_LIST               1
+                     934 LOAD_GLOBAL             45 (NULL + dict)
+                     946 LOAD_FAST                5 (color_dict)
+                     948 LOAD_FAST                8 (o)
+                     950 BINARY_SUBSCR
+                     960 KW_NAMES                10
+                     962 PRECALL                  1
+                     966 CALL                     1
+                     976 LOAD_CONST              15 ('markers')
+                     978 LOAD_FAST                8 (o)
+         
+         182         980 LOAD_CONST              16 ('color')
+                     982 LOAD_CONST              17 ('rgba(0, 0, 0, 0)')
+                     984 BUILD_MAP                1
+                     986 LOAD_FAST                8 (o)
+                     988 LOAD_CONST              12 (True)
+                     990 LOAD_CONST              18 ('none')
+         
+         181         992 KW_NAMES                19
+                     994 PRECALL                  9
+                     998 CALL                     9
+         
+         180        1008 PRECALL                  1
+                    1012 CALL                     1
+                    1022 POP_TOP
+                    1024 JUMP_BACKWARD           75 (to 876)
+         
+         183     >> 1026 LOAD_FAST                2 (fig)
+                    1028 LOAD_METHOD             25 (update_layout)
+                    1050 LOAD_CONST              20 ('Empirical Frequency of Measurement Types per Object')
+         
+         184        1052 LOAD_FAST                1 (use_hz)
+                    1054 POP_JUMP_FORWARD_IF_FALSE     2 (to 1060)
+                    1056 LOAD_CONST              21 ('[Hz]')
+                    1058 JUMP_FORWARD             1 (to 1062)
+                 >> 1060 LOAD_CONST              22 ('[ms]')
+         
+         185     >> 1062 LOAD_CONST              23 ('Measurement Type')
+                    1064 LOAD_CONST              24 ('Objects')
+                    1066 LOAD_CONST              25 ('group')
+         
+         183        1068 KW_NAMES                26
+                    1070 PRECALL                  5
+                    1074 CALL                     5
+                    1084 POP_TOP
          
-         183        1112 LOAD_FAST                2 (fig)
-                    1114 RETURN_VALUE
+         186        1086 LOAD_FAST                2 (fig)
+                    1088 RETURN_VALUE
          consts
             None
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 4
                flags     : 19
                code 0x970069007c005d085c0200007d017d027c017c0293028c095300
-               156           0 RESUME                   0
+               158           0 RESUME                   0
                              2 BUILD_MAP                0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 8 (to 24)
                              8 UNPACK_SEQUENCE          2
                             12 STORE_FAST               1 (o)
                             14 STORE_FAST               2 (c)
                             16 LOAD_FAST                1 (o)
@@ -1638,15 +1576,15 @@
                consts
                names      ()
                varnames   ('.0', 'o', 'c')
                freevars   ()
                cellvars   ()
                filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
                name       '<dictcomp>'
-               firstlineno 156
+               firstlineno 158
                lnotab 0x
             'time'
             1
             0
             1000
             'Overlapping timestamps: '
             100
@@ -1665,31 +1603,31 @@
             'Empirical Frequency of Measurement Types per Object'
             '[Hz]'
             '[ms]'
             'Measurement Type'
             'Objects'
             'group'
             ('title_text', 'yaxis_title', 'xaxis_title', 'legend_title', 'boxmode')
-         names      ('go', 'Figure', 'plotly', 'colors', 'qualitative', 'Plotly', 'occurring_objects', 'zip', 'cycle', 'measurement_series', 'items', 'object_map', 'df', 'sort_values', 'diff', 'map', 'pd', 'Timedelta', 'total_seconds', 'len', 'count', 'print', 'Box', 'dict', 'add_trace', 'Scatter', 'update_layout')
+         names      ('go', 'Figure', 'plotly', 'colors', 'qualitative', 'Plotly', 'objects', 'zip', 'cycle', 'measurement_series', 'items', 'df', 'sort_values', 'diff', 'map', 'pd', 'Timedelta', 'total_seconds', 'len', 'count', 'print', 'Box', 'dict', 'add_trace', 'Scatter', 'update_layout')
          varnames   ('md', 'use_hz', 'fig', 'colorscale', 'objs', 'color_dict', 'm', 'msc', 'o', 'ts', 'diffs', 'series', 'zero_fraction', 'b')
          freevars   ()
          cellvars   ()
          filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
          name       'create_measurement_frequency_plot'
-         firstlineno 152
+         firstlineno 154
          lnotab
-            0x020126012c010e014e013e013e01b602040120020a0126015c010c012e
-            016801020108fe12042ef10411080218014c010cff10ff12031a010a0106
-            fe1203
+            0x020126012c010e014e013e0114011001b602040120020a0126015c010c
+            012e016801020108fe12042ef00412080218014c010cff10ff12031a010a
+            0106fe1203
       (10000, True)
       (True, True, 15000, False)
       (True,)
-   names      ('itertools', 'cycle', 'typing', 'TypedDict', 'Collection', 'numpy', 'np', 'pandas', 'pd', 'plotly', 'plotly.graph_objects', 'graph_objects', 'go', 'plotly.subplots', 'make_subplots', 'mdata.core', 'machine_data_def', 'mdd', 'mdata.core.util', 'mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'MachineData', 'create_overview_plot', 'Selection', 'str', 'bool', 'create_timeseries_plot', 'create_measurement_frequency_plot')
+   names      ('itertools', 'cycle', 'typing', 'TypedDict', 'Collection', 'numpy', 'np', 'pandas', 'pd', 'plotly', 'plotly.graph_objects', 'graph_objects', 'go', 'plotly.subplots', 'make_subplots', 'mdata.core', 'MDConcepts', 'MachineData', 'ObservationTypes', 'mdata.core.shared_defs', 'project_on_feature_columns', 'mdata.core.util', 'mangle_arg_to_set', 'mangle_arg_with_bool_fallback', 'mangle_arg_to_list', 'create_overview_plot', 'Selection', 'str', 'bool', 'create_timeseries_plot', 'create_measurement_frequency_plot')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'C:\\Users\\Leah\\PycharmProjects\\mdata\\src\\mdata\\visualization\\plotting.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff02010c0110020801080108010c010c020c01140318461c08020102
-      fe1a0114ff020214fe083d
+      0x00ff02010c0110020801080108010c010c0214010c0114030e461c0802
+      0102fe100114ff020214fe083e
```

### Comparing `mdata-0.1.2/src/mdata/visualization/matplot.py` & `mdata-0.1.3/src/mdata/visualization/matplot.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,30 +1,28 @@
-from typing import TypedDict, Collection, Optional
-
 import matplotlib.pyplot as plt
 import seaborn as sns
 
-from mdata.core import mdd
+from mdata.core import MachineData
 
-def create_basic_stacked_subplots(md: mdd.MachineData, measurement_type: str, objects: set[str] = None, features: list[str] = None, figsize=None):
+def create_basic_stacked_subplots(md: MachineData, measurement_type: str, objects: set[str] = None, features: list[str] = None, figsize=None):
     tsc = md.measurement_series[measurement_type]
     os = objects
     fs = features
     if os is None:
-        os = list(tsc.object_map.keys())
+        os = list(tsc.objects)
     else:
-        assert os <= set(tsc.object_map.keys())
-        os = [o for o in tsc.object_map if o in os]
+        assert os <= set(tsc.objects)
+        os = [o for o in tsc.objects if o in os]
     if fs is None:
         fs = list(tsc.timeseries_spec.features)
     else:
         assert set(fs) <= set(tsc.timeseries_spec.features)
         fs = [f for f in fs if f in tsc.timeseries_spec.features]
 
-    fig, axs = plt.subplots(len(fs), 1, sharex=True, figsize=figsize)
+    fig, axs = plt.subplots(len(fs), 1, sharex='all', figsize=figsize)
 
     for i, f in enumerate(fs):
         for o in os:
             ts = tsc.view(o)
             sns.lineplot(data=ts.df, x='time', y=f, ax=axs[i])
         # axs[i].plot(tsc.df.time, tsc.df[f])
         # axs[i].set_title(f)
```

### Comparing `mdata-0.1.2/src/mdata/visualization/plotting.py` & `mdata-0.1.3/src/mdata/visualization/plotting.py`

 * *Files 4% similar despite different names*

```diff
@@ -3,57 +3,58 @@
 
 import numpy as np
 import pandas as pd
 import plotly
 import plotly.graph_objects as go
 from plotly.subplots import make_subplots
 
-from mdata.core import machine_data_def as mdd
+from mdata.core import MDConcepts, MachineData, ObservationTypes
+from mdata.core.shared_defs import project_on_feature_columns
 from mdata.core.util import mangle_arg_to_set, mangle_arg_with_bool_fallback, mangle_arg_to_list
 
 
-def create_overview_plot(md: mdd.MachineData, downsample_to=10_000, use_gl=True):
+def create_overview_plot(md: MachineData, downsample_to=10_000, use_gl=True):
     fig = make_subplots(rows=2, cols=1, shared_xaxes=True,
                         vertical_spacing=0.1)
 
     def create_hovertemplate(fs):
         return '<b>time: %{x:%X}</b>' \
             + '<br>' \
             + '<br>'.join([f'<i>{f}: %{{customdata[{i}]}}</i>' for i, f in enumerate(fs)]) + '<extra></extra>'
 
-    def derive_colors(series, colorscale=plotly.colors.qualitative.Plotly):
-        codes, _ = pd.factorize(series)
-        codes = codes % len(colorscale)
-        return np.take(colorscale, codes)
+    # def derive_colors(series, colorscale=plotly.colors.qualitative.Plotly):
+    #     codes, _ = pd.factorize(series)
+    #     codes = codes % len(colorscale)
+    #     return np.take(colorscale, codes)
 
     did_downsample = False
     colorscale = plotly.colors.qualitative.Plotly
-    objs = md.occurring_objects
+    objs = md.objects
     color_dict = {o: c for o, c in zip(objs, cycle(colorscale))}
 
-    for tsc in md.iter_all_timeseries():
+    for tsc in md.series_containers:
         timeseries_type = tsc.timeseries_spec
         typ = timeseries_type.type
-        row = 1 if typ == mdd.ObservationTypes.E else 2
+        row = 1 if typ == ObservationTypes.E else 2
         fs = timeseries_type.features
-        for g, gidx in tsc.df.groupby(mdd.MDConcepts.Object).groups.items():
+        for g, idx in tsc.df.groupby(MDConcepts.Object).groups.items():
             obj = g
-            df = tsc.df.loc[gidx]
+            df = tsc.df.loc[idx]
             c = color_dict[g]
 
             length = len(df)
             if downsample_to and length > downsample_to:
                 assert length > 0
                 step = max(1, int(length / downsample_to + .5))
                 idx = np.arange(0, length, step)
                 df = df.iloc[idx]
                 did_downsample = True
 
-            x, y = df[mdd.MDConcepts.Time], df[mdd.MDConcepts.Label]
-            f_df = mdd.project_on_feature_columns(df)
+            x, y = df[MDConcepts.Time], df[MDConcepts.Label]
+            f_df = project_on_feature_columns(df)
             cls = go.Scattergl if use_gl else go.Scatter
             marker = dict(color=c)  # size=2
             n = f'{timeseries_type.type}_{timeseries_type.label}_{obj}'
             g = cls(name=n, customdata=f_df, x=x, y=y, mode='markers',
                     hovertemplate=create_hovertemplate(fs), marker=marker, legendgroup=obj,
                     showlegend=False)
             fig.add_trace(g, row=row, col=1)
@@ -84,15 +85,15 @@
 class Selection(TypedDict):
     object: str
     measurement: str
     features: list[str] | bool
     events: set[str] | bool
 
 
-def create_timeseries_plot(md: mdd.MachineData, measurement_type: str, object: str,
+def create_timeseries_plot(md: MachineData, measurement_type: str, object: str,
                            features: Collection[str] | bool = True,
                            events: Collection[str] | bool = True, downsample_to=15_000, split_into_subplots=False):
     events = mangle_arg_with_bool_fallback(mangle_arg_to_set, events, if_true=md.event_specs.keys())
     tsc = md.measurement_series[measurement_type]
     features = mangle_arg_with_bool_fallback(mangle_arg_to_list, features, if_true=tsc.timeseries_spec.features)
 
     assert set(features) <= set(tsc.timeseries_spec.features)
@@ -100,44 +101,45 @@
 
     sampler = None
     full_length = len(df)
     if full_length > downsample_to:
         from tsdownsample import MinMaxLTTBDownsampler
         sampler = MinMaxLTTBDownsampler()
 
-    df = df.loc[df[mdd.MDConcepts.Object] == object, [mdd.MDConcepts.Time] + features]
+    df = df.loc[df[MDConcepts.Object] == object, [
+        MDConcepts.Time] + features]
 
     if split_into_subplots:
         f_count = max(1, len(features))
         row_heights = [.9 / f_count] * f_count + [.1]
     else:
         row_heights = [.9, .1]
     fig = make_subplots(rows=len(row_heights), cols=1, row_heights=row_heights, shared_xaxes=True,
                         vertical_spacing=0.05)
 
     for i, f in enumerate(features, start=1):
         # go.scatter.Line()
-        x, y = df[mdd.MDConcepts.Time], df[f]
+        x, y = df[MDConcepts.Time], df[f]
         isna_ = ~y.isna()
         x, y = x[isna_], y[isna_]
         if sampler is not None:
             x = x.values
             y = y.values
-            sidx = sampler.downsample(x, y, n_out=downsample_to)
-            x = x[sidx]
-            y = y[sidx]
+            sampled_idx = sampler.downsample(x, y, n_out=downsample_to)
+            x = x[sampled_idx]
+            y = y[sampled_idx]
 
         row = i if split_into_subplots else 1
         fig.add_trace(go.Scattergl(name=f, x=x, y=y, mode='lines'), row=row, col=1)
 
     last_row_idx = len(row_heights)
     for e in events:
         edf = md.event_series[e].df
         edf = edf.loc[edf.object == object]
-        x = edf[mdd.MDConcepts.Time]
+        x = edf[MDConcepts.Time]
         fig.add_trace(
             go.Scatter(name=e, x=x, y=np.zeros_like(x), mode='markers',
                        marker=dict(size=10, line_width=4, symbol='line-ns-open')), row=last_row_idx, col=1)
 
     fig.update_yaxes(row=last_row_idx, col=1, visible=False)
 
     title_text = 'Timeseries'
@@ -145,21 +147,22 @@
         title_text += f'<br><sup>(sampled to {downsample_to} out of {full_length} data points)</sup>'
     fig.update_layout(title_text=title_text, showlegend=True,
                       legend=dict(x=0, y=-0.2, orientation='h'))
 
     return fig
 
 
-def create_measurement_frequency_plot(md: mdd.MachineData, use_hz=True):
+def create_measurement_frequency_plot(md: MachineData, use_hz=True):
     fig = go.Figure()
     colorscale = plotly.colors.qualitative.Plotly
-    objs = md.occurring_objects
+    objs = md.objects
     color_dict = {o: c for o, c in zip(objs, cycle(colorscale))}
     for m, msc in md.measurement_series.items():
-        for o, ts in msc.object_map.items():
+        for o in msc.objects:
+            ts = msc[o]
             diffs = ts.df['time'].sort_values().diff()[1:].map(pd.Timedelta.total_seconds)
             series: pd.Series
             if use_hz:
                 series = 1 / diffs[diffs != 0]
             else:
                 series = diffs * 1000
             if len(diffs) > 0:
```

### Comparing `mdata-0.1.2/PKG-INFO` & `mdata-0.1.3/PKG-INFO`

 * *Files 16% similar despite different names*

```diff
@@ -1,30 +1,24 @@
 Metadata-Version: 2.1
 Name: mdata
-Version: 0.1.2
+Version: 0.1.3
 Summary: 
 License: MIT
 Keywords: data format,machine data
 Author: Leah Tacke genannt Unterberg
 Author-email: leah.tgu@pads.rwth-aachen.de
-Requires-Python: >=3.10,<4.0
+Requires-Python: >=3.11,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
-Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
-Requires-Dist: bottleneck
 Requires-Dist: immutabledict
-Requires-Dist: llvmlite (>=0.40,<0.41)
 Requires-Dist: matplotlib
-Requires-Dist: numba (>=0.57,<0.58)
-Requires-Dist: numexpr
-Requires-Dist: pandas (>=1.5,<2.0)
+Requires-Dist: pandas[clipboard,computation,excel,hdf5,output-formatting,performance,postgresql] (>=2.0,<3.0)
 Requires-Dist: plotly (>=5.15,<6.0)
 Requires-Dist: seaborn
-Requires-Dist: tables
 Requires-Dist: tsdownsample (>=0.1.2,<0.2.0)
 Description-Content-Type: text/markdown
 
 This is the official machine data format package.
 
 It supports csv importing, exporting and format compliance checking.
 Machine data is parsed into a python object that provides typed views on the contained measurement and event timeseries.
```

