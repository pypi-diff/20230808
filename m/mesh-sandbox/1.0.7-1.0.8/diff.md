# Comparing `tmp/mesh_sandbox-1.0.7-py3-none-any.whl.zip` & `tmp/mesh_sandbox-1.0.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 78925 bytes, number of entries: 76
+Zip file size: 79266 bytes, number of entries: 76
 -rw-r--r--  2.0 unx       22 b- defN 80-Jan-01 00:00 mesh_sandbox/__init__.py
 -rw-r--r--  2.0 unx     3925 b- defN 80-Jan-01 00:00 mesh_sandbox/api.py
 -rw-r--r--  2.0 unx     3403 b- defN 80-Jan-01 00:00 mesh_sandbox/common/__init__.py
 -rw-r--r--  2.0 unx     6504 b- defN 80-Jan-01 00:00 mesh_sandbox/common/constants.py
 -rw-r--r--  2.0 unx     1481 b- defN 80-Jan-01 00:00 mesh_sandbox/common/exceptions.py
 -rw-r--r--  2.0 unx      551 b- defN 80-Jan-01 00:00 mesh_sandbox/common/fernet.py
 -rw-r--r--  2.0 unx      392 b- defN 80-Jan-01 00:00 mesh_sandbox/common/handler_helpers.py
 -rw-r--r--  2.0 unx    14664 b- defN 80-Jan-01 00:00 mesh_sandbox/common/messaging.py
 -rw-r--r--  2.0 unx     6088 b- defN 80-Jan-01 00:00 mesh_sandbox/common/mex_headers.py
 -rw-r--r--  2.0 unx     2233 b- defN 80-Jan-01 00:00 mesh_sandbox/conftest.py
 -rw-r--r--  2.0 unx     4089 b- defN 80-Jan-01 00:00 mesh_sandbox/dependencies.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/__init__.py
 -rw-r--r--  2.0 unx     4143 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/admin.py
 -rw-r--r--  2.0 unx      605 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/handshake.py
--rw-r--r--  2.0 unx    15450 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/inbox.py
+-rw-r--r--  2.0 unx    15582 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/inbox.py
 -rw-r--r--  2.0 unx     1392 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/lookup.py
 -rw-r--r--  2.0 unx    10045 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/outbox.py
 -rw-r--r--  2.0 unx     2356 b- defN 80-Jan-01 00:00 mesh_sandbox/handlers/tracking.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 mesh_sandbox/models/__init__.py
 -rw-r--r--  2.0 unx     1032 b- defN 80-Jan-01 00:00 mesh_sandbox/models/mailbox.py
 -rw-r--r--  2.0 unx     4926 b- defN 80-Jan-01 00:00 mesh_sandbox/models/message.py
 -rw-r--r--  2.0 unx      518 b- defN 80-Jan-01 00:00 mesh_sandbox/models/workflow.py
@@ -52,27 +52,27 @@
 -rw-r--r--  2.0 unx       24 b- defN 80-Jan-01 00:00 mesh_sandbox/test_plugin/example_plugin.txt
 -rw-r--r--  2.0 unx      106 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/__init__.py
 -rw-r--r--  2.0 unx    15707 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/admin.py
 -rw-r--r--  2.0 unx     1598 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/docker_tests.py
 -rw-r--r--  2.0 unx      740 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/exceptions.py
 -rw-r--r--  2.0 unx     6259 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/handshake.py
 -rw-r--r--  2.0 unx     6885 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/helpers.py
--rw-r--r--  2.0 unx    10412 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/inbox.py
+-rw-r--r--  2.0 unx    11683 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/inbox.py
 -rw-r--r--  2.0 unx     6547 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/java_client_tests.py
 -rw-r--r--  2.0 unx     2768 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/lookup.py
 -rw-r--r--  2.0 unx     3901 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/mesh_api_helpers.py
 -rw-r--r--  2.0 unx     3947 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/mesh_client_tests.py
 -rw-r--r--  2.0 unx     5006 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/messaging_tests.py
--rw-r--r--  2.0 unx    20061 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/outbox.py
+-rw-r--r--  2.0 unx    21329 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/outbox.py
 -rw-r--r--  2.0 unx      663 b- defN 80-Jan-01 00:00 mesh_sandbox/tests/serialisation.py
 -rw-r--r--  2.0 unx     1237 b- defN 80-Jan-01 00:00 mesh_sandbox/views/__init__.py
 -rw-r--r--  2.0 unx     2314 b- defN 80-Jan-01 00:00 mesh_sandbox/views/admin.py
 -rw-r--r--  2.0 unx     3885 b- defN 80-Jan-01 00:00 mesh_sandbox/views/error.py
 -rw-r--r--  2.0 unx     5662 b- defN 80-Jan-01 00:00 mesh_sandbox/views/inbox.py
 -rw-r--r--  2.0 unx     2775 b- defN 80-Jan-01 00:00 mesh_sandbox/views/lookup.py
 -rw-r--r--  2.0 unx     4932 b- defN 80-Jan-01 00:00 mesh_sandbox/views/outbox.py
 -rw-r--r--  2.0 unx     8918 b- defN 80-Jan-01 00:00 mesh_sandbox/views/tracking.py
--rw-r--r--  2.0 unx     1051 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.7.dist-info/LICENSE
--rw-r--r--  2.0 unx     2388 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.7.dist-info/METADATA
--rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.7.dist-info/WHEEL
-?rw-r--r--  2.0 unx     6902 b- defN 16-Jan-01 00:00 mesh_sandbox-1.0.7.dist-info/RECORD
-76 files, 262680 bytes uncompressed, 67807 bytes compressed:  74.2%
+-rw-r--r--  2.0 unx     1051 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.8.dist-info/LICENSE
+-rw-r--r--  2.0 unx     2388 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.8.dist-info/METADATA
+-rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 mesh_sandbox-1.0.8.dist-info/WHEEL
+?rw-r--r--  2.0 unx     6902 b- defN 16-Jan-01 00:00 mesh_sandbox-1.0.8.dist-info/RECORD
+76 files, 265351 bytes uncompressed, 68148 bytes compressed:  74.3%
```

## zipnote {}

```diff
@@ -210,20 +210,20 @@
 
 Filename: mesh_sandbox/views/outbox.py
 Comment: 
 
 Filename: mesh_sandbox/views/tracking.py
 Comment: 
 
-Filename: mesh_sandbox-1.0.7.dist-info/LICENSE
+Filename: mesh_sandbox-1.0.8.dist-info/LICENSE
 Comment: 
 
-Filename: mesh_sandbox-1.0.7.dist-info/METADATA
+Filename: mesh_sandbox-1.0.8.dist-info/METADATA
 Comment: 
 
-Filename: mesh_sandbox-1.0.7.dist-info/WHEEL
+Filename: mesh_sandbox-1.0.8.dist-info/WHEEL
 Comment: 
 
-Filename: mesh_sandbox-1.0.7.dist-info/RECORD
+Filename: mesh_sandbox-1.0.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mesh_sandbox/__init__.py

```diff
@@ -1 +1 @@
-__version__ = "1.0.7"
+__version__ = "1.0.8"
```

## mesh_sandbox/handlers/inbox.py

```diff
@@ -237,15 +237,19 @@
         max_results: int = DEFAULT_MAX_RESULTS,
         last_key: Optional[dict] = None,
         message_filter: Optional[Callable[[Message], bool]] = None,
         rich: bool = False,
     ) -> tuple[list[Message], Optional[dict]]:
 
         messages = (
-            await self.messaging.get_inbox_messages(mailbox.mailbox_id)
+            sorted(
+                await self.messaging.get_inbox_messages(mailbox.mailbox_id),
+                key=lambda message: message.created_timestamp,
+                reverse=True,
+            )
             if rich
             else await self.messaging.get_accepted_inbox_messages(mailbox.mailbox_id)
         )
 
         if message_filter:
             messages = list(filter(message_filter, messages))
```

## mesh_sandbox/tests/inbox.py

```diff
@@ -120,14 +120,15 @@
             next_page,
             headers={Headers.Authorization: generate_auth_token(recipient), Headers.Accept: accept},
         )
         response = res.json()
         assert response["messages"] == message_ids[page_size : page_size * 2]
 
     # rich inbox
+    message_ids = list(reversed(message_ids))
 
     res = app.get(
         f"/messageexchange/{recipient}/inbox/rich?max_results={page_size}",
         headers={Headers.Authorization: generate_auth_token(recipient), Headers.Accept: accept},
     )
 
     assert res.status_code == status.HTTP_200_OK
@@ -148,16 +149,14 @@
     # rich outbox
 
     res = app.get(
         f"/messageexchange/{sender}/outbox/rich?max_results={page_size}",
         headers={Headers.Authorization: generate_auth_token(sender), Headers.Accept: accept},
     )
 
-    message_ids = list(reversed(message_ids))
-
     assert res.status_code == status.HTTP_200_OK
     response = res.json()
     messages = [res["message_id"] for res in response.get("messages", [])]
     assert messages == message_ids[:page_size]
 
     next_page = response["links"].get("next")
     assert next_page
@@ -314,7 +313,48 @@
         f"/messageexchange/{recipient}/inbox/rich",
         headers={Headers.Authorization: generate_auth_token(recipient)},
     )
     assert res.status_code == status.HTTP_200_OK
     messages = res.json().get("messages", [])
     assert len(messages) == 5
     assert acknowledged_message_id in [m["message_id"] for m in messages]
+
+
+def test_rich_inbox_returns_most_recent_messages(app: TestClient):
+
+    sender = _CANNED_MAILBOX1
+    recipient = _CANNED_MAILBOX2
+    total_messages = 105
+
+    res = app.get(
+        f"/messageexchange/{recipient}/inbox",
+        headers={Headers.Authorization: generate_auth_token(recipient)},
+    )
+    assert res.json()["messages"] == []
+
+    message_ids = {}
+    for index in range(total_messages):
+
+        resp = mesh_api_send_message(
+            app,
+            sender_mailbox_id=sender,
+            recipient_mailbox_id=recipient,
+        )
+
+        assert resp.status_code == status.HTTP_202_ACCEPTED
+        result = resp.json()
+        message_id = result["messageID"]
+        assert message_id
+        message_ids[index] = message_id
+
+    res = app.get(
+        f"/messageexchange/{recipient}/inbox/rich",
+        headers={Headers.Authorization: generate_auth_token(recipient)},
+    )
+    assert res.status_code == status.HTTP_200_OK
+    messages = res.json().get("messages", [])
+    assert len(messages) == 100  # the default limit
+
+    message_sent_index = total_messages - 1
+    for messages_in_inbox_index in range(100):
+        assert messages[messages_in_inbox_index]["message_id"] == message_ids[message_sent_index]
+        message_sent_index -= 1
```

## mesh_sandbox/tests/outbox.py

```diff
@@ -607,7 +607,48 @@
 
     download_response = app.head(
         f"/messageexchange/{recipient}/inbox/{message_id}",
         headers={Headers.Authorization: generate_auth_token(recipient), Headers.Accept: accept},
     )
     assert download_response.status_code == status.HTTP_200_OK
     assert download_response.headers[Headers.Mex_Content_Checksum] == checksum
+
+
+def test_rich_outbox_returns_most_recent_messages(app: TestClient):
+
+    sender = _CANNED_MAILBOX1
+    recipient = _CANNED_MAILBOX2
+    total_messages = 105
+
+    res = app.get(
+        f"/messageexchange/{recipient}/inbox",
+        headers={Headers.Authorization: generate_auth_token(recipient)},
+    )
+    assert res.json()["messages"] == []
+
+    message_ids = {}
+    for index in range(total_messages):
+
+        resp = mesh_api_send_message(
+            app,
+            sender_mailbox_id=sender,
+            recipient_mailbox_id=recipient,
+        )
+
+        assert resp.status_code == status.HTTP_202_ACCEPTED
+        result = resp.json()
+        message_id = result["messageID"]
+        assert message_id
+        message_ids[index] = message_id
+
+    res = app.get(
+        f"/messageexchange/{sender}/outbox/rich",
+        headers={Headers.Authorization: generate_auth_token(sender)},
+    )
+    assert res.status_code == status.HTTP_200_OK
+    messages = res.json().get("messages", [])
+    assert len(messages) == 100  # the default limit
+
+    message_sent_index = total_messages - 1
+    for messages_in_inbox_index in range(100):
+        assert messages[messages_in_inbox_index]["message_id"] == message_ids[message_sent_index]
+        message_sent_index -= 1
```

## Comparing `mesh_sandbox-1.0.7.dist-info/LICENSE` & `mesh_sandbox-1.0.8.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mesh_sandbox-1.0.7.dist-info/METADATA` & `mesh_sandbox-1.0.8.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mesh-sandbox
-Version: 1.0.7
+Version: 1.0.8
 Summary: NHSDigital mesh sandbox, a locally testable version of the MESH api
 License: MIT
 Author: spinecore
 Requires-Python: >=3.9,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.9
```

## Comparing `mesh_sandbox-1.0.7.dist-info/RECORD` & `mesh_sandbox-1.0.8.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-mesh_sandbox/__init__.py,sha256=BW7SWRpHoxuOQZ67pS20yog2LWYl-nK7-BEFBNrHGgA,22
+mesh_sandbox/__init__.py,sha256=NND_6JDYnYnGzN3-RTpS5F7wzv62vDf7hAxiyTSBJfE,22
 mesh_sandbox/api.py,sha256=F2KUKENAsSe6NAGG0wzHA2jebGF6mWFgta1q55oqacU,3925
 mesh_sandbox/common/__init__.py,sha256=MwKS4FixADUGgN49MQJI7vW0Wx6mnf9SBOPbgE4RddM,3403
 mesh_sandbox/common/constants.py,sha256=_hnaHDkAQGHWLF7n_WfC5ZHIY5D-fUbOdpSqLusUMNY,6504
 mesh_sandbox/common/exceptions.py,sha256=YQII8w6DQQoKuW0cukEr6PIE9j0rwrqDpCn5lapgmkQ,1481
 mesh_sandbox/common/fernet.py,sha256=f8yygkVnK1cmQLBgcPifoB4PwGpgiOrG8Yk-6OMDy8o,551
 mesh_sandbox/common/handler_helpers.py,sha256=Eg00Tide2mL87EoMFw83fDuxiTL5DgIwxHs2RaJasgE,392
 mesh_sandbox/common/messaging.py,sha256=xZbNpWQLhfjI4wiBG3PpIkEy2WbvwxqaWSR90sSb4hk,14664
 mesh_sandbox/common/mex_headers.py,sha256=Eu-ixdVml2obROXggYyUyiS4QZHUA1JUgF7gO4YYkyg,6088
 mesh_sandbox/conftest.py,sha256=IXrb8Y8Hi4-0ZxDNfTDFI0L1uG1Iz9FBQdNBZtPMsEw,2233
 mesh_sandbox/dependencies.py,sha256=Crl7yEUED-XYl_odMenpvMJoYeIVDROWfvcrfvV85fc,4089
 mesh_sandbox/handlers/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mesh_sandbox/handlers/admin.py,sha256=5-vdKhx-zDyzu9r0VsXtZucfK0K8bYlBibyj5xYHkEc,4143
 mesh_sandbox/handlers/handshake.py,sha256=p3_NveSscNBgCdIIJhBza34b0WreqgBxZwI2sw7ZMTk,605
-mesh_sandbox/handlers/inbox.py,sha256=J20JUX1dHlS2We2UIDQa1MMoVN_QsRoP0tC-3zKAlD8,15450
+mesh_sandbox/handlers/inbox.py,sha256=xyL7Txh4S2niBhueXNBMCr5t2nwnVIbdd_DFqXKNcco,15582
 mesh_sandbox/handlers/lookup.py,sha256=p_xmnCJi6BoNqRaQjRAGeQthL5EohQfZ_LA1h0QU36Q,1392
 mesh_sandbox/handlers/outbox.py,sha256=XrLOGhw0QqMTfMFevrh-_Z-EyFSEAQLO1BcmbL1bR0Y,10045
 mesh_sandbox/handlers/tracking.py,sha256=nmn5JexFhAvzFmj9C5l0w4sq8sNz3x-mMd3CsGVrEM4,2356
 mesh_sandbox/models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mesh_sandbox/models/mailbox.py,sha256=58R6TyH8Qn3k_V3XzWIf5vAseGCmXqQQWFJ8-Tyv2yg,1032
 mesh_sandbox/models/message.py,sha256=ze-IPbCg6XlKZtOL1RWQvMnu04AzrGppwdk2mTyVAfU,4926
 mesh_sandbox/models/workflow.py,sha256=T8A1Q729TOUaz1MOa1Ly8oZs_G4769xMZpTYGF0TlO8,518
@@ -51,26 +51,26 @@
 mesh_sandbox/test_plugin/example_plugin.txt,sha256=aUePU6UUVhpxeP37Pdz5Zxyn_nxI6HCY3qtQBo1iUEI,24
 mesh_sandbox/tests/__init__.py,sha256=wPjH0Ka1334a0OR9VMUfeYxsr03JqWjHTBnAH_1SB7I,106
 mesh_sandbox/tests/admin.py,sha256=yVD3LRWaLzQMzXysu2GKrO1ZSmwjdIhiVCpCo6xb4oQ,15707
 mesh_sandbox/tests/docker_tests.py,sha256=-dLCnAdgZkpU6tkgO4FwO7Sjvt5zZe45ewBSXo5afT0,1598
 mesh_sandbox/tests/exceptions.py,sha256=j_jKskVzLAYpyu4qNAEY5ahkbk8Uh2Nc_CGpnpdXjnI,740
 mesh_sandbox/tests/handshake.py,sha256=X-fCbwaEAc8cAvvnniCvt4W4DAV9ItPq7tpIpZkfj6M,6259
 mesh_sandbox/tests/helpers.py,sha256=wRC1t8mj4FKChebvwfcJWpxqK_nmE1NBUHgfCA2rBsk,6885
-mesh_sandbox/tests/inbox.py,sha256=GLqOC6qlivKpp7qEtcGqv_nECkf2MhP4XwRWbIPC_ks,10412
+mesh_sandbox/tests/inbox.py,sha256=zfwBEj97QmkteAbZQRnfH0P7oXOYKWgOs1GL5BjT-jM,11683
 mesh_sandbox/tests/java_client_tests.py,sha256=NYvNH1LxJc0SmHQ3q6mSvEd6Wuv2r_xMqAXW28sT2Pw,6547
 mesh_sandbox/tests/lookup.py,sha256=wY8x0F415y2um48Lw5kyD4ugMo1vBGKB7cqPdHEaVO4,2768
 mesh_sandbox/tests/mesh_api_helpers.py,sha256=ZedDWMHO88j4Zxw3hsK5vmvivy3UhdzbzHle0g9GJXA,3901
 mesh_sandbox/tests/mesh_client_tests.py,sha256=WL7ht-tT4QLMw73pIbcFMZg7Ehpn5Mi4jcZg5qgEgyw,3947
 mesh_sandbox/tests/messaging_tests.py,sha256=Bup6aJsiJ0xdtg0Ab37ME0VHI6HFJA-0ATmfS88giBI,5006
-mesh_sandbox/tests/outbox.py,sha256=AbQR8vgRy8KAG0RMCU0jYFUXSCPQMrLRJMJTU3PGQhI,20061
+mesh_sandbox/tests/outbox.py,sha256=4atWHZKtwVEFvTgcUx4U2JqjSeg2o1ueWjhmvkSt0hs,21329
 mesh_sandbox/tests/serialisation.py,sha256=kRSMZLDHlX6oRK6c2OCZL0XQoUCKQxqcYXrJWbc9VkA,663
 mesh_sandbox/views/__init__.py,sha256=nZkb6_1S8jz8Xl_AayfwjgEZG0JD2dfulfGxjJ5W9Ec,1237
 mesh_sandbox/views/admin.py,sha256=gisfIpNezpnabbs-0jXDLGTdzetq8Age6KsK8dxOkCQ,2314
 mesh_sandbox/views/error.py,sha256=9lnUr3P93Vm-nOrBTEuAD6nrSBUvpI6-XqXzILWjgGk,3885
 mesh_sandbox/views/inbox.py,sha256=gnaD9Csx5BqilVRefQQ_tXmeq80lwcLJfepW005GrkU,5662
 mesh_sandbox/views/lookup.py,sha256=HHUqZ-Iy22ysC3qaO8Bl5GBQqf_7IiBbe5acyxqS78M,2775
 mesh_sandbox/views/outbox.py,sha256=jxYiHylEdpljZ6Wl45Ke3aaH5rEKb-kzUuCNEKDS3So,4932
 mesh_sandbox/views/tracking.py,sha256=1H7Ghcvqkmx__KS1Y-lm105EVx_Z1eJo3oMDh8pzRMQ,8918
-mesh_sandbox-1.0.7.dist-info/LICENSE,sha256=usgzIvDUpVX5pYZepJTRXQJqIaz0mdd32GuS5a3PFlY,1051
-mesh_sandbox-1.0.7.dist-info/METADATA,sha256=GXyIyMoDV7WJzCWLUVO-V4vA6lmxFhV5y_IPNuMSsyk,2388
-mesh_sandbox-1.0.7.dist-info/WHEEL,sha256=Zb28QaM1gQi8f4VCBhsUklF61CTlNYfs9YAZn-TOGFk,88
-mesh_sandbox-1.0.7.dist-info/RECORD,,
+mesh_sandbox-1.0.8.dist-info/LICENSE,sha256=usgzIvDUpVX5pYZepJTRXQJqIaz0mdd32GuS5a3PFlY,1051
+mesh_sandbox-1.0.8.dist-info/METADATA,sha256=TfmA_qg9lTMjXbgzrpr3qOf9x2spgXuE1kFj-XGleIA,2388
+mesh_sandbox-1.0.8.dist-info/WHEEL,sha256=Zb28QaM1gQi8f4VCBhsUklF61CTlNYfs9YAZn-TOGFk,88
+mesh_sandbox-1.0.8.dist-info/RECORD,,
```

